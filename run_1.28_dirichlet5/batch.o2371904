2021-04-29 12:45:00,925 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.11s.
2021-04-29 12:45:01,343 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.21s.
2021-04-29 12:45:01,739 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 12:45:01,865 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.13s.
2021-04-29 12:45:01,868 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:45:01,878 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:45:02,743 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 101.
2021-04-29 12:45:02,744 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.88s.
Iteration =  0  Dual obj =  -44.71379670669206  Primal_obj =  4646521.403354173  Gap =  4646566.117150879 Sum =  426.70644918127766
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.0964692702225882  Primal_obj =  2081.5202354496028  Gap =  2081.6167047198255 Sum =  0.5600693887887935
Iteration =  3  Dual obj =  0.09206462967168885  Primal_obj =  3217.6335635067576  Gap =  3217.541498877086 Sum =  0.6007523431112993
Iteration =  4  Dual obj =  0.18151745392967317  Primal_obj =  2137.9271436618765  Gap =  2137.7456262079468 Sum =  0.5939421138139003
Iteration =  5  Dual obj =  0.25617086762802044  Primal_obj =  1097.581244384355  Gap =  1097.325073516727 Sum =  0.629421625428678
Iteration =  6  Dual obj =  0.28063874162490343  Primal_obj =  248.19990844544222  Gap =  247.91926970381732 Sum =  0.9989568142681895
Iteration =  7  Dual obj =  0.287833207975953  Primal_obj =  87.03285008620665  Gap =  86.7450168782307 Sum =  1.0449675029320469
Iteration =  8  Dual obj =  0.29093791133928415  Primal_obj =  30.68072745832278  Gap =  30.389789546983497 Sum =  1.0143464455720785
Iteration =  9  Dual obj =  0.29181225121858295  Primal_obj =  9.61556851257719  Gap =  9.323756261358607 Sum =  0.9948474042523701
Iteration =  10  Dual obj =  0.2920119736468863  Primal_obj =  3.5126097897312145  Gap =  3.2205978160843283 Sum =  0.9954069219740482
Iteration =  11  Dual obj =  0.2921090658650281  Primal_obj =  1.7801764254152184  Gap =  1.4880673595501903 Sum =  0.9970175802663499
Iteration =  12  Dual obj =  0.29214158922164396  Primal_obj =  0.718995215426248  Gap =  0.42685362620460404 Sum =  0.9988065297812008
Iteration =  13  Dual obj =  0.29215623361607324  Primal_obj =  0.6262917137796722  Gap =  0.33413548016359895 Sum =  0.9999364411444965
Iteration =  14  Dual obj =  0.29216388776282637  Primal_obj =  0.4620948913437228  Gap =  0.1699310035808964 Sum =  1.0003713131632468
Iteration =  15  Dual obj =  0.2921667583494696  Primal_obj =  0.41816442358547046  Gap =  0.12599766523600087 Sum =  1.0001146543600983
Iteration =  16  Dual obj =  0.2921696392300844  Primal_obj =  0.3709625865177963  Gap =  0.07879294728771191 Sum =  0.9998975030002278
Iteration =  17  Dual obj =  0.29217101455889083  Primal_obj =  0.33895171541474045  Gap =  0.04678070085584962 Sum =  0.9998579645749417
Iteration =  18  Dual obj =  0.29217178914357267  Primal_obj =  0.32560185250405327  Gap =  0.0334300633604806 Sum =  0.9999083739504075
Iteration =  19  Dual obj =  0.2921725313997146  Primal_obj =  0.3103220569848348  Gap =  0.018149525585120174 Sum =  0.9999514395640607
Iteration =  20  Dual obj =  0.29217293821943113  Primal_obj =  0.3041501999396743  Gap =  0.01197726172024316 Sum =  1.0000054201985247
Iteration =  21  Dual obj =  0.2921733222104835  Primal_obj =  0.32003266727685986  Gap =  0.027859345066376384 Sum =  1.00005677988299
Iteration =  22  Dual obj =  0.29217359714095875  Primal_obj =  0.2928617621964279  Gap =  0.0006881650554691476 Sum =  1.0000239769642898
Iteration =  23  Dual obj =  0.29217359803332665  Primal_obj =  0.2927707460111725  Gap =  0.0005971479778458244 Sum =  1.0000240988828206
Iteration =  24  Dual obj =  0.29217359885387784  Primal_obj =  0.29268930284714567  Gap =  0.0005157039932678353 Sum =  1.0000234646480761
Iteration =  0  Dual obj =  -24.86621618579392  Primal_obj =  3490268.340612894  Gap =  3490293.20682908 Sum =  426.70644918127766
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.1760071721705185  Primal_obj =  15243.121479418764  Gap =  15243.297486590935 Sum =  2.8875855361321845
Iteration =  4  Dual obj =  0.4807833661097553  Primal_obj =  3571.566835030919  Gap =  3571.086051664809 Sum =  0.6444420239873946
Iteration =  5  Dual obj =  0.5858147964407711  Primal_obj =  2573.969643677747  Gap =  2573.3838288813063 Sum =  0.6961885522043914
Iteration =  6  Dual obj =  0.6911479220091356  Primal_obj =  2439.3140269733763  Gap =  2438.622879051367 Sum =  0.591934664496318
Iteration =  7  Dual obj =  0.791236234577929  Primal_obj =  2884.0662086825746  Gap =  2883.274972447997 Sum =  0.5995844716089357
Iteration =  8  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  9  Dual obj =  0.8247281505599482  Primal_obj =  965.5720844497712  Gap =  964.7473562992112 Sum =  0.6570570816777863
Iteration =  10  Dual obj =  0.8608920968850123  Primal_obj =  787.552311334383  Gap =  786.691419237498 Sum =  1.214202019653347
Iteration =  11  Dual obj =  0.8773010768710034  Primal_obj =  669.2007162132779  Gap =  668.3234151364069 Sum =  0.9944509715634984
Iteration =  12  Dual obj =  0.8889457832196926  Primal_obj =  732.0311137935103  Gap =  731.1421680102906 Sum =  1.3338253756376717
Iteration =  13  Dual obj =  0.8976813515452107  Primal_obj =  403.1260829295899  Gap =  402.2284015780447 Sum =  1.006239039910403
Iteration =  14  Dual obj =  0.9031749415011552  Primal_obj =  377.2655986511516  Gap =  376.36242370965044 Sum =  1.2577074540982895
Iteration =  15  Dual obj =  0.9069982213817284  Primal_obj =  194.8964978905151  Gap =  193.98949966913335 Sum =  0.9863731788938306
Iteration =  16  Dual obj =  0.9091672864290012  Primal_obj =  106.6034606038999  Gap =  105.69429331747091 Sum =  1.1940734123043717
Iteration =  17  Dual obj =  0.9111851710707342  Primal_obj =  122.18032640911724  Gap =  121.2691412380465 Sum =  0.990199569925097
Iteration =  18  Dual obj =  0.9125878409420624  Primal_obj =  51.05269919664608  Gap =  50.14011135570402 Sum =  1.1207106396133637
Iteration =  19  Dual obj =  0.9135877689956046  Primal_obj =  55.649253451537625  Gap =  54.73566568254202 Sum =  1.0085549664077225
Iteration =  20  Dual obj =  0.9144720390688962  Primal_obj =  41.22102999832142  Gap =  40.30655795925252 Sum =  1.0876232093555331
Iteration =  21  Dual obj =  0.9149910889250578  Primal_obj =  17.2029209453834  Gap =  16.287929856458344 Sum =  1.0089046103131243
Iteration =  22  Dual obj =  0.9151820315468119  Primal_obj =  7.999602617870502  Gap =  7.08442058632369 Sum =  1.0457614277188763
Iteration =  23  Dual obj =  0.9153398390526203  Primal_obj =  11.49882078769998  Gap =  10.58348094864736 Sum =  1.008158158168603
Iteration =  24  Dual obj =  0.915524797892169  Primal_obj =  8.976796250706503  Gap =  8.061271452814333 Sum =  1.0183917979513306
Iteration =  0  Dual obj =  0.915524797892169  Primal_obj =  8.976796250706503  Gap =  8.061271452814333 Sum =  1.0183917979513306
Iteration =  1  Dual obj =  0.9155872688267483  Primal_obj =  3.2324330955180955  Gap =  2.316845826691347 Sum =  1.0229683715522757
Iteration =  2  Dual obj =  0.9156719736133603  Primal_obj =  5.386091106234282  Gap =  4.470419132620922 Sum =  1.0117093582769543
Iteration =  3  Dual obj =  0.9157297094858772  Primal_obj =  3.767620329503938  Gap =  2.851890620018061 Sum =  1.0036355439600333
Iteration =  4  Dual obj =  0.9157539513347885  Primal_obj =  2.03842238464921  Gap =  1.1226684333144215 Sum =  1.0013619702580283
Iteration =  5  Dual obj =  0.9157630387000697  Primal_obj =  1.6513795876726176  Gap =  0.7356165489725479 Sum =  1.0008267503374988
Iteration =  6  Dual obj =  0.9157688302511899  Primal_obj =  1.5362555309492754  Gap =  0.6204867006980854 Sum =  0.9996318641774855
Iteration =  7  Dual obj =  0.9157737975034728  Primal_obj =  1.502685914368667  Gap =  0.5869121168651943 Sum =  0.9997451060537376
Iteration =  8  Dual obj =  0.9157784627268951  Primal_obj =  1.3538070610489727  Gap =  0.43802859832207763 Sum =  0.9993263651279859
Iteration =  9  Dual obj =  0.9157823462634986  Primal_obj =  1.304636081740955  Gap =  0.3888537354774564 Sum =  1.0006706488663637
Iteration =  10  Dual obj =  0.9157851058205457  Primal_obj =  1.2894405217180478  Gap =  0.37365541589750206 Sum =  1.0008460324585464
Iteration =  11  Dual obj =  0.9157877991379602  Primal_obj =  1.287080969899148  Gap =  0.37129317076118795 Sum =  0.9999664600046667
Iteration =  12  Dual obj =  0.9157898876065578  Primal_obj =  1.2481992257535908  Gap =  0.332409338147033 Sum =  0.999831784999589
Iteration =  13  Dual obj =  0.915791737879841  Primal_obj =  1.2700397147202365  Gap =  0.35424797684039544 Sum =  0.9996894395016386
Iteration =  14  Dual obj =  0.915793728617406  Primal_obj =  1.1972053607787654  Gap =  0.28141163216135934 Sum =  0.9992494839958902
Iteration =  15  Dual obj =  0.9157950939411594  Primal_obj =  1.2067690170605678  Gap =  0.2909739231194084 Sum =  0.9990342824122758
Iteration =  16  Dual obj =  0.915796163006444  Primal_obj =  1.1165218269096973  Gap =  0.2007256639032533 Sum =  0.999466921809777
Iteration =  17  Dual obj =  0.9157971954038266  Primal_obj =  1.0715689479868087  Gap =  0.15577175258298204 Sum =  1.0000279672833547
Iteration =  18  Dual obj =  0.9157979234263041  Primal_obj =  1.0836022340013363  Gap =  0.1678043105750322 Sum =  1.0000590121865276
Iteration =  19  Dual obj =  0.915798736457067  Primal_obj =  1.1305515884592607  Gap =  0.21475285200219374 Sum =  1.0002938161584185
Iteration =  20  Dual obj =  0.9157995638501563  Primal_obj =  1.0874866265325547  Gap =  0.17168706268239842 Sum =  1.0004032727414842
Iteration =  21  Dual obj =  0.9158001825691404  Primal_obj =  1.052505281895379  Gap =  0.13670509932623864 Sum =  0.9998211553091411
Iteration =  22  Dual obj =  0.9158007851061162  Primal_obj =  1.055093561694404  Gap =  0.13929277658828776 Sum =  0.99955963792872
Iteration =  23  Dual obj =  0.9158013410639398  Primal_obj =  1.0963317077413663  Gap =  0.1805303666774265 Sum =  0.9996899313862833
Iteration =  24  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  0  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  1  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  2  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  3  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  4  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  5  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  6  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  7  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  8  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  9  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  10  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  11  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  12  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  13  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  14  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  15  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  16  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  17  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  18  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  19  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  20  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  21  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  22  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  23  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  24  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  0  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  1  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  2  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  3  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  4  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  5  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  6  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  7  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  8  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  9  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  10  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  11  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  12  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  13  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  14  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  15  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  16  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  17  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  18  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  19  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  20  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  21  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  22  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  23  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Iteration =  24  Dual obj =  0.9158018714592352  Primal_obj =  1.101304010159228  Gap =  0.18550213869999277 Sum =  0.9998113939549368
Done, writing results...
