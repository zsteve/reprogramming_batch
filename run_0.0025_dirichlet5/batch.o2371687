2021-04-29 12:23:31,714 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.09s.
2021-04-29 12:23:32,130 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.22s.
2021-04-29 12:23:32,532 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 12:23:32,648 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-29 12:23:32,651 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:23:32,660 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:23:33,463 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 113.
2021-04-29 12:23:33,463 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.82s.
Iteration =  0  Dual obj =  -41.160156913200176  Primal_obj =  10519.009614863187  Gap =  10560.169771776387 Sum =  382.25556782243495
Iteration =  1  Dual obj =  -0.11708115876963983  Primal_obj =  2.532143810940499  Gap =  2.6492249697101387 Sum =  0.8944327494517598
Iteration =  2  Dual obj =  -0.10185499019808432  Primal_obj =  1.0891353941789879  Gap =  1.1909903843770722 Sum =  0.9184539904136013
Iteration =  3  Dual obj =  -0.0964491742432811  Primal_obj =  0.4339400803100928  Gap =  0.5303892545533739 Sum =  0.9447902991317796
Iteration =  4  Dual obj =  -0.0942409593798626  Primal_obj =  0.20809589908936194  Gap =  0.30233685846922453 Sum =  0.9936860649143407
Iteration =  5  Dual obj =  -0.09346358039410174  Primal_obj =  0.052599432695455306  Gap =  0.14606301308955705 Sum =  1.0055988984437245
Iteration =  6  Dual obj =  -0.09323043532762719  Primal_obj =  -0.008579992323504704  Gap =  0.08465044300412249 Sum =  0.9996207657683349
Iteration =  7  Dual obj =  -0.0931266490012493  Primal_obj =  -0.03448646194773468  Gap =  0.05864018705351462 Sum =  0.9978882395289629
Iteration =  8  Dual obj =  -0.09307697052764882  Primal_obj =  -0.04828902319265603  Gap =  0.04478794733499279 Sum =  0.9992947706474014
Iteration =  9  Dual obj =  -0.0930498903607278  Primal_obj =  -0.05473322028781889  Gap =  0.03831667007290891 Sum =  1.000598877005204
Iteration =  10  Dual obj =  -0.0930260684095105  Primal_obj =  -0.05918842310255566  Gap =  0.033837645306954836 Sum =  1.0003833782467269
Iteration =  11  Dual obj =  -0.09300185525948543  Primal_obj =  -0.06406734637393233  Gap =  0.0289345088855531 Sum =  1.0003098626758762
Iteration =  12  Dual obj =  -0.09298365625565573  Primal_obj =  -0.06683426634551641  Gap =  0.02614938991013932 Sum =  1.0001565521644782
Iteration =  13  Dual obj =  -0.09296986828484824  Primal_obj =  -0.07270589866443426  Gap =  0.020263969620413977 Sum =  1.0001471913767048
Iteration =  14  Dual obj =  -0.09295914934284052  Primal_obj =  -0.0774809337922961  Gap =  0.015478215550544419 Sum =  1.0000307469893581
Iteration =  15  Dual obj =  -0.09295310202213009  Primal_obj =  -0.08124937855251019  Gap =  0.011703723469619898 Sum =  0.9997477177488128
Iteration =  16  Dual obj =  -0.0929485133435952  Primal_obj =  -0.08402365908004457  Gap =  0.008924854263550636 Sum =  0.999582296500944
Iteration =  17  Dual obj =  -0.09294573655961129  Primal_obj =  -0.08550430788377499  Gap =  0.0074414286758363035 Sum =  0.9996641262533538
Iteration =  18  Dual obj =  -0.09294350592100283  Primal_obj =  -0.08621936349011619  Gap =  0.006724142430886634 Sum =  0.9998022473988495
Iteration =  19  Dual obj =  -0.0929417835879423  Primal_obj =  -0.08669597974173687  Gap =  0.006245803846205433 Sum =  0.999769753873488
Iteration =  20  Dual obj =  -0.09294022091875614  Primal_obj =  -0.08765723236076343  Gap =  0.00528298855799271 Sum =  0.9997345146689152
Iteration =  21  Dual obj =  -0.09293899062256528  Primal_obj =  -0.08816739633856173  Gap =  0.004771594284003547 Sum =  0.9997675837911807
Iteration =  22  Dual obj =  -0.09293785502907467  Primal_obj =  -0.08878254511969368  Gap =  0.004155309909380997 Sum =  0.9998884354799827
Iteration =  23  Dual obj =  -0.09293700699727742  Primal_obj =  -0.0893919349176111  Gap =  0.0035450720796663115 Sum =  0.9998538153134248
Iteration =  24  Dual obj =  -0.09293626076630154  Primal_obj =  -0.08991195393782736  Gap =  0.0030243068284741825 Sum =  0.9997031936903411
Iteration =  0  Dual obj =  -44.465409661504076  Primal_obj =  10945.415719323106  Gap =  10989.88112898461 Sum =  382.25556782243495
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  inf
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.1423872884871715  Primal_obj =  3.778356198983144  Gap =  3.920743487470315 Sum =  0.6411677084775089
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  -0.122851146209424  Primal_obj =  5.846332062757916  Gap =  5.96918320896734 Sum =  0.964724967591283
Iteration =  5  Dual obj =  -0.11366366336816326  Primal_obj =  4.552224308496219  Gap =  4.6658879718643815 Sum =  0.8795635365959331
Iteration =  6  Dual obj =  -0.10511523474863897  Primal_obj =  4.184710216947662  Gap =  4.289825451696301 Sum =  0.9818231171066668
Iteration =  7  Dual obj =  -0.09740051577885486  Primal_obj =  3.390195096832465  Gap =  3.4875956126113197 Sum =  0.931601988829375
Iteration =  8  Dual obj =  -0.09156021356440885  Primal_obj =  2.712559110249509  Gap =  2.8041193238139175 Sum =  0.9552955626261646
Iteration =  9  Dual obj =  -0.08661317397215894  Primal_obj =  2.129880941564079  Gap =  2.216494115536238 Sum =  0.9019904964082616
Iteration =  10  Dual obj =  -0.08402013699480065  Primal_obj =  1.9456727071670437  Gap =  2.0296928441618443 Sum =  0.9393044242209833
Iteration =  11  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  12  Dual obj =  -0.0821762941249375  Primal_obj =  1.36733765271742  Gap =  1.4495139468423575 Sum =  0.9372534197144256
Iteration =  13  Dual obj =  -0.08057311397116704  Primal_obj =  1.1759368451549674  Gap =  1.2565099591261344 Sum =  0.9146560329810257
Iteration =  14  Dual obj =  -0.07987832171377757  Primal_obj =  1.0317266958604103  Gap =  1.1116050175741878 Sum =  0.942837168304723
Iteration =  15  Dual obj =  -0.07898779709463818  Primal_obj =  1.1163454839276874  Gap =  1.1953332810223256 Sum =  0.9022310274857546
Iteration =  16  Dual obj =  -0.07817513932517481  Primal_obj =  0.9842705489731792  Gap =  1.062445688298354 Sum =  0.941692227752994
Iteration =  17  Dual obj =  -0.07711263765822148  Primal_obj =  0.8428917536822986  Gap =  0.9200043913405201 Sum =  0.9140838462328076
Iteration =  18  Dual obj =  -0.07616060630371738  Primal_obj =  0.6983263733949859  Gap =  0.7744869796987033 Sum =  0.9442904018273672
Iteration =  19  Dual obj =  -0.07557319336363891  Primal_obj =  0.66707761521674  Gap =  0.7426508085803789 Sum =  0.947692429931245
Iteration =  20  Dual obj =  -0.07506063221113826  Primal_obj =  0.4948889394517184  Gap =  0.5699495716628566 Sum =  0.9467319406920238
Iteration =  21  Dual obj =  -0.07448694638866883  Primal_obj =  0.4186216146390942  Gap =  0.493108561027763 Sum =  0.956803561196057
Iteration =  22  Dual obj =  -0.07394234091864657  Primal_obj =  0.33960251013461384  Gap =  0.41354485105326044 Sum =  0.9643494282091907
Iteration =  23  Dual obj =  -0.0735879467903934  Primal_obj =  0.25195752330333965  Gap =  0.325545470093733 Sum =  0.9702658549663397
Iteration =  24  Dual obj =  -0.07333329304594852  Primal_obj =  0.20293455880460606  Gap =  0.2762678518505546 Sum =  0.9736963666220861
Iteration =  0  Dual obj =  -0.07333329304594852  Primal_obj =  0.20293455880460606  Gap =  0.2762678518505546 Sum =  0.9736963666220861
Iteration =  1  Dual obj =  -0.07320885084089077  Primal_obj =  0.15801346297792568  Gap =  0.23122231381881644 Sum =  0.9743274646005757
Iteration =  2  Dual obj =  -0.07303587087337235  Primal_obj =  0.14004494266588455  Gap =  0.2130808135392569 Sum =  0.9773621643002923
Iteration =  3  Dual obj =  -0.07283981627842069  Primal_obj =  0.12060571318226088  Gap =  0.19344552946068155 Sum =  0.9825574938546116
Iteration =  4  Dual obj =  -0.07270951939070708  Primal_obj =  0.10161799583445777  Gap =  0.17432751522516485 Sum =  0.9850977625749184
Iteration =  5  Dual obj =  -0.07257819283829484  Primal_obj =  0.07370005612920832  Gap =  0.14627824896750316 Sum =  0.9905443075339319
Iteration =  6  Dual obj =  -0.07243877848865796  Primal_obj =  0.042343785383826216  Gap =  0.11478256387248417 Sum =  0.9953285194692741
Iteration =  7  Dual obj =  -0.07233215644419108  Primal_obj =  0.020205016256773706  Gap =  0.09253717270096479 Sum =  0.9988554114336137
Iteration =  8  Dual obj =  -0.07227405609284995  Primal_obj =  0.006065214649559975  Gap =  0.07833927074240993 Sum =  0.9991837365248291
Iteration =  9  Dual obj =  -0.07222548725106742  Primal_obj =  -0.005041646708211389  Gap =  0.06718384054285603 Sum =  1.0003941020212284
Iteration =  10  Dual obj =  -0.07218751582810817  Primal_obj =  -0.011264112975347462  Gap =  0.06092340285276071 Sum =  1.0004528178911178
Iteration =  11  Dual obj =  -0.07216345731137323  Primal_obj =  -0.016763402918376788  Gap =  0.055400054392996445 Sum =  1.0002925605918656
Iteration =  12  Dual obj =  -0.07214115070520714  Primal_obj =  -0.020823007607587762  Gap =  0.05131814309761938 Sum =  1.0003358408846663
Iteration =  13  Dual obj =  -0.07212390350810967  Primal_obj =  -0.023889329318730335  Gap =  0.048234574189379334 Sum =  0.9996614879097753
Iteration =  14  Dual obj =  -0.07211022615665477  Primal_obj =  -0.027976631695996887  Gap =  0.044133594460657885 Sum =  0.999555637709773
Iteration =  15  Dual obj =  -0.07209972582027471  Primal_obj =  -0.03216836067562841  Gap =  0.039931365144646305 Sum =  0.9991126335928423
Iteration =  16  Dual obj =  -0.07209047025891233  Primal_obj =  -0.03358673227394848  Gap =  0.03850373798496384 Sum =  0.999557346403503
Iteration =  17  Dual obj =  -0.07208218108836263  Primal_obj =  -0.0347013534584925  Gap =  0.037380827629870134 Sum =  0.9998320404003771
Iteration =  18  Dual obj =  -0.07207420195680458  Primal_obj =  -0.03661962332640745  Gap =  0.03545457863039714 Sum =  0.9996732190435835
Iteration =  19  Dual obj =  -0.07206663456734431  Primal_obj =  -0.03898583535469055  Gap =  0.033080799212653764 Sum =  0.9998503375667284
Iteration =  20  Dual obj =  -0.07206033614717924  Primal_obj =  -0.040366839865069004  Gap =  0.03169349628211024 Sum =  0.9996309709765845
Iteration =  21  Dual obj =  -0.07205428755461543  Primal_obj =  -0.04182822258152012  Gap =  0.03022606497309531 Sum =  0.9997233559035049
Iteration =  22  Dual obj =  -0.0720473317432269  Primal_obj =  -0.043559745626586405  Gap =  0.028487586116640498 Sum =  0.9994665611227369
Iteration =  23  Dual obj =  -0.0720422166580664  Primal_obj =  -0.0451916215215792  Gap =  0.0268505951364872 Sum =  0.9996250031966591
Iteration =  24  Dual obj =  -0.0720380754166782  Primal_obj =  -0.04666958334223521  Gap =  0.025368492074442986 Sum =  0.9996956572655089
Iteration =  0  Dual obj =  -0.0720380754166782  Primal_obj =  -0.04666958334223521  Gap =  0.025368492074442986 Sum =  0.9996956572655089
Iteration =  1  Dual obj =  -0.0720366069748889  Primal_obj =  -0.047507158374823374  Gap =  0.02452944860006552 Sum =  0.999669508008955
Iteration =  2  Dual obj =  -0.07203521061104753  Primal_obj =  -0.04838260103033151  Gap =  0.023652609580716022 Sum =  0.9995160806442095
Iteration =  3  Dual obj =  -0.0720334072523292  Primal_obj =  -0.04897829548710757  Gap =  0.02305511176522164 Sum =  0.9995881092149785
Iteration =  4  Dual obj =  -0.07203177585095297  Primal_obj =  -0.04950227251393573  Gap =  0.02252950333701724 Sum =  0.9997017522106821
Iteration =  5  Dual obj =  -0.0720294289156182  Primal_obj =  -0.05083531880876534  Gap =  0.021194110106852862 Sum =  0.9997957378258712
Iteration =  6  Dual obj =  -0.07202716881851917  Primal_obj =  -0.05236112826448361  Gap =  0.019666040554035563 Sum =  0.9996160572926999
Iteration =  7  Dual obj =  -0.07202528342746214  Primal_obj =  -0.05342117394371866  Gap =  0.018604109483743483 Sum =  0.9996717923406693
Iteration =  8  Dual obj =  -0.07202265411055628  Primal_obj =  -0.05449727458681147  Gap =  0.017525379523744805 Sum =  0.9996974061192696
Iteration =  9  Dual obj =  -0.07201984896801646  Primal_obj =  -0.05547170194326638  Gap =  0.016548147024750076 Sum =  0.9998261934489618
Iteration =  10  Dual obj =  -0.07201693454537558  Primal_obj =  -0.057203091993180424  Gap =  0.014813842552195158 Sum =  0.9997423060717647
Iteration =  11  Dual obj =  -0.07201452303960211  Primal_obj =  -0.05862519055169042  Gap =  0.013389332487911687 Sum =  0.9995554261929785
Iteration =  12  Dual obj =  -0.07201263066588162  Primal_obj =  -0.05962438605312656  Gap =  0.012388244612755062 Sum =  0.9996352334232328
Iteration =  13  Dual obj =  -0.07201129644401984  Primal_obj =  -0.06040944270908109  Gap =  0.011601853734938744 Sum =  0.9996064811784476
Iteration =  14  Dual obj =  -0.0720100927977661  Primal_obj =  -0.06121840544140408  Gap =  0.010791687356362017 Sum =  0.9997063634631898
Iteration =  15  Dual obj =  -0.07200882578909827  Primal_obj =  -0.062311017371386695  Gap =  0.009697808417711576 Sum =  0.9996587870910507
Iteration =  16  Dual obj =  -0.07200764478221466  Primal_obj =  -0.06302574114803844  Gap =  0.008981903634176225 Sum =  0.9996990752385464
Iteration =  17  Dual obj =  -0.07200676833767  Primal_obj =  -0.06379575437018621  Gap =  0.00821101396748379 Sum =  0.9997452829383505
Iteration =  18  Dual obj =  -0.07200582748666076  Primal_obj =  -0.06485477901190616  Gap =  0.007151048474754604 Sum =  0.9996135696730613
Iteration =  19  Dual obj =  -0.07200487959671595  Primal_obj =  -0.06560196830888824  Gap =  0.006402911287827703 Sum =  0.9994933107446213
Iteration =  20  Dual obj =  -0.07200421183259752  Primal_obj =  -0.06615771718082732  Gap =  0.005846494651770201 Sum =  0.9994528133946571
Iteration =  21  Dual obj =  -0.07200347613328154  Primal_obj =  -0.06673656293805458  Gap =  0.005266913195226958 Sum =  0.99944898682895
Iteration =  22  Dual obj =  -0.07200276342940527  Primal_obj =  -0.06736117719676568  Gap =  0.004641586232639591 Sum =  0.9993925686410255
Iteration =  23  Dual obj =  -0.07200204414120082  Primal_obj =  -0.06803249303760238  Gap =  0.003969551103598437 Sum =  0.9995458914603608
Iteration =  24  Dual obj =  -0.07200153373509448  Primal_obj =  -0.06836371081600837  Gap =  0.0036378229190861117 Sum =  0.9996739454551946
Iteration =  0  Dual obj =  -0.07200153373509448  Primal_obj =  -0.06836371081600837  Gap =  0.0036378229190861117 Sum =  0.9996739454551946
Iteration =  1  Dual obj =  -0.07200126037005274  Primal_obj =  -0.06845687625176207  Gap =  0.0035443841182906666 Sum =  0.9996396403718413
Iteration =  2  Dual obj =  -0.07200101050267546  Primal_obj =  -0.06856307106363002  Gap =  0.00343793943904544 Sum =  0.9996701268744044
Iteration =  3  Dual obj =  -0.07200077411819143  Primal_obj =  -0.06871106447681209  Gap =  0.0032897096413793403 Sum =  0.9996863521617396
Iteration =  4  Dual obj =  -0.07200061791314964  Primal_obj =  -0.06881487100681102  Gap =  0.0031857469063386185 Sum =  0.9997014145326368
Iteration =  5  Dual obj =  -0.07200047178033174  Primal_obj =  -0.06895724098580996  Gap =  0.0030432307945217757 Sum =  0.9997102327000809
Iteration =  6  Dual obj =  -0.07200034206840934  Primal_obj =  -0.06909605238573864  Gap =  0.002904289682670702 Sum =  0.9997347516331834
Iteration =  7  Dual obj =  -0.07200023675028877  Primal_obj =  -0.06917986249915108  Gap =  0.0028203742511376945 Sum =  0.999747940428528
Iteration =  8  Dual obj =  -0.07200010996754325  Primal_obj =  -0.0692580712567031  Gap =  0.002742038710840153 Sum =  0.9997488739834972
Iteration =  9  Dual obj =  -0.07199998150004835  Primal_obj =  -0.06942554922970952  Gap =  0.002574432270338836 Sum =  0.999778866170344
Iteration =  10  Dual obj =  -0.07199983793832698  Primal_obj =  -0.06954084755320314  Gap =  0.0024589903851238437 Sum =  0.9998064794544024
Iteration =  11  Dual obj =  -0.07199971056671212  Primal_obj =  -0.06968141706695381  Gap =  0.0023182934997583032 Sum =  0.9998237283597102
Iteration =  12  Dual obj =  -0.07199958236043538  Primal_obj =  -0.06978250722731733  Gap =  0.002217075133118057 Sum =  0.9998534930941708
Iteration =  13  Dual obj =  -0.07199938041325002  Primal_obj =  -0.06989480661242578  Gap =  0.0021045738008242387 Sum =  0.9998636913905541
Iteration =  14  Dual obj =  -0.07199916913598613  Primal_obj =  -0.07006641464597792  Gap =  0.0019327544900082094 Sum =  0.9998572579878275
Iteration =  15  Dual obj =  -0.07199893667954076  Primal_obj =  -0.0702043109197498  Gap =  0.0017946257597909604 Sum =  0.9998032093501046
Iteration =  16  Dual obj =  -0.07199868961763081  Primal_obj =  -0.07033330712183981  Gap =  0.0016653824957909985 Sum =  0.9998682736570267
Iteration =  17  Dual obj =  -0.07199843632644473  Primal_obj =  -0.07049385666870664  Gap =  0.001504579657738092 Sum =  0.9998755280840452
Iteration =  18  Dual obj =  -0.07199819106187852  Primal_obj =  -0.07058401862209188  Gap =  0.0014141724397866429 Sum =  0.99986337421414
Iteration =  19  Dual obj =  -0.07199794007386445  Primal_obj =  -0.07066874268891099  Gap =  0.0013291973849534622 Sum =  0.9999132349507844
Iteration =  20  Dual obj =  -0.07199775470108259  Primal_obj =  -0.07080529171079393  Gap =  0.0011924629902886619 Sum =  0.9999041585197304
Iteration =  21  Dual obj =  -0.0719976088031648  Primal_obj =  -0.07088506459445174  Gap =  0.0011125442087130677 Sum =  0.9999034212569786
Iteration =  22  Dual obj =  -0.07199746675480197  Primal_obj =  -0.07094893366605003  Gap =  0.0010485330887519406 Sum =  0.9998963962304626
Iteration =  23  Dual obj =  -0.07199735571492027  Primal_obj =  -0.07101838040702194  Gap =  0.0009789753078983388 Sum =  0.9999000201549106
Iteration =  24  Dual obj =  -0.07199723028414953  Primal_obj =  -0.07109554042353752  Gap =  0.0009016898606120094 Sum =  0.9999131801001476
Done, writing results...
