2021-04-29 12:31:17,286 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.70s.
2021-04-29 12:31:17,782 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.26s.
2021-04-29 12:31:18,293 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.51s.
2021-04-29 12:31:18,433 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.14s.
2021-04-29 12:31:18,437 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:31:18,449 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:31:19,403 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 116.
2021-04-29 12:31:19,404 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.97s.
Iteration =  0  Dual obj =  -53.21399948462168  Primal_obj =  158255.19224515304  Gap =  158308.40624463765 Sum =  358.36353727927474
Iteration =  1  Dual obj =  -0.01691718131010856  Primal_obj =  86.3627036622371  Gap =  86.3796208435472 Sum =  0.8809135634312987
Iteration =  2  Dual obj =  0.06117733471718856  Primal_obj =  31.21710144114962  Gap =  31.15592410643243 Sum =  0.7220998175692894
Iteration =  3  Dual obj =  0.0881481044626839  Primal_obj =  18.669966509351642  Gap =  18.58181840488896 Sum =  0.6622003344694769
Iteration =  4  Dual obj =  0.1044443806222973  Primal_obj =  8.940562755874897  Gap =  8.8361183752526 Sum =  0.7737873349847091
Iteration =  5  Dual obj =  0.1139418239419308  Primal_obj =  2.965366434854649  Gap =  2.8514246109127184 Sum =  0.9530160122995115
Iteration =  6  Dual obj =  0.11705986327057921  Primal_obj =  0.9418889716577341  Gap =  0.8248291083871548 Sum =  1.0075425984589037
Iteration =  7  Dual obj =  0.1177292798073824  Primal_obj =  0.4331966216409995  Gap =  0.3154673418336171 Sum =  1.0087724148159825
Iteration =  8  Dual obj =  0.1179477755308328  Primal_obj =  0.2568778041746193  Gap =  0.1389300286437865 Sum =  0.9966093557147824
Iteration =  9  Dual obj =  0.11801873568978725  Primal_obj =  0.19556511868249105  Gap =  0.07754638299270379 Sum =  0.9965986060930643
Iteration =  10  Dual obj =  0.11805676415482039  Primal_obj =  0.1600946409003787  Gap =  0.04203787674555831 Sum =  0.9981093364136375
Iteration =  11  Dual obj =  0.1180753045395925  Primal_obj =  0.1424161803725524  Gap =  0.024340875832959907 Sum =  0.999734946217676
Iteration =  12  Dual obj =  0.11808715575506026  Primal_obj =  0.1347031624341575  Gap =  0.01661600667909724 Sum =  1.000017537353924
Iteration =  13  Dual obj =  0.11809505842026403  Primal_obj =  0.1287296881713966  Gap =  0.010634629751132565 Sum =  0.9995843610516685
Iteration =  14  Dual obj =  0.11809939324970883  Primal_obj =  0.12439921874368351  Gap =  0.006299825493974676 Sum =  1.0000003299919769
Iteration =  15  Dual obj =  0.11810181187251495  Primal_obj =  0.12191601984983778  Gap =  0.003814207977322834 Sum =  1.0000652907536258
Iteration =  16  Dual obj =  0.11810318445874365  Primal_obj =  0.12043899865232183  Gap =  0.002335814193578173 Sum =  1.0000785529874443
Iteration =  17  Dual obj =  0.11810403148977558  Primal_obj =  0.1198146583847326  Gap =  0.001710626894957018 Sum =  0.9996588633600525
Iteration =  18  Dual obj =  0.11810468380661941  Primal_obj =  0.11938999543433473  Gap =  0.0012853116277153215 Sum =  0.999868956829903
Iteration =  19  Dual obj =  0.11810511940964623  Primal_obj =  0.11903694006364199  Gap =  0.0009318206539957602 Sum =  1.0000832672375475
Iteration =  20  Dual obj =  0.11810540471002093  Primal_obj =  0.11884058540223882  Gap =  0.0007351806922178961 Sum =  1.000016143297016
Iteration =  21  Dual obj =  0.11810562939667607  Primal_obj =  0.11870943341312185  Gap =  0.0006038040164457747 Sum =  0.999915316707866
Iteration =  22  Dual obj =  0.11810580670926422  Primal_obj =  0.11860266259137336  Gap =  0.0004968558821091401 Sum =  0.9999178461562486
Iteration =  23  Dual obj =  0.11810593437034662  Primal_obj =  0.11849994778286788  Gap =  0.0003940134125212519 Sum =  1.0000931419401016
Iteration =  24  Dual obj =  0.11810603198242725  Primal_obj =  0.11842393813427667  Gap =  0.00031790615184941473 Sum =  1.0000277597191207
Iteration =  0  Dual obj =  -43.594571489823984  Primal_obj =  127209.91320387642  Gap =  127253.50777536625 Sum =  358.36353727927474
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.06591674664344324  Primal_obj =  48.453901692960976  Gap =  48.51981843960442 Sum =  0.47066051509826834
Iteration =  3  Dual obj =  0.0688075071832494  Primal_obj =  45.620020370612785  Gap =  45.551212863429534 Sum =  0.8351826654756913
Iteration =  4  Dual obj =  0.09768729543817348  Primal_obj =  27.3937824238652  Gap =  27.296095128427027 Sum =  0.7445695306683763
Iteration =  5  Dual obj =  0.11232415765645734  Primal_obj =  17.71671120272293  Gap =  17.604387045066474 Sum =  0.7113057285320089
Iteration =  6  Dual obj =  0.12163132545438343  Primal_obj =  13.110151723029805  Gap =  12.98852039757542 Sum =  0.7301862371461623
Iteration =  7  Dual obj =  0.12760967617673885  Primal_obj =  9.875912718032014  Gap =  9.748303041855275 Sum =  0.7828993805059534
Iteration =  8  Dual obj =  0.13204277279243795  Primal_obj =  7.103575192562894  Gap =  6.971532419770456 Sum =  0.8940656921877099
Iteration =  9  Dual obj =  0.1352301535147551  Primal_obj =  5.505157751541028  Gap =  5.369927598026273 Sum =  0.9223775791416751
Iteration =  10  Dual obj =  0.13701602584493988  Primal_obj =  4.294812929292186  Gap =  4.157796903447246 Sum =  0.9559298140346346
Iteration =  11  Dual obj =  0.13815981011371029  Primal_obj =  3.468178950822407  Gap =  3.3300191407086968 Sum =  1.0344449994031018
Iteration =  12  Dual obj =  0.13908085760102326  Primal_obj =  2.4483401142707857  Gap =  2.3092592566697623 Sum =  1.0056070859954294
Iteration =  13  Dual obj =  0.13966438856664018  Primal_obj =  1.7557575631162496  Gap =  1.6160931745496094 Sum =  0.9938094454259193
Iteration =  14  Dual obj =  0.1401067030868525  Primal_obj =  1.5271261872005013  Gap =  1.3870194841136487 Sum =  0.9887472114334036
Iteration =  15  Dual obj =  0.14038711683008528  Primal_obj =  1.3558152564123198  Gap =  1.2154281395822346 Sum =  0.9962992353361174
Iteration =  16  Dual obj =  0.14060687185760062  Primal_obj =  0.9682129294790289  Gap =  0.8276060576214284 Sum =  0.9972589165187298
Iteration =  17  Dual obj =  0.14075348242588775  Primal_obj =  0.831252964442704  Gap =  0.6904994820168162 Sum =  1.0081570001862623
Iteration =  18  Dual obj =  0.1408860145688613  Primal_obj =  0.7091232379678766  Gap =  0.5682372233990153 Sum =  1.0052413850209327
Iteration =  19  Dual obj =  0.14099658190038086  Primal_obj =  0.6106506556778861  Gap =  0.46965407377750523 Sum =  0.9936425749510971
Iteration =  20  Dual obj =  0.1410892620647926  Primal_obj =  0.49599875079184536  Gap =  0.35490948872705275 Sum =  0.9920222352540007
Iteration =  21  Dual obj =  0.14115901404563538  Primal_obj =  0.45584712063214555  Gap =  0.31468810658651014 Sum =  0.9995187034885722
Iteration =  22  Dual obj =  0.14121460402204217  Primal_obj =  0.39112421445228573  Gap =  0.24990961043024357 Sum =  0.9920340617405736
Iteration =  23  Dual obj =  0.14126122721315632  Primal_obj =  0.36456325815866664  Gap =  0.22330203094551032 Sum =  0.9959467130987948
Iteration =  24  Dual obj =  0.1413007114492445  Primal_obj =  0.3360010282991677  Gap =  0.19470031684992323 Sum =  1.0032037264370033
Iteration =  0  Dual obj =  0.1413007114492445  Primal_obj =  0.3360010282991677  Gap =  0.19470031684992323 Sum =  1.0032037264370033
Iteration =  1  Dual obj =  0.14132476346219072  Primal_obj =  0.27397490519784357  Gap =  0.13265014173565284 Sum =  0.9992418814839426
Iteration =  2  Dual obj =  0.14134120597039768  Primal_obj =  0.2521030822031161  Gap =  0.11076187623271844 Sum =  0.9971394834199675
Iteration =  3  Dual obj =  0.14135348373684198  Primal_obj =  0.24631196389021168  Gap =  0.1049584801533697 Sum =  0.9978169275256913
Iteration =  4  Dual obj =  0.14137225546674217  Primal_obj =  0.2550649881554177  Gap =  0.11369273268867555 Sum =  0.9992249405290252
Iteration =  5  Dual obj =  0.14139063946316707  Primal_obj =  0.2659613002186428  Gap =  0.12457066075547571 Sum =  0.9997777050706457
Iteration =  6  Dual obj =  0.14141295557328282  Primal_obj =  0.2549323184401256  Gap =  0.11351936286684278 Sum =  1.0022703182504882
Iteration =  7  Dual obj =  0.14143385538796574  Primal_obj =  0.2347627829263199  Gap =  0.09332892753835417 Sum =  1.0001065287175317
Iteration =  8  Dual obj =  0.141448413074296  Primal_obj =  0.22492969663554874  Gap =  0.08348128356125273 Sum =  0.997770566814549
Iteration =  9  Dual obj =  0.14146469430104136  Primal_obj =  0.22754395483720502  Gap =  0.08607926053616366 Sum =  0.9974045505478365
Iteration =  10  Dual obj =  0.1414759618357726  Primal_obj =  0.22385733358152285  Gap =  0.08238137174575025 Sum =  0.9992357890975143
Iteration =  11  Dual obj =  0.14148651107268395  Primal_obj =  0.21116694510511244  Gap =  0.06968043403242849 Sum =  1.0007612593525073
Iteration =  12  Dual obj =  0.14149479932241626  Primal_obj =  0.21693306670799933  Gap =  0.07543826738558307 Sum =  1.0026776622223106
Iteration =  13  Dual obj =  0.1415034579771483  Primal_obj =  0.21761063138968298  Gap =  0.07610717341253467 Sum =  1.0009468230318406
Iteration =  14  Dual obj =  0.1415118978635245  Primal_obj =  0.20584074405107752  Gap =  0.06432884618755302 Sum =  0.9997139371177791
Iteration =  15  Dual obj =  0.14151941122634268  Primal_obj =  0.1937533789137736  Gap =  0.05223396768743091 Sum =  0.9970439749875937
Iteration =  16  Dual obj =  0.14152559748869317  Primal_obj =  0.18818701398681326  Gap =  0.046661416498120084 Sum =  0.9963448954442038
Iteration =  17  Dual obj =  0.1415304275089566  Primal_obj =  0.18540787447353352  Gap =  0.043877446964576905 Sum =  1.0005254017916023
Iteration =  18  Dual obj =  0.1415352028273236  Primal_obj =  0.1800633755884827  Gap =  0.03852817276115911 Sum =  1.0039419955366986
Iteration =  19  Dual obj =  0.14153953996982305  Primal_obj =  0.17741156774299643  Gap =  0.03587202777317339 Sum =  1.0016614894246691
Iteration =  20  Dual obj =  0.14154392868167642  Primal_obj =  0.17672789954529514  Gap =  0.03518397086361871 Sum =  0.9984188375758334
Iteration =  21  Dual obj =  0.14154843577383538  Primal_obj =  0.1752727568944565  Gap =  0.033724321120621126 Sum =  0.9995668287046687
Iteration =  22  Dual obj =  0.14155218169433564  Primal_obj =  0.17676393928811712  Gap =  0.03521175759378148 Sum =  0.9984221817073382
Iteration =  23  Dual obj =  0.14155603766613967  Primal_obj =  0.17861662071439416  Gap =  0.03706058304825449 Sum =  0.9999064450107142
Iteration =  24  Dual obj =  0.14156047227693175  Primal_obj =  0.17360964948687818  Gap =  0.03204917720994643 Sum =  1.0012208322390936
Iteration =  0  Dual obj =  0.14156047227693175  Primal_obj =  0.17360964948687818  Gap =  0.03204917720994643 Sum =  1.0012208322390936
Iteration =  1  Dual obj =  0.14156196680355937  Primal_obj =  0.16944049025247324  Gap =  0.027878523448913867 Sum =  1.0001610318155636
Iteration =  2  Dual obj =  0.14156402073346305  Primal_obj =  0.16288509208082833  Gap =  0.021321071347365272 Sum =  0.9995462224295184
Iteration =  3  Dual obj =  0.14156578032004524  Primal_obj =  0.1595828086234709  Gap =  0.018017028303425664 Sum =  0.9995715054597973
Iteration =  4  Dual obj =  0.14156718866087056  Primal_obj =  0.1582562813374316  Gap =  0.016689092676561046 Sum =  0.9985640952326033
Iteration =  5  Dual obj =  0.14156834381500524  Primal_obj =  0.15712476435595737  Gap =  0.015556420540952132 Sum =  0.999660176822036
Iteration =  6  Dual obj =  0.14156956238838717  Primal_obj =  0.15654157615605083  Gap =  0.014972013767663661 Sum =  1.0014260183333932
Iteration =  7  Dual obj =  0.14157099177527593  Primal_obj =  0.15706649668975078  Gap =  0.01549550491447485 Sum =  1.0012913740564344
Iteration =  8  Dual obj =  0.14157243552717635  Primal_obj =  0.15834615779802913  Gap =  0.016773722270852776 Sum =  0.9989748330125606
Iteration =  9  Dual obj =  0.1415742276295982  Primal_obj =  0.15933283561357373  Gap =  0.017758607983975522 Sum =  0.9986684129804356
Iteration =  10  Dual obj =  0.14157606397747433  Primal_obj =  0.15822515112125954  Gap =  0.016649087143785213 Sum =  0.9995602731482758
Iteration =  11  Dual obj =  0.14157751167427662  Primal_obj =  0.15923937870353505  Gap =  0.017661867029258427 Sum =  1.0004936125169839
Iteration =  12  Dual obj =  0.14157904350811898  Primal_obj =  0.15828752667103516  Gap =  0.016708483162916177 Sum =  1.0000802785003593
Iteration =  13  Dual obj =  0.14158107480965074  Primal_obj =  0.15857239927379133  Gap =  0.01699132446414059 Sum =  0.9994938628378713
Iteration =  14  Dual obj =  0.14158265377107343  Primal_obj =  0.1598562267109796  Gap =  0.01827357293990617 Sum =  0.9999846722281769
Iteration =  15  Dual obj =  0.14158416387417141  Primal_obj =  0.16084402451418905  Gap =  0.01925986064001764 Sum =  1.000101721330663
Iteration =  16  Dual obj =  0.1415856383417442  Primal_obj =  0.15978536841573765  Gap =  0.018199730073993448 Sum =  0.9992534231105488
Iteration =  17  Dual obj =  0.14158706326587286  Primal_obj =  0.15780852308927518  Gap =  0.016221459823402312 Sum =  0.9996885892207432
Iteration =  18  Dual obj =  0.14158818024978395  Primal_obj =  0.15561243052386736  Gap =  0.01402425027408341 Sum =  1.0003985659974033
Iteration =  19  Dual obj =  0.14158929352299296  Primal_obj =  0.15296899534183586  Gap =  0.011379701818842902 Sum =  1.0004050695793762
Iteration =  20  Dual obj =  0.14159044205496024  Primal_obj =  0.15098693915397546  Gap =  0.009396497099015216 Sum =  0.9999522271760404
Iteration =  21  Dual obj =  0.14159125958346597  Primal_obj =  0.14979756710285613  Gap =  0.008206307519390166 Sum =  0.9999396743526812
Iteration =  22  Dual obj =  0.14159187751438096  Primal_obj =  0.14897522017122244  Gap =  0.007383342656841485 Sum =  0.9999680304389393
Iteration =  23  Dual obj =  0.14159256151428867  Primal_obj =  0.1484629439311634  Gap =  0.006870382416874737 Sum =  1.0001997919450827
Iteration =  24  Dual obj =  0.14159300565522578  Primal_obj =  0.14833524294335443  Gap =  0.006742237288128644 Sum =  0.9997624628478364
Iteration =  0  Dual obj =  0.14159300565522578  Primal_obj =  0.14833524294335443  Gap =  0.006742237288128644 Sum =  0.9997624628478364
Iteration =  1  Dual obj =  0.14159324190175177  Primal_obj =  0.147742240578888  Gap =  0.006148998677136225 Sum =  1.0000684486000506
Iteration =  2  Dual obj =  0.1415935620380804  Primal_obj =  0.14705055723317603  Gap =  0.005456995195095626 Sum =  0.9999141430819904
Iteration =  3  Dual obj =  0.14159384798065938  Primal_obj =  0.1467333193142732  Gap =  0.00513947133361381 Sum =  1.0001246761139861
Iteration =  4  Dual obj =  0.1415942787695441  Primal_obj =  0.14632719561611932  Gap =  0.0047329168465752025 Sum =  0.9999621334961293
Iteration =  5  Dual obj =  0.14159472747946455  Primal_obj =  0.14612306818690252  Gap =  0.004528340707437961 Sum =  1.000091955641583
Iteration =  6  Dual obj =  0.14159504316671834  Primal_obj =  0.14585137388533612  Gap =  0.004256330718617779 Sum =  0.9997810546161603
Iteration =  7  Dual obj =  0.14159525260142677  Primal_obj =  0.14595050832233022  Gap =  0.00435525572090345 Sum =  0.9999776289733471
Iteration =  8  Dual obj =  0.14159550731679355  Primal_obj =  0.14570855034350205  Gap =  0.004113043026708507 Sum =  0.9999998539719084
Iteration =  9  Dual obj =  0.14159577097439796  Primal_obj =  0.14569696072927174  Gap =  0.00410118975487378 Sum =  1.0002679786570443
Iteration =  10  Dual obj =  0.14159610035329415  Primal_obj =  0.14571728059307393  Gap =  0.004121180239779781 Sum =  1.0001086039678906
Iteration =  11  Dual obj =  0.14159643515931505  Primal_obj =  0.1454928932818234  Gap =  0.003896458122508356 Sum =  0.9997156286642581
Iteration =  12  Dual obj =  0.1415967389692386  Primal_obj =  0.14527238172199888  Gap =  0.0036756427527602775 Sum =  0.9996108039119896
Iteration =  13  Dual obj =  0.14159697525074233  Primal_obj =  0.14497345823734026  Gap =  0.0033764829865979284 Sum =  1.0001843235468302
Iteration =  14  Dual obj =  0.14159723864380783  Primal_obj =  0.1449201586552085  Gap =  0.003322920011400665 Sum =  1.000312890307132
Iteration =  15  Dual obj =  0.14159747181530027  Primal_obj =  0.1449500091906224  Gap =  0.0033525373753221233 Sum =  1.0000259791374555
Iteration =  16  Dual obj =  0.14159773108943624  Primal_obj =  0.1447304846084364  Gap =  0.0031327535190001643 Sum =  0.9997648733681517
Iteration =  17  Dual obj =  0.14159795651551205  Primal_obj =  0.1447421543366409  Gap =  0.003144197821128847 Sum =  1.0000772839030863
Iteration =  18  Dual obj =  0.14159821020964414  Primal_obj =  0.14490537860219307  Gap =  0.003307168392548937 Sum =  1.0003686083939183
Iteration =  19  Dual obj =  0.14159843635765604  Primal_obj =  0.14489006809462493  Gap =  0.003291631736968892 Sum =  1.0000067741638703
Iteration =  20  Dual obj =  0.141598612925339  Primal_obj =  0.14490425204656143  Gap =  0.00330563912122242 Sum =  0.9995169764581808
Iteration =  21  Dual obj =  0.141598818763111  Primal_obj =  0.14493793370455577  Gap =  0.0033391149414447596 Sum =  0.999744305458649
Iteration =  22  Dual obj =  0.14159909397272502  Primal_obj =  0.14490708039058345  Gap =  0.0033079864178584273 Sum =  1.0005999576912066
Iteration =  23  Dual obj =  0.14159938295029034  Primal_obj =  0.14493153309548748  Gap =  0.003332150145197138 Sum =  1.0004915665310623
Iteration =  24  Dual obj =  0.14159965010775677  Primal_obj =  0.14481904449317307  Gap =  0.0032193943854162965 Sum =  0.9999445653399324
Done, writing results...
