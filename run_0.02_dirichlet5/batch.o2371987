2021-04-29 13:11:14,989 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.13s.
2021-04-29 13:11:15,412 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.22s.
2021-04-29 13:11:15,800 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.39s.
2021-04-29 13:11:15,914 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-29 13:11:15,917 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 13:11:15,926 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 13:11:16,731 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 105.
2021-04-29 13:11:16,732 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.82s.
Iteration =  0  Dual obj =  -51.61857354579788  Primal_obj =  67097.53843925364  Gap =  67149.15701279943 Sum =  362.86635479592957
Iteration =  1  Dual obj =  -0.032648518797247214  Primal_obj =  37.52417220953673  Gap =  37.556820728333975 Sum =  0.797415089219285
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  3  Dual obj =  0.023872465643930724  Primal_obj =  22.41982655152368  Gap =  22.39595408587975 Sum =  0.7286182210888661
Iteration =  4  Dual obj =  0.048988498891323354  Primal_obj =  9.146924245864138  Gap =  9.097935746972816 Sum =  0.7042067389067797
Iteration =  5  Dual obj =  0.06371643698668422  Primal_obj =  5.742192954037302  Gap =  5.678476517050617 Sum =  0.8926279967307305
Iteration =  6  Dual obj =  0.07090793666012535  Primal_obj =  2.2067210267732507  Gap =  2.135813090113125 Sum =  0.9386997190836589
Iteration =  7  Dual obj =  0.07292694607455426  Primal_obj =  0.8520235356567268  Gap =  0.7790965895821725 Sum =  1.0013490528608777
Iteration =  8  Dual obj =  0.07344740326839982  Primal_obj =  0.3968938078470337  Gap =  0.3234464045786339 Sum =  1.0015008176346867
Iteration =  9  Dual obj =  0.07363336658476012  Primal_obj =  0.24418880119342318  Gap =  0.17055543460866307 Sum =  0.9947660313292336
Iteration =  10  Dual obj =  0.07371319691925593  Primal_obj =  0.15555123146010166  Gap =  0.08183803454084573 Sum =  0.9981114585166397
Iteration =  11  Dual obj =  0.07374980571092105  Primal_obj =  0.11643863814825929  Gap =  0.042688832437338245 Sum =  1.0013399385873902
Iteration =  12  Dual obj =  0.0737683506073597  Primal_obj =  0.09481790258486333  Gap =  0.021049551977503633 Sum =  0.999919046986177
Iteration =  13  Dual obj =  0.0737774132078629  Primal_obj =  0.08508521896160327  Gap =  0.01130780575374038 Sum =  0.9990909815161293
Iteration =  14  Dual obj =  0.07378195375909395  Primal_obj =  0.08009894479878932  Gap =  0.006316991039695366 Sum =  0.9998310023344215
Iteration =  15  Dual obj =  0.0737842858006135  Primal_obj =  0.07739301595715084  Gap =  0.003608730156537343 Sum =  1.0002126869251495
Iteration =  16  Dual obj =  0.07378556921293142  Primal_obj =  0.07608661637597246  Gap =  0.0023010471630410395 Sum =  1.0000868591117598
Iteration =  17  Dual obj =  0.07378650395749548  Primal_obj =  0.07536599347054952  Gap =  0.001579489513054047 Sum =  0.9996317508323366
Iteration =  18  Dual obj =  0.07378719526345412  Primal_obj =  0.07489290624804945  Gap =  0.0011057109845953317 Sum =  0.9999300742687449
Iteration =  19  Dual obj =  0.07378757265076197  Primal_obj =  0.07456159626048718  Gap =  0.0007740236097252134 Sum =  1.0001279595926365
Iteration =  20  Dual obj =  0.07378780868788881  Primal_obj =  0.07434593607406587  Gap =  0.0005581273861770542 Sum =  0.9999451040514884
Iteration =  21  Dual obj =  0.07378798737212035  Primal_obj =  0.07421536669642353  Gap =  0.00042737932430318704 Sum =  0.9998896512007872
Iteration =  22  Dual obj =  0.07378813339229477  Primal_obj =  0.07416701980433967  Gap =  0.00037888641204489315 Sum =  0.9999876924688702
Iteration =  23  Dual obj =  0.07378825412279887  Primal_obj =  0.07414563794787998  Gap =  0.0003573838250811173 Sum =  1.000074325562027
Iteration =  24  Dual obj =  0.0737883615102246  Primal_obj =  0.07409165255454658  Gap =  0.0003032910443219877 Sum =  0.9999994337085558
Iteration =  0  Dual obj =  -39.21141713196037  Primal_obj =  57834.60584905041  Gap =  57873.81726618237 Sum =  362.86635479592957
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.12528959914813997  Primal_obj =  31.322012560729625  Gap =  31.447302159877765 Sum =  0.6076340023404858
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  0.009740181402026697  Primal_obj =  40.89190505325777  Gap =  40.88216487185574 Sum =  0.5353392125584437
Iteration =  5  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  6  Dual obj =  0.043195438461010906  Primal_obj =  19.096005460923656  Gap =  19.052810022462644 Sum =  0.660448154794689
Iteration =  7  Dual obj =  0.0525318079997516  Primal_obj =  18.429279438494657  Gap =  18.376747630494904 Sum =  0.7101073417535977
Iteration =  8  Dual obj =  0.05856171554619757  Primal_obj =  16.765375324004356  Gap =  16.70681360845816 Sum =  0.7082390233612599
Iteration =  9  Dual obj =  0.06719184638208842  Primal_obj =  15.629512188435717  Gap =  15.562320342053628 Sum =  0.7105067450516962
Iteration =  10  Dual obj =  0.07772540167042116  Primal_obj =  12.498168667166231  Gap =  12.42044326549581 Sum =  0.7064937983483683
Iteration =  11  Dual obj =  0.08112359709417717  Primal_obj =  11.255214405931957  Gap =  11.17409080883778 Sum =  0.7215777340673108
Iteration =  12  Dual obj =  0.08701792226242042  Primal_obj =  8.890142470842527  Gap =  8.803124548580106 Sum =  0.7312965086549724
Iteration =  13  Dual obj =  0.0914834315305428  Primal_obj =  8.414157138138236  Gap =  8.322673706607693 Sum =  0.7744219777920563
Iteration =  14  Dual obj =  0.09542724153352723  Primal_obj =  6.135497382254682  Gap =  6.040070140721155 Sum =  0.8217729603795992
Iteration =  15  Dual obj =  0.09867492502316852  Primal_obj =  4.452289338302947  Gap =  4.353614413279779 Sum =  0.8087744277654967
Iteration =  16  Dual obj =  0.1008570762627093  Primal_obj =  3.430789751153112  Gap =  3.3299326748904026 Sum =  0.8217850553824768
Iteration =  17  Dual obj =  0.10244999952426657  Primal_obj =  2.7100811149385233  Gap =  2.607631115414257 Sum =  0.8562507703625082
Iteration =  18  Dual obj =  0.104142381434095  Primal_obj =  2.984024751643684  Gap =  2.879882370209589 Sum =  0.9837296249111712
Iteration =  19  Dual obj =  0.10523131892106696  Primal_obj =  2.0907658479742772  Gap =  1.9855345290532103 Sum =  0.9931974568910751
Iteration =  20  Dual obj =  0.10575715935120958  Primal_obj =  1.6204564192577482  Gap =  1.5146992599065385 Sum =  0.9966301886209644
Iteration =  21  Dual obj =  0.10614047563047056  Primal_obj =  1.4771967323528983  Gap =  1.3710562567224278 Sum =  0.9969291405553514
Iteration =  22  Dual obj =  0.1065191247119445  Primal_obj =  1.4580280572095698  Gap =  1.3515089324976253 Sum =  1.0046799707927185
Iteration =  23  Dual obj =  0.10689611387598376  Primal_obj =  1.245766329459697  Gap =  1.1388702155837132 Sum =  0.9946492082204093
Iteration =  24  Dual obj =  0.1071448153696697  Primal_obj =  1.0196106824520699  Gap =  0.9124658670824002 Sum =  0.9875675240759239
Iteration =  0  Dual obj =  0.1071448153696697  Primal_obj =  1.0196106824520699  Gap =  0.9124658670824002 Sum =  0.9875675240759239
Iteration =  1  Dual obj =  0.10725365533085984  Primal_obj =  0.7602003175770085  Gap =  0.6529466622461486 Sum =  0.9942358046435572
Iteration =  2  Dual obj =  0.10736953603601233  Primal_obj =  0.7054165785341225  Gap =  0.5980470424981102 Sum =  1.0045756058342357
Iteration =  3  Dual obj =  0.10750960490917116  Primal_obj =  0.7184317639710649  Gap =  0.6109221590618937 Sum =  1.0028029596760728
Iteration =  4  Dual obj =  0.10764506434808442  Primal_obj =  0.7715308262757138  Gap =  0.6638857619276294 Sum =  0.9958497715582759
Iteration =  5  Dual obj =  0.10777050306468176  Primal_obj =  0.4759763778085053  Gap =  0.36820587474382355 Sum =  0.9956138007063505
Iteration =  6  Dual obj =  0.1078375574377759  Primal_obj =  0.34629714122328453  Gap =  0.23845958378550863 Sum =  0.9954504310892462
Iteration =  7  Dual obj =  0.10789225784526696  Primal_obj =  0.29735193122319337  Gap =  0.1894596733779264 Sum =  1.0045851036147826
Iteration =  8  Dual obj =  0.10793528986480232  Primal_obj =  0.26709334922237404  Gap =  0.1591580593575717 Sum =  1.0038142233086376
Iteration =  9  Dual obj =  0.10796765043384639  Primal_obj =  0.22588738845876322  Gap =  0.11791973802491683 Sum =  0.996072961351439
Iteration =  10  Dual obj =  0.107987770426858  Primal_obj =  0.2037014139962468  Gap =  0.0957136435693888 Sum =  0.9990205712878744
Iteration =  11  Dual obj =  0.10800528322725814  Primal_obj =  0.18971693256649852  Gap =  0.08171164933924038 Sum =  0.9984154775561016
Iteration =  12  Dual obj =  0.10801914221396174  Primal_obj =  0.19047944425157468  Gap =  0.08246030203761294 Sum =  1.00086009939491
Iteration =  13  Dual obj =  0.1080316126804859  Primal_obj =  0.1770597479159974  Gap =  0.0690281352355115 Sum =  1.0008781161778992
Iteration =  14  Dual obj =  0.10804623826370911  Primal_obj =  0.1770220537437503  Gap =  0.06897581548004118 Sum =  0.9994524794877078
Iteration =  15  Dual obj =  0.10805940992892128  Primal_obj =  0.18011115994254245  Gap =  0.07205175001362117 Sum =  0.9984453771507538
Iteration =  16  Dual obj =  0.10807331871089154  Primal_obj =  0.17940935179296905  Gap =  0.0713360330820775 Sum =  1.0003048677751656
Iteration =  17  Dual obj =  0.10808532328433995  Primal_obj =  0.1728365668532936  Gap =  0.06475124356895365 Sum =  1.0003181967392079
Iteration =  18  Dual obj =  0.10809525052433845  Primal_obj =  0.15568397052060817  Gap =  0.04758871999626972 Sum =  1.000107114813658
Iteration =  19  Dual obj =  0.10810149209816196  Primal_obj =  0.14656577849425725  Gap =  0.038464286396095296 Sum =  0.9998609501739071
Iteration =  20  Dual obj =  0.10810654298817889  Primal_obj =  0.1400869555666658  Gap =  0.031980412578486925 Sum =  1.0000446857727807
Iteration =  21  Dual obj =  0.10811036994496911  Primal_obj =  0.13782596837447242  Gap =  0.029715598429503304 Sum =  0.9995303808581734
Iteration =  22  Dual obj =  0.10811403336877064  Primal_obj =  0.1364131893365641  Gap =  0.028299155967793463 Sum =  1.000093947405268
Iteration =  23  Dual obj =  0.10811761643038055  Primal_obj =  0.13467616374054403  Gap =  0.02655854731016348 Sum =  0.9992238822141097
Iteration =  24  Dual obj =  0.10812115806050071  Primal_obj =  0.13104218594064926  Gap =  0.022921027880148548 Sum =  1.0003127520009292
Iteration =  0  Dual obj =  0.10812115806050071  Primal_obj =  0.13104218594064926  Gap =  0.022921027880148548 Sum =  1.0003127520009292
Iteration =  1  Dual obj =  0.10812299497690084  Primal_obj =  0.12485366082118012  Gap =  0.016730665844279277 Sum =  0.9999806880462163
Iteration =  2  Dual obj =  0.10812519094291587  Primal_obj =  0.11983758233127237  Gap =  0.011712391388356502 Sum =  1.0000492709526352
Iteration =  3  Dual obj =  0.10812642347493623  Primal_obj =  0.11783711866390817  Gap =  0.00971069518897194 Sum =  0.9997996708559617
Iteration =  4  Dual obj =  0.10812753046981285  Primal_obj =  0.11754962007683366  Gap =  0.009422089607020803 Sum =  1.0001813349428632
Iteration =  5  Dual obj =  0.10812860891219354  Primal_obj =  0.11750543244996366  Gap =  0.009376823537770113 Sum =  0.9998469175126552
Iteration =  6  Dual obj =  0.10812967692034814  Primal_obj =  0.11723243808174554  Gap =  0.009102761161397396 Sum =  0.9998560012666886
Iteration =  7  Dual obj =  0.10813123050029574  Primal_obj =  0.11713609947884981  Gap =  0.00900486897855407 Sum =  1.0002970917059228
Iteration =  8  Dual obj =  0.10813239640255448  Primal_obj =  0.11624236897657196  Gap =  0.00810997257401748 Sum =  1.0000126852990534
Iteration =  9  Dual obj =  0.10813338525333996  Primal_obj =  0.11503258900763826  Gap =  0.006899203754298297 Sum =  1.000322103224451
Iteration =  10  Dual obj =  0.10813432160102607  Primal_obj =  0.11376180881017375  Gap =  0.005627487209147686 Sum =  0.9999140181730741
Iteration =  11  Dual obj =  0.10813494058401832  Primal_obj =  0.11271237007642226  Gap =  0.004577429492403945 Sum =  1.000080267179676
Iteration =  12  Dual obj =  0.10813543314320588  Primal_obj =  0.11189619457346997  Gap =  0.0037607614302640896 Sum =  1.0001492654238486
Iteration =  13  Dual obj =  0.10813576331940286  Primal_obj =  0.11117641772665907  Gap =  0.0030406544072562047 Sum =  0.9999355596872095
Iteration =  14  Dual obj =  0.10813603149931987  Primal_obj =  0.11070357020954924  Gap =  0.0025675387102293695 Sum =  0.9998877208949893
Iteration =  15  Dual obj =  0.10813619999007595  Primal_obj =  0.1102752713748262  Gap =  0.002139071384750252 Sum =  0.9999209118895445
Iteration =  16  Dual obj =  0.10813641132243805  Primal_obj =  0.10995148657687026  Gap =  0.0018150752544322107 Sum =  1.0000716028899785
Iteration =  17  Dual obj =  0.10813660310602163  Primal_obj =  0.10984069637312996  Gap =  0.0017040932671083253 Sum =  1.0000017600163842
Iteration =  18  Dual obj =  0.10813673415901509  Primal_obj =  0.10973442284286124  Gap =  0.0015976886838461463 Sum =  0.9998932916693075
Iteration =  19  Dual obj =  0.10813686806081106  Primal_obj =  0.10962645050719559  Gap =  0.0014895824463845297 Sum =  0.9998864548945732
Iteration =  20  Dual obj =  0.10813700741686158  Primal_obj =  0.10954256242151791  Gap =  0.0014055550046563337 Sum =  1.0001342956591661
Iteration =  21  Dual obj =  0.1081371594953689  Primal_obj =  0.10953135823789445  Gap =  0.0013941987425255542 Sum =  1.0000419783763734
Iteration =  22  Dual obj =  0.10813734722035827  Primal_obj =  0.10960050747678131  Gap =  0.0014631602564230406 Sum =  0.9999973782754183
Iteration =  23  Dual obj =  0.1081375140390099  Primal_obj =  0.10983038128191211  Gap =  0.001692867242902213 Sum =  0.9999250355496452
Iteration =  24  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  0  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  1  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  2  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  3  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  4  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  5  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  6  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  7  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  8  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  9  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  10  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  11  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  12  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  13  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  14  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  15  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  16  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  17  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  18  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  19  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  20  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  21  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  22  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  23  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Iteration =  24  Dual obj =  0.10813771313600337  Primal_obj =  0.10981950660660722  Gap =  0.0016817934706038484 Sum =  1.000094249926103
Done, writing results...
