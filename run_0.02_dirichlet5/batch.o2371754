2021-04-29 12:31:00,164 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.08s.
2021-04-29 12:31:00,596 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.23s.
2021-04-29 12:31:00,984 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.39s.
2021-04-29 12:31:01,099 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-29 12:31:01,102 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:31:01,112 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:31:01,909 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 111.
2021-04-29 12:31:01,909 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.81s.
Iteration =  0  Dual obj =  -49.23189291553325  Primal_obj =  122723.62812827273  Gap =  122772.86002118826 Sum =  351.9104591906208
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.11394483798643057  Primal_obj =  43.669243657159754  Gap =  43.783188495146184 Sum =  0.5649163271936841
Iteration =  3  Dual obj =  0.027739498359517764  Primal_obj =  41.742624200782664  Gap =  41.71488470242315 Sum =  0.7332201463882224
Iteration =  4  Dual obj =  0.05582645557604564  Primal_obj =  24.225772601300697  Gap =  24.16994614572465 Sum =  0.7148509632675464
Iteration =  5  Dual obj =  0.0745588451898669  Primal_obj =  8.820632187595809  Gap =  8.746073342405943 Sum =  0.8775159918906887
Iteration =  6  Dual obj =  0.08191556721921599  Primal_obj =  2.261478819430884  Gap =  2.179563252211668 Sum =  0.9996971158301421
Iteration =  7  Dual obj =  0.08350575357635824  Primal_obj =  0.6017783687410242  Gap =  0.5182726151646659 Sum =  1.0185965094937965
Iteration =  8  Dual obj =  0.0838881667015846  Primal_obj =  0.24299107193297498  Gap =  0.15910290523139037 Sum =  1.0022926790837363
Iteration =  9  Dual obj =  0.08399805090737321  Primal_obj =  0.1306996974851063  Gap =  0.04670164657773308 Sum =  0.9982937254742457
Iteration =  10  Dual obj =  0.08402388305110767  Primal_obj =  0.09820062387117875  Gap =  0.014176740820071088 Sum =  1.0008263730499827
Iteration =  11  Dual obj =  0.08403047784955578  Primal_obj =  0.08971261265569958  Gap =  0.005682134806143796 Sum =  1.0000681126887307
Iteration =  12  Dual obj =  0.08403321304524  Primal_obj =  0.08714973508656876  Gap =  0.0031165220413287564 Sum =  0.9994009196169208
Iteration =  13  Dual obj =  0.08403466070624677  Primal_obj =  0.08609021297097702  Gap =  0.0020555522647302538 Sum =  0.9998099245287029
Iteration =  14  Dual obj =  0.08403563959641538  Primal_obj =  0.08547414992536637  Gap =  0.0014385103289509815 Sum =  1.0001064975555638
Iteration =  15  Dual obj =  0.08403625001959192  Primal_obj =  0.08499716191746398  Gap =  0.0009609118978720632 Sum =  0.9999663641483335
Iteration =  16  Dual obj =  0.08403666155730699  Primal_obj =  0.08470996794603577  Gap =  0.0006733063887287838 Sum =  0.9998518894262889
Iteration =  17  Dual obj =  0.08403690741078579  Primal_obj =  0.0845270744948513  Gap =  0.0004901670840655181 Sum =  1.0000422568823113
Iteration =  18  Dual obj =  0.08403706977092071  Primal_obj =  0.0844326297918421  Gap =  0.00039556002092139275 Sum =  1.000054938702934
Iteration =  19  Dual obj =  0.08403720768582122  Primal_obj =  0.08434568913009163  Gap =  0.00030848144427041146 Sum =  0.9999854374568078
Iteration =  20  Dual obj =  0.08403730193271333  Primal_obj =  0.08426942383872159  Gap =  0.00023212190600825633 Sum =  0.999967168383907
Iteration =  21  Dual obj =  0.08403736705645222  Primal_obj =  0.08421823224971799  Gap =  0.00018086519326576678 Sum =  1.0000274191225105
Iteration =  22  Dual obj =  0.08403741604942229  Primal_obj =  0.08418104553363234  Gap =  0.00014362948421005328 Sum =  1.0000143536970356
Iteration =  23  Dual obj =  0.08403745110806571  Primal_obj =  0.08415530557314913  Gap =  0.00011785446508341679 Sum =  0.9999728775028018
Iteration =  24  Dual obj =  0.08403748171173736  Primal_obj =  0.08413823377472812  Gap =  0.000100752062990761 Sum =  0.9999921308141648
Iteration =  0  Dual obj =  -34.81488839795151  Primal_obj =  87828.77324772108  Gap =  87863.58813611903 Sum =  351.9104591906208
Iteration =  1  Dual obj =  0.01443012202387968  Primal_obj =  78.36560517385655  Gap =  78.35117505183267 Sum =  0.67772746222659
Iteration =  2  Dual obj =  0.08086189997112736  Primal_obj =  34.18679046412977  Gap =  34.105928564158646 Sum =  0.7786080040925963
Iteration =  3  Dual obj =  0.10440638172535702  Primal_obj =  21.067957543994225  Gap =  20.963551162268868 Sum =  0.7182452723773254
Iteration =  4  Dual obj =  0.11548541497790768  Primal_obj =  15.48125553327376  Gap =  15.365770118295853 Sum =  0.7302697453872624
Iteration =  5  Dual obj =  0.1237850290090739  Primal_obj =  10.211475260560993  Gap =  10.08769023155192 Sum =  0.8436850991028608
Iteration =  6  Dual obj =  0.1287075332965457  Primal_obj =  6.681499857013401  Gap =  6.552792323716855 Sum =  0.9418010108977324
Iteration =  7  Dual obj =  0.13119615471532056  Primal_obj =  4.398584998403972  Gap =  4.267388843688652 Sum =  1.029013728310863
Iteration =  8  Dual obj =  0.13234193181440992  Primal_obj =  3.0231059708595347  Gap =  2.890764039045125 Sum =  1.0058732353850814
Iteration =  9  Dual obj =  0.13324086734009644  Primal_obj =  2.1220336638714135  Gap =  1.988792796531317 Sum =  0.9838143226405751
Iteration =  10  Dual obj =  0.13382649065001043  Primal_obj =  1.5004797564022765  Gap =  1.366653265752266 Sum =  0.9973724088436768
Iteration =  11  Dual obj =  0.13411298618321682  Primal_obj =  1.0079967126741727  Gap =  0.8738837264909558 Sum =  1.006180557063922
Iteration =  12  Dual obj =  0.13436510456195103  Primal_obj =  0.779579255049369  Gap =  0.6452141504874179 Sum =  1.0020846413518112
Iteration =  13  Dual obj =  0.13454523052412015  Primal_obj =  0.4941887122427458  Gap =  0.35964348171862565 Sum =  0.9900805219136172
Iteration =  14  Dual obj =  0.13464597088275537  Primal_obj =  0.34225990514927956  Gap =  0.2076139342665242 Sum =  0.9974797919207191
Iteration =  15  Dual obj =  0.13470747097804356  Primal_obj =  0.28946967104710025  Gap =  0.1547622000690567 Sum =  1.0013980442768298
Iteration =  16  Dual obj =  0.13475610158459939  Primal_obj =  0.27434308925932127  Gap =  0.13958698767472189 Sum =  1.0027779048676406
Iteration =  17  Dual obj =  0.13479934548199832  Primal_obj =  0.264902144039074  Gap =  0.13010279855707566 Sum =  0.9984409207104818
Iteration =  18  Dual obj =  0.1348341831545444  Primal_obj =  0.25205740997313253  Gap =  0.11722322681858813 Sum =  0.9987957738668369
Iteration =  19  Dual obj =  0.13486751348001627  Primal_obj =  0.22134921822718256  Gap =  0.0864817047471663 Sum =  0.9974696208467839
Iteration =  20  Dual obj =  0.13489029903480038  Primal_obj =  0.21390634910065634  Gap =  0.07901605006585596 Sum =  1.0005467057096724
Iteration =  21  Dual obj =  0.13491072316194547  Primal_obj =  0.19620895447875455  Gap =  0.06129823131680909 Sum =  0.9997343624590006
Iteration =  22  Dual obj =  0.13492630207987577  Primal_obj =  0.19027574765104055  Gap =  0.05534944557116478 Sum =  0.9992597802908336
Iteration =  23  Dual obj =  0.13494074400860237  Primal_obj =  0.18240381859051427  Gap =  0.0474630745819119 Sum =  1.000456292903724
Iteration =  24  Dual obj =  0.1349526877312386  Primal_obj =  0.17374136124148232  Gap =  0.038788673510243704 Sum =  0.9995227335000937
Iteration =  0  Dual obj =  0.1349526877312386  Primal_obj =  0.17374136124148232  Gap =  0.038788673510243704 Sum =  0.9995227335000937
Iteration =  1  Dual obj =  0.13495791474379445  Primal_obj =  0.16095577835846575  Gap =  0.025997863614671296 Sum =  1.0006049916736095
Iteration =  2  Dual obj =  0.13496240782801888  Primal_obj =  0.15749759782387796  Gap =  0.022535189995859073 Sum =  0.9993157196988722
Iteration =  3  Dual obj =  0.13496694407240056  Primal_obj =  0.1609792349563056  Gap =  0.026012290883905026 Sum =  0.9998094415237753
Iteration =  4  Dual obj =  0.13497275599304093  Primal_obj =  0.1644164576264748  Gap =  0.029443701633433877 Sum =  1.0004517864044025
Iteration =  5  Dual obj =  0.13497887240756448  Primal_obj =  0.16439170828504782  Gap =  0.029412835877483334 Sum =  0.9997259668632403
Iteration =  6  Dual obj =  0.13498425714333306  Primal_obj =  0.15886957502194518  Gap =  0.023885317878612117 Sum =  0.9999024598487187
Iteration =  7  Dual obj =  0.13498907407597963  Primal_obj =  0.15419765037870145  Gap =  0.019208576302721825 Sum =  0.9990890929781042
Iteration =  8  Dual obj =  0.13499220422895125  Primal_obj =  0.1506452313785851  Gap =  0.015653027149633847 Sum =  0.9996950847714569
Iteration =  9  Dual obj =  0.13499431597573  Primal_obj =  0.1479767727175806  Gap =  0.012982456741850612 Sum =  1.0004894628353416
Iteration =  10  Dual obj =  0.1349964553523264  Primal_obj =  0.14562996850540505  Gap =  0.010633513153078644 Sum =  1.0002846464365358
Iteration =  11  Dual obj =  0.13499835368091892  Primal_obj =  0.14369210200830076  Gap =  0.008693748327381845 Sum =  0.9994799826366324
Iteration =  12  Dual obj =  0.13499983115344855  Primal_obj =  0.14276949378954698  Gap =  0.0077696626360984344 Sum =  1.0001652741105713
Iteration =  13  Dual obj =  0.1350011675345345  Primal_obj =  0.14172128672232137  Gap =  0.006720119187786866 Sum =  1.000290280530133
Iteration =  14  Dual obj =  0.13500239782575682  Primal_obj =  0.14103555368896695  Gap =  0.006033155863210127 Sum =  1.0001503938216292
Iteration =  15  Dual obj =  0.13500345235893324  Primal_obj =  0.1400332713972999  Gap =  0.005029819038366662 Sum =  1.0002022188558595
Iteration =  16  Dual obj =  0.1350042838507185  Primal_obj =  0.1396927603043826  Gap =  0.004688476453664103 Sum =  1.0000988414832368
Iteration =  17  Dual obj =  0.1350050082773372  Primal_obj =  0.1396261393107498  Gap =  0.0046211310334126066 Sum =  0.9999240245664358
Iteration =  18  Dual obj =  0.13500563877438676  Primal_obj =  0.1394567898425054  Gap =  0.004451151068118636 Sum =  1.0002805295066053
Iteration =  19  Dual obj =  0.1350062222010223  Primal_obj =  0.13942768876136516  Gap =  0.004421466560342868 Sum =  0.9997620690421575
Iteration =  20  Dual obj =  0.13500673323748272  Primal_obj =  0.13880264769828474  Gap =  0.003795914460802019 Sum =  0.9999092983724064
Iteration =  21  Dual obj =  0.1350072838287037  Primal_obj =  0.13803477347802276  Gap =  0.003027489649319065 Sum =  1.0000673026640765
Iteration =  22  Dual obj =  0.13500770385670985  Primal_obj =  0.13743881064045102  Gap =  0.0024311067837411715 Sum =  0.9997997368334688
Iteration =  23  Dual obj =  0.13500797975898757  Primal_obj =  0.13723238007836688  Gap =  0.002224400319379316 Sum =  1.0000741324925326
Iteration =  24  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  0  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  1  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  2  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  3  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  4  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  5  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  6  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  7  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  8  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  9  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  10  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  11  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  12  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  13  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  14  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  15  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  16  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  17  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  18  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  19  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  20  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  21  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  22  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  23  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  24  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  0  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  1  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  2  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  3  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  4  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  5  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  6  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  7  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  8  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  9  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  10  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  11  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  12  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  13  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  14  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  15  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  16  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  17  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  18  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  19  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  20  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  21  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  22  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  23  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Iteration =  24  Dual obj =  0.13500823562583236  Primal_obj =  0.13700641095139054  Gap =  0.0019981753255581824 Sum =  1.0001971067445945
Done, writing results...
