2021-04-29 12:31:21,852 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.62s.
2021-04-29 12:31:22,364 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.28s.
2021-04-29 12:31:22,849 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.48s.
2021-04-29 12:31:22,992 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.14s.
2021-04-29 12:31:22,996 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:31:23,008 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:31:23,943 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 102.
2021-04-29 12:31:23,944 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.95s.
Iteration =  0  Dual obj =  -48.270564144922126  Primal_obj =  69322.49688136695  Gap =  69370.76744551188 Sum =  443.1424198204358
Iteration =  1  Dual obj =  -0.019863252568475105  Primal_obj =  38.682691134806305  Gap =  38.70255438737478 Sum =  0.6362905770609364
Iteration =  2  Dual obj =  0.05989333024107214  Primal_obj =  15.75022014254387  Gap =  15.690326812302798 Sum =  0.7904876044628222
Iteration =  3  Dual obj =  0.08142441738682205  Primal_obj =  8.271168420378666  Gap =  8.189744002991844 Sum =  0.7900803620693967
Iteration =  4  Dual obj =  0.09315017623630793  Primal_obj =  4.513085652358208  Gap =  4.4199354761219 Sum =  0.8491894139277703
Iteration =  5  Dual obj =  0.0995379317925664  Primal_obj =  1.3810829943260667  Gap =  1.2815450625335003 Sum =  0.9791713278410156
Iteration =  6  Dual obj =  0.10090586044874425  Primal_obj =  0.42215087651077365  Gap =  0.3212450160620294 Sum =  1.0108971392016546
Iteration =  7  Dual obj =  0.10118117035294574  Primal_obj =  0.19645860570906085  Gap =  0.0952774353561151 Sum =  0.9982258384102227
Iteration =  8  Dual obj =  0.10126609655483793  Primal_obj =  0.13432822116992896  Gap =  0.03306212461509103 Sum =  1.000231527814611
Iteration =  9  Dual obj =  0.10129105657338826  Primal_obj =  0.11347387185838537  Gap =  0.012182815284997109 Sum =  1.0005995777866976
Iteration =  10  Dual obj =  0.10130062336380193  Primal_obj =  0.10703678174741041  Gap =  0.005736158383608483 Sum =  0.9998210954529226
Iteration =  11  Dual obj =  0.10130459829180893  Primal_obj =  0.10401715826247138  Gap =  0.0027125599706624426 Sum =  0.9996684877739265
Iteration =  12  Dual obj =  0.10130644052852839  Primal_obj =  0.1027585317010392  Gap =  0.0014520911725108138 Sum =  0.9998875352873628
Iteration =  13  Dual obj =  0.10130732135137682  Primal_obj =  0.10216256559068963  Gap =  0.0008552442393128107 Sum =  1.0000632286628484
Iteration =  14  Dual obj =  0.10130782703089294  Primal_obj =  0.10187793499996578  Gap =  0.0005701079690728361 Sum =  0.9998537756623185
Iteration =  15  Dual obj =  0.10130813396058379  Primal_obj =  0.1017434016781171  Gap =  0.0004352677175333136 Sum =  0.9999852815696326
Iteration =  16  Dual obj =  0.10130838673797304  Primal_obj =  0.10169006344727007  Gap =  0.00038167670929702135 Sum =  0.999914245698582
Iteration =  17  Dual obj =  0.10130861423495267  Primal_obj =  0.10163244507414386  Gap =  0.00032383083919118594 Sum =  0.9999169505689589
Iteration =  18  Dual obj =  0.10130877914773981  Primal_obj =  0.10155712144216643  Gap =  0.0002483422944266206 Sum =  1.0000430052074698
Iteration =  19  Dual obj =  0.10130888525173434  Primal_obj =  0.10149204123198126  Gap =  0.0001831559802469157 Sum =  1.0000629350979189
Iteration =  20  Dual obj =  0.1013089588112936  Primal_obj =  0.1014521053710485  Gap =  0.000143146559754892 Sum =  0.999989321023244
Iteration =  21  Dual obj =  0.10130902116146331  Primal_obj =  0.1014421482725548  Gap =  0.00013312711109148 Sum =  0.9998358047122923
Iteration =  22  Dual obj =  0.10130905575730709  Primal_obj =  0.10144443609233322  Gap =  0.00013538033502613622 Sum =  0.9999055248221019
Iteration =  23  Dual obj =  0.10130911525041474  Primal_obj =  0.10142127873688073  Gap =  0.00011216348646599095 Sum =  1.0000378551212379
Iteration =  24  Dual obj =  0.10130915958636195  Primal_obj =  0.10140527342381506  Gap =  9.611383745310176e-05 Sum =  0.9999872062430148
Iteration =  0  Dual obj =  -57.504248490476286  Primal_obj =  92041.72478759532  Gap =  92099.22903608579 Sum =  443.1424198204358
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  inf
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.3897835758899052  Primal_obj =  680.660549167609  Gap =  681.0503327434989 Sum =  8.97174779755803
Iteration =  4  Dual obj =  -0.047303249021668964  Primal_obj =  75.24071951013808  Gap =  75.28802275915974 Sum =  0.7434066141711082
Iteration =  5  Dual obj =  0.03353475639566737  Primal_obj =  50.988926654198245  Gap =  50.95539189780258 Sum =  0.6586801454747139
Iteration =  6  Dual obj =  0.07665162928633762  Primal_obj =  22.68876812976878  Gap =  22.61211650048244 Sum =  0.7664442365966464
Iteration =  7  Dual obj =  0.09088552715741774  Primal_obj =  14.773654323880432  Gap =  14.682768796723014 Sum =  0.7868626790610047
Iteration =  8  Dual obj =  0.10080709157165624  Primal_obj =  12.0302596681943  Gap =  11.929452576622644 Sum =  0.743476154232346
Iteration =  9  Dual obj =  0.10831262086607454  Primal_obj =  8.98872801927482  Gap =  8.880415398408745 Sum =  0.7518962962475598
Iteration =  10  Dual obj =  0.11214533006961427  Primal_obj =  7.321593402696585  Gap =  7.209448072626971 Sum =  0.8010741984839952
Iteration =  11  Dual obj =  0.11524587670528465  Primal_obj =  5.192393690925167  Gap =  5.077147814219882 Sum =  0.8285444851633981
Iteration =  12  Dual obj =  0.117717517364878  Primal_obj =  4.64573466277261  Gap =  4.528017145407732 Sum =  0.8679123208395726
Iteration =  13  Dual obj =  0.12020512018817231  Primal_obj =  3.6429117700200573  Gap =  3.522706649831885 Sum =  0.8651603952145672
Iteration =  14  Dual obj =  0.12179826825063242  Primal_obj =  3.406006123661009  Gap =  3.2842078554103766 Sum =  0.8865961659638735
Iteration =  15  Dual obj =  0.1232682472372036  Primal_obj =  3.1622970191230415  Gap =  3.039028771885838 Sum =  0.9012897164896367
Iteration =  16  Dual obj =  0.12436778951866191  Primal_obj =  2.5448927568003517  Gap =  2.4205249672816898 Sum =  0.9235603923562155
Iteration =  17  Dual obj =  0.12532935717765323  Primal_obj =  2.133387913244927  Gap =  2.008058556067274 Sum =  0.9753058892140882
Iteration =  18  Dual obj =  0.12582520599607971  Primal_obj =  1.8897530354546677  Gap =  1.7639278294585878 Sum =  1.0430854566162966
Iteration =  19  Dual obj =  0.12620129927495308  Primal_obj =  1.6403199017293693  Gap =  1.5141186024544162 Sum =  1.0535486016354643
Iteration =  20  Dual obj =  0.12644815286758826  Primal_obj =  1.2105802222995574  Gap =  1.0841320694319692 Sum =  1.008708735689583
Iteration =  21  Dual obj =  0.12664907407147302  Primal_obj =  1.0082886563478242  Gap =  0.8816395822763512 Sum =  0.9928315827673615
Iteration =  22  Dual obj =  0.12686242263558228  Primal_obj =  0.9798619362090568  Gap =  0.8529995135734745 Sum =  0.9802896658372506
Iteration =  23  Dual obj =  0.12703236847383498  Primal_obj =  1.091088524365077  Gap =  0.9640561558912419 Sum =  0.9770002020930715
Iteration =  24  Dual obj =  0.12723626095848484  Primal_obj =  1.0331714570351431  Gap =  0.9059351960766583 Sum =  0.9730299108250873
Iteration =  0  Dual obj =  0.12723626095848484  Primal_obj =  1.0331714570351431  Gap =  0.9059351960766583 Sum =  0.9730299108250873
Iteration =  1  Dual obj =  0.12735674035850716  Primal_obj =  0.7941616103083603  Gap =  0.6668048699498531 Sum =  0.9735053645733225
Iteration =  2  Dual obj =  0.1274590438320968  Primal_obj =  0.6599736733056702  Gap =  0.5325146294735734 Sum =  0.9845350808065763
Iteration =  3  Dual obj =  0.12753939731798083  Primal_obj =  0.6662253084029157  Gap =  0.5386859110849349 Sum =  0.9946851527958704
Iteration =  4  Dual obj =  0.12762556894305632  Primal_obj =  0.6297957620439236  Gap =  0.5021701931008673 Sum =  1.0164439021525484
Iteration =  5  Dual obj =  0.12772919498110477  Primal_obj =  0.6407524960584694  Gap =  0.5130233010773646 Sum =  1.0196589903404942
Iteration =  6  Dual obj =  0.12781927007294397  Primal_obj =  0.6508308350067319  Gap =  0.5230115649337879 Sum =  1.0117636019201481
Iteration =  7  Dual obj =  0.12789727193689823  Primal_obj =  0.7931125714559301  Gap =  0.6652152995190318 Sum =  0.9981828637604517
Iteration =  8  Dual obj =  0.12797511844501228  Primal_obj =  0.6645244022965228  Gap =  0.5365492838515105 Sum =  0.9941032910953804
Iteration =  9  Dual obj =  0.12805468903815648  Primal_obj =  0.5618203214478384  Gap =  0.43376563240968197 Sum =  0.9877187921980013
Iteration =  10  Dual obj =  0.12812218453975976  Primal_obj =  0.5257035145032435  Gap =  0.3975813299634837 Sum =  0.9855800736756793
Iteration =  11  Dual obj =  0.1281834927754063  Primal_obj =  0.5541756245179217  Gap =  0.4259921317425154 Sum =  0.9969309951749187
Iteration =  12  Dual obj =  0.12823356566379351  Primal_obj =  0.5860635213694593  Gap =  0.45782995570566576 Sum =  1.0040692594176206
Iteration =  13  Dual obj =  0.1282792625392407  Primal_obj =  0.5582915390324519  Gap =  0.43001227649321117 Sum =  1.0060115073577094
Iteration =  14  Dual obj =  0.12832054003936036  Primal_obj =  0.4488129046125858  Gap =  0.3204923645732254 Sum =  1.0031651329060174
Iteration =  15  Dual obj =  0.12834940427252506  Primal_obj =  0.40387868860882276  Gap =  0.2755292843362977 Sum =  1.000213472552725
Iteration =  16  Dual obj =  0.1283690402583916  Primal_obj =  0.36226623777909844  Gap =  0.23389719752070684 Sum =  0.9992221652871901
Iteration =  17  Dual obj =  0.12838660152006842  Primal_obj =  0.3081989954481402  Gap =  0.1798123939280718 Sum =  0.9990977373061625
Iteration =  18  Dual obj =  0.1284040126700446  Primal_obj =  0.27283623334187956  Gap =  0.14443222067183498 Sum =  0.9986291732373616
Iteration =  19  Dual obj =  0.12841690257912594  Primal_obj =  0.25533148111013204  Gap =  0.1269145785310061 Sum =  0.9987813292863817
Iteration =  20  Dual obj =  0.12842907576219154  Primal_obj =  0.25324117538044316  Gap =  0.12481209961825163 Sum =  0.9996546907234658
Iteration =  21  Dual obj =  0.12844206856375098  Primal_obj =  0.2549305741157201  Gap =  0.12648850555196914 Sum =  1.000615618962954
Iteration =  22  Dual obj =  0.1284560266268771  Primal_obj =  0.24612913708512815  Gap =  0.11767311045825105 Sum =  1.0023269599663167
Iteration =  23  Dual obj =  0.1284703588173402  Primal_obj =  0.2398608922667601  Gap =  0.1113905334494199 Sum =  1.000841080829447
Iteration =  24  Dual obj =  0.12848285219532757  Primal_obj =  0.23075895964415444  Gap =  0.10227610744882687 Sum =  0.999574409314305
Iteration =  0  Dual obj =  0.12848285219532757  Primal_obj =  0.23075895964415444  Gap =  0.10227610744882687 Sum =  0.999574409314305
Iteration =  1  Dual obj =  0.12848923039084892  Primal_obj =  0.21353284574704  Gap =  0.0850436153561911 Sum =  0.9994753453613534
Iteration =  2  Dual obj =  0.12849759507697833  Primal_obj =  0.1937186219698619  Gap =  0.06522102689288356 Sum =  1.0016579640090857
Iteration =  3  Dual obj =  0.1285042415383456  Primal_obj =  0.1833909003512142  Gap =  0.05488665881286858 Sum =  0.9995841571683919
Iteration =  4  Dual obj =  0.12850933075675963  Primal_obj =  0.17893954406336193  Gap =  0.0504302133066023 Sum =  0.9994401260140416
Iteration =  5  Dual obj =  0.12851477147096568  Primal_obj =  0.1790582126890165  Gap =  0.05054344121805082 Sum =  0.99951262591669
Iteration =  6  Dual obj =  0.12852051512984938  Primal_obj =  0.18493555406154777  Gap =  0.056415038931698386 Sum =  1.000804497842812
Iteration =  7  Dual obj =  0.12852484392543523  Primal_obj =  0.1925493193550088  Gap =  0.06402447542957357 Sum =  0.9994361016182802
Iteration =  8  Dual obj =  0.12853002133729158  Primal_obj =  0.19705336818159364  Gap =  0.06852334684430206 Sum =  0.9997604098440472
Iteration =  9  Dual obj =  0.12853699547582592  Primal_obj =  0.1990794517799874  Gap =  0.07054245630416148 Sum =  0.9988229407207309
Iteration =  10  Dual obj =  0.12854412029058168  Primal_obj =  0.19623899613990425  Gap =  0.06769487584932257 Sum =  1.000892650594433
Iteration =  11  Dual obj =  0.12854841319892452  Primal_obj =  0.19818141327093622  Gap =  0.0696330000720117 Sum =  1.0004273633661178
Iteration =  12  Dual obj =  0.12855368859876815  Primal_obj =  0.19526546194151626  Gap =  0.06671177334274811 Sum =  1.000291968340996
Iteration =  13  Dual obj =  0.1285580020874344  Primal_obj =  0.19050669182993527  Gap =  0.06194868974250087 Sum =  0.9996127046983978
Iteration =  14  Dual obj =  0.1285617936133897  Primal_obj =  0.1839225500617201  Gap =  0.055360756448330384 Sum =  1.0001432890372055
Iteration =  15  Dual obj =  0.12856532857924438  Primal_obj =  0.17668273333343154  Gap =  0.04811740475418716 Sum =  0.9998544686476267
Iteration =  16  Dual obj =  0.12856821086266068  Primal_obj =  0.17023408557589062  Gap =  0.04166587471322994 Sum =  0.9994077987032157
Iteration =  17  Dual obj =  0.12857081400254142  Primal_obj =  0.16547297241594067  Gap =  0.03690215841339925 Sum =  0.9999022185558935
Iteration =  18  Dual obj =  0.12857325277773818  Primal_obj =  0.16287986264602786  Gap =  0.03430660986828968 Sum =  0.9998352708128301
Iteration =  19  Dual obj =  0.12857543891950404  Primal_obj =  0.160444832151187  Gap =  0.031869393231682946 Sum =  1.000422523442884
Iteration =  20  Dual obj =  0.1285781067047162  Primal_obj =  0.15995754309684074  Gap =  0.03137943639212454 Sum =  1.0001826336166668
Iteration =  21  Dual obj =  0.12858033627986795  Primal_obj =  0.16037939163994597  Gap =  0.031799055360078016 Sum =  0.9995243732484121
Iteration =  22  Dual obj =  0.1285825546197575  Primal_obj =  0.16307003442642168  Gap =  0.03448747980666417 Sum =  0.9995302693476135
Iteration =  23  Dual obj =  0.1285845809857203  Primal_obj =  0.16375487356763468  Gap =  0.0351702925819144 Sum =  1.0001841562322202
Iteration =  24  Dual obj =  0.12858686086824167  Primal_obj =  0.16114342431547904  Gap =  0.03255656344723737 Sum =  1.000685098970736
Iteration =  0  Dual obj =  0.12858686086824167  Primal_obj =  0.16114342431547904  Gap =  0.03255656344723737 Sum =  1.000685098970736
Iteration =  1  Dual obj =  0.128588093891824  Primal_obj =  0.15661326497704536  Gap =  0.028025171085221373 Sum =  0.9998319071474308
Iteration =  2  Dual obj =  0.12858959792007796  Primal_obj =  0.1487251663652634  Gap =  0.020135568445185437 Sum =  0.9993836648427308
Iteration =  3  Dual obj =  0.12859158770662746  Primal_obj =  0.14061065505574757  Gap =  0.012019067349120116 Sum =  0.9999436607159067
Iteration =  4  Dual obj =  0.12859310378827676  Primal_obj =  0.13774766232183314  Gap =  0.009154558533556373 Sum =  1.0004852568613578
Iteration =  5  Dual obj =  0.12859398793531035  Primal_obj =  0.13658166088156326  Gap =  0.00798767294625291 Sum =  1.000362994549153
Iteration =  6  Dual obj =  0.128594527805478  Primal_obj =  0.13601137042850633  Gap =  0.00741684262302833 Sum =  1.000214513351884
Iteration =  7  Dual obj =  0.12859495092733353  Primal_obj =  0.1355011678585578  Gap =  0.006906216931224285 Sum =  0.9998566522990846
Iteration =  8  Dual obj =  0.12859540726694396  Primal_obj =  0.1351741492731972  Gap =  0.0065787420062532465 Sum =  0.9998909843469835
Iteration =  9  Dual obj =  0.1285958568644433  Primal_obj =  0.13527947201419413  Gap =  0.006683615149750827 Sum =  0.9999939727855371
Iteration =  10  Dual obj =  0.1285962831007777  Primal_obj =  0.1356653178543064  Gap =  0.0070690347535287135 Sum =  0.9995700276351043
Iteration =  11  Dual obj =  0.1285966512488757  Primal_obj =  0.13559893542139168  Gap =  0.007002284172515971 Sum =  0.999740846900294
Iteration =  12  Dual obj =  0.1285971025517703  Primal_obj =  0.13483048906933834  Gap =  0.006233386517568051 Sum =  0.9998714622458338
Iteration =  13  Dual obj =  0.1285975997517164  Primal_obj =  0.13376436595879254  Gap =  0.005166766207076151 Sum =  1.0004016473018948
Iteration =  14  Dual obj =  0.12859798901268943  Primal_obj =  0.13287168335270594  Gap =  0.0042736943400165095 Sum =  1.000393047123088
Iteration =  15  Dual obj =  0.12859835656234417  Primal_obj =  0.13207103274546156  Gap =  0.0034726761831173902 Sum =  1.0002118174548136
Iteration =  16  Dual obj =  0.12859863523354712  Primal_obj =  0.13172345349563774  Gap =  0.0031248182620906284 Sum =  1.000085855887578
Iteration =  17  Dual obj =  0.12859884790857623  Primal_obj =  0.13150040632554083  Gap =  0.0029015584169646003 Sum =  0.9998206643628564
Iteration =  18  Dual obj =  0.12859900580918524  Primal_obj =  0.13140639757480727  Gap =  0.0028073917656220304 Sum =  1.0000373758739984
Iteration =  19  Dual obj =  0.12859915546366804  Primal_obj =  0.13139097250069945  Gap =  0.0027918170370314077 Sum =  0.9997564173390586
Iteration =  20  Dual obj =  0.12859931612649075  Primal_obj =  0.1312776751863658  Gap =  0.0026783590598750406 Sum =  0.9999355550110494
Iteration =  21  Dual obj =  0.12859945600591388  Primal_obj =  0.13115705837771782  Gap =  0.002557602371803941 Sum =  0.9999309325303792
Iteration =  22  Dual obj =  0.1285995584163422  Primal_obj =  0.1309798988396978  Gap =  0.0023803404233555814 Sum =  1.0000378002253851
Iteration =  23  Dual obj =  0.12859968861148036  Primal_obj =  0.13073718769980366  Gap =  0.002137499088323308 Sum =  1.0000901804082312
Iteration =  24  Dual obj =  0.12859978935371214  Primal_obj =  0.13061307497329872  Gap =  0.00201328561958658 Sum =  1.0000520437338976
Done, writing results...
