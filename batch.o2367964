2021-04-26 23:05:11,796 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.21s.
2021-04-26 23:05:12,232 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.23s.
2021-04-26 23:05:12,663 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.43s.
2021-04-26 23:05:12,779 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-26 23:05:12,783 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-26 23:05:12,793 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-26 23:05:13,619 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 119.
2021-04-26 23:05:13,620 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.84s.
Iteration =  0  Dual obj =  -37.5025169492519  Primal_obj =  11536.123049036898  Gap =  11573.625565986149 Sum =  401.59096008717813
Iteration =  1  Dual obj =  -0.10090237465084471  Primal_obj =  4.248002620158213  Gap =  4.348904994809058 Sum =  0.9323601979321396
Iteration =  2  Dual obj =  -0.07353264047600547  Primal_obj =  0.9629005050953394  Gap =  1.036433145571345 Sum =  0.9035058605044622
Iteration =  3  Dual obj =  -0.06893585951316017  Primal_obj =  0.29799332724684197  Gap =  0.36692918676000214 Sum =  0.9524658734020424
Iteration =  4  Dual obj =  -0.06738848203692827  Primal_obj =  0.158256481956972  Gap =  0.22564496399390027 Sum =  0.986981372949406
Iteration =  5  Dual obj =  -0.066788533419537  Primal_obj =  0.05440115049624822  Gap =  0.12118968391578522 Sum =  1.0026297835460407
Iteration =  6  Dual obj =  -0.06654716463898212  Primal_obj =  0.012791227515875803  Gap =  0.07933839215485793 Sum =  1.0035331554570237
Iteration =  7  Dual obj =  -0.06637896800547591  Primal_obj =  -0.008370644866885657  Gap =  0.05800832313859025 Sum =  1.0020486901389245
Iteration =  8  Dual obj =  -0.06626829400784369  Primal_obj =  -0.021913263709776837  Gap =  0.04435503029806685 Sum =  1.0018875600373205
Iteration =  9  Dual obj =  -0.06620180210706911  Primal_obj =  -0.03550856462543159  Gap =  0.03069323748163752 Sum =  1.002501683245782
Iteration =  10  Dual obj =  -0.06615906803713106  Primal_obj =  -0.04698933501835385  Gap =  0.01916973301877721 Sum =  1.0021973041750707
Iteration =  11  Dual obj =  -0.06613225697351532  Primal_obj =  -0.05298260518790099  Gap =  0.013149651785614336 Sum =  1.0010323004082926
Iteration =  12  Dual obj =  -0.06611338507659198  Primal_obj =  -0.05781646126691216  Gap =  0.008296923809679821 Sum =  1.0008699565164139
Iteration =  13  Dual obj =  -0.06609863759067845  Primal_obj =  -0.06014257491585913  Gap =  0.0059560626748193235 Sum =  1.0012939146350965
Iteration =  14  Dual obj =  -0.06608766777678367  Primal_obj =  -0.06174883324301622  Gap =  0.004338834533767447 Sum =  1.0012535880922293
Iteration =  15  Dual obj =  -0.06607983664769689  Primal_obj =  -0.06256225284440321  Gap =  0.0035175838032936724 Sum =  1.0009626123856
Iteration =  16  Dual obj =  -0.0660728564572652  Primal_obj =  -0.0630130283386204  Gap =  0.003059828118644803 Sum =  1.0007122848493977
Iteration =  17  Dual obj =  -0.06606714040713327  Primal_obj =  -0.063382061248967  Gap =  0.0026850791581662647 Sum =  1.0007427158784108
Iteration =  18  Dual obj =  -0.06606236775305899  Primal_obj =  -0.06368245013137941  Gap =  0.002379917621679578 Sum =  1.0005922603178279
Iteration =  19  Dual obj =  -0.06605865167127394  Primal_obj =  -0.06401525053179682  Gap =  0.0020434011394771107 Sum =  1.0005098632538123
Iteration =  20  Dual obj =  -0.06605583325592614  Primal_obj =  -0.06441907796924444  Gap =  0.001636755286681696 Sum =  1.0002643320308238
Iteration =  21  Dual obj =  -0.06605391953712544  Primal_obj =  -0.06478799226412162  Gap =  0.001265927273003828 Sum =  1.0001431119743167
Iteration =  22  Dual obj =  -0.0660525822579637  Primal_obj =  -0.06506727483627732  Gap =  0.000985307421686385 Sum =  1.0000970143450871
Iteration =  23  Dual obj =  -0.06605164920358295  Primal_obj =  -0.06527094923729775  Gap =  0.0007806999662852004 Sum =  1.000096810278295
Iteration =  24  Dual obj =  -0.06605102002225402  Primal_obj =  -0.0654190369005972  Gap =  0.0006319831216568261 Sum =  1.000061861246468
Iteration =  0  Dual obj =  -42.317508447969544  Primal_obj =  13596.040302012805  Gap =  13638.357810460775 Sum =  401.59096008717813
Iteration =  1  Dual obj =  -0.1423737984651695  Primal_obj =  10.256909380552667  Gap =  10.399283179017836 Sum =  0.993843715525106
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  3  Dual obj =  -0.11146821693528228  Primal_obj =  5.556885644036436  Gap =  5.668353860971719 Sum =  0.967650433534167
Iteration =  4  Dual obj =  -0.0878069133191762  Primal_obj =  4.4088660031167795  Gap =  4.496672916435956 Sum =  1.0356778050296649
Iteration =  5  Dual obj =  -0.06946781085847795  Primal_obj =  3.08612141100298  Gap =  3.155589221861458 Sum =  0.9412702461049777
Iteration =  6  Dual obj =  -0.06055398048302403  Primal_obj =  2.0571179740119114  Gap =  2.1176719544949356 Sum =  0.9272590186473963
Iteration =  7  Dual obj =  -0.055104081486165316  Primal_obj =  0.8520900107251205  Gap =  0.9071940922112858 Sum =  0.9351901108617213
Iteration =  8  Dual obj =  -0.053014405656868574  Primal_obj =  0.4719522234371348  Gap =  0.5249666290940034 Sum =  0.9393529494238593
Iteration =  9  Dual obj =  -0.05195355287379731  Primal_obj =  0.31790130699154245  Gap =  0.3698548598653398 Sum =  0.9518305091368602
Iteration =  10  Dual obj =  -0.05134670316646661  Primal_obj =  0.2645978603207568  Gap =  0.3159445634872234 Sum =  0.9673889620227639
Iteration =  11  Dual obj =  -0.05098826223571551  Primal_obj =  0.17480928912021976  Gap =  0.22579755135593527 Sum =  0.9793976546125089
Iteration =  12  Dual obj =  -0.05074028555136606  Primal_obj =  0.12985989118271257  Gap =  0.18060017673407863 Sum =  0.9865013230616708
Iteration =  13  Dual obj =  -0.050572336857823745  Primal_obj =  0.08729186329837038  Gap =  0.13786420015619413 Sum =  0.9914127782728412
Iteration =  14  Dual obj =  -0.05043534212357453  Primal_obj =  0.059196019323258464  Gap =  0.109631361446833 Sum =  0.995102331625745
Iteration =  15  Dual obj =  -0.050347130845219565  Primal_obj =  0.05017899174457058  Gap =  0.10052612258979014 Sum =  0.996325411446132
Iteration =  16  Dual obj =  -0.05026032246273499  Primal_obj =  0.035014500703178325  Gap =  0.08527482316591331 Sum =  0.9968359355872929
Iteration =  17  Dual obj =  -0.050189461716842694  Primal_obj =  0.025580671459742688  Gap =  0.07577013317658537 Sum =  0.9973930166209026
Iteration =  18  Dual obj =  -0.05012639699360978  Primal_obj =  0.015726397400440878  Gap =  0.06585279439405066 Sum =  0.9980272141650968
Iteration =  19  Dual obj =  -0.05007710293337707  Primal_obj =  0.005631726487413974  Gap =  0.05570882942079104 Sum =  0.9980803274885571
Iteration =  20  Dual obj =  -0.05003938751599362  Primal_obj =  -0.0037721807567343835  Gap =  0.04626720675925924 Sum =  0.9990654250442449
Iteration =  21  Dual obj =  -0.050007537512923486  Primal_obj =  -0.0074142607220589185  Gap =  0.04259327679086457 Sum =  1.0000425673078202
Iteration =  22  Dual obj =  -0.049982068133601176  Primal_obj =  -0.013231428745843432  Gap =  0.036750639387757744 Sum =  1.0007933023543327
Iteration =  23  Dual obj =  -0.04996447042736591  Primal_obj =  -0.01914510320917566  Gap =  0.03081936721819025 Sum =  1.001126053530223
Iteration =  24  Dual obj =  -0.049948140457214824  Primal_obj =  -0.02337456322281295  Gap =  0.026573577234401874 Sum =  1.0003594195701175
Iteration =  0  Dual obj =  -0.049948140457214824  Primal_obj =  -0.02337456322281295  Gap =  0.026573577234401874 Sum =  1.0003594195701175
Iteration =  1  Dual obj =  -0.049940101383819505  Primal_obj =  -0.027635090889554167  Gap =  0.022305010494265337 Sum =  1.0006751465402268
Iteration =  2  Dual obj =  -0.049931872111096426  Primal_obj =  -0.02823212943754108  Gap =  0.021699742673555344 Sum =  1.0000577225276954
Iteration =  3  Dual obj =  -0.04992282143225721  Primal_obj =  -0.030987141402106275  Gap =  0.018935680030150934 Sum =  0.9994389539188956
Iteration =  4  Dual obj =  -0.04991468835211603  Primal_obj =  -0.031056468075784216  Gap =  0.018858220276331814 Sum =  0.9986449156100012
Iteration =  5  Dual obj =  -0.0499059222613451  Primal_obj =  -0.032183986901719544  Gap =  0.017721935359625553 Sum =  0.9990620324945183
Iteration =  6  Dual obj =  -0.04989446466992967  Primal_obj =  -0.034877542776697135  Gap =  0.015016921893232532 Sum =  0.9998519446272243
Iteration =  7  Dual obj =  -0.049882831754649935  Primal_obj =  -0.03724127237070776  Gap =  0.012641559383942173 Sum =  1.0007444285029425
Iteration =  8  Dual obj =  -0.04987383484275883  Primal_obj =  -0.03932376802449064  Gap =  0.010550066818268186 Sum =  1.001346982691532
Iteration =  9  Dual obj =  -0.04986531167073634  Primal_obj =  -0.042061435339872916  Gap =  0.007803876330863421 Sum =  1.0010591463430991
Iteration =  10  Dual obj =  -0.04986002150539664  Primal_obj =  -0.04374187442977075  Gap =  0.006118147075625892 Sum =  1.0005899581488025
Iteration =  11  Dual obj =  -0.049856510600742254  Primal_obj =  -0.044555862468781474  Gap =  0.005300648131960781 Sum =  0.9998351550992748
Iteration =  12  Dual obj =  -0.0498538185091234  Primal_obj =  -0.045353652451622  Gap =  0.004500166057501399 Sum =  0.9995330089917125
Iteration =  13  Dual obj =  -0.04985136482396199  Primal_obj =  -0.045719663975890085  Gap =  0.004131700848071906 Sum =  0.9995288563057114
Iteration =  14  Dual obj =  -0.04984881371771484  Primal_obj =  -0.0459726807503974  Gap =  0.003876132967317439 Sum =  0.9998039443691783
Iteration =  15  Dual obj =  -0.049845643258200234  Primal_obj =  -0.046276674796733516  Gap =  0.0035689684614667178 Sum =  1.000286277214667
Iteration =  16  Dual obj =  -0.049842610041983225  Primal_obj =  -0.04636833331175248  Gap =  0.0034742767302307423 Sum =  1.0005175489818388
Iteration =  17  Dual obj =  -0.049840088383828376  Primal_obj =  -0.04652886779764458  Gap =  0.0033112205861837996 Sum =  1.0004911673026964
Iteration =  18  Dual obj =  -0.049837543487071805  Primal_obj =  -0.04703943342719838  Gap =  0.002798110059873425 Sum =  1.0002103313614685
Iteration =  19  Dual obj =  -0.04983542051120059  Primal_obj =  -0.047150515907038046  Gap =  0.0026849046041625413 Sum =  0.9999763300476914
Iteration =  20  Dual obj =  -0.04983316176976838  Primal_obj =  -0.04716174904416963  Gap =  0.0026714127255987527 Sum =  0.9995655492851403
Iteration =  21  Dual obj =  -0.049830881536984145  Primal_obj =  -0.0470576048916405  Gap =  0.0027732766453436447 Sum =  0.9993113374307863
Iteration =  22  Dual obj =  -0.04982861947248707  Primal_obj =  -0.047143029919493123  Gap =  0.0026855895529939444 Sum =  0.9995418005291863
Iteration =  23  Dual obj =  -0.049826744748232996  Primal_obj =  -0.047299895915526774  Gap =  0.0025268488327062216 Sum =  0.9998658800503077
Iteration =  24  Dual obj =  -0.049825197048752705  Primal_obj =  -0.047677991830305425  Gap =  0.0021472052184472804 Sum =  1.000124987696032
Iteration =  0  Dual obj =  -0.049825197048752705  Primal_obj =  -0.047677991830305425  Gap =  0.0021472052184472804 Sum =  1.000124987696032
Iteration =  1  Dual obj =  -0.04982447062462763  Primal_obj =  -0.047993110559785904  Gap =  0.0018313600648417264 Sum =  1.0000449434205327
Iteration =  2  Dual obj =  -0.04982390971442577  Primal_obj =  -0.04828274281423535  Gap =  0.0015411669001904188 Sum =  0.999932565338871
Iteration =  3  Dual obj =  -0.04982331155626344  Primal_obj =  -0.04849974706961227  Gap =  0.00132356448665117 Sum =  0.9998730525962998
Iteration =  4  Dual obj =  -0.049822811175934005  Primal_obj =  -0.0486288209414958  Gap =  0.001193990234438204 Sum =  0.9998582171879067
Iteration =  5  Dual obj =  -0.049822374985420165  Primal_obj =  -0.04871367291525526  Gap =  0.0011087020701649047 Sum =  0.9999411385294291
Iteration =  6  Dual obj =  -0.049822031187626806  Primal_obj =  -0.04875809925423304  Gap =  0.0010639319333937691 Sum =  0.9999463307631222
Iteration =  7  Dual obj =  -0.049821712928898254  Primal_obj =  -0.0488077426676726  Gap =  0.0010139702612256551 Sum =  1.0000001166861994
Iteration =  8  Dual obj =  -0.04982139128094381  Primal_obj =  -0.048821245062462215  Gap =  0.0010001462184815943 Sum =  0.9999941311445701
Iteration =  9  Dual obj =  -0.04982091882584441  Primal_obj =  -0.04881570101328907  Gap =  0.0010052178125553451 Sum =  0.9999360468311854
Iteration =  10  Dual obj =  -0.04982031635032176  Primal_obj =  -0.04877995035777466  Gap =  0.0010403659925471015 Sum =  0.9998552869931004
Iteration =  11  Dual obj =  -0.049819790028505354  Primal_obj =  -0.04879838101033035  Gap =  0.001021409018175004 Sum =  0.9997655378639191
Iteration =  12  Dual obj =  -0.049819152598329905  Primal_obj =  -0.04880495851412059  Gap =  0.0010141940842093161 Sum =  0.9997772575416459
Iteration =  13  Dual obj =  -0.04981849881726389  Primal_obj =  -0.04881168738687852  Gap =  0.0010068114303853695 Sum =  0.9997639801738155
Iteration =  14  Dual obj =  -0.04981787505154332  Primal_obj =  -0.04879408655396926  Gap =  0.001023788497574063 Sum =  0.9998616636672895
Iteration =  15  Dual obj =  -0.04981729574236908  Primal_obj =  -0.0487259994259588  Gap =  0.0010912963164102785 Sum =  0.9999196452661505
Iteration =  16  Dual obj =  -0.04981680603449784  Primal_obj =  -0.04875938366449084  Gap =  0.0010574223700069996 Sum =  0.9999298103782344
Iteration =  17  Dual obj =  -0.049816221310222016  Primal_obj =  -0.048725163222252774  Gap =  0.001091058087969242 Sum =  1.0000053362602699
Iteration =  18  Dual obj =  -0.0498157219193929  Primal_obj =  -0.04863484321468238  Gap =  0.0011808787047105224 Sum =  0.9999293843460191
Iteration =  19  Dual obj =  -0.04981530097269346  Primal_obj =  -0.04874633984513686  Gap =  0.0010689611275565974 Sum =  0.9998818765759363
Iteration =  20  Dual obj =  -0.04981480655196906  Primal_obj =  -0.0488971423129764  Gap =  0.0009176642389926576 Sum =  0.999836239612849
Iteration =  21  Dual obj =  -0.04981444467408962  Primal_obj =  -0.04899289106666406  Gap =  0.0008215536074255569 Sum =  0.9997979105934947
Iteration =  22  Dual obj =  -0.04981415977517935  Primal_obj =  -0.049061669312668185  Gap =  0.0007524904625111628 Sum =  0.9997997209996439
Iteration =  23  Dual obj =  -0.049813908902464524  Primal_obj =  -0.04914365178280371  Gap =  0.0006702571196608165 Sum =  0.9998985958442541
Iteration =  24  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  0  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  1  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  2  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  3  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  4  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  5  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  6  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  7  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  8  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  9  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  10  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  11  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  12  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  13  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  14  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  15  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  16  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  17  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  18  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  19  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  20  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  21  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  22  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  23  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Iteration =  24  Dual obj =  -0.049813678271421816  Primal_obj =  -0.049199074982276436  Gap =  0.0006146032891453795 Sum =  0.9999979123588846
Done, writing results...
