2021-04-29 12:30:37,273 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.05s.
2021-04-29 12:30:37,682 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.22s.
2021-04-29 12:30:38,066 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.38s.
2021-04-29 12:30:38,174 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-29 12:30:38,177 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:30:38,186 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:30:38,978 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 108.
2021-04-29 12:30:38,979 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.80s.
Iteration =  0  Dual obj =  -43.00110352332321  Primal_obj =  30482.626162216762  Gap =  30525.627265740084 Sum =  429.60280658230306
Iteration =  1  Dual obj =  -0.030574633502749405  Primal_obj =  14.520479362047475  Gap =  14.551053995550223 Sum =  0.7326990930409674
Iteration =  2  Dual obj =  0.012471468324918536  Primal_obj =  6.457145735235782  Gap =  6.444674266910863 Sum =  0.8439008288679851
Iteration =  3  Dual obj =  0.02643481825366878  Primal_obj =  3.478490555944634  Gap =  3.4520557376909653 Sum =  0.8281237506462699
Iteration =  4  Dual obj =  0.033167182780975336  Primal_obj =  1.4922782568028445  Gap =  1.4591110740218691 Sum =  0.9189539090461519
Iteration =  5  Dual obj =  0.03615776012220308  Primal_obj =  0.8623270522055159  Gap =  0.8261692920833128 Sum =  1.0049582384714415
Iteration =  6  Dual obj =  0.0370787577664959  Primal_obj =  0.3535386755207752  Gap =  0.31645991775427934 Sum =  0.9993849701398041
Iteration =  7  Dual obj =  0.03739196170862777  Primal_obj =  0.1985926607624389  Gap =  0.16120069905381113 Sum =  0.9928150891023619
Iteration =  8  Dual obj =  0.03751380148015909  Primal_obj =  0.12112725302997915  Gap =  0.08361345154982006 Sum =  0.9991270318346432
Iteration =  9  Dual obj =  0.03757176142803746  Primal_obj =  0.0886440366609139  Gap =  0.05107227523287644 Sum =  0.999434382452114
Iteration =  10  Dual obj =  0.037602976656492516  Primal_obj =  0.06805390172574599  Gap =  0.030450925069253475 Sum =  0.9990269628125447
Iteration =  11  Dual obj =  0.03761858222190019  Primal_obj =  0.05413680742490225  Gap =  0.016518225203002057 Sum =  1.0005331684187349
Iteration =  12  Dual obj =  0.037625851612697214  Primal_obj =  0.04641556643013345  Gap =  0.008789714817436234 Sum =  0.9997315831523459
Iteration =  13  Dual obj =  0.037629408628099374  Primal_obj =  0.0427919659415197  Gap =  0.005162557313420323 Sum =  0.9994519835168146
Iteration =  14  Dual obj =  0.037631517531125966  Primal_obj =  0.040921221557849746  Gap =  0.0032897040267237804 Sum =  0.9999714408134721
Iteration =  15  Dual obj =  0.03763284088655979  Primal_obj =  0.039859124241179725  Gap =  0.002226283354619933 Sum =  1.0000003291107098
Iteration =  16  Dual obj =  0.0376336762425065  Primal_obj =  0.03908734362667339  Gap =  0.0014536673841668915 Sum =  0.9998242302549485
Iteration =  17  Dual obj =  0.03763420194633898  Primal_obj =  0.038603868155845975  Gap =  0.0009696662095069961 Sum =  1.0000131403459422
Iteration =  18  Dual obj =  0.037634512823920496  Primal_obj =  0.03831533167864859  Gap =  0.0006808188547280936 Sum =  0.9999588886936915
Iteration =  19  Dual obj =  0.03763474392658142  Primal_obj =  0.03812356727890362  Gap =  0.0004888233523221985 Sum =  0.9998775834796154
Iteration =  20  Dual obj =  0.037634898919717955  Primal_obj =  0.038019869783617016  Gap =  0.00038497086389906177 Sum =  0.9999915231301837
Iteration =  21  Dual obj =  0.03763502918590894  Primal_obj =  0.03794678552048891  Gap =  0.0003117563345799712 Sum =  1.000002555325707
Iteration =  22  Dual obj =  0.03763513283818442  Primal_obj =  0.037897779085274794  Gap =  0.00026264624709037426 Sum =  0.999923739980588
Iteration =  23  Dual obj =  0.037635155728497446  Primal_obj =  0.03789415660555291  Gap =  0.00025900087705546526 Sum =  0.999940181321546
Iteration =  24  Dual obj =  0.03763517366773465  Primal_obj =  0.03788315544290133  Gap =  0.0002479817751666752 Sum =  0.9999463284954812
Iteration =  0  Dual obj =  -60.06162405660533  Primal_obj =  41607.373892078875  Gap =  41667.43551613548 Sum =  429.60280658230306
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.10416095786420454  Primal_obj =  11.0866340482489  Gap =  11.190795006113104 Sum =  0.4432951150857376
Iteration =  3  Dual obj =  -0.00624483020827328  Primal_obj =  15.262702981774016  Gap =  15.268947811982288 Sum =  0.904944672935622
Iteration =  4  Dual obj =  0.01910654671963352  Primal_obj =  10.048481639084866  Gap =  10.029375092365232 Sum =  0.776467693184297
Iteration =  5  Dual obj =  0.03199161902220518  Primal_obj =  5.261757737569097  Gap =  5.229766118546891 Sum =  0.8565782271989406
Iteration =  6  Dual obj =  0.0374821559350886  Primal_obj =  3.2673457961979806  Gap =  3.229863640262892 Sum =  0.8035209491007957
Iteration =  7  Dual obj =  0.04024409801951545  Primal_obj =  2.672780484914261  Gap =  2.6325363868947456 Sum =  0.8341069306753814
Iteration =  8  Dual obj =  0.04196803960467348  Primal_obj =  2.0359740663137  Gap =  1.9940060267090263 Sum =  0.8622238989974351
Iteration =  9  Dual obj =  0.043432516212146235  Primal_obj =  1.9616614185159582  Gap =  1.918228902303812 Sum =  0.9033465440551349
Iteration =  10  Dual obj =  0.04471891289498404  Primal_obj =  1.4176703546040725  Gap =  1.3729514417090884 Sum =  0.9394924184636556
Iteration =  11  Dual obj =  0.04565075349554597  Primal_obj =  1.1476362732920729  Gap =  1.101985519796527 Sum =  0.9677775017434549
Iteration =  12  Dual obj =  0.04636453469917105  Primal_obj =  0.8719303639285361  Gap =  0.8255658292293651 Sum =  0.9780698957771762
Iteration =  13  Dual obj =  0.04673437888269186  Primal_obj =  0.7067813498010042  Gap =  0.6600469709183123 Sum =  0.9658180566126824
Iteration =  14  Dual obj =  0.047043855087634  Primal_obj =  0.6213240128640668  Gap =  0.5742801577764328 Sum =  0.9739290582206093
Iteration =  15  Dual obj =  0.047265798757906465  Primal_obj =  0.6042277017708301  Gap =  0.5569619030129236 Sum =  0.9781377693059139
Iteration =  16  Dual obj =  0.047445854622168146  Primal_obj =  0.5076515645970302  Gap =  0.46020570997486204 Sum =  0.9764986548572868
Iteration =  17  Dual obj =  0.04755297933651442  Primal_obj =  0.4553315213537178  Gap =  0.40777854201720337 Sum =  0.9801733120346885
Iteration =  18  Dual obj =  0.047655035981235536  Primal_obj =  0.40629684228625945  Gap =  0.3586418063050239 Sum =  0.9938433590960849
Iteration =  19  Dual obj =  0.04772711046803951  Primal_obj =  0.3746598490421999  Gap =  0.3269327385741604 Sum =  0.9945441024290533
Iteration =  20  Dual obj =  0.0477919952903257  Primal_obj =  0.33813888085888577  Gap =  0.2903468855685601 Sum =  1.0009957171127626
Iteration =  21  Dual obj =  0.04783290801633952  Primal_obj =  0.30984655940200434  Gap =  0.2620136513856648 Sum =  1.0069532372921979
Iteration =  22  Dual obj =  0.047870458991918836  Primal_obj =  0.2776393380035255  Gap =  0.2297688790116067 Sum =  1.0049871981989682
Iteration =  23  Dual obj =  0.04789727025213405  Primal_obj =  0.25382833834343166  Gap =  0.2059310680912976 Sum =  1.0048547840626214
Iteration =  24  Dual obj =  0.04792008911328194  Primal_obj =  0.24112515776378135  Gap =  0.1932050686504994 Sum =  1.0053499940117934
Iteration =  0  Dual obj =  0.04792008911328194  Primal_obj =  0.24112515776378135  Gap =  0.1932050686504994 Sum =  1.0053499940117934
Iteration =  1  Dual obj =  0.047929187571653625  Primal_obj =  0.22982254394199955  Gap =  0.18189335637034593 Sum =  1.0040080211517461
Iteration =  2  Dual obj =  0.04793987891221377  Primal_obj =  0.22204476686690122  Gap =  0.17410488795468745 Sum =  1.001754778668443
Iteration =  3  Dual obj =  0.04795051599970977  Primal_obj =  0.2129793299938432  Gap =  0.16502881399413344 Sum =  1.000181866284554
Iteration =  4  Dual obj =  0.04796566335137336  Primal_obj =  0.20361302866302997  Gap =  0.1556473653116566 Sum =  0.9985569259760413
Iteration =  5  Dual obj =  0.04798536428195973  Primal_obj =  0.1912141910750183  Gap =  0.14322882679305857 Sum =  0.9966768079876864
Iteration =  6  Dual obj =  0.04800529028173103  Primal_obj =  0.18164892456057757  Gap =  0.13364363427884654 Sum =  0.9952977534790772
Iteration =  7  Dual obj =  0.048021697332100585  Primal_obj =  0.18636499215986646  Gap =  0.13834329482776586 Sum =  0.9944228706464915
Iteration =  8  Dual obj =  0.04803509426917469  Primal_obj =  0.17481725818488175  Gap =  0.12678216391570707 Sum =  0.9955875330911415
Iteration =  9  Dual obj =  0.04804761908444037  Primal_obj =  0.16108021732160732  Gap =  0.11303259823716695 Sum =  0.9967320887870543
Iteration =  10  Dual obj =  0.04805849632851755  Primal_obj =  0.15234532888229796  Gap =  0.1042868325537804 Sum =  0.9978666714182323
Iteration =  11  Dual obj =  0.04806971720207334  Primal_obj =  0.14443540361532808  Gap =  0.09636568641325474 Sum =  0.9986246495420859
Iteration =  12  Dual obj =  0.048079974049587755  Primal_obj =  0.13904859614069556  Gap =  0.09096862209110781 Sum =  0.9991549586536237
Iteration =  13  Dual obj =  0.04808988062312017  Primal_obj =  0.1364202215661357  Gap =  0.08833034094301553 Sum =  1.0006602164403755
Iteration =  14  Dual obj =  0.04809730766448786  Primal_obj =  0.12989518756554488  Gap =  0.08179787990105702 Sum =  0.9990311175583053
Iteration =  15  Dual obj =  0.048103386965363384  Primal_obj =  0.12508536672888182  Gap =  0.07698197976351843 Sum =  0.9986523705015996
Iteration =  16  Dual obj =  0.048108430077114316  Primal_obj =  0.12214097518275487  Gap =  0.07403254510564056 Sum =  0.9983740148021687
Iteration =  17  Dual obj =  0.04811458154041991  Primal_obj =  0.11707504746334461  Gap =  0.06896046592292471 Sum =  0.9976902658826446
Iteration =  18  Dual obj =  0.048119621330312556  Primal_obj =  0.11587050014271567  Gap =  0.06775087881240312 Sum =  0.9988817409821388
Iteration =  19  Dual obj =  0.04812451615054024  Primal_obj =  0.10871481846116182  Gap =  0.06059030231062158 Sum =  1.0002476372839189
Iteration =  20  Dual obj =  0.048128500246625315  Primal_obj =  0.1045019366205998  Gap =  0.05637343637397448 Sum =  1.001653943266352
Iteration =  21  Dual obj =  0.04813202844318963  Primal_obj =  0.10216794959097927  Gap =  0.05403592114778964 Sum =  1.0019062507422987
Iteration =  22  Dual obj =  0.04813515903043141  Primal_obj =  0.09883458979465151  Gap =  0.0506994307642201 Sum =  1.0028176457133746
Iteration =  23  Dual obj =  0.04813821419568402  Primal_obj =  0.09485800825340335  Gap =  0.046719794057719324 Sum =  1.0023910438109473
Iteration =  24  Dual obj =  0.04814119492514199  Primal_obj =  0.09192627991848822  Gap =  0.04378508499334623 Sum =  1.0025272157473126
Iteration =  0  Dual obj =  0.04814119492514199  Primal_obj =  0.09192627991848822  Gap =  0.04378508499334623 Sum =  1.0025272157473126
Iteration =  1  Dual obj =  0.04814258672410711  Primal_obj =  0.08932716219672154  Gap =  0.041184575472614435 Sum =  1.0024306152189488
Iteration =  2  Dual obj =  0.0481440537722508  Primal_obj =  0.08542756838800841  Gap =  0.037283514615757615 Sum =  1.0018941508621555
Iteration =  3  Dual obj =  0.04814562614634371  Primal_obj =  0.08171175349210574  Gap =  0.03356612734576203 Sum =  1.0011517906787544
Iteration =  4  Dual obj =  0.04814789449211954  Primal_obj =  0.07852205894881215  Gap =  0.030374164456692603 Sum =  1.0003353058946343
Iteration =  5  Dual obj =  0.048149816744955144  Primal_obj =  0.07681622542013564  Gap =  0.028666408675180492 Sum =  0.9989610163282947
Iteration =  6  Dual obj =  0.04815089882620385  Primal_obj =  0.07403857781483583  Gap =  0.02588767898863198 Sum =  0.9983111815954935
Iteration =  7  Dual obj =  0.04815184023265462  Primal_obj =  0.07266023636896113  Gap =  0.02450839613630651 Sum =  0.9982911840646025
Iteration =  8  Dual obj =  0.048153109896975445  Primal_obj =  0.07199176017246381  Gap =  0.023838650275488364 Sum =  0.9987877858276717
Iteration =  9  Dual obj =  0.04815416689022614  Primal_obj =  0.07204523366480928  Gap =  0.023891066774583136 Sum =  0.9994433675731798
Iteration =  10  Dual obj =  0.04815500436231053  Primal_obj =  0.07182189228135885  Gap =  0.02366688791904832 Sum =  1.0001723751761034
Iteration =  11  Dual obj =  0.04815582335979254  Primal_obj =  0.07179357449499763  Gap =  0.023637751135205082 Sum =  1.0005030079029524
Iteration =  12  Dual obj =  0.04815686230597101  Primal_obj =  0.07154557537224437  Gap =  0.023388713066273367 Sum =  1.0005928369060724
Iteration =  13  Dual obj =  0.04815863809486183  Primal_obj =  0.07123389067969188  Gap =  0.02307525258483005 Sum =  0.9999910579548572
Iteration =  14  Dual obj =  0.048159920092055344  Primal_obj =  0.07124899957432781  Gap =  0.02308907948227247 Sum =  0.9992728232203467
Iteration =  15  Dual obj =  0.048161294718603136  Primal_obj =  0.06991107131768165  Gap =  0.021749776599078514 Sum =  0.9988671530836843
Iteration =  16  Dual obj =  0.048162642935480726  Primal_obj =  0.06874423555821807  Gap =  0.020581592622737344 Sum =  0.99868236726802
Iteration =  17  Dual obj =  0.048163721115316666  Primal_obj =  0.0689770733727402  Gap =  0.020813352257423534 Sum =  0.9981261698430502
Iteration =  18  Dual obj =  0.04816526579246587  Primal_obj =  0.0689693338729904  Gap =  0.020804068080524526 Sum =  0.9983599374676496
Iteration =  19  Dual obj =  0.048167432426456845  Primal_obj =  0.06735828708435482  Gap =  0.019190854657897972 Sum =  0.9994047263873778
Iteration =  20  Dual obj =  0.048168619635850014  Primal_obj =  0.06502674302156113  Gap =  0.01685812338571111 Sum =  1.0000565347010957
Iteration =  21  Dual obj =  0.04816978681869816  Primal_obj =  0.0639157030761999  Gap =  0.01574591625750174 Sum =  1.0008806369728416
Iteration =  22  Dual obj =  0.048170440491905046  Primal_obj =  0.06347478018782318  Gap =  0.015304339695918136 Sum =  1.0014906245590347
Iteration =  23  Dual obj =  0.04817130623438516  Primal_obj =  0.06240663550227102  Gap =  0.014235329267885857 Sum =  1.0016194486058194
Iteration =  24  Dual obj =  0.04817234387612267  Primal_obj =  0.060917151566972375  Gap =  0.012744807690849708 Sum =  1.0012257978998171
Iteration =  0  Dual obj =  0.04817234387612267  Primal_obj =  0.060917151566972375  Gap =  0.012744807690849708 Sum =  1.0012257978998171
Iteration =  1  Dual obj =  0.048172971124704346  Primal_obj =  0.06039828981393758  Gap =  0.012225318689233232 Sum =  1.0011126882612484
Iteration =  2  Dual obj =  0.04817343572578579  Primal_obj =  0.05979221572340537  Gap =  0.01161877999761958 Sum =  1.0006733989071406
Iteration =  3  Dual obj =  0.048173872883005134  Primal_obj =  0.058953944619891785  Gap =  0.010780071736886651 Sum =  1.000145592622507
Iteration =  4  Dual obj =  0.048174215221168104  Primal_obj =  0.05846351772104555  Gap =  0.010289302499877445 Sum =  0.9998624656860186
Iteration =  5  Dual obj =  0.048174509623868406  Primal_obj =  0.05801377443804112  Gap =  0.009839264814172716 Sum =  0.9995156941345212
Iteration =  6  Dual obj =  0.04817481515892155  Primal_obj =  0.05748928540763655  Gap =  0.009314470248714998 Sum =  0.99922948673035
Iteration =  7  Dual obj =  0.048175128681284186  Primal_obj =  0.05709063679322762  Gap =  0.008915508111943436 Sum =  0.9992302084915989
Iteration =  8  Dual obj =  0.04817567870982608  Primal_obj =  0.05662186156778312  Gap =  0.008446182857957042 Sum =  0.9994682155148191
Iteration =  9  Dual obj =  0.04817629614778192  Primal_obj =  0.05615094629662003  Gap =  0.007974650148838108 Sum =  0.999785387422552
Iteration =  10  Dual obj =  0.04817667373989934  Primal_obj =  0.05573538603090546  Gap =  0.007558712291006117 Sum =  1.0001526152828397
Iteration =  11  Dual obj =  0.048177062258019356  Primal_obj =  0.055396038964318925  Gap =  0.007218976706299569 Sum =  1.0003345088794027
Iteration =  12  Dual obj =  0.04817734637518051  Primal_obj =  0.05514916352141351  Gap =  0.006971817146233003 Sum =  1.0002595730831305
Iteration =  13  Dual obj =  0.04817771761397573  Primal_obj =  0.05491843137234141  Gap =  0.006740713758365678 Sum =  1.0003040481112544
Iteration =  14  Dual obj =  0.04817808058121267  Primal_obj =  0.05472825649495676  Gap =  0.006550175913744086 Sum =  1.0001996454998225
Iteration =  15  Dual obj =  0.04817840302881099  Primal_obj =  0.054488803424722745  Gap =  0.0063104003959117555 Sum =  0.9997742188445344
Iteration =  16  Dual obj =  0.048178656380826676  Primal_obj =  0.05429117831033328  Gap =  0.006112521929506606 Sum =  0.9996725010811891
Iteration =  17  Dual obj =  0.04817906624554677  Primal_obj =  0.05424322521418172  Gap =  0.00606415896863495 Sum =  0.9994952621741102
Iteration =  18  Dual obj =  0.04817937643783064  Primal_obj =  0.05420911501242495  Gap =  0.006029738574594309 Sum =  0.999415999880936
Iteration =  19  Dual obj =  0.04817980511428688  Primal_obj =  0.05405236854189201  Gap =  0.005872563427605129 Sum =  0.9995905291328571
Iteration =  20  Dual obj =  0.04818034568263973  Primal_obj =  0.05397652937395678  Gap =  0.005796183691317049 Sum =  1.0001143493231046
Iteration =  21  Dual obj =  0.048180940337556974  Primal_obj =  0.053851245153440266  Gap =  0.0056703048158832925 Sum =  1.0002203234876457
Iteration =  22  Dual obj =  0.04818131127368471  Primal_obj =  0.05382981117216856  Gap =  0.005648499898483851 Sum =  1.0002287882559049
Iteration =  23  Dual obj =  0.0481816012164399  Primal_obj =  0.05364454220638218  Gap =  0.00546294098994228 Sum =  1.0003324773879527
Iteration =  24  Dual obj =  0.048181839360114116  Primal_obj =  0.05356649248613815  Gap =  0.005384653126024035 Sum =  1.0002486250005753
Done, writing results...
