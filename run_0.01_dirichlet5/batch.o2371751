2021-04-29 12:30:55,950 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.10s.
2021-04-29 12:30:56,350 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.21s.
2021-04-29 12:30:56,734 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.38s.
2021-04-29 12:30:56,849 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-29 12:30:56,852 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:30:56,862 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:30:57,655 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 102.
2021-04-29 12:30:57,656 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.81s.
Iteration =  0  Dual obj =  -57.60817054373847  Primal_obj =  49613.14419256596  Gap =  49670.7523631097 Sum =  398.87125545511134
Iteration =  1  Dual obj =  -0.04416122923553527  Primal_obj =  21.638981064444106  Gap =  21.68314229367964 Sum =  1.060283310128305
Iteration =  2  Dual obj =  -0.00395957314886667  Primal_obj =  6.233305183148907  Gap =  6.237264756297774 Sum =  0.7967101805507085
Iteration =  3  Dual obj =  0.007168846935272234  Primal_obj =  3.13462454235314  Gap =  3.1274556954178676 Sum =  0.8567367285746231
Iteration =  4  Dual obj =  0.012125191478780278  Primal_obj =  1.655041670390586  Gap =  1.6429164789118056 Sum =  0.9429815572143139
Iteration =  5  Dual obj =  0.014256884876979826  Primal_obj =  0.7003444562516998  Gap =  0.68608757137472 Sum =  1.0022263230975228
Iteration =  6  Dual obj =  0.014933055047457938  Primal_obj =  0.3951956350104664  Gap =  0.38026257996300844 Sum =  0.9954918823954494
Iteration =  7  Dual obj =  0.015223955708467699  Primal_obj =  0.2260195881793245  Gap =  0.2107956324708568 Sum =  0.9939033244706258
Iteration =  8  Dual obj =  0.015362495589844538  Primal_obj =  0.12858745599119079  Gap =  0.11322496040134625 Sum =  1.0015133641354743
Iteration =  9  Dual obj =  0.015430620920708134  Primal_obj =  0.08056765616196544  Gap =  0.0651370352412573 Sum =  1.001168992385892
Iteration =  10  Dual obj =  0.015463245977130802  Primal_obj =  0.04833943690247146  Gap =  0.03287619092534066 Sum =  0.9991436371963651
Iteration =  11  Dual obj =  0.01547724608440531  Primal_obj =  0.03122831941475783  Gap =  0.01575107333035252 Sum =  1.000735434913027
Iteration =  12  Dual obj =  0.015484314184518583  Primal_obj =  0.02360130566793238  Gap =  0.008116991483413796 Sum =  0.9997125812636685
Iteration =  13  Dual obj =  0.015487684710232286  Primal_obj =  0.02044167488103292  Gap =  0.004953990170800634 Sum =  0.9994676400459641
Iteration =  14  Dual obj =  0.015489682718485765  Primal_obj =  0.018475317255091134  Gap =  0.0029856345366053687 Sum =  1.0000081220776258
Iteration =  15  Dual obj =  0.015490777137953016  Primal_obj =  0.01746696450197499  Gap =  0.001976187364021975 Sum =  0.9999121279126566
Iteration =  16  Dual obj =  0.015491425239834124  Primal_obj =  0.016918891857926485  Gap =  0.0014274666180923608 Sum =  0.999771072592829
Iteration =  17  Dual obj =  0.015491879772352229  Primal_obj =  0.016549832454969438  Gap =  0.0010579526826172084 Sum =  0.9998970604961999
Iteration =  18  Dual obj =  0.015492212035335485  Primal_obj =  0.016329323053512076  Gap =  0.0008371110181765919 Sum =  1.0000484909414218
Iteration =  19  Dual obj =  0.015492468737321715  Primal_obj =  0.016187806763354046  Gap =  0.000695338026032331 Sum =  0.9998813637430737
Iteration =  20  Dual obj =  0.015492685327553468  Primal_obj =  0.016082145121891586  Gap =  0.0005894597943381184 Sum =  0.9997951471415626
Iteration =  21  Dual obj =  0.015492856494965075  Primal_obj =  0.01601062156399516  Gap =  0.0005177650690300836 Sum =  1.0000348778491783
Iteration =  22  Dual obj =  0.015492958191471114  Primal_obj =  0.015960459543065617  Gap =  0.00046750135159450215 Sum =  0.9999259270997565
Iteration =  23  Dual obj =  0.01549308060648151  Primal_obj =  0.015902407139034083  Gap =  0.000409326532552573 Sum =  0.9998892787088696
Iteration =  24  Dual obj =  0.015493184972279049  Primal_obj =  0.015847027215186493  Gap =  0.0003538422429074442 Sum =  1.0000009112193493
Iteration =  0  Dual obj =  -55.193922786795454  Primal_obj =  52676.260825838006  Gap =  52731.454748624805 Sum =  398.87125545511134
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.3916302694355752  Primal_obj =  340.6732287282016  Gap =  341.06485899763715 Sum =  6.868731855360684
Iteration =  4  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  5  Dual obj =  -0.1680206276601139  Primal_obj =  67.15306750594158  Gap =  67.32108813360169 Sum =  2.115411763134111
Iteration =  6  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.062500
Iteration =  7  Dual obj =  -0.1164965473506259  Primal_obj =  13.058407402127274  Gap =  13.174903949477901 Sum =  0.3661751966420272
Iteration =  8  Dual obj =  -0.07793101633851764  Primal_obj =  44.79544396025261  Gap =  44.87337497659113 Sum =  1.0390832590172119
Iteration =  9  Dual obj =  -0.06318012569949119  Primal_obj =  23.604474273188167  Gap =  23.66765439888766 Sum =  0.8793315108495398
Iteration =  10  Dual obj =  -0.04169392399131987  Primal_obj =  21.96308264045101  Gap =  22.00477656444233 Sum =  0.881693358951783
Iteration =  11  Dual obj =  -0.03395231350031766  Primal_obj =  19.26146245653237  Gap =  19.29541477003269 Sum =  0.8830798770186918
Iteration =  12  Dual obj =  -0.026465521429976935  Primal_obj =  17.450329536723988  Gap =  17.476795058153964 Sum =  0.9542909411616222
Iteration =  13  Dual obj =  -0.019723289916869495  Primal_obj =  14.281965013292252  Gap =  14.301688303209122 Sum =  0.7103271375142164
Iteration =  14  Dual obj =  -0.01405858687497804  Primal_obj =  13.570575862664187  Gap =  13.584634449539164 Sum =  0.8098507990866612
Iteration =  15  Dual obj =  -0.007135462182929833  Primal_obj =  11.841623468374223  Gap =  11.848758930557153 Sum =  0.9075964540664979
Iteration =  16  Dual obj =  -0.0053613687197401685  Primal_obj =  11.64818055840485  Gap =  11.65354192712459 Sum =  0.8596092653322289
Iteration =  17  Dual obj =  -0.0003495975589620018  Primal_obj =  8.957079591900378  Gap =  8.95742918945934 Sum =  0.7659584179715324
Iteration =  18  Dual obj =  0.0034457506362498974  Primal_obj =  8.57159906614175  Gap =  8.568153315505501 Sum =  0.8784976447575024
Iteration =  19  Dual obj =  0.00592136225887261  Primal_obj =  8.13539944977156  Gap =  8.129478087512688 Sum =  0.8551168335609407
Iteration =  20  Dual obj =  0.010006691023764114  Primal_obj =  7.08930540230619  Gap =  7.0792987112824255 Sum =  0.8212039653007734
Iteration =  21  Dual obj =  0.011418021463298192  Primal_obj =  5.870491208738319  Gap =  5.859073187275021 Sum =  0.827339494609463
Iteration =  22  Dual obj =  0.013894488721863364  Primal_obj =  5.690262446496471  Gap =  5.676367957774607 Sum =  0.8154993074044793
Iteration =  23  Dual obj =  0.015428643741946732  Primal_obj =  4.607181804377061  Gap =  4.591753160635114 Sum =  0.8432027608456256
Iteration =  24  Dual obj =  0.01662942626532872  Primal_obj =  4.171037246004662  Gap =  4.154407819739333 Sum =  0.8213222361531036
Iteration =  0  Dual obj =  0.01662942626532872  Primal_obj =  4.171037246004662  Gap =  4.154407819739333 Sum =  0.8213222361531036
Iteration =  1  Dual obj =  0.017799623843992488  Primal_obj =  3.429496268427789  Gap =  3.4116966445837966 Sum =  0.8285150229828258
Iteration =  2  Dual obj =  0.01896819146696957  Primal_obj =  3.003734943565304  Gap =  2.9847667520983343 Sum =  0.8404086257845795
Iteration =  3  Dual obj =  0.020181149192464776  Primal_obj =  2.6188194597589725  Gap =  2.598638310566508 Sum =  0.8646238565737246
Iteration =  4  Dual obj =  0.02116749817519104  Primal_obj =  2.425908753277581  Gap =  2.40474125510239 Sum =  0.869927326478863
Iteration =  5  Dual obj =  0.022324037032070934  Primal_obj =  2.312948330435342  Gap =  2.2906242934032712 Sum =  0.90233632522769
Iteration =  6  Dual obj =  0.023032914113486336  Primal_obj =  2.1539510235565054  Gap =  2.130918109443019 Sum =  0.912882104790466
Iteration =  7  Dual obj =  0.023822550714517547  Primal_obj =  1.6483078886925326  Gap =  1.624485337978015 Sum =  0.9500892980826443
Iteration =  8  Dual obj =  0.024271784048794275  Primal_obj =  1.406344739830964  Gap =  1.3820729557821698 Sum =  0.9570992654171042
Iteration =  9  Dual obj =  0.024798187179548733  Primal_obj =  1.204291957842525  Gap =  1.1794937706629764 Sum =  0.9915471108951789
Iteration =  10  Dual obj =  0.025305689902396004  Primal_obj =  0.9553378611800222  Gap =  0.9300321712776262 Sum =  0.9846054628363522
Iteration =  11  Dual obj =  0.025679207731475674  Primal_obj =  0.813213422181952  Gap =  0.7875342144504763 Sum =  0.9863686332863975
Iteration =  12  Dual obj =  0.02598627086995315  Primal_obj =  0.7259853381554886  Gap =  0.6999990672855354 Sum =  0.9852863023073873
Iteration =  13  Dual obj =  0.026228319846238735  Primal_obj =  0.5931399281245107  Gap =  0.5669116082782719 Sum =  0.9777975627881409
Iteration =  14  Dual obj =  0.026394291928221396  Primal_obj =  0.4754886648669925  Gap =  0.4490943729387711 Sum =  0.9765959074030754
Iteration =  15  Dual obj =  0.026527508801893217  Primal_obj =  0.4264683370407979  Gap =  0.3999408282389047 Sum =  0.9871570688572084
Iteration =  16  Dual obj =  0.026640805795802042  Primal_obj =  0.37652518384589223  Gap =  0.3498843780500902 Sum =  0.988832338058224
Iteration =  17  Dual obj =  0.02673100404156091  Primal_obj =  0.36599776011034346  Gap =  0.33926675606878254 Sum =  0.9920031662059325
Iteration =  18  Dual obj =  0.026831968294525936  Primal_obj =  0.3179790817530853  Gap =  0.29114711345855937 Sum =  0.9876461668803143
Iteration =  19  Dual obj =  0.02690269652909156  Primal_obj =  0.2987828608923101  Gap =  0.27188016436321855 Sum =  0.9867964749368318
Iteration =  20  Dual obj =  0.02696768043251049  Primal_obj =  0.2569823513151128  Gap =  0.23001467088260233 Sum =  0.9908621133207718
Iteration =  21  Dual obj =  0.027014535646936226  Primal_obj =  0.2273012402790143  Gap =  0.20028670463207807 Sum =  0.9970708164861152
Iteration =  22  Dual obj =  0.027058060155231847  Primal_obj =  0.21030590124402931  Gap =  0.18324784108879746 Sum =  1.0018031700991292
Iteration =  23  Dual obj =  0.027098574162890923  Primal_obj =  0.19977333828939356  Gap =  0.17267476412650262 Sum =  0.9986318926570238
Iteration =  24  Dual obj =  0.027134413287396957  Primal_obj =  0.20391191816005372  Gap =  0.17677750487265675 Sum =  1.0011238651761607
Iteration =  0  Dual obj =  0.027134413287396957  Primal_obj =  0.20391191816005372  Gap =  0.17677750487265675 Sum =  1.0011238651761607
Iteration =  1  Dual obj =  0.0271524247006506  Primal_obj =  0.17562504023534428  Gap =  0.14847261553469368 Sum =  1.0007025964150873
Iteration =  2  Dual obj =  0.027168610595611268  Primal_obj =  0.15240126041919133  Gap =  0.12523264982358007 Sum =  0.9998456198124447
Iteration =  3  Dual obj =  0.02718128213330723  Primal_obj =  0.14358263299159915  Gap =  0.11640135085829192 Sum =  0.9983217784960348
Iteration =  4  Dual obj =  0.02719699916363596  Primal_obj =  0.13770880683893486  Gap =  0.11051180767529889 Sum =  0.9964630943397512
Iteration =  5  Dual obj =  0.02721454406984724  Primal_obj =  0.14104209822405392  Gap =  0.11382755415420667 Sum =  0.9948951949499447
Iteration =  6  Dual obj =  0.02724033638011208  Primal_obj =  0.137311086078091  Gap =  0.11007074969797892 Sum =  0.9973788258715324
Iteration =  7  Dual obj =  0.02726425171958539  Primal_obj =  0.13737665951450403  Gap =  0.11011240779491864 Sum =  0.9976332466117975
Iteration =  8  Dual obj =  0.02728539707866627  Primal_obj =  0.12723977686330726  Gap =  0.09995437978464099 Sum =  0.9976676241879505
Iteration =  9  Dual obj =  0.027302885986899478  Primal_obj =  0.12057484258255281  Gap =  0.09327195659565334 Sum =  0.9980590610905866
Iteration =  10  Dual obj =  0.027319695177265756  Primal_obj =  0.10296411073095774  Gap =  0.07564441555369197 Sum =  1.0004022670518566
Iteration =  11  Dual obj =  0.027332392295402047  Primal_obj =  0.09339315076978022  Gap =  0.06606075847437817 Sum =  1.0025529178002075
Iteration =  12  Dual obj =  0.027343145633139547  Primal_obj =  0.07817061024781274  Gap =  0.0508274646146732 Sum =  1.0028045312255622
Iteration =  13  Dual obj =  0.027351053797768532  Primal_obj =  0.06636776937925887  Gap =  0.039016715581490335 Sum =  1.0010250441192732
Iteration =  14  Dual obj =  0.027356176142849596  Primal_obj =  0.06051349167103692  Gap =  0.03315731552818733 Sum =  0.9992854154849505
Iteration =  15  Dual obj =  0.02736010848770275  Primal_obj =  0.05629357302558344  Gap =  0.028933464537880687 Sum =  0.9989889017929188
Iteration =  16  Dual obj =  0.027363246397601397  Primal_obj =  0.053944451279333824  Gap =  0.026581204881732427 Sum =  0.9991408067839673
Iteration =  17  Dual obj =  0.027365998314909927  Primal_obj =  0.05228436054474739  Gap =  0.02491836222983746 Sum =  0.9992971959253573
Iteration =  18  Dual obj =  0.027369329326136616  Primal_obj =  0.050032896997735166  Gap =  0.02266356767159855 Sum =  1.0000009037251056
Iteration =  19  Dual obj =  0.027373089087346775  Primal_obj =  0.0475681344260801  Gap =  0.020195045338733324 Sum =  1.0002087915235853
Iteration =  20  Dual obj =  0.027375850698080795  Primal_obj =  0.045957524154108656  Gap =  0.01858167345602786 Sum =  1.0003366928911412
Iteration =  21  Dual obj =  0.02737861857938679  Primal_obj =  0.045008594477261174  Gap =  0.017629975897874385 Sum =  1.0010054716307686
Iteration =  22  Dual obj =  0.027381142158502868  Primal_obj =  0.04396905529443375  Gap =  0.01658791313593088 Sum =  1.0006325388622828
Iteration =  23  Dual obj =  0.027383791898941277  Primal_obj =  0.04327020913276752  Gap =  0.015886417233826246 Sum =  1.0004304844768497
Iteration =  24  Dual obj =  0.027386339283349482  Primal_obj =  0.04279774764316567  Gap =  0.015411408359816189 Sum =  0.9997640931623393
Iteration =  0  Dual obj =  0.027386339283349482  Primal_obj =  0.04279774764316567  Gap =  0.015411408359816189 Sum =  0.9997640931623393
Iteration =  1  Dual obj =  0.02738746237990343  Primal_obj =  0.041166573730169534  Gap =  0.013779111350266104 Sum =  0.9996408031731862
Iteration =  2  Dual obj =  0.027388745260904457  Primal_obj =  0.039183946832143754  Gap =  0.011795201571239297 Sum =  0.9995296152929605
Iteration =  3  Dual obj =  0.027389819807432  Primal_obj =  0.03794293246178605  Gap =  0.010553112654354053 Sum =  0.9994781640953163
Iteration =  4  Dual obj =  0.027390722906598122  Primal_obj =  0.03726987449912733  Gap =  0.009879151592529209 Sum =  0.9996236938380766
Iteration =  5  Dual obj =  0.027391522742948447  Primal_obj =  0.036897472692689864  Gap =  0.009505949949741417 Sum =  1.0000027903873674
Iteration =  6  Dual obj =  0.027392269653260234  Primal_obj =  0.03676909135107709  Gap =  0.009376821697816853 Sum =  1.0001290521345139
Iteration =  7  Dual obj =  0.02739331610962893  Primal_obj =  0.03679629385464708  Gap =  0.009402977745018155 Sum =  1.0003416188473775
Iteration =  8  Dual obj =  0.027394296317950956  Primal_obj =  0.036815921099134036  Gap =  0.00942162478118308 Sum =  0.999942776482794
Iteration =  9  Dual obj =  0.027395347598036197  Primal_obj =  0.0370777404464538  Gap =  0.009682392848417605 Sum =  1.0001232029983123
Iteration =  10  Dual obj =  0.027396318832662747  Primal_obj =  0.037143230304735445  Gap =  0.009746911472072697 Sum =  1.000357515433819
Iteration =  11  Dual obj =  0.02739749962964673  Primal_obj =  0.03700168569439137  Gap =  0.009604186064744641 Sum =  1.000278384059452
Iteration =  12  Dual obj =  0.02739865909334136  Primal_obj =  0.03653968796557833  Gap =  0.009141028872236966 Sum =  1.0001688596825367
Iteration =  13  Dual obj =  0.027400032409332902  Primal_obj =  0.03606526742701406  Gap =  0.008665235017681159 Sum =  0.9997992382016171
Iteration =  14  Dual obj =  0.02740119475473729  Primal_obj =  0.035957833697906144  Gap =  0.008556638943168854 Sum =  0.9996926203572067
Iteration =  15  Dual obj =  0.02740226796310232  Primal_obj =  0.03557183345004633  Gap =  0.00816956548694401 Sum =  1.0000829180542652
Iteration =  16  Dual obj =  0.02740312327874965  Primal_obj =  0.03488393059223001  Gap =  0.007480807313480359 Sum =  1.0001235795918817
Iteration =  17  Dual obj =  0.02740401696967574  Primal_obj =  0.034382925329922  Gap =  0.006978908360246262 Sum =  1.0002922858697434
Iteration =  18  Dual obj =  0.027404914589274125  Primal_obj =  0.03371240499517773  Gap =  0.006307490405903608 Sum =  1.0001073234879958
Iteration =  19  Dual obj =  0.027405610037948405  Primal_obj =  0.03317537777425679  Gap =  0.005769767736308384 Sum =  1.0001586371098798
Iteration =  20  Dual obj =  0.027406236097551332  Primal_obj =  0.032743000873764055  Gap =  0.005336764776212723 Sum =  1.0003581295596224
Iteration =  21  Dual obj =  0.027406769111594443  Primal_obj =  0.032384540463676184  Gap =  0.004977771352081741 Sum =  1.0001480776965228
Iteration =  22  Dual obj =  0.027407250360481746  Primal_obj =  0.032107065281981303  Gap =  0.004699814921499557 Sum =  0.9999604660771667
Iteration =  23  Dual obj =  0.027407726555637932  Primal_obj =  0.03201534155863983  Gap =  0.0046076150030019 Sum =  0.9999187165573866
Iteration =  24  Dual obj =  0.027408138576259622  Primal_obj =  0.03201027665841201  Gap =  0.004602138082152388 Sum =  0.9999865126612373
Done, writing results...
