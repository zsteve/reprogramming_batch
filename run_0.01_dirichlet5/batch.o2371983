2021-04-29 13:11:06,057 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.07s.
2021-04-29 13:11:06,472 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.22s.
2021-04-29 13:11:06,871 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 13:11:06,987 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-29 13:11:06,990 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 13:11:06,999 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 13:11:07,793 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 112.
2021-04-29 13:11:07,794 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.81s.
Iteration =  0  Dual obj =  -47.39972486383655  Primal_obj =  72590.86133732907  Gap =  72638.2610621929 Sum =  585.0702661990595
Iteration =  1  Dual obj =  -0.03816725322554128  Primal_obj =  36.286274881359  Gap =  36.32444213458454 Sum =  0.9662802335999203
Iteration =  2  Dual obj =  0.0035295206127011133  Primal_obj =  16.661663903009035  Gap =  16.658134382396334 Sum =  0.9676764269805173
Iteration =  3  Dual obj =  0.01855028629200129  Primal_obj =  10.709477738055526  Gap =  10.690927451763525 Sum =  0.833391134288974
Iteration =  4  Dual obj =  0.02805623629146982  Primal_obj =  5.526665785971478  Gap =  5.498609549680007 Sum =  0.8962240770901448
Iteration =  5  Dual obj =  0.03356308454201965  Primal_obj =  2.146641370645927  Gap =  2.1130782861039075 Sum =  0.9674347627355748
Iteration =  6  Dual obj =  0.035609568805387015  Primal_obj =  0.7732878086827742  Gap =  0.7376782398773872 Sum =  1.006044800350834
Iteration =  7  Dual obj =  0.03618635252741916  Primal_obj =  0.2938592172869137  Gap =  0.2576728647594946 Sum =  1.0044515971015908
Iteration =  8  Dual obj =  0.036364948681791666  Primal_obj =  0.1527747139414617  Gap =  0.11640976525967003 Sum =  0.9978143975236763
Iteration =  9  Dual obj =  0.03642703432054095  Primal_obj =  0.08509302195097024  Gap =  0.048665987630429286 Sum =  0.999094872073673
Iteration =  10  Dual obj =  0.03645005258196764  Primal_obj =  0.05894480887220954  Gap =  0.022494756290241905 Sum =  1.0001827638843819
Iteration =  11  Dual obj =  0.03645934725557524  Primal_obj =  0.04905637533121436  Gap =  0.012597028075639123 Sum =  0.999616939789858
Iteration =  12  Dual obj =  0.03646421208022733  Primal_obj =  0.04502051770757878  Gap =  0.008556305627351456 Sum =  0.9998582309753632
Iteration =  13  Dual obj =  0.036467263607034256  Primal_obj =  0.043085788152143645  Gap =  0.006618524545109389 Sum =  0.9995351725660876
Iteration =  14  Dual obj =  0.0364695197508957  Primal_obj =  0.04149802470581139  Gap =  0.005028504954915691 Sum =  0.9996609072973712
Iteration =  15  Dual obj =  0.03647103805319031  Primal_obj =  0.040353369872240724  Gap =  0.0038823318190504136 Sum =  0.9998219710873744
Iteration =  16  Dual obj =  0.036472163515866206  Primal_obj =  0.03950323434592497  Gap =  0.0030310708300587616 Sum =  0.9998437542346437
Iteration =  17  Dual obj =  0.03647296760650327  Primal_obj =  0.03883933082220703  Gap =  0.0023663632157037567 Sum =  0.999776935130378
Iteration =  18  Dual obj =  0.036473547550676055  Primal_obj =  0.03835508041316102  Gap =  0.0018815328624849637 Sum =  0.999944201603806
Iteration =  19  Dual obj =  0.036473978942864346  Primal_obj =  0.03799824156790234  Gap =  0.001524262625037992 Sum =  0.9998942280189134
Iteration =  20  Dual obj =  0.036474309630089574  Primal_obj =  0.03773417057702991  Gap =  0.0012598609469403332 Sum =  0.9999260964420082
Iteration =  21  Dual obj =  0.036474566009707644  Primal_obj =  0.03749548367665126  Gap =  0.0010209176669436146 Sum =  0.9999113215573739
Iteration =  22  Dual obj =  0.03647476504073317  Primal_obj =  0.03734169698890101  Gap =  0.0008669319481678373 Sum =  0.9999429089944272
Iteration =  23  Dual obj =  0.03647495287452018  Primal_obj =  0.03717365244133709  Gap =  0.0006986995668169099 Sum =  0.9999522834182923
Iteration =  24  Dual obj =  0.036475099299097556  Primal_obj =  0.037057241823876944  Gap =  0.0005821425247793874 Sum =  0.99994470367699
Iteration =  0  Dual obj =  -48.97277332658483  Primal_obj =  61023.41291819757  Gap =  61072.385691524156 Sum =  585.0702661990595
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.14048766791377215  Primal_obj =  50.55780218232268  Gap =  50.698289850236456 Sum =  0.9140268744110456
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  -0.039326649980753754  Primal_obj =  37.78455485352667  Gap =  37.82388150350742 Sum =  0.8809828020202619
Iteration =  5  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  6  Dual obj =  -0.022269382888889546  Primal_obj =  31.1082163295134  Gap =  31.13048571240229 Sum =  0.896008803511064
Iteration =  7  Dual obj =  -0.009159249403521169  Primal_obj =  27.418609434324157  Gap =  27.427768683727678 Sum =  0.8256740123421786
Iteration =  8  Dual obj =  -0.0003713190790003637  Primal_obj =  22.949714203145465  Gap =  22.950085522224466 Sum =  0.8251438138252356
Iteration =  9  Dual obj =  0.0158248771456845  Primal_obj =  19.562954361725087  Gap =  19.5471294845794 Sum =  0.8499700216948639
Iteration =  10  Dual obj =  0.025691687360280588  Primal_obj =  15.427824020578514  Gap =  15.402132333218233 Sum =  0.8512408593014904
Iteration =  11  Dual obj =  0.03188199475805662  Primal_obj =  11.749413848509914  Gap =  11.717531853751858 Sum =  0.8375385345432698
Iteration =  12  Dual obj =  0.03594514535323606  Primal_obj =  8.700510836661586  Gap =  8.664565691308349 Sum =  0.838896547527073
Iteration =  13  Dual obj =  0.0385561105960686  Primal_obj =  7.2472180530236034  Gap =  7.208661942427534 Sum =  0.8480563642282251
Iteration =  14  Dual obj =  0.041553060121479427  Primal_obj =  5.766756322569864  Gap =  5.725203262448384 Sum =  0.8629516433723152
Iteration =  15  Dual obj =  0.04370443828433705  Primal_obj =  4.552085355672873  Gap =  4.5083809173885365 Sum =  0.8776614802457297
Iteration =  16  Dual obj =  0.04549058878684013  Primal_obj =  3.6208762432949415  Gap =  3.5753856545081013 Sum =  0.8950138400339415
Iteration =  17  Dual obj =  0.04708494968348545  Primal_obj =  3.0047756671204673  Gap =  2.9576907174369818 Sum =  0.9243532744050708
Iteration =  18  Dual obj =  0.048260865334707824  Primal_obj =  2.1953197596252862  Gap =  2.1470588942905784 Sum =  0.9510786107119613
Iteration =  19  Dual obj =  0.04901680355584319  Primal_obj =  1.640893375253242  Gap =  1.5918765716973988 Sum =  0.951555051423662
Iteration =  20  Dual obj =  0.049431470991114224  Primal_obj =  1.409726156107346  Gap =  1.3602946851162319 Sum =  0.9467289946775466
Iteration =  21  Dual obj =  0.04978876665098141  Primal_obj =  1.289241252515915  Gap =  1.2394524858649336 Sum =  0.954062580118963
Iteration =  22  Dual obj =  0.05014768575996027  Primal_obj =  1.180601136876578  Gap =  1.1304534511166178 Sum =  0.9636989396002675
Iteration =  23  Dual obj =  0.05039971787561246  Primal_obj =  1.0142881755619984  Gap =  0.9638884576863859 Sum =  0.9706544188534264
Iteration =  24  Dual obj =  0.05067771458606889  Primal_obj =  0.8964607071775934  Gap =  0.8457829925915246 Sum =  0.9938894894231837
Iteration =  0  Dual obj =  0.05067771458606889  Primal_obj =  0.8964607071775934  Gap =  0.8457829925915246 Sum =  0.9938894894231837
Iteration =  1  Dual obj =  0.050801779685068355  Primal_obj =  0.7159250796024147  Gap =  0.6651232999173463 Sum =  0.9871915942145619
Iteration =  2  Dual obj =  0.050900885413921126  Primal_obj =  0.6638781881233984  Gap =  0.6129773027094773 Sum =  0.9883360658328885
Iteration =  3  Dual obj =  0.05104115046454382  Primal_obj =  0.5808255659479058  Gap =  0.529784415483362 Sum =  0.9943777237688338
Iteration =  4  Dual obj =  0.051155561908236044  Primal_obj =  0.47204815177967585  Gap =  0.4208925898714398 Sum =  0.9994624540296113
Iteration =  5  Dual obj =  0.05126177396241683  Primal_obj =  0.4122558454279623  Gap =  0.36099407146554546 Sum =  0.9993233608324888
Iteration =  6  Dual obj =  0.0513548216328622  Primal_obj =  0.3461930496614075  Gap =  0.2948382280285453 Sum =  1.0035860935491325
Iteration =  7  Dual obj =  0.05143199922424036  Primal_obj =  0.3029844517149204  Gap =  0.25155245249068003 Sum =  1.0055988099734816
Iteration =  8  Dual obj =  0.05149497991663271  Primal_obj =  0.2220533187789058  Gap =  0.1705583388622731 Sum =  1.0031535057847263
Iteration =  9  Dual obj =  0.05153059439810491  Primal_obj =  0.17163438259148817  Gap =  0.12010378819338326 Sum =  1.003374854760085
Iteration =  10  Dual obj =  0.05155778810877757  Primal_obj =  0.13517959842297955  Gap =  0.08362181031420199 Sum =  1.0016954617204241
Iteration =  11  Dual obj =  0.05157280986557376  Primal_obj =  0.11899036451388015  Gap =  0.06741755464830639 Sum =  1.0000051772443825
Iteration =  12  Dual obj =  0.05158661725888186  Primal_obj =  0.10598003197513256  Gap =  0.0543934147162507 Sum =  0.9982506265309523
Iteration =  13  Dual obj =  0.05159939201526465  Primal_obj =  0.09871131316819365  Gap =  0.047111921152929 Sum =  0.9977118578431838
Iteration =  14  Dual obj =  0.051610002916486375  Primal_obj =  0.09508699713752637  Gap =  0.04347699422104 Sum =  0.997627537263589
Iteration =  15  Dual obj =  0.051620017800782736  Primal_obj =  0.09047925635168903  Gap =  0.0388592385509063 Sum =  0.9982613430110415
Iteration =  16  Dual obj =  0.05162919994470931  Primal_obj =  0.08807009027686935  Gap =  0.03644089033216004 Sum =  0.9990905825763702
Iteration =  17  Dual obj =  0.05163636796125903  Primal_obj =  0.08783229329030068  Gap =  0.036195925329041645 Sum =  1.0006415783688167
Iteration =  18  Dual obj =  0.051643018461005843  Primal_obj =  0.08448728564628977  Gap =  0.032844267185283924 Sum =  1.000775578506367
Iteration =  19  Dual obj =  0.051648522975779335  Primal_obj =  0.08507576883101102  Gap =  0.033427245855231685 Sum =  1.0013180289388153
Iteration =  20  Dual obj =  0.051653242103282745  Primal_obj =  0.08118084791154973  Gap =  0.02952760580826698 Sum =  1.0012738725266332
Iteration =  21  Dual obj =  0.05165769212139128  Primal_obj =  0.07655838945905148  Gap =  0.024900697337660205 Sum =  1.0004890759105665
Iteration =  22  Dual obj =  0.05166186262958032  Primal_obj =  0.0729735569430973  Gap =  0.021311694313516982 Sum =  1.0000359943226622
Iteration =  23  Dual obj =  0.05166473765590289  Primal_obj =  0.07124903315487292  Gap =  0.019584295498970034 Sum =  0.9993769437922944
Iteration =  24  Dual obj =  0.05166755757769735  Primal_obj =  0.06956223847264068  Gap =  0.017894680894943324 Sum =  0.9989622974717122
Iteration =  0  Dual obj =  0.05166755757769735  Primal_obj =  0.06956223847264068  Gap =  0.017894680894943324 Sum =  0.9989622974717122
Iteration =  1  Dual obj =  0.05166900157282036  Primal_obj =  0.06792565711137542  Gap =  0.016256655538555063 Sum =  0.9991323057968386
Iteration =  2  Dual obj =  0.051670098516086935  Primal_obj =  0.06673222740971604  Gap =  0.01506212889362911 Sum =  0.9993942269973695
Iteration =  3  Dual obj =  0.051671546508593826  Primal_obj =  0.06553079345624209  Gap =  0.013859246947648264 Sum =  0.9999069407730462
Iteration =  4  Dual obj =  0.05167303642937346  Primal_obj =  0.0647120648643652  Gap =  0.013039028434991745 Sum =  1.0003123805990306
Iteration =  5  Dual obj =  0.05167408676533068  Primal_obj =  0.06487108707853814  Gap =  0.01319700031320746 Sum =  1.0006946164161856
Iteration =  6  Dual obj =  0.0516752661882354  Primal_obj =  0.06524027791439473  Gap =  0.013565011726159329 Sum =  1.0008082976142296
Iteration =  7  Dual obj =  0.051676690378491916  Primal_obj =  0.06652102389612521  Gap =  0.014844333517633299 Sum =  1.0009417373763527
Iteration =  8  Dual obj =  0.05167805470927371  Primal_obj =  0.06581434909284187  Gap =  0.014136294383568157 Sum =  1.0005694483401992
Iteration =  9  Dual obj =  0.051679826666651094  Primal_obj =  0.06401246145799934  Gap =  0.012332634791348246 Sum =  1.0001852597215677
Iteration =  10  Dual obj =  0.0516810438615327  Primal_obj =  0.06317551498384469  Gap =  0.011494471122311986 Sum =  0.9999368279342864
Iteration =  11  Dual obj =  0.05168226332819795  Primal_obj =  0.062412961175017656  Gap =  0.010730697846819709 Sum =  0.9996100862596161
Iteration =  12  Dual obj =  0.051683261201467066  Primal_obj =  0.0622285742636665  Gap =  0.010545313062199434 Sum =  0.9994266321346246
Iteration =  13  Dual obj =  0.05168450611750573  Primal_obj =  0.06191658957481479  Gap =  0.010232083457309055 Sum =  0.9994906839103873
Iteration =  14  Dual obj =  0.051685549260887816  Primal_obj =  0.0617418616691838  Gap =  0.010056312408295985 Sum =  0.999635698868727
Iteration =  15  Dual obj =  0.051686799989456265  Primal_obj =  0.061320324650068356  Gap =  0.00963352466061209 Sum =  0.9997029520706591
Iteration =  16  Dual obj =  0.051688136456101555  Primal_obj =  0.06087801948180266  Gap =  0.009189883025701104 Sum =  1.0000333790071798
Iteration =  17  Dual obj =  0.05168924407054234  Primal_obj =  0.060692292492267874  Gap =  0.009003048421725536 Sum =  1.0000847586387047
Iteration =  18  Dual obj =  0.051690400313603946  Primal_obj =  0.06065127589780462  Gap =  0.008960875584200674 Sum =  0.9999985452467544
Iteration =  19  Dual obj =  0.05169158208259231  Primal_obj =  0.060807307371959204  Gap =  0.009115725289366897 Sum =  0.9999995400828683
Iteration =  20  Dual obj =  0.05169259901448084  Primal_obj =  0.0608806344023989  Gap =  0.009188035387918063 Sum =  1.000022654925995
Iteration =  21  Dual obj =  0.05169344213438704  Primal_obj =  0.061298027062176436  Gap =  0.009604584927789393 Sum =  0.9999028396372673
Iteration =  22  Dual obj =  0.05169419377723136  Primal_obj =  0.060758881084486946  Gap =  0.009064687307255584 Sum =  0.9999205314581829
Iteration =  23  Dual obj =  0.05169502331617515  Primal_obj =  0.059608454395616614  Gap =  0.007913431079441466 Sum =  0.9999845156856626
Iteration =  24  Dual obj =  0.051696081539312114  Primal_obj =  0.05824062938738539  Gap =  0.006544547848073276 Sum =  0.9999216023484561
Iteration =  0  Dual obj =  0.051696081539312114  Primal_obj =  0.05824062938738539  Gap =  0.006544547848073276 Sum =  0.9999216023484561
Iteration =  1  Dual obj =  0.05169649059958062  Primal_obj =  0.05768277675582406  Gap =  0.005986286156243442 Sum =  0.9999714647787759
Iteration =  2  Dual obj =  0.05169677449387291  Primal_obj =  0.05718149610303496  Gap =  0.005484721609162052 Sum =  0.9999650356917753
Iteration =  3  Dual obj =  0.051696960673839734  Primal_obj =  0.056854222370446406  Gap =  0.0051572616966066714 Sum =  0.9999921581525177
Iteration =  4  Dual obj =  0.051697283375217964  Primal_obj =  0.05627784278518466  Gap =  0.004580559409966697 Sum =  1.0001286344194515
Iteration =  5  Dual obj =  0.05169761063651784  Primal_obj =  0.05585767899433968  Gap =  0.0041600683578218375 Sum =  1.0000973706139493
Iteration =  6  Dual obj =  0.051697837798025593  Primal_obj =  0.05567622282564777  Gap =  0.003978385027622176 Sum =  1.0000743440219022
Iteration =  7  Dual obj =  0.05169807328428247  Primal_obj =  0.0554676377929236  Gap =  0.0037695645086411322 Sum =  0.9999575707611076
Iteration =  8  Dual obj =  0.05169829126718476  Primal_obj =  0.05533471343653694  Gap =  0.0036364221693521784 Sum =  0.999889982378377
Iteration =  9  Dual obj =  0.0516984981729805  Primal_obj =  0.05523958647426359  Gap =  0.0035410883012830865 Sum =  0.999846170850871
Iteration =  10  Dual obj =  0.05169879111172988  Primal_obj =  0.055244085737231684  Gap =  0.0035452946255018006 Sum =  0.9998450172960925
Iteration =  11  Dual obj =  0.05169903238820846  Primal_obj =  0.05532276790395506  Gap =  0.003623735515746601 Sum =  0.9998108044174039
Iteration =  12  Dual obj =  0.05169935416006427  Primal_obj =  0.05522665289316568  Gap =  0.003527298733101411 Sum =  0.9999202566784345
Iteration =  13  Dual obj =  0.051699673016259426  Primal_obj =  0.055079918609651925  Gap =  0.003380245593392499 Sum =  0.9999278439077672
Iteration =  14  Dual obj =  0.05169994754674065  Primal_obj =  0.05502637480767074  Gap =  0.00332642726093009 Sum =  0.9999582056334639
Iteration =  15  Dual obj =  0.0517002196329584  Primal_obj =  0.05508604000093834  Gap =  0.003385820367979943 Sum =  1.0001321728919432
Iteration =  16  Dual obj =  0.05170051776911209  Primal_obj =  0.05522133597220885  Gap =  0.0035208182030967636 Sum =  1.000178435588784
Iteration =  17  Dual obj =  0.051700804356305294  Primal_obj =  0.05517200352776292  Gap =  0.003471199171457627 Sum =  1.000163542100662
Iteration =  18  Dual obj =  0.051701149461851656  Primal_obj =  0.05518054456571985  Gap =  0.003479395103868195 Sum =  1.0001255646133909
Iteration =  19  Dual obj =  0.051701503618741235  Primal_obj =  0.05514646760260621  Gap =  0.003444963983864978 Sum =  1.0001784717073625
Iteration =  20  Dual obj =  0.051701813915902006  Primal_obj =  0.05507890771735849  Gap =  0.003377093801456482 Sum =  1.0001483412341492
Iteration =  21  Dual obj =  0.051702045330288424  Primal_obj =  0.05487333072337672  Gap =  0.003171285393088294 Sum =  1.0000060055144107
Iteration =  22  Dual obj =  0.051702371262930626  Primal_obj =  0.05472080814578981  Gap =  0.003018436882859181 Sum =  0.9999063100296975
Iteration =  23  Dual obj =  0.051702700387266064  Primal_obj =  0.0545990780873768  Gap =  0.002896377700110739 Sum =  0.9998056686464025
Iteration =  24  Dual obj =  0.05170294313795747  Primal_obj =  0.054545247283215643  Gap =  0.0028423041452581704 Sum =  0.9997748568178255
Done, writing results...
