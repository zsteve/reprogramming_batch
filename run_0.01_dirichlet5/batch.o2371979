2021-04-29 13:04:03,100 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.20s.
2021-04-29 13:04:03,512 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.22s.
2021-04-29 13:04:03,909 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 13:04:04,027 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-29 13:04:04,030 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 13:04:04,041 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 13:04:04,860 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 122.
2021-04-29 13:04:04,862 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.83s.
Iteration =  0  Dual obj =  -60.558534199469236  Primal_obj =  92965.14300824971  Gap =  93025.70154244918 Sum =  329.3312693949075
Iteration =  1  Dual obj =  -0.052811119781092826  Primal_obj =  23.532870361078093  Gap =  23.585681480859186 Sum =  0.8639368392497824
Iteration =  2  Dual obj =  -0.009375139739312241  Primal_obj =  10.172059669236077  Gap =  10.18143480897539 Sum =  0.8385608024779767
Iteration =  3  Dual obj =  0.00285029287216014  Primal_obj =  6.106053209823838  Gap =  6.103202916951678 Sum =  0.8218360015959421
Iteration =  4  Dual obj =  0.009859895781632252  Primal_obj =  3.1752149047120297  Gap =  3.1653550089303977 Sum =  0.9189007460339845
Iteration =  5  Dual obj =  0.013450872186582506  Primal_obj =  0.6616366296797109  Gap =  0.6481857574931285 Sum =  1.0089425387011681
Iteration =  6  Dual obj =  0.014177035017594753  Primal_obj =  0.1876816068787513  Gap =  0.17350457186115653 Sum =  0.996038528002846
Iteration =  7  Dual obj =  0.014360317706545143  Primal_obj =  0.07451862999889335  Gap =  0.06015831229234821 Sum =  0.9961459114536082
Iteration =  8  Dual obj =  0.014403822596608062  Primal_obj =  0.040408216795493  Gap =  0.02600439419888494 Sum =  1.0008356869139572
Iteration =  9  Dual obj =  0.014419113122815054  Primal_obj =  0.026576651274952276  Gap =  0.012157538152137222 Sum =  1.0000183998387726
Iteration =  10  Dual obj =  0.014425518615728529  Primal_obj =  0.021348388127831214  Gap =  0.006922869512102685 Sum =  0.9991681303133535
Iteration =  11  Dual obj =  0.014428634968593167  Primal_obj =  0.019076110525132334  Gap =  0.004647475556539167 Sum =  0.9996629025494523
Iteration =  12  Dual obj =  0.014430484400368159  Primal_obj =  0.01788909217291612  Gap =  0.003458607772547962 Sum =  0.9999368282984546
Iteration =  13  Dual obj =  0.014431870996260608  Primal_obj =  0.017001244027153334  Gap =  0.0025693730308927257 Sum =  0.9996083692493787
Iteration =  14  Dual obj =  0.014432912975785656  Primal_obj =  0.016387129048514068  Gap =  0.0019542160727284118 Sum =  0.999648329831655
Iteration =  15  Dual obj =  0.01443356663778017  Primal_obj =  0.015996703376461252  Gap =  0.0015631367386810813 Sum =  0.9999424487901925
Iteration =  16  Dual obj =  0.014434087159039693  Primal_obj =  0.015688580319953058  Gap =  0.0012544931609133649 Sum =  1.0000066521415172
Iteration =  17  Dual obj =  0.014434488414760034  Primal_obj =  0.015433697055491441  Gap =  0.0009992086407314069 Sum =  0.9997551755372044
Iteration =  18  Dual obj =  0.014434792652746224  Primal_obj =  0.015262122654873672  Gap =  0.0008273300021274486 Sum =  0.9999258141576888
Iteration =  19  Dual obj =  0.014435028630323237  Primal_obj =  0.015112564703148632  Gap =  0.0006775360728253944 Sum =  1.000008398817792
Iteration =  20  Dual obj =  0.014435231020590689  Primal_obj =  0.015001936800350515  Gap =  0.0005667057797598268 Sum =  0.9999112835760291
Iteration =  21  Dual obj =  0.014435388577966612  Primal_obj =  0.014914819791574385  Gap =  0.00047943121360777274 Sum =  0.9999037214815495
Iteration =  22  Dual obj =  0.014435529256739077  Primal_obj =  0.01484894428749789  Gap =  0.0004134150307588125 Sum =  1.0000164576187254
Iteration =  23  Dual obj =  0.014435646844601566  Primal_obj =  0.014793256477481392  Gap =  0.0003576096328798267 Sum =  0.9999805649173257
Iteration =  24  Dual obj =  0.014435749905969606  Primal_obj =  0.01474774875779894  Gap =  0.0003119988518293336 Sum =  0.9999553087355421
Iteration =  0  Dual obj =  -70.33853726696063  Primal_obj =  84257.42730968694  Gap =  84327.7658469539 Sum =  329.3312693949075
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.7407597291523668  Primal_obj =  1054.7967263612704  Gap =  1055.5374860904228 Sum =  25.899777174303964
Iteration =  4  Dual obj =  -0.1607277058412045  Primal_obj =  40.04593001209193  Gap =  40.20665771793313 Sum =  1.3790642694444242
Iteration =  5  Dual obj =  -0.11141620196337122  Primal_obj =  36.85459838327775  Gap =  36.96601458524112 Sum =  0.6519086411903758
Iteration =  6  Dual obj =  -0.07557831021131617  Primal_obj =  34.58097131610559  Gap =  34.6565496263169 Sum =  0.7754847949446547
Iteration =  7  Dual obj =  -0.058862746446619874  Primal_obj =  27.941458273955345  Gap =  28.000321020401966 Sum =  0.7604341180321863
Iteration =  8  Dual obj =  -0.035595548746619535  Primal_obj =  22.905197891637748  Gap =  22.94079344038437 Sum =  0.8348189399914775
Iteration =  9  Dual obj =  -0.021150377032959453  Primal_obj =  19.501487720913897  Gap =  19.522638097946857 Sum =  0.6617110677347178
Iteration =  10  Dual obj =  -0.006706355566801908  Primal_obj =  19.384507586189617  Gap =  19.39121394175642 Sum =  0.8541158131911295
Iteration =  11  Dual obj =  0.005089282652829742  Primal_obj =  15.23714316027587  Gap =  15.232053877623041 Sum =  0.8548205845979673
Iteration =  12  Dual obj =  0.011293322725178731  Primal_obj =  9.348794571528137  Gap =  9.337501248802958 Sum =  0.8288681992101448
Iteration =  13  Dual obj =  0.015779105743830353  Primal_obj =  6.129153432190884  Gap =  6.113374326447053 Sum =  0.8360585979312998
Iteration =  14  Dual obj =  0.018214141068215214  Primal_obj =  4.8810729237478245  Gap =  4.862858782679609 Sum =  0.8467449831478379
Iteration =  15  Dual obj =  0.020169537984092933  Primal_obj =  4.145969386094895  Gap =  4.125799848110802 Sum =  0.8731247368984584
Iteration =  16  Dual obj =  0.02168757932359494  Primal_obj =  3.2688193350305053  Gap =  3.2471317557069104 Sum =  0.8860493149983943
Iteration =  17  Dual obj =  0.022824714654992792  Primal_obj =  2.27349158176619  Gap =  2.250666867111197 Sum =  0.914468880998939
Iteration =  18  Dual obj =  0.023755233596689285  Primal_obj =  1.9514319266944882  Gap =  1.9276766930977989 Sum =  0.9513901525874076
Iteration =  19  Dual obj =  0.024563753495579776  Primal_obj =  1.2265585173564473  Gap =  1.2019947638608675 Sum =  0.9534326409450978
Iteration =  20  Dual obj =  0.02505014994601703  Primal_obj =  0.9279773283581159  Gap =  0.9029271784120988 Sum =  0.9658906243477035
Iteration =  21  Dual obj =  0.02538439000398052  Primal_obj =  0.7304721658772247  Gap =  0.7050877758732442 Sum =  0.9708410014570137
Iteration =  22  Dual obj =  0.02563323792671207  Primal_obj =  0.5930304435086766  Gap =  0.5673972055819645 Sum =  0.9763991821584468
Iteration =  23  Dual obj =  0.025836942435131814  Primal_obj =  0.45603538662049353  Gap =  0.43019844418536174 Sum =  0.978983581979658
Iteration =  24  Dual obj =  0.025991283560602863  Primal_obj =  0.34206996654602595  Gap =  0.3160786829854231 Sum =  0.9811171332778077
Iteration =  0  Dual obj =  0.025991283560602863  Primal_obj =  0.34206996654602595  Gap =  0.3160786829854231 Sum =  0.9811171332778077
Iteration =  1  Dual obj =  0.026066087983432802  Primal_obj =  0.2706100462499593  Gap =  0.24454395826652653 Sum =  0.9786893482779555
Iteration =  2  Dual obj =  0.026135285931183888  Primal_obj =  0.22579600405968442  Gap =  0.19966071812850053 Sum =  0.978019036673963
Iteration =  3  Dual obj =  0.02620090367494626  Primal_obj =  0.18484206108287327  Gap =  0.158641157407927 Sum =  0.9796426109553484
Iteration =  4  Dual obj =  0.026253288961511856  Primal_obj =  0.1650351405339187  Gap =  0.13878185157240686 Sum =  0.9816724690151637
Iteration =  5  Dual obj =  0.026311098210015604  Primal_obj =  0.1490410831653442  Gap =  0.1227299849553286 Sum =  0.9873384176145568
Iteration =  6  Dual obj =  0.026366761708385436  Primal_obj =  0.139926606267411  Gap =  0.11355984455902556 Sum =  0.9888284032692187
Iteration =  7  Dual obj =  0.02641825492337526  Primal_obj =  0.14445790282648358  Gap =  0.11803964790310831 Sum =  0.9965704537914302
Iteration =  8  Dual obj =  0.026451528817315058  Primal_obj =  0.13800318184767324  Gap =  0.11155165303035819 Sum =  1.0023104933181306
Iteration =  9  Dual obj =  0.02648140605452562  Primal_obj =  0.12702095774837552  Gap =  0.1005395516938499 Sum =  1.0049888873543544
Iteration =  10  Dual obj =  0.02650516937088486  Primal_obj =  0.11734229902197583  Gap =  0.09083712965109098 Sum =  1.0061773694229221
Iteration =  11  Dual obj =  0.026524515406156454  Primal_obj =  0.10963049778912126  Gap =  0.08310598238296481 Sum =  1.0045139628924884
Iteration =  12  Dual obj =  0.026542497956765915  Primal_obj =  0.10432529173545614  Gap =  0.07778279377869023 Sum =  1.0036372679951326
Iteration =  13  Dual obj =  0.0265588758651754  Primal_obj =  0.09474601038682927  Gap =  0.06818713452165387 Sum =  1.0025873295344083
Iteration =  14  Dual obj =  0.02657174522988046  Primal_obj =  0.08640548338395714  Gap =  0.05983373815407668 Sum =  1.0014743913354502
Iteration =  15  Dual obj =  0.026582550616208313  Primal_obj =  0.0794618875389994  Gap =  0.05287933692279108 Sum =  0.9993938587167714
Iteration =  16  Dual obj =  0.026594363273315557  Primal_obj =  0.0747341076735375  Gap =  0.04813974440022194 Sum =  0.999159358234917
Iteration =  17  Dual obj =  0.026604052920036647  Primal_obj =  0.07271924497026616  Gap =  0.046115192050229514 Sum =  0.9988325528230197
Iteration =  18  Dual obj =  0.026612510819465876  Primal_obj =  0.06730876672961664  Gap =  0.04069625591015076 Sum =  0.9984020107562912
Iteration =  19  Dual obj =  0.026620208914692783  Primal_obj =  0.06357295996223092  Gap =  0.03695275104753813 Sum =  0.9992562494021193
Iteration =  20  Dual obj =  0.02662646378159122  Primal_obj =  0.06242707116382887  Gap =  0.03580060738223765 Sum =  0.9989116529438002
Iteration =  21  Dual obj =  0.02663228826254735  Primal_obj =  0.06009320483383311  Gap =  0.03346091657128576 Sum =  0.9995988423271794
Iteration =  22  Dual obj =  0.026637669209452874  Primal_obj =  0.055885142317836395  Gap =  0.02924747310838352 Sum =  0.9993231795240545
Iteration =  23  Dual obj =  0.026641957861072513  Primal_obj =  0.053652725008958846  Gap =  0.027010767147886333 Sum =  0.9999051009611584
Iteration =  24  Dual obj =  0.026645470528578068  Primal_obj =  0.05103183648894827  Gap =  0.0243863659603702 Sum =  0.9996774193742259
Iteration =  0  Dual obj =  0.026645470528578068  Primal_obj =  0.05103183648894827  Gap =  0.0243863659603702 Sum =  0.9996774193742259
Iteration =  1  Dual obj =  0.026646754643859093  Primal_obj =  0.049720549749176585  Gap =  0.023073795105317492 Sum =  0.9997001603592928
Iteration =  2  Dual obj =  0.026648053766218593  Primal_obj =  0.04842025767000331  Gap =  0.021772203903784718 Sum =  0.9996491540740832
Iteration =  3  Dual obj =  0.026649198087115526  Primal_obj =  0.04734389513263085  Gap =  0.020694697045515322 Sum =  0.9993695486577537
Iteration =  4  Dual obj =  0.026650414771175378  Primal_obj =  0.046350522467162314  Gap =  0.019700107695986936 Sum =  0.9994783907234754
Iteration =  5  Dual obj =  0.026652116953516925  Primal_obj =  0.04538629799341953  Gap =  0.018734181039902608 Sum =  0.9991837135750542
Iteration =  6  Dual obj =  0.02665396214247597  Primal_obj =  0.04466605593248621  Gap =  0.01801209379001024 Sum =  0.9997016460930195
Iteration =  7  Dual obj =  0.026655385826942605  Primal_obj =  0.04443112571479345  Gap =  0.017775739887850844 Sum =  0.9995863826623146
Iteration =  8  Dual obj =  0.026657130480491287  Primal_obj =  0.04392451273638667  Gap =  0.017267382255895386 Sum =  1.00019193596783
Iteration =  9  Dual obj =  0.026659097819833645  Primal_obj =  0.0437747037634833  Gap =  0.017115605943649657 Sum =  1.0003282979942474
Iteration =  10  Dual obj =  0.02666091628774167  Primal_obj =  0.043782201212253874  Gap =  0.017121284924512203 Sum =  1.001142496710981
Iteration =  11  Dual obj =  0.026662449750273473  Primal_obj =  0.04361519723140381  Gap =  0.016952747481130334 Sum =  1.00141491676007
Iteration =  12  Dual obj =  0.026664031559925465  Primal_obj =  0.043749062876137806  Gap =  0.01708503131621234 Sum =  1.0021128743314087
Iteration =  13  Dual obj =  0.0266656457582083  Primal_obj =  0.04344336339410042  Gap =  0.016777717635892118 Sum =  1.001208391056712
Iteration =  14  Dual obj =  0.02666735405551497  Primal_obj =  0.042663677407094064  Gap =  0.015996323351579095 Sum =  1.0010635288438405
Iteration =  15  Dual obj =  0.02666891626526892  Primal_obj =  0.04196536998089476  Gap =  0.015296453715625838 Sum =  1.0007197291327603
Iteration =  16  Dual obj =  0.02667007477857955  Primal_obj =  0.04103348947318192  Gap =  0.014363414694602367 Sum =  1.0004304016857966
Iteration =  17  Dual obj =  0.026671094806869716  Primal_obj =  0.04012403892321914  Gap =  0.013452944116349425 Sum =  1.0000404914437806
Iteration =  18  Dual obj =  0.026672063114672483  Primal_obj =  0.03939177067714211  Gap =  0.01271970756246963 Sum =  1.0000131997656894
Iteration =  19  Dual obj =  0.02667319638281073  Primal_obj =  0.03851772040038538  Gap =  0.011844524017574652 Sum =  0.999858868081991
Iteration =  20  Dual obj =  0.02667417328153262  Primal_obj =  0.037787512921675245  Gap =  0.011113339640142626 Sum =  1.0000067779948776
Iteration =  21  Dual obj =  0.02667526655044533  Primal_obj =  0.03715125794224852  Gap =  0.010475991391803191 Sum =  0.9997434147709158
Iteration =  22  Dual obj =  0.026676321124727283  Primal_obj =  0.03669690280766358  Gap =  0.010020581682936295 Sum =  0.9997230199760974
Iteration =  23  Dual obj =  0.026677044405245785  Primal_obj =  0.036234527064649594  Gap =  0.009557482659403808 Sum =  0.9994826316266661
Iteration =  24  Dual obj =  0.02667771111191388  Primal_obj =  0.03612326876701635  Gap =  0.009445557655102473 Sum =  0.9995947452817492
Iteration =  0  Dual obj =  0.02667771111191388  Primal_obj =  0.03612326876701635  Gap =  0.009445557655102473 Sum =  0.9995947452817492
Iteration =  1  Dual obj =  0.026678043037501625  Primal_obj =  0.03576102551646347  Gap =  0.009082982478961846 Sum =  0.9993682607276382
Iteration =  2  Dual obj =  0.0266782847847322  Primal_obj =  0.03550281914839347  Gap =  0.00882453436366127 Sum =  0.9994867417524367
Iteration =  3  Dual obj =  0.026678483321653443  Primal_obj =  0.03533293757369728  Gap =  0.008654454252043836 Sum =  0.9995339734278783
Iteration =  4  Dual obj =  0.02667886005459305  Primal_obj =  0.03505870179334407  Gap =  0.008379841738751018 Sum =  0.9994715557999378
Iteration =  5  Dual obj =  0.026679278500685626  Primal_obj =  0.034786396155750215  Gap =  0.00810711765506459 Sum =  0.99959402065841
Iteration =  6  Dual obj =  0.02667967106336669  Primal_obj =  0.034626522558266024  Gap =  0.007946851494899335 Sum =  0.9995436392633963
Iteration =  7  Dual obj =  0.02668008486573542  Primal_obj =  0.0345652343407602  Gap =  0.007885149475024777 Sum =  0.9997347914236819
Iteration =  8  Dual obj =  0.026680491223009493  Primal_obj =  0.03458932665252956  Gap =  0.007908835429520068 Sum =  0.9998713525684604
Iteration =  9  Dual obj =  0.026681046140229647  Primal_obj =  0.034840008122553334  Gap =  0.008158961982323687 Sum =  1.0002638788094238
Iteration =  10  Dual obj =  0.026681460041386038  Primal_obj =  0.03499327963380072  Gap =  0.008311819592414685 Sum =  1.000419869712769
Iteration =  11  Dual obj =  0.026681967168596298  Primal_obj =  0.03500704341643  Gap =  0.008325076247833706 Sum =  1.000867705431809
Iteration =  12  Dual obj =  0.026682556030161703  Primal_obj =  0.03484433359893996  Gap =  0.008161777568778256 Sum =  1.001016580147276
Iteration =  13  Dual obj =  0.02668310898015979  Primal_obj =  0.03480112058405241  Gap =  0.008118011603892618 Sum =  1.0011179800633783
Iteration =  14  Dual obj =  0.02668381531258025  Primal_obj =  0.0348088374135829  Gap =  0.00812502210100265 Sum =  1.0010257564054554
Iteration =  15  Dual obj =  0.02668460896987154  Primal_obj =  0.03476001955405565  Gap =  0.008075410584184112 Sum =  1.000980244190803
Iteration =  16  Dual obj =  0.02668541090835882  Primal_obj =  0.03493554062551284  Gap =  0.008250129717154019 Sum =  1.000742348479648
Iteration =  17  Dual obj =  0.02668619779574315  Primal_obj =  0.03495678030080235  Gap =  0.008270582505059198 Sum =  1.0006200379450005
Iteration =  18  Dual obj =  0.026687097729977308  Primal_obj =  0.035373348002998545  Gap =  0.008686250273021237 Sum =  1.0004233277323937
Iteration =  19  Dual obj =  0.026687990413734743  Primal_obj =  0.036331233318816755  Gap =  0.009643242905082013 Sum =  1.0003116602614364
Iteration =  20  Dual obj =  0.026688432652558373  Primal_obj =  0.03702324981653238  Gap =  0.010334817163974004 Sum =  1.0003591055306733
Iteration =  21  Dual obj =  0.026688884201403716  Primal_obj =  0.037008859266873875  Gap =  0.01031997506547016 Sum =  1.0003974278334073
Iteration =  22  Dual obj =  0.026689385307389995  Primal_obj =  0.03649977175975995  Gap =  0.009810386452369955 Sum =  1.0003516546029494
Iteration =  23  Dual obj =  0.026689800456039914  Primal_obj =  0.03586547384766682  Gap =  0.009175673391626907 Sum =  1.0003833199277592
Iteration =  24  Dual obj =  0.0266903386584506  Primal_obj =  0.035033077366433796  Gap =  0.008342738707983195 Sum =  1.0003342226389385
Done, writing results...
