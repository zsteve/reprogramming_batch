2021-04-29 12:29:12,563 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.01s.
2021-04-29 12:29:12,969 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.21s.
2021-04-29 12:29:13,341 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.37s.
2021-04-29 12:29:13,448 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-29 12:29:13,451 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:29:13,460 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:29:14,226 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 116.
2021-04-29 12:29:14,227 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.78s.
Iteration =  0  Dual obj =  -44.380145764988676  Primal_obj =  45605.11325806115  Gap =  45649.49340382614 Sum =  392.6163998224273
Iteration =  1  Dual obj =  -0.05088668651125883  Primal_obj =  16.784013402613365  Gap =  16.834900089124623 Sum =  0.8126115064578426
Iteration =  2  Dual obj =  -0.009120541376624533  Primal_obj =  9.147834823571936  Gap =  9.15695536494856 Sum =  0.8203724622510775
Iteration =  3  Dual obj =  0.004127324663615435  Primal_obj =  3.441398875046727  Gap =  3.4372715503831115 Sum =  0.8026719228276956
Iteration =  4  Dual obj =  0.011692747427530778  Primal_obj =  2.0125852435898417  Gap =  2.000892496162311 Sum =  0.9112763396225809
Iteration =  5  Dual obj =  0.015735493500727324  Primal_obj =  0.7455358747439119  Gap =  0.7298003812431846 Sum =  0.9930654683322607
Iteration =  6  Dual obj =  0.01674024045883379  Primal_obj =  0.3183940403759926  Gap =  0.30165379991715885 Sum =  1.002473381728623
Iteration =  7  Dual obj =  0.01698138367880045  Primal_obj =  0.19953926639118708  Gap =  0.18255788271238663 Sum =  0.9947185550991293
Iteration =  8  Dual obj =  0.017078643646859102  Primal_obj =  0.14300307879702936  Gap =  0.12592443515017027 Sum =  0.9955206725873456
Iteration =  9  Dual obj =  0.01712965638463389  Primal_obj =  0.10671155768533419  Gap =  0.0895819013007003 Sum =  1.0002078608623475
Iteration =  10  Dual obj =  0.017159276354615102  Primal_obj =  0.08255884021790788  Gap =  0.06539956386329278 Sum =  1.0000500183400205
Iteration =  11  Dual obj =  0.017177883764706595  Primal_obj =  0.06078728186939655  Gap =  0.04360939810468996 Sum =  0.9984476960354525
Iteration =  12  Dual obj =  0.017189291179764973  Primal_obj =  0.042354630302800594  Gap =  0.02516533912303562 Sum =  0.9989745282026248
Iteration =  13  Dual obj =  0.01719591696190217  Primal_obj =  0.02984113217763762  Gap =  0.012645215215735448 Sum =  0.999818391123433
Iteration =  14  Dual obj =  0.017199312828945965  Primal_obj =  0.024234535662059825  Gap =  0.00703522283311386 Sum =  0.9997529290411815
Iteration =  15  Dual obj =  0.01720124676136062  Primal_obj =  0.021634070084872656  Gap =  0.0044328233235120355 Sum =  0.9994741579405675
Iteration =  16  Dual obj =  0.01720248517600944  Primal_obj =  0.02027915206805822  Gap =  0.003076666892048781 Sum =  0.9995267673289621
Iteration =  17  Dual obj =  0.017203421492854018  Primal_obj =  0.01943574033462918  Gap =  0.0022323188417751605 Sum =  0.9999255733909433
Iteration =  18  Dual obj =  0.0172041029348586  Primal_obj =  0.0189606733453708  Gap =  0.0017565704105121996 Sum =  0.9999259701061124
Iteration =  19  Dual obj =  0.017204619302915218  Primal_obj =  0.018647814323426867  Gap =  0.0014431950205116492 Sum =  0.9997040097347953
Iteration =  20  Dual obj =  0.01720501351886169  Primal_obj =  0.018392015518598384  Gap =  0.0011870019997366928 Sum =  0.9998454397993074
Iteration =  21  Dual obj =  0.017205304907496687  Primal_obj =  0.018165593052981197  Gap =  0.00096028814548451 Sum =  1.0000579045079876
Iteration =  22  Dual obj =  0.017205540461254512  Primal_obj =  0.018019139853580807  Gap =  0.0008135993923262946 Sum =  0.9999449783568877
Iteration =  23  Dual obj =  0.017205744555692952  Primal_obj =  0.017908252746660525  Gap =  0.0007025081909675726 Sum =  0.9998846582187767
Iteration =  24  Dual obj =  0.017205912865388823  Primal_obj =  0.017817445920508657  Gap =  0.0006115330551198332 Sum =  0.9999716540430864
Iteration =  0  Dual obj =  -39.93099409738626  Primal_obj =  42598.481195149216  Gap =  42638.4121892466 Sum =  392.6163998224273
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.08206905314644763  Primal_obj =  18.97474931532272  Gap =  19.056818368469166 Sum =  0.46766078004610956
Iteration =  3  Dual obj =  -0.009832367004591239  Primal_obj =  15.177091554812888  Gap =  15.18692392181748 Sum =  0.7090914813165344
Iteration =  4  Dual obj =  0.014012517612935683  Primal_obj =  9.035780081204212  Gap =  9.021767563591277 Sum =  0.7842605069856454
Iteration =  5  Dual obj =  0.023907098106940743  Primal_obj =  4.286144046485955  Gap =  4.262236948379014 Sum =  0.837943899658145
Iteration =  6  Dual obj =  0.028771652782701912  Primal_obj =  3.0835175087009747  Gap =  3.0547458559182727 Sum =  0.8305610396156322
Iteration =  7  Dual obj =  0.031575611848300975  Primal_obj =  1.974341647462856  Gap =  1.9427660356145549 Sum =  0.8620425373836338
Iteration =  8  Dual obj =  0.03316602629993897  Primal_obj =  1.5134303224152459  Gap =  1.480264296115307 Sum =  0.9124594397130528
Iteration =  9  Dual obj =  0.03438639207938056  Primal_obj =  1.0307582205845691  Gap =  0.9963718285051886 Sum =  0.9331858119672376
Iteration =  10  Dual obj =  0.035260137229052024  Primal_obj =  0.8023888823926191  Gap =  0.7671287451635671 Sum =  0.9497264976113695
Iteration =  11  Dual obj =  0.035812408416440476  Primal_obj =  0.5264765480992402  Gap =  0.4906641396827997 Sum =  0.9620937965858529
Iteration =  12  Dual obj =  0.03616860762013703  Primal_obj =  0.473507647587118  Gap =  0.437339039966981 Sum =  0.9771584473112263
Iteration =  13  Dual obj =  0.036438365065416714  Primal_obj =  0.3562727806176293  Gap =  0.3198344155522126 Sum =  0.9855801268023638
Iteration =  14  Dual obj =  0.03661751117209752  Primal_obj =  0.2893620984576074  Gap =  0.25274458728550986 Sum =  0.9909256132703218
Iteration =  15  Dual obj =  0.036720220188216204  Primal_obj =  0.22069436536335107  Gap =  0.18397414517513488 Sum =  0.9936807920575963
Iteration =  16  Dual obj =  0.03678027250830351  Primal_obj =  0.18881689222867443  Gap =  0.1520366197203709 Sum =  0.9954045978943461
Iteration =  17  Dual obj =  0.03682224246732724  Primal_obj =  0.17131222097419732  Gap =  0.13448997850687008 Sum =  0.9976721345477466
Iteration =  18  Dual obj =  0.03685486224506107  Primal_obj =  0.16042607564308783  Gap =  0.12357121339802676 Sum =  0.9990230876319854
Iteration =  19  Dual obj =  0.036882871490488814  Primal_obj =  0.14715071985857295  Gap =  0.11026784836808413 Sum =  1.0017403442084887
Iteration =  20  Dual obj =  0.03691057701981359  Primal_obj =  0.13293011440659155  Gap =  0.09601953738677796 Sum =  1.0037470460694808
Iteration =  21  Dual obj =  0.03693402330478767  Primal_obj =  0.12473218079899853  Gap =  0.08779815749421085 Sum =  1.0026315005212245
Iteration =  22  Dual obj =  0.03695414530567358  Primal_obj =  0.1138057110360923  Gap =  0.07685156573041872 Sum =  1.0013085811339981
Iteration =  23  Dual obj =  0.036971016310386615  Primal_obj =  0.10292775383597418  Gap =  0.06595673752558756 Sum =  1.0014778176912944
Iteration =  24  Dual obj =  0.036985592386790944  Primal_obj =  0.09669207537440193  Gap =  0.059706482987610984 Sum =  1.0006467780918769
Iteration =  0  Dual obj =  0.036985592386790944  Primal_obj =  0.09669207537440193  Gap =  0.059706482987610984 Sum =  1.0006467780918769
Iteration =  1  Dual obj =  0.03699343654992521  Primal_obj =  0.08399415297640708  Gap =  0.047000716426481876 Sum =  1.0000510843855261
Iteration =  2  Dual obj =  0.03699936178554351  Primal_obj =  0.07581603641786352  Gap =  0.03881667463232002 Sum =  0.9998538535636889
Iteration =  3  Dual obj =  0.03700464100192313  Primal_obj =  0.07057591776727815  Gap =  0.03357127676535501 Sum =  0.9998339154966935
Iteration =  4  Dual obj =  0.03700940257933155  Primal_obj =  0.0687377394900263  Gap =  0.03172833691069475 Sum =  1.0007122771944585
Iteration =  5  Dual obj =  0.037016269474084006  Primal_obj =  0.06525289441910531  Gap =  0.028236624945021306 Sum =  1.0002850337841418
Iteration =  6  Dual obj =  0.03702335373135213  Primal_obj =  0.06441722354642926  Gap =  0.027393869815077132 Sum =  1.0000241394541889
Iteration =  7  Dual obj =  0.037029638703762094  Primal_obj =  0.06464897635012459  Gap =  0.0276193376463625 Sum =  1.0001649177563166
Iteration =  8  Dual obj =  0.03703500330496083  Primal_obj =  0.06395439131367353  Gap =  0.0269193880087127 Sum =  1.0002395367408332
Iteration =  9  Dual obj =  0.037040167103923785  Primal_obj =  0.06024624773586068  Gap =  0.023206080631936896 Sum =  1.0000334524897
Iteration =  10  Dual obj =  0.037044387369029076  Primal_obj =  0.059222776097026086  Gap =  0.02217838872799701 Sum =  0.9998217885491029
Iteration =  11  Dual obj =  0.03704840725369196  Primal_obj =  0.05838791724001849  Gap =  0.021339509986326527 Sum =  0.9998455614405435
Iteration =  12  Dual obj =  0.037051224155947415  Primal_obj =  0.057408949006673426  Gap =  0.02035772485072601 Sum =  0.9997770545667111
Iteration =  13  Dual obj =  0.037054000822852845  Primal_obj =  0.05618734878684199  Gap =  0.019133347963989147 Sum =  0.9989885800896252
Iteration =  14  Dual obj =  0.037056172657527725  Primal_obj =  0.05494924897614857  Gap =  0.017893076318620846 Sum =  0.9988426934956269
Iteration =  15  Dual obj =  0.03705830339943038  Primal_obj =  0.05377175696466918  Gap =  0.016713453565238803 Sum =  0.9988209030609378
Iteration =  16  Dual obj =  0.03706011174834678  Primal_obj =  0.0529352523718771  Gap =  0.01587514062353032 Sum =  0.9993529284939566
Iteration =  17  Dual obj =  0.03706192260677027  Primal_obj =  0.05177099391432541  Gap =  0.014709071307555138 Sum =  0.999543627044573
Iteration =  18  Dual obj =  0.037063606955455464  Primal_obj =  0.050461445516405926  Gap =  0.013397838560950462 Sum =  0.9998265945051857
Iteration =  19  Dual obj =  0.03706509700544748  Primal_obj =  0.04954295147229937  Gap =  0.012477854466851887 Sum =  1.0001711897460166
Iteration =  20  Dual obj =  0.03706636128460314  Primal_obj =  0.048759508970567675  Gap =  0.011693147685964536 Sum =  1.0003682390767468
Iteration =  21  Dual obj =  0.037067726410262035  Primal_obj =  0.0477413754051704  Gap =  0.010673648994908365 Sum =  1.0002668103657124
Iteration =  22  Dual obj =  0.03706909114851066  Primal_obj =  0.04690674940999241  Gap =  0.009837658261481752 Sum =  0.9997897925773478
Iteration =  23  Dual obj =  0.03707037853956918  Primal_obj =  0.04662498636776566  Gap =  0.009554607828196476 Sum =  1.0000764552866208
Iteration =  24  Dual obj =  0.03707136455523076  Primal_obj =  0.04637907939409139  Gap =  0.009307714838860628 Sum =  1.0004101641976706
Iteration =  0  Dual obj =  0.03707136455523076  Primal_obj =  0.04637907939409139  Gap =  0.009307714838860628 Sum =  1.0004101641976706
Iteration =  1  Dual obj =  0.03707189724681872  Primal_obj =  0.04545547948211545  Gap =  0.008383582235296734 Sum =  1.0004798396850956
Iteration =  2  Dual obj =  0.03707274594367867  Primal_obj =  0.04371702717733725  Gap =  0.0066442812336585805 Sum =  1.000350801091045
Iteration =  3  Dual obj =  0.03707358702195465  Primal_obj =  0.042213914479252074  Gap =  0.005140327457297422 Sum =  1.0004623051879316
Iteration =  4  Dual obj =  0.03707414620222783  Primal_obj =  0.04141110198026077  Gap =  0.00433695577803294 Sum =  1.000385681352425
Iteration =  5  Dual obj =  0.037074599968660304  Primal_obj =  0.040909346395550314  Gap =  0.0038347464268900094 Sum =  1.0001199463020671
Iteration =  6  Dual obj =  0.037074951349392406  Primal_obj =  0.040553916835484385  Gap =  0.0034789654860919797 Sum =  0.999835073544595
Iteration =  7  Dual obj =  0.0370753021305497  Primal_obj =  0.04029557750834138  Gap =  0.0032202753777916815 Sum =  0.9997963759081507
Iteration =  8  Dual obj =  0.037075583238263425  Primal_obj =  0.04015989588437681  Gap =  0.003084312646113384 Sum =  0.9999583352086412
Iteration =  9  Dual obj =  0.03707591354677789  Primal_obj =  0.04011311051545499  Gap =  0.0030371969686771028 Sum =  0.9999579255439515
Iteration =  10  Dual obj =  0.037076290250086685  Primal_obj =  0.040176050471927266  Gap =  0.0030997602218405806 Sum =  0.999856834398328
Iteration =  11  Dual obj =  0.037076630178716714  Primal_obj =  0.040156985139297705  Gap =  0.00308035496058099 Sum =  1.0001168806285141
Iteration =  12  Dual obj =  0.037076960846466576  Primal_obj =  0.040195453195821434  Gap =  0.003118492349354858 Sum =  1.0001924022610216
Iteration =  13  Dual obj =  0.03707728615867555  Primal_obj =  0.04017127332010581  Gap =  0.0030939871614302575 Sum =  0.9999259115742831
Iteration =  14  Dual obj =  0.037077629187612926  Primal_obj =  0.04012055280088672  Gap =  0.003042923613273796 Sum =  0.9998185255993607
Iteration =  15  Dual obj =  0.03707801359267388  Primal_obj =  0.04013724206974914  Gap =  0.0030592284770752584 Sum =  0.9997758892989883
Iteration =  16  Dual obj =  0.037078434259927504  Primal_obj =  0.04008862818263467  Gap =  0.003010193922707169 Sum =  0.9999392370146923
Iteration =  17  Dual obj =  0.037078995838479414  Primal_obj =  0.04014714355112246  Gap =  0.003068147712643049 Sum =  0.9999894405131007
Iteration =  18  Dual obj =  0.03707952649754344  Primal_obj =  0.04024296699089637  Gap =  0.0031634404933529314 Sum =  1.000152055148702
Iteration =  19  Dual obj =  0.037080061407136  Primal_obj =  0.0403408266529995  Gap =  0.003260765245863495 Sum =  1.0000861563847754
Iteration =  20  Dual obj =  0.0370804430563057  Primal_obj =  0.04055833946433891  Gap =  0.0034778964080332125 Sum =  0.9999558046637292
Iteration =  21  Dual obj =  0.03708077061763815  Primal_obj =  0.04083618237399424  Gap =  0.003755411756356089 Sum =  0.9999565115554938
Iteration =  22  Dual obj =  0.03708108783873814  Primal_obj =  0.040958590720583346  Gap =  0.003877502881845206 Sum =  0.9999106903350673
Iteration =  23  Dual obj =  0.037081396566731636  Primal_obj =  0.04125640514273771  Gap =  0.00417500857600607 Sum =  0.9998178697439893
Iteration =  24  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  0  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  1  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  2  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  3  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  4  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  5  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  6  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  7  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  8  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  9  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  10  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  11  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  12  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  13  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  14  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  15  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  16  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  17  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  18  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  19  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  20  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  21  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  22  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  23  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Iteration =  24  Dual obj =  0.03708175269108448  Primal_obj =  0.041626545861055686  Gap =  0.004544793169971209 Sum =  0.9999168767987145
Done, writing results...
