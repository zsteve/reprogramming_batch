2021-04-29 13:11:11,799 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.07s.
2021-04-29 13:11:12,199 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.21s.
2021-04-29 13:11:12,600 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 13:11:12,710 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-29 13:11:12,713 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 13:11:12,723 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 13:11:13,517 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 107.
2021-04-29 13:11:13,518 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.81s.
Iteration =  0  Dual obj =  -31.738886776315425  Primal_obj =  33327.447338307196  Gap =  33359.18622508351 Sum =  690.3154096791565
Iteration =  1  Dual obj =  -0.0269768172598729  Primal_obj =  18.922939947945263  Gap =  18.949916765205135 Sum =  0.8621699825822695
Iteration =  2  Dual obj =  0.016069806423518754  Primal_obj =  6.4002001440405945  Gap =  6.3841303376170755 Sum =  0.8336928785151094
Iteration =  3  Dual obj =  0.026996093499085227  Primal_obj =  2.2155527729096782  Gap =  2.188556679410593 Sum =  0.8276580119952305
Iteration =  4  Dual obj =  0.03428288644846536  Primal_obj =  1.2515292721389855  Gap =  1.21724638569052 Sum =  0.9731828340094782
Iteration =  5  Dual obj =  0.03637304390880492  Primal_obj =  0.44765611950471634  Gap =  0.41128307559591143 Sum =  1.0111000878414422
Iteration =  6  Dual obj =  0.03691576187820145  Primal_obj =  0.24346270828858507  Gap =  0.20654694641038363 Sum =  0.9933336402245292
Iteration =  7  Dual obj =  0.03709625316444316  Primal_obj =  0.14433308521466304  Gap =  0.10723683205021987 Sum =  0.996599019402201
Iteration =  8  Dual obj =  0.037183391668716835  Primal_obj =  0.09779330424656324  Gap =  0.060609912577846405 Sum =  0.9990383917862187
Iteration =  9  Dual obj =  0.037224054671716966  Primal_obj =  0.07088192018018824  Gap =  0.033657865508471274 Sum =  0.9986888387066335
Iteration =  10  Dual obj =  0.03724258966535496  Primal_obj =  0.05525260187725527  Gap =  0.01801001221190031 Sum =  0.998190655868646
Iteration =  11  Dual obj =  0.03725214460479696  Primal_obj =  0.04711171684800568  Gap =  0.009859572243208714 Sum =  0.9992522627369184
Iteration =  12  Dual obj =  0.037257419008927775  Primal_obj =  0.04338118032525093  Gap =  0.006123761316323154 Sum =  0.9994773460229702
Iteration =  13  Dual obj =  0.0372607762473436  Primal_obj =  0.041293919655154096  Gap =  0.004033143407810497 Sum =  0.9990359748906352
Iteration =  14  Dual obj =  0.03726289565591423  Primal_obj =  0.040138359896755404  Gap =  0.0028754642408411746 Sum =  0.9996358851825535
Iteration =  15  Dual obj =  0.03726427744732219  Primal_obj =  0.03942182483582775  Gap =  0.002157547388505557 Sum =  0.9997720726483647
Iteration =  16  Dual obj =  0.03726519461086114  Primal_obj =  0.03886724050893943  Gap =  0.0016020458980782887 Sum =  0.9997515330896027
Iteration =  17  Dual obj =  0.037265812459390354  Primal_obj =  0.038520849747742  Gap =  0.0012550372883516486 Sum =  0.9998944440916437
Iteration =  18  Dual obj =  0.03726628577666399  Primal_obj =  0.03827433163838925  Gap =  0.0010080458617252597 Sum =  1.0000226473459335
Iteration =  19  Dual obj =  0.03726664277776158  Primal_obj =  0.038065698149946606  Gap =  0.0007990553721850258 Sum =  0.9998849561720362
Iteration =  20  Dual obj =  0.037266940787591234  Primal_obj =  0.03789754758186799  Gap =  0.0006306067942767543 Sum =  0.9999012951348081
Iteration =  21  Dual obj =  0.03726715779323429  Primal_obj =  0.03776926628540821  Gap =  0.0005021084921739138 Sum =  1.0000356804323178
Iteration =  22  Dual obj =  0.03726732003434838  Primal_obj =  0.037676917925705614  Gap =  0.0004095978913572357 Sum =  0.9999632228164532
Iteration =  23  Dual obj =  0.037267433029286735  Primal_obj =  0.03761820234035225  Gap =  0.0003507693110655144 Sum =  0.9999172586563084
Iteration =  24  Dual obj =  0.037267545797969925  Primal_obj =  0.03755801398698319  Gap =  0.00029046818901326543 Sum =  0.9999821308275809
Iteration =  0  Dual obj =  -30.71297491486081  Primal_obj =  31258.632336416136  Gap =  31289.345311331 Sum =  690.3154096791565
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.23522410132243657  Primal_obj =  163.80667886773216  Gap =  164.0419029690546 Sum =  4.891898562814717
Iteration =  4  Dual obj =  -0.028721855863903384  Primal_obj =  27.080102262878068  Gap =  27.10882411874197 Sum =  0.8156672891686836
Iteration =  5  Dual obj =  0.019355172275570112  Primal_obj =  11.719288328786469  Gap =  11.699933156510898 Sum =  0.7970912027076302
Iteration =  6  Dual obj =  0.03723041241574071  Primal_obj =  6.843904142552181  Gap =  6.80667373013644 Sum =  0.8261941190855486
Iteration =  7  Dual obj =  0.04507137272896482  Primal_obj =  4.026926567983354  Gap =  3.9818551952543895 Sum =  0.8330091388365896
Iteration =  8  Dual obj =  0.04847291013886122  Primal_obj =  2.7302559236525106  Gap =  2.6817830135136496 Sum =  0.8475709872161745
Iteration =  9  Dual obj =  0.050664984337584575  Primal_obj =  2.155310023040039  Gap =  2.1046450387024542 Sum =  0.8613408376048004
Iteration =  10  Dual obj =  0.05226972706896925  Primal_obj =  1.8185376163140647  Gap =  1.7662678892450956 Sum =  0.8884820091646659
Iteration =  11  Dual obj =  0.05362022767843898  Primal_obj =  1.434167273642004  Gap =  1.380547045963565 Sum =  0.9181466905789331
Iteration =  12  Dual obj =  0.054518363746341655  Primal_obj =  1.0392923602425719  Gap =  0.9847739964962302 Sum =  0.9420776944982281
Iteration =  13  Dual obj =  0.055224913317590954  Primal_obj =  0.8611044433661437  Gap =  0.8058795300485527 Sum =  0.9705024623626707
Iteration =  14  Dual obj =  0.055775824483729364  Primal_obj =  0.715725690878135  Gap =  0.6599498663944057 Sum =  0.9772171481123122
Iteration =  15  Dual obj =  0.056153244026980464  Primal_obj =  0.616138127423622  Gap =  0.5599848833966414 Sum =  0.9887725378798973
Iteration =  16  Dual obj =  0.05641422948879448  Primal_obj =  0.46701776714765103  Gap =  0.41060353765885654 Sum =  0.9891114929414615
Iteration =  17  Dual obj =  0.05659059762878469  Primal_obj =  0.3999106857005087  Gap =  0.343320088071724 Sum =  0.9900439848415692
Iteration =  18  Dual obj =  0.056714111212320034  Primal_obj =  0.34919737351640734  Gap =  0.2924832623040873 Sum =  0.992646851719782
Iteration =  19  Dual obj =  0.05681374792528873  Primal_obj =  0.30546193222650686  Gap =  0.24864818430121813 Sum =  0.9971823991089467
Iteration =  20  Dual obj =  0.05688622200631585  Primal_obj =  0.2543205820260278  Gap =  0.19743436001971196 Sum =  0.9964105630006896
Iteration =  21  Dual obj =  0.05693182805940222  Primal_obj =  0.2307008286162246  Gap =  0.17376900055682237 Sum =  0.9974951271639847
Iteration =  22  Dual obj =  0.05696814588281483  Primal_obj =  0.2224921382098313  Gap =  0.16552399232701648 Sum =  1.0000533454424871
Iteration =  23  Dual obj =  0.057000989931965756  Primal_obj =  0.2022263901987268  Gap =  0.14522540026676103 Sum =  1.0013330966412113
Iteration =  24  Dual obj =  0.05702545914176169  Primal_obj =  0.18878686400813452  Gap =  0.13176140486637283 Sum =  1.003397467805121
Iteration =  0  Dual obj =  0.05702545914176169  Primal_obj =  0.18878686400813452  Gap =  0.13176140486637283 Sum =  1.003397467805121
Iteration =  1  Dual obj =  0.057043301005867714  Primal_obj =  0.16871461446410024  Gap =  0.11167131345823253 Sum =  1.0008215781606549
Iteration =  2  Dual obj =  0.05705677215913159  Primal_obj =  0.15578400390283162  Gap =  0.09872723174370003 Sum =  1.0010845382123883
Iteration =  3  Dual obj =  0.057069823343181246  Primal_obj =  0.153143670171335  Gap =  0.09607384682815376 Sum =  1.0010051825362045
Iteration =  4  Dual obj =  0.057082219467346706  Primal_obj =  0.1444717948268586  Gap =  0.08738957535951189 Sum =  0.9993990473067533
Iteration =  5  Dual obj =  0.0570992343246082  Primal_obj =  0.13914187297666514  Gap =  0.08204263865205694 Sum =  0.9999063302888156
Iteration =  6  Dual obj =  0.05711318635692707  Primal_obj =  0.1279417836836787  Gap =  0.07082859732675163 Sum =  1.000291382529925
Iteration =  7  Dual obj =  0.05712716222973044  Primal_obj =  0.12116026149343267  Gap =  0.06403309926370224 Sum =  0.9991537599195506
Iteration =  8  Dual obj =  0.05714004279834903  Primal_obj =  0.11207301568110811  Gap =  0.054932972882759085 Sum =  0.9992055154988336
Iteration =  9  Dual obj =  0.057149996653621075  Primal_obj =  0.10782314094403084  Gap =  0.05067314429040976 Sum =  0.9983354868789754
Iteration =  10  Dual obj =  0.0571582882062049  Primal_obj =  0.09961956316853825  Gap =  0.042461274962333345 Sum =  0.9979436292564625
Iteration =  11  Dual obj =  0.05716593530935102  Primal_obj =  0.09391913331230112  Gap =  0.0367531980029501 Sum =  0.9970638349750657
Iteration =  12  Dual obj =  0.0571730296893877  Primal_obj =  0.08989595396427598  Gap =  0.03272292427488828 Sum =  0.998571602065031
Iteration =  13  Dual obj =  0.05717865158927361  Primal_obj =  0.08587945925452838  Gap =  0.028700807665254763 Sum =  1.0009611413937316
Iteration =  14  Dual obj =  0.057183116145377196  Primal_obj =  0.08252815152675369  Gap =  0.025345035381376495 Sum =  1.0006396534514728
Iteration =  15  Dual obj =  0.05718688295459875  Primal_obj =  0.07947188696496217  Gap =  0.022285004010363423 Sum =  1.0007780303641376
Iteration =  16  Dual obj =  0.057189623495182015  Primal_obj =  0.07751856085913737  Gap =  0.020328937363955357 Sum =  1.0007906162420381
Iteration =  17  Dual obj =  0.05719263599835608  Primal_obj =  0.07606963470470254  Gap =  0.018876998706346466 Sum =  1.000538405129913
Iteration =  18  Dual obj =  0.05719523839408103  Primal_obj =  0.07463042325234465  Gap =  0.01743518485826362 Sum =  1.0002789346010914
Iteration =  19  Dual obj =  0.057197726553235295  Primal_obj =  0.07335630953381675  Gap =  0.016158582980581454 Sum =  1.0003165203223299
Iteration =  20  Dual obj =  0.05720027911679727  Primal_obj =  0.072315995283903  Gap =  0.015115716167105733 Sum =  1.000182424290966
Iteration =  21  Dual obj =  0.05720248869922462  Primal_obj =  0.0717320533319511  Gap =  0.014529564632726477 Sum =  1.0002431311456812
Iteration =  22  Dual obj =  0.05720469561117124  Primal_obj =  0.07084612030867043  Gap =  0.013641424697499197 Sum =  1.0000054318370062
Iteration =  23  Dual obj =  0.05720691478006289  Primal_obj =  0.07033757225290488  Gap =  0.013130657472841992 Sum =  1.0000698259980814
Iteration =  24  Dual obj =  0.057209079001795574  Primal_obj =  0.07072733046847171  Gap =  0.013518251466676137 Sum =  1.0003017222628001
Iteration =  0  Dual obj =  0.057209079001795574  Primal_obj =  0.07072733046847171  Gap =  0.013518251466676137 Sum =  1.0003017222628001
Iteration =  1  Dual obj =  0.057210110863439224  Primal_obj =  0.06950359278267085  Gap =  0.012293481919231623 Sum =  1.0004146250105141
Iteration =  2  Dual obj =  0.057210831462023104  Primal_obj =  0.06854236095709823  Gap =  0.011331529495075127 Sum =  1.0000191321890277
Iteration =  3  Dual obj =  0.05721160132642247  Primal_obj =  0.06763512666779997  Gap =  0.010423525341377499 Sum =  0.9997433669882393
Iteration =  4  Dual obj =  0.057212221148328864  Primal_obj =  0.0670632928867446  Gap =  0.009851071738415741 Sum =  0.9998281155113016
Iteration =  5  Dual obj =  0.05721287922554964  Primal_obj =  0.06660936630872541  Gap =  0.009396487083175767 Sum =  0.9998737938246618
Iteration =  6  Dual obj =  0.05721378445182234  Primal_obj =  0.06622010435923634  Gap =  0.009006319907413997 Sum =  0.9999921224936756
Iteration =  7  Dual obj =  0.057214677153156895  Primal_obj =  0.06592098179775285  Gap =  0.008706304644595958 Sum =  1.0003603635931588
Iteration =  8  Dual obj =  0.05721558589056702  Primal_obj =  0.06591430884518062  Gap =  0.008698722954613602 Sum =  1.0005856550292898
Iteration =  9  Dual obj =  0.05721664706935515  Primal_obj =  0.06612822580393016  Gap =  0.008911578734575008 Sum =  1.0006201606092824
Iteration =  10  Dual obj =  0.057217606940530394  Primal_obj =  0.0664544982392337  Gap =  0.00923689129870331 Sum =  1.000591637091536
Iteration =  11  Dual obj =  0.057218517726656995  Primal_obj =  0.06690699845642428  Gap =  0.009688480729767288 Sum =  1.0005399794086745
Iteration =  12  Dual obj =  0.0572194605621424  Primal_obj =  0.06721628196503446  Gap =  0.009996821402892056 Sum =  1.000159268876117
Iteration =  13  Dual obj =  0.05722063576753278  Primal_obj =  0.06780679799096379  Gap =  0.010586162223431006 Sum =  0.9996891247964845
Iteration =  14  Dual obj =  0.057221617065469126  Primal_obj =  0.06847176514009513  Gap =  0.011250148074626008 Sum =  0.9998248614395344
Iteration =  15  Dual obj =  0.05722249069310202  Primal_obj =  0.06872754023447264  Gap =  0.011505049541370618 Sum =  0.9999493745495932
Iteration =  16  Dual obj =  0.05722332110683487  Primal_obj =  0.06870616078986183  Gap =  0.011482839683026963 Sum =  0.9998763722338816
Iteration =  17  Dual obj =  0.057224297000872476  Primal_obj =  0.06843892776853239  Gap =  0.011214630767659911 Sum =  1.0000715362771089
Iteration =  18  Dual obj =  0.05722532998691427  Primal_obj =  0.06824146205639205  Gap =  0.011016132069477776 Sum =  1.000225573723238
Iteration =  19  Dual obj =  0.05722631735997202  Primal_obj =  0.06775124568220646  Gap =  0.010524928322234436 Sum =  1.0001459635812584
Iteration =  20  Dual obj =  0.05722723755572863  Primal_obj =  0.06747036810791705  Gap =  0.010243130552188423 Sum =  1.00029907352641
Iteration =  21  Dual obj =  0.05722822722850862  Primal_obj =  0.06713882865195672  Gap =  0.009910601423448101 Sum =  1.0000324370918858
Iteration =  22  Dual obj =  0.05722895978722187  Primal_obj =  0.06678130176427113  Gap =  0.009552341977049267 Sum =  0.999802844151011
Iteration =  23  Dual obj =  0.0572297516047302  Primal_obj =  0.06635267865590963  Gap =  0.009122927051179432 Sum =  0.9997245119443777
Iteration =  24  Dual obj =  0.05723034775370419  Primal_obj =  0.06586953326889006  Gap =  0.008639185515185867 Sum =  0.9996234970086277
Iteration =  0  Dual obj =  0.05723034775370419  Primal_obj =  0.06586953326889006  Gap =  0.008639185515185867 Sum =  0.9996234970086277
Iteration =  1  Dual obj =  0.05723063395720725  Primal_obj =  0.06545318575357023  Gap =  0.008222551796362984 Sum =  0.9997025197341263
Iteration =  2  Dual obj =  0.05723096735202849  Primal_obj =  0.06472715355265299  Gap =  0.007496186200624498 Sum =  0.9997529315244843
Iteration =  3  Dual obj =  0.05723131750274971  Primal_obj =  0.06393973473613535  Gap =  0.0067084172333856384 Sum =  0.999932954036076
Iteration =  4  Dual obj =  0.05723167917442188  Primal_obj =  0.06325899791794594  Gap =  0.0060273187435240586 Sum =  1.0000725753289312
Iteration =  5  Dual obj =  0.05723199383996868  Primal_obj =  0.06267328871812425  Gap =  0.005441294878155568 Sum =  1.000060417990904
Iteration =  6  Dual obj =  0.05723237028755725  Primal_obj =  0.06199221136702662  Gap =  0.004759841079469376 Sum =  1.0000047645366068
Iteration =  7  Dual obj =  0.057232693259181164  Primal_obj =  0.061476395060978725  Gap =  0.004243701801797561 Sum =  0.9999786864434151
Iteration =  8  Dual obj =  0.057232968470020976  Primal_obj =  0.061184302297038744  Gap =  0.003951333827017768 Sum =  1.0001138578644597
Iteration =  9  Dual obj =  0.05723312470596178  Primal_obj =  0.06101091207034998  Gap =  0.003777787364388205 Sum =  1.0000126426727274
Iteration =  10  Dual obj =  0.05723323259852807  Primal_obj =  0.06090354889136501  Gap =  0.003670316292836942 Sum =  1.0000224099063786
Iteration =  11  Dual obj =  0.05723338583874876  Primal_obj =  0.06076825259523794  Gap =  0.0035348667564891745 Sum =  0.9999190257488656
Iteration =  12  Dual obj =  0.05723362919748683  Primal_obj =  0.06066339221707094  Gap =  0.0034297630195841144 Sum =  1.0001422407312632
Iteration =  13  Dual obj =  0.057233822461172465  Primal_obj =  0.06059711702176122  Gap =  0.003363294560588752 Sum =  1.0001628364086352
Iteration =  14  Dual obj =  0.057234015638228816  Primal_obj =  0.060519645047883985  Gap =  0.003285629409655169 Sum =  1.0001657828862773
Iteration =  15  Dual obj =  0.057234219959971445  Primal_obj =  0.06042829679919971  Gap =  0.0031940768392282673 Sum =  1.0000575230045938
Iteration =  16  Dual obj =  0.05723445810249222  Primal_obj =  0.060373270987734984  Gap =  0.0031388128852427657 Sum =  1.0000881860974098
Iteration =  17  Dual obj =  0.057234667921717455  Primal_obj =  0.06032775941264188  Gap =  0.0030930914909244253 Sum =  0.9999369446683598
Iteration =  18  Dual obj =  0.057234886222042966  Primal_obj =  0.060287097459410716  Gap =  0.0030522112373677496 Sum =  0.9999226325939452
Iteration =  19  Dual obj =  0.0572351266973985  Primal_obj =  0.060294456839334584  Gap =  0.003059330141936087 Sum =  0.9999934112519078
Iteration =  20  Dual obj =  0.05723544747693861  Primal_obj =  0.06029305485938399  Gap =  0.0030576073824453848 Sum =  1.0002197595215057
Iteration =  21  Dual obj =  0.05723572442173126  Primal_obj =  0.060250639918391274  Gap =  0.0030149154966600117 Sum =  1.0000699362058019
Iteration =  22  Dual obj =  0.05723607777802982  Primal_obj =  0.060253168726059646  Gap =  0.0030170909480298283 Sum =  1.0001087057858884
Iteration =  23  Dual obj =  0.057236356661911195  Primal_obj =  0.060230205329191704  Gap =  0.002993848667280509 Sum =  1.0000818466093753
Iteration =  24  Dual obj =  0.05723660787582238  Primal_obj =  0.0603152672243205  Gap =  0.0030786593484981167 Sum =  1.0000145122758852
Done, writing results...
