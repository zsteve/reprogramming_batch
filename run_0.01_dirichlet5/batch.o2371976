2021-04-29 13:04:02,481 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.14s.
2021-04-29 13:04:02,895 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.22s.
2021-04-29 13:04:03,300 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 13:04:03,417 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-29 13:04:03,420 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 13:04:03,430 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 13:04:04,253 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 113.
2021-04-29 13:04:04,254 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.84s.
Iteration =  0  Dual obj =  -58.967751718709934  Primal_obj =  46328.94417513639  Gap =  46387.9119268551 Sum =  404.87471181479043
Iteration =  1  Dual obj =  -0.046522474275049755  Primal_obj =  15.607773310181887  Gap =  15.654295784456936 Sum =  0.8009370550081756
Iteration =  2  Dual obj =  -0.009108851449877428  Primal_obj =  6.9878363409517545  Gap =  6.996945192401632 Sum =  0.7903017772164005
Iteration =  3  Dual obj =  0.002932323356237332  Primal_obj =  3.50014779393644  Gap =  3.4972154705802025 Sum =  0.8467825217645037
Iteration =  4  Dual obj =  0.008894010199888152  Primal_obj =  2.033256847283145  Gap =  2.024362837083257 Sum =  0.9604065274368696
Iteration =  5  Dual obj =  0.011049390017007337  Primal_obj =  1.0384316076584617  Gap =  1.0273822176414542 Sum =  1.0051055166923266
Iteration =  6  Dual obj =  0.01180980864566146  Primal_obj =  0.6419699678980938  Gap =  0.6301601592524323 Sum =  0.9899963913894465
Iteration =  7  Dual obj =  0.012270338848584736  Primal_obj =  0.42543876047322077  Gap =  0.413168421624636 Sum =  0.9901451540981787
Iteration =  8  Dual obj =  0.012525689609570765  Primal_obj =  0.2076022313219955  Gap =  0.19507654171242475 Sum =  0.9990192756084078
Iteration =  9  Dual obj =  0.012634197855464081  Primal_obj =  0.10432458142870356  Gap =  0.09169038357323947 Sum =  1.0007383558097966
Iteration =  10  Dual obj =  0.012687479314359446  Primal_obj =  0.06468157395175701  Gap =  0.05199409463739757 Sum =  1.000496543858338
Iteration =  11  Dual obj =  0.012713958110522845  Primal_obj =  0.04216889809663177  Gap =  0.029454939986108923 Sum =  1.0004831322358285
Iteration =  12  Dual obj =  0.012727415528391697  Primal_obj =  0.02975370240637086  Gap =  0.017026286877979163 Sum =  1.000288230061351
Iteration =  13  Dual obj =  0.012733792239460619  Primal_obj =  0.021931376049875106  Gap =  0.009197583810414488 Sum =  0.9996271952352882
Iteration =  14  Dual obj =  0.01273686272061587  Primal_obj =  0.018142903762702556  Gap =  0.005406041042086685 Sum =  0.9997171272456158
Iteration =  15  Dual obj =  0.012738539215317677  Primal_obj =  0.016111393285653572  Gap =  0.003372854070335895 Sum =  1.0000169929734979
Iteration =  16  Dual obj =  0.012739528405014907  Primal_obj =  0.014967135504961218  Gap =  0.002227607099946311 Sum =  0.9998289673968257
Iteration =  17  Dual obj =  0.012740162382128856  Primal_obj =  0.014293786620955234  Gap =  0.0015536242388263788 Sum =  0.9998086724834271
Iteration =  18  Dual obj =  0.012740615888080467  Primal_obj =  0.013856410655764956  Gap =  0.0011157947676844887 Sum =  0.9999112760237363
Iteration =  19  Dual obj =  0.012740908442704993  Primal_obj =  0.013612510009950674  Gap =  0.0008716015672456806 Sum =  1.0000380760261152
Iteration =  20  Dual obj =  0.0127411660924787  Primal_obj =  0.013415801124392529  Gap =  0.000674635031913829 Sum =  0.9998974459056942
Iteration =  21  Dual obj =  0.01274135503791065  Primal_obj =  0.013284517730998244  Gap =  0.0005431626930875941 Sum =  0.9999548904264213
Iteration =  22  Dual obj =  0.012741509960219423  Primal_obj =  0.013180444531481553  Gap =  0.0004389345712621298 Sum =  0.9999655520527047
Iteration =  23  Dual obj =  0.01274162775880925  Primal_obj =  0.013098639142536408  Gap =  0.0003570113837271585 Sum =  0.9999811039042569
Iteration =  24  Dual obj =  0.012741717213898225  Primal_obj =  0.013039678682185266  Gap =  0.00029796146828704045 Sum =  0.9999363538805274
Iteration =  0  Dual obj =  -41.73055699060344  Primal_obj =  36331.179345502554  Gap =  36372.90990249316 Sum =  404.87471181479043
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.3122704317035733  Primal_obj =  249.92769145353554  Gap =  250.23996188523913 Sum =  5.693398124257018
Iteration =  4  Dual obj =  -0.04919360769624968  Primal_obj =  29.58720033873793  Gap =  29.63639394643418 Sum =  0.8015952031371785
Iteration =  5  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  6  Dual obj =  -0.03247770548029446  Primal_obj =  19.168095220740422  Gap =  19.200572926220715 Sum =  0.8831934053991317
Iteration =  7  Dual obj =  -0.023612458907770133  Primal_obj =  16.615545106241402  Gap =  16.639157565149173 Sum =  0.9053746590111351
Iteration =  8  Dual obj =  -0.015829252818685524  Primal_obj =  19.18955481534599  Gap =  19.205384068164676 Sum =  0.9787835425417654
Iteration =  9  Dual obj =  -0.010334897498452036  Primal_obj =  15.806945046317121  Gap =  15.817279943815574 Sum =  0.6281290190360824
Iteration =  10  Dual obj =  -0.0036296212578550424  Primal_obj =  14.03815308750158  Gap =  14.041782708759435 Sum =  0.7964784058068228
Iteration =  11  Dual obj =  0.007033572132995693  Primal_obj =  11.817261156453704  Gap =  11.810227584320709 Sum =  0.8717599336999975
Iteration =  12  Dual obj =  0.012281725123985655  Primal_obj =  8.510656412287489  Gap =  8.498374687163503 Sum =  0.850869815320996
Iteration =  13  Dual obj =  0.015347793045217661  Primal_obj =  8.536814683127215  Gap =  8.521466890081998 Sum =  0.8529395766829032
Iteration =  14  Dual obj =  0.019640793200611198  Primal_obj =  6.326887773974393  Gap =  6.307246980773782 Sum =  0.8659184369732984
Iteration =  15  Dual obj =  0.02226297702831701  Primal_obj =  5.03570806361911  Gap =  5.013445086590792 Sum =  0.8433630531867938
Iteration =  16  Dual obj =  0.024004479621673756  Primal_obj =  4.063811187031523  Gap =  4.039806707409849 Sum =  0.852082639379377
Iteration =  17  Dual obj =  0.02577547930011418  Primal_obj =  3.868746964068484  Gap =  3.84297148476837 Sum =  0.8724238617867802
Iteration =  18  Dual obj =  0.02727758465394945  Primal_obj =  3.4481823503657827  Gap =  3.420904765711833 Sum =  0.8761128854576403
Iteration =  19  Dual obj =  0.028276091275703755  Primal_obj =  2.9388372706409713  Gap =  2.9105611793652675 Sum =  0.894971513954667
Iteration =  20  Dual obj =  0.02918899570949729  Primal_obj =  2.581322067607047  Gap =  2.5521330718975497 Sum =  0.9160611797684317
Iteration =  21  Dual obj =  0.02973619449323648  Primal_obj =  2.48671982079294  Gap =  2.456983626299704 Sum =  0.9256064504486927
Iteration =  22  Dual obj =  0.03036398184234822  Primal_obj =  2.0842073476538405  Gap =  2.0538433658114923 Sum =  0.9423534122914394
Iteration =  23  Dual obj =  0.03089087490969245  Primal_obj =  1.9312180371097472  Gap =  1.9003271622000546 Sum =  0.9517623537855133
Iteration =  24  Dual obj =  0.03127152909488431  Primal_obj =  1.5250528785831046  Gap =  1.4937813494882202 Sum =  0.952936513622248
Iteration =  0  Dual obj =  0.03127152909488431  Primal_obj =  1.5250528785831046  Gap =  1.4937813494882202 Sum =  0.952936513622248
Iteration =  1  Dual obj =  0.03148451033760932  Primal_obj =  1.3721469192366118  Gap =  1.3406624088990025 Sum =  0.9499738693929387
Iteration =  2  Dual obj =  0.03175920618031303  Primal_obj =  1.3331960850390514  Gap =  1.3014368788587385 Sum =  0.9590929109328787
Iteration =  3  Dual obj =  0.03203215769498602  Primal_obj =  1.2380529664060966  Gap =  1.2060208087111106 Sum =  0.9588219539092782
Iteration =  4  Dual obj =  0.03234527968447318  Primal_obj =  1.199716414166715  Gap =  1.1673711344822417 Sum =  0.9637485318938824
Iteration =  5  Dual obj =  0.03262345583803233  Primal_obj =  1.1224718709528698  Gap =  1.0898484151148375 Sum =  0.9711771745154654
Iteration =  6  Dual obj =  0.03290139068296265  Primal_obj =  0.9868869281052993  Gap =  0.9539855374223367 Sum =  0.984555007088362
Iteration =  7  Dual obj =  0.033111082361206065  Primal_obj =  0.7806702253669292  Gap =  0.7475591430057231 Sum =  0.9988049803202409
Iteration =  8  Dual obj =  0.03324960592239126  Primal_obj =  0.6396661013273933  Gap =  0.6064164954050021 Sum =  1.0124884387104673
Iteration =  9  Dual obj =  0.033352761848466105  Primal_obj =  0.525194750652028  Gap =  0.49184198880356195 Sum =  1.0150379939508056
Iteration =  10  Dual obj =  0.033431728142446784  Primal_obj =  0.48343007409419503  Gap =  0.44999834595174826 Sum =  1.0145164945125513
Iteration =  11  Dual obj =  0.03349280871300955  Primal_obj =  0.3947828807527859  Gap =  0.36129007203977637 Sum =  1.0122840853397876
Iteration =  12  Dual obj =  0.03354201968904347  Primal_obj =  0.3743867981416016  Gap =  0.3408447784525581 Sum =  1.010323253587845
Iteration =  13  Dual obj =  0.033585979120427725  Primal_obj =  0.3042587311146925  Gap =  0.27067275199426477 Sum =  1.0055586673069632
Iteration =  14  Dual obj =  0.03362647568446224  Primal_obj =  0.26278615514580606  Gap =  0.2291596794613438 Sum =  1.0024020519730366
Iteration =  15  Dual obj =  0.033660840774041335  Primal_obj =  0.22434074030225637  Gap =  0.19067989952821504 Sum =  0.99808201094434
Iteration =  16  Dual obj =  0.03368539774139168  Primal_obj =  0.18087735784890188  Gap =  0.1471919601075102 Sum =  0.9973921378141026
Iteration =  17  Dual obj =  0.03370526012391622  Primal_obj =  0.15550177997256143  Gap =  0.1217965198486452 Sum =  0.9986464740344885
Iteration =  18  Dual obj =  0.033721431506454194  Primal_obj =  0.1337033636926799  Gap =  0.09998193218622571 Sum =  0.9985551880958488
Iteration =  19  Dual obj =  0.03373443219299614  Primal_obj =  0.12104339992140362  Gap =  0.08730896772840747 Sum =  0.9990232946238418
Iteration =  20  Dual obj =  0.03374548332155376  Primal_obj =  0.11327283375844586  Gap =  0.0795273504368921 Sum =  1.000100688342921
Iteration =  21  Dual obj =  0.03375573950193189  Primal_obj =  0.10825339116521944  Gap =  0.07449765166328755 Sum =  1.0007618418819217
Iteration =  22  Dual obj =  0.03376433461309051  Primal_obj =  0.10187040313000573  Gap =  0.06810606851691522 Sum =  0.9996707823083971
Iteration =  23  Dual obj =  0.0337726740665269  Primal_obj =  0.08968089258083747  Gap =  0.055908218514310576 Sum =  0.9999442531495776
Iteration =  24  Dual obj =  0.033779328862111324  Primal_obj =  0.08466689196632779  Gap =  0.050887563104216466 Sum =  0.9991412161746118
Iteration =  0  Dual obj =  0.033779328862111324  Primal_obj =  0.08466689196632779  Gap =  0.050887563104216466 Sum =  0.9991412161746118
Iteration =  1  Dual obj =  0.03378217552533051  Primal_obj =  0.07794607859542507  Gap =  0.04416390307009456 Sum =  0.9990961265835447
Iteration =  2  Dual obj =  0.03378555227887309  Primal_obj =  0.07189428061680475  Gap =  0.03810872833793166 Sum =  0.9993766509076089
Iteration =  3  Dual obj =  0.033787872807927354  Primal_obj =  0.06748222645581038  Gap =  0.03369435364788303 Sum =  0.9997191053237149
Iteration =  4  Dual obj =  0.03378995292376981  Primal_obj =  0.06432713486955452  Gap =  0.03053718194578471 Sum =  0.9998280280221323
Iteration =  5  Dual obj =  0.03379230860547677  Primal_obj =  0.061313684782957845  Gap =  0.02752137617748107 Sum =  0.9999459665250865
Iteration =  6  Dual obj =  0.0337947958275735  Primal_obj =  0.05961002965470802  Gap =  0.02581523382713452 Sum =  0.9996861431192706
Iteration =  7  Dual obj =  0.03379746025685516  Primal_obj =  0.05819999867599385  Gap =  0.02440253841913869 Sum =  0.9997013526876705
Iteration =  8  Dual obj =  0.03379969567008491  Primal_obj =  0.05793406029892614  Gap =  0.024134364628841234 Sum =  0.9991156177803738
Iteration =  9  Dual obj =  0.033802306205269264  Primal_obj =  0.05817146971532541  Gap =  0.02436916351005615 Sum =  0.9992731472608325
Iteration =  10  Dual obj =  0.03380508984742772  Primal_obj =  0.05693194254251688  Gap =  0.023126852695089156 Sum =  1.0001206229860378
Iteration =  11  Dual obj =  0.03380712935030929  Primal_obj =  0.055854814180407886  Gap =  0.0220476848300986 Sum =  1.0004463477174368
Iteration =  12  Dual obj =  0.03380933545851536  Primal_obj =  0.05461297448797833  Gap =  0.020803639029462972 Sum =  1.001074428733474
Iteration =  13  Dual obj =  0.0338113826619489  Primal_obj =  0.05331566091557555  Gap =  0.019504278253626647 Sum =  1.0012306853226547
Iteration =  14  Dual obj =  0.033813252441924735  Primal_obj =  0.0521270759536164  Gap =  0.018313823511691668 Sum =  1.0016597736852475
Iteration =  15  Dual obj =  0.03381497477510233  Primal_obj =  0.05097527801362109  Gap =  0.017160303238518762 Sum =  1.0015406680424188
Iteration =  16  Dual obj =  0.033816469642744526  Primal_obj =  0.049733126749216566  Gap =  0.01591665710647204 Sum =  1.0010728679575016
Iteration =  17  Dual obj =  0.03381768092813131  Primal_obj =  0.048276011319820414  Gap =  0.014458330391689103 Sum =  1.000542005655921
Iteration =  18  Dual obj =  0.03381898298242314  Primal_obj =  0.046833007168021704  Gap =  0.013014024185598563 Sum =  1.000120081149464
Iteration =  19  Dual obj =  0.03382006310278838  Primal_obj =  0.045640906113328245  Gap =  0.011820843010539865 Sum =  0.9999938051696098
Iteration =  20  Dual obj =  0.03382112198921827  Primal_obj =  0.044377806015839016  Gap =  0.010556684026620744 Sum =  0.9997840584865753
Iteration =  21  Dual obj =  0.033821957637893724  Primal_obj =  0.04347875362096655  Gap =  0.009656795983072827 Sum =  0.9997663660670864
Iteration =  22  Dual obj =  0.03382270520078912  Primal_obj =  0.04268498481912847  Gap =  0.008862279618339346 Sum =  0.9997663469962306
Iteration =  23  Dual obj =  0.033823535077553486  Primal_obj =  0.04198943875519111  Gap =  0.008165903677637622 Sum =  1.0000282466727006
Iteration =  24  Dual obj =  0.033824146119484796  Primal_obj =  0.04150634851351487  Gap =  0.0076822023940300715 Sum =  0.9999830442620438
Iteration =  0  Dual obj =  0.033824146119484796  Primal_obj =  0.04150634851351487  Gap =  0.0076822023940300715 Sum =  0.9999830442620438
Iteration =  1  Dual obj =  0.03382445472849444  Primal_obj =  0.0410919636637406  Gap =  0.007267508935246157 Sum =  0.9998650861108312
Iteration =  2  Dual obj =  0.03382484972305268  Primal_obj =  0.04052890897305385  Gap =  0.006704059250001171 Sum =  0.9996106222373664
Iteration =  3  Dual obj =  0.03382519305661716  Primal_obj =  0.04007814270700155  Gap =  0.006252949650384393 Sum =  0.9996747809767065
Iteration =  4  Dual obj =  0.03382557562061193  Primal_obj =  0.03956616602631288  Gap =  0.005740590405700949 Sum =  0.9995820073810515
Iteration =  5  Dual obj =  0.033826013565285876  Primal_obj =  0.03912326997370791  Gap =  0.0052972564084220325 Sum =  0.9996455057982521
Iteration =  6  Dual obj =  0.033826340431793875  Primal_obj =  0.038857691106287465  Gap =  0.00503135067449359 Sum =  0.9997733357521662
Iteration =  7  Dual obj =  0.03382660065198543  Primal_obj =  0.038660990554884034  Gap =  0.0048343899028986045 Sum =  0.9999857913497047
Iteration =  8  Dual obj =  0.03382680952976687  Primal_obj =  0.03854852225294238  Gap =  0.0047217127231755085 Sum =  1.0001981272325442
Iteration =  9  Dual obj =  0.03382704439183796  Primal_obj =  0.038452535582740366  Gap =  0.004625491190902407 Sum =  1.0004423288685882
Iteration =  10  Dual obj =  0.033827393294569845  Primal_obj =  0.038249832228558656  Gap =  0.004422438933988811 Sum =  1.0004833139501
Iteration =  11  Dual obj =  0.03382773449428301  Primal_obj =  0.03815459223446073  Gap =  0.004326857740177721 Sum =  1.0003699283741345
Iteration =  12  Dual obj =  0.0338280972411826  Primal_obj =  0.03803928651839848  Gap =  0.004211189277215879 Sum =  1.0002563819274686
Iteration =  13  Dual obj =  0.0338284745020152  Primal_obj =  0.03785928286025517  Gap =  0.004030808358239969 Sum =  1.000106826803737
Iteration =  14  Dual obj =  0.03382881122359459  Primal_obj =  0.037699794991371896  Gap =  0.0038709837677773085 Sum =  0.9999748894408096
Iteration =  15  Dual obj =  0.03382923048494127  Primal_obj =  0.03756024488719094  Gap =  0.003731014402249669 Sum =  0.9998056523751024
Iteration =  16  Dual obj =  0.033829686450896124  Primal_obj =  0.037342908266576755  Gap =  0.003513221815680631 Sum =  1.0000995330877598
Iteration =  17  Dual obj =  0.03383003365406097  Primal_obj =  0.03717572554926506  Gap =  0.0033456918952040893 Sum =  1.0001845083514982
Iteration =  18  Dual obj =  0.033830414126128736  Primal_obj =  0.037275830246764785  Gap =  0.0034454161206360495 Sum =  1.0002985791484034
Iteration =  19  Dual obj =  0.033830763044097614  Primal_obj =  0.03710134451445364  Gap =  0.0032705814703560265 Sum =  1.000354156682236
Iteration =  20  Dual obj =  0.033831009068019814  Primal_obj =  0.03692528525399558  Gap =  0.0030942761859757625 Sum =  1.0002247534428215
Iteration =  21  Dual obj =  0.033831266380850156  Primal_obj =  0.03676166284535742  Gap =  0.0029303964645072678 Sum =  1.000081288244109
Iteration =  22  Dual obj =  0.03383154474944944  Primal_obj =  0.03657996523432133  Gap =  0.002748420484871894 Sum =  0.9998651629188371
Iteration =  23  Dual obj =  0.033831768479698536  Primal_obj =  0.03645786184445708  Gap =  0.0026260933647585458 Sum =  0.9997304508159868
Iteration =  24  Dual obj =  0.0338320122046469  Primal_obj =  0.03633673551994  Gap =  0.0025047233152931045 Sum =  0.9997256011574924
Done, writing results...
