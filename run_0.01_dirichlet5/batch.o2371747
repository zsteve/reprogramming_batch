2021-04-29 12:30:37,222 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.08s.
2021-04-29 12:30:37,634 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.22s.
2021-04-29 12:30:38,023 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.39s.
2021-04-29 12:30:38,132 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-29 12:30:38,135 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:30:38,144 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:30:39,030 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 117.
2021-04-29 12:30:39,032 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.90s.
Iteration =  0  Dual obj =  -41.98625536047098  Primal_obj =  35780.635573997555  Gap =  35822.621829358024 Sum =  1287.5424042178538
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.11242784412411444  Primal_obj =  12.307438043549773  Gap =  12.419865887673888 Sum =  0.46460162094676716
Iteration =  3  Dual obj =  -0.026271956710327497  Primal_obj =  7.032552008834217  Gap =  7.058823965544544 Sum =  0.9090900545190336
Iteration =  4  Dual obj =  -0.014289263646259709  Primal_obj =  2.8156707643631096  Gap =  2.8299600280093693 Sum =  0.9199668832802996
Iteration =  5  Dual obj =  -0.0075526324921116675  Primal_obj =  1.5524541986226417  Gap =  1.5600068311147532 Sum =  0.9865581002865729
Iteration =  6  Dual obj =  -0.004839280597303745  Primal_obj =  0.6269373508498789  Gap =  0.6317766314471827 Sum =  1.0218495142385813
Iteration =  7  Dual obj =  -0.00403687292149682  Primal_obj =  0.3048912113655509  Gap =  0.30892808428704777 Sum =  1.0198275593457284
Iteration =  8  Dual obj =  -0.003727552340649389  Primal_obj =  0.17274499780413866  Gap =  0.17647255014478805 Sum =  1.0108157353345497
Iteration =  9  Dual obj =  -0.0035717194596269156  Primal_obj =  0.09255536376854327  Gap =  0.0961270832281702 Sum =  1.0045054304518504
Iteration =  10  Dual obj =  -0.0035043942882745285  Primal_obj =  0.05818303129732311  Gap =  0.06168742558559764 Sum =  1.002780153979268
Iteration =  11  Dual obj =  -0.0034701202364399233  Primal_obj =  0.033672936758388186  Gap =  0.03714305699482811 Sum =  1.0016120072571644
Iteration =  12  Dual obj =  -0.003454238738428178  Primal_obj =  0.020633144103958834  Gap =  0.024087382842387012 Sum =  1.0003148133007498
Iteration =  13  Dual obj =  -0.0034455505003482007  Primal_obj =  0.012253127956042595  Gap =  0.015698678456390794 Sum =  0.9998426286774125
Iteration =  14  Dual obj =  -0.0034405854581885404  Primal_obj =  0.006532968729200769  Gap =  0.00997355418738931 Sum =  0.9998602326522056
Iteration =  15  Dual obj =  -0.0034376365945855917  Primal_obj =  0.0028785975894371346  Gap =  0.006316234184022726 Sum =  0.9998162275130056
Iteration =  16  Dual obj =  -0.0034359635431980683  Primal_obj =  0.0005591244666143524  Gap =  0.003995088009812421 Sum =  0.9996467792626492
Iteration =  17  Dual obj =  -0.0034348951542261703  Primal_obj =  -0.0006960038825851722  Gap =  0.002738891271640998 Sum =  0.9995443169922518
Iteration =  18  Dual obj =  -0.003434079709202075  Primal_obj =  -0.0014689782566321974  Gap =  0.0019651014525698778 Sum =  0.9996605262486145
Iteration =  19  Dual obj =  -0.003433464954008366  Primal_obj =  -0.0019141536502480239  Gap =  0.0015193113037603422 Sum =  0.9997881871125331
Iteration =  20  Dual obj =  -0.0034329637207183104  Primal_obj =  -0.002243699720250125  Gap =  0.0011892640004681852 Sum =  0.9997780120149378
Iteration =  21  Dual obj =  -0.003432580243499791  Primal_obj =  -0.0024725314411730287  Gap =  0.0009600488023267621 Sum =  0.9998851942526552
Iteration =  22  Dual obj =  -0.003432280586660579  Primal_obj =  -0.0026420644481861266  Gap =  0.0007902161384744522 Sum =  0.9999225362305815
Iteration =  23  Dual obj =  -0.0034320447433599383  Primal_obj =  -0.0027657587879834356  Gap =  0.0006662859553765027 Sum =  0.9998899943404375
Iteration =  24  Dual obj =  -0.003431855599028373  Primal_obj =  -0.002856109329463119  Gap =  0.000575746269565254 Sum =  0.9999922814440372
Iteration =  0  Dual obj =  -39.30828627208908  Primal_obj =  32002.880964441167  Gap =  32042.189250713254 Sum =  1287.5424042178538
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.09554863935091952  Primal_obj =  13.701473074668229  Gap =  13.797021714019149 Sum =  0.3822195806750961
Iteration =  3  Dual obj =  -0.02256626669018101  Primal_obj =  12.331975634889137  Gap =  12.354541901579317 Sum =  0.857893441571907
Iteration =  4  Dual obj =  -0.0017505958974546251  Primal_obj =  7.676735690619243  Gap =  7.678486286516698 Sum =  0.9467350723503842
Iteration =  5  Dual obj =  0.004425602252188854  Primal_obj =  5.832356901306582  Gap =  5.827931299054393 Sum =  0.9377996248772398
Iteration =  6  Dual obj =  0.009877265017982827  Primal_obj =  3.6936722122550485  Gap =  3.6837949472370655 Sum =  0.9071320377783545
Iteration =  7  Dual obj =  0.013591744066543579  Primal_obj =  2.3738144782383728  Gap =  2.3602227341718294 Sum =  0.9312257819810412
Iteration =  8  Dual obj =  0.015728075264619133  Primal_obj =  2.0343350994114116  Gap =  2.0186070241467924 Sum =  0.9326810024874388
Iteration =  9  Dual obj =  0.017615892068854423  Primal_obj =  1.5364292326485367  Gap =  1.5188133405796822 Sum =  0.9431817596800889
Iteration =  10  Dual obj =  0.018921974929798295  Primal_obj =  1.1804326142101433  Gap =  1.1615106392803451 Sum =  0.9715316423432683
Iteration =  11  Dual obj =  0.019746079580816134  Primal_obj =  1.041344725902947  Gap =  1.0215986463221307 Sum =  0.9784079117721165
Iteration =  12  Dual obj =  0.020328184517444958  Primal_obj =  0.8159013155886103  Gap =  0.7955731310711653 Sum =  0.9804732270277126
Iteration =  13  Dual obj =  0.020758799317799056  Primal_obj =  0.7209415616002525  Gap =  0.7001827622824535 Sum =  0.9915346190886272
Iteration =  14  Dual obj =  0.02108115606045614  Primal_obj =  0.5634692400823337  Gap =  0.5423880840218775 Sum =  0.9903605585609998
Iteration =  15  Dual obj =  0.02134800898499832  Primal_obj =  0.49107454094187764  Gap =  0.4697265319568793 Sum =  0.9911383048671718
Iteration =  16  Dual obj =  0.021531873661680773  Primal_obj =  0.42537787011015327  Gap =  0.4038459964484725 Sum =  1.0060555097441486
Iteration =  17  Dual obj =  0.021666962152303293  Primal_obj =  0.3549436679266223  Gap =  0.333276705774319 Sum =  0.9999539579573574
Iteration =  18  Dual obj =  0.02177826227595551  Primal_obj =  0.3293722884644136  Gap =  0.30759402618845805 Sum =  1.0093561207320867
Iteration =  19  Dual obj =  0.021862559493912553  Primal_obj =  0.2426154907846767  Gap =  0.22075293129076415 Sum =  1.0072210159169068
Iteration =  20  Dual obj =  0.021928785270039677  Primal_obj =  0.20978515999388644  Gap =  0.18785637472384675 Sum =  1.0051623219637162
Iteration =  21  Dual obj =  0.02197611715408246  Primal_obj =  0.19391786633780023  Gap =  0.17194174918371777 Sum =  1.0048411258046124
Iteration =  22  Dual obj =  0.022025060904450652  Primal_obj =  0.17305281105625492  Gap =  0.15102775015180425 Sum =  1.002477341572042
Iteration =  23  Dual obj =  0.022060206942115065  Primal_obj =  0.15776984044070064  Gap =  0.13570963349858556 Sum =  1.0041294855055898
Iteration =  24  Dual obj =  0.022096927068934093  Primal_obj =  0.1419993569292795  Gap =  0.11990242986034541 Sum =  1.0018895770079617
Iteration =  0  Dual obj =  0.022096927068934093  Primal_obj =  0.1419993569292795  Gap =  0.11990242986034541 Sum =  1.0018895770079617
Iteration =  1  Dual obj =  0.022117327588356953  Primal_obj =  0.11504588651482497  Gap =  0.09292855892646802 Sum =  1.0006142265235867
Iteration =  2  Dual obj =  0.02213307625065095  Primal_obj =  0.10359739975078613  Gap =  0.08146432350013519 Sum =  1.0023343431117713
Iteration =  3  Dual obj =  0.022146371454059323  Primal_obj =  0.09763717510938506  Gap =  0.07549080365532573 Sum =  1.0017183415825157
Iteration =  4  Dual obj =  0.022161701357261164  Primal_obj =  0.09450509293840964  Gap =  0.07234339158114847 Sum =  1.003144386064221
Iteration =  5  Dual obj =  0.022178610712299224  Primal_obj =  0.10176201947009317  Gap =  0.07958340875779395 Sum =  1.0021417089150706
Iteration =  6  Dual obj =  0.02219822402978431  Primal_obj =  0.09107937629014297  Gap =  0.06888115226035865 Sum =  1.0024243509707502
Iteration =  7  Dual obj =  0.022215623684631106  Primal_obj =  0.09090441721373095  Gap =  0.06868879352909985 Sum =  1.0026943763304974
Iteration =  8  Dual obj =  0.022229894763958275  Primal_obj =  0.08442169407137182  Gap =  0.062191799307413545 Sum =  1.0011732364116244
Iteration =  9  Dual obj =  0.02224438589700619  Primal_obj =  0.07846943467458445  Gap =  0.05622504877757826 Sum =  1.0004356424120864
Iteration =  10  Dual obj =  0.02225565322732259  Primal_obj =  0.07423196881388168  Gap =  0.05197631558655909 Sum =  1.000309579023194
Iteration =  11  Dual obj =  0.022264955306831324  Primal_obj =  0.07008137021180597  Gap =  0.04781641490497464 Sum =  1.0001350209881874
Iteration =  12  Dual obj =  0.022273293040480736  Primal_obj =  0.06182228204573785  Gap =  0.039548989005257114 Sum =  0.9996911080406631
Iteration =  13  Dual obj =  0.022280478576614523  Primal_obj =  0.055314033006824595  Gap =  0.03303355443021007 Sum =  0.999971070044978
Iteration =  14  Dual obj =  0.02228628656536801  Primal_obj =  0.05208925421067678  Gap =  0.02980296764530877 Sum =  1.0004907405978054
Iteration =  15  Dual obj =  0.022291654956328878  Primal_obj =  0.05006228550897304  Gap =  0.027770630552644164 Sum =  1.000215884100961
Iteration =  16  Dual obj =  0.0222963003347178  Primal_obj =  0.04648459987293735  Gap =  0.02418829953821955 Sum =  0.9998064138168479
Iteration =  17  Dual obj =  0.022300207473171907  Primal_obj =  0.04698320324942423  Gap =  0.024682995776252326 Sum =  1.000376707876211
Iteration =  18  Dual obj =  0.022303485634605838  Primal_obj =  0.04513289740713966  Gap =  0.022829411772533822 Sum =  0.9997170505188337
Iteration =  19  Dual obj =  0.022307021342419985  Primal_obj =  0.04357353998914276  Gap =  0.021266518646722778 Sum =  1.0001870838569986
Iteration =  20  Dual obj =  0.022311015214651057  Primal_obj =  0.04374421649701869  Gap =  0.021433201282367635 Sum =  1.0006062696382947
Iteration =  21  Dual obj =  0.022314266903085144  Primal_obj =  0.044915571380721914  Gap =  0.02260130447763677 Sum =  1.000773577271353
Iteration =  22  Dual obj =  0.022317572501935935  Primal_obj =  0.047473603743794  Gap =  0.025156031241858067 Sum =  1.0000306959435505
Iteration =  23  Dual obj =  0.02232115980774392  Primal_obj =  0.04313419365776777  Gap =  0.02081303385002385 Sum =  1.0000314197995186
Iteration =  24  Dual obj =  0.022324290980606322  Primal_obj =  0.040630874037500514  Gap =  0.018306583056894192 Sum =  1.0003018846048557
Iteration =  0  Dual obj =  0.022324290980606322  Primal_obj =  0.040630874037500514  Gap =  0.018306583056894192 Sum =  1.0003018846048557
Iteration =  1  Dual obj =  0.022325509424950363  Primal_obj =  0.0385594334866991  Gap =  0.01623392406174874 Sum =  1.0001429669838298
Iteration =  2  Dual obj =  0.02232660739302173  Primal_obj =  0.03653278035712085  Gap =  0.014206172964099116 Sum =  1.0003738292750577
Iteration =  3  Dual obj =  0.022327495387824622  Primal_obj =  0.0350504415416885  Gap =  0.012722946153863879 Sum =  1.0001540796815551
Iteration =  4  Dual obj =  0.0223286508950849  Primal_obj =  0.033592393684111155  Gap =  0.011263742789026254 Sum =  1.0002918888065553
Iteration =  5  Dual obj =  0.02232969337539746  Primal_obj =  0.032845340351010985  Gap =  0.010515646975613524 Sum =  1.0002830305077
Iteration =  6  Dual obj =  0.02233094895363949  Primal_obj =  0.03240414403114278  Gap =  0.010073195077503289 Sum =  1.000205149408086
Iteration =  7  Dual obj =  0.022331640156310388  Primal_obj =  0.032096246084394195  Gap =  0.009764605928083807 Sum =  1.0000039438571728
Iteration =  8  Dual obj =  0.022332329288688172  Primal_obj =  0.03201159299855667  Gap =  0.009679263709868501 Sum =  1.0000023371652091
Iteration =  9  Dual obj =  0.022333402626660222  Primal_obj =  0.03192345771780511  Gap =  0.009590055091144887 Sum =  0.9996835483328521
Iteration =  10  Dual obj =  0.02233520731094535  Primal_obj =  0.03314724815137872  Gap =  0.01081204084043337 Sum =  0.9999295951605462
Iteration =  11  Dual obj =  0.022336442635083734  Primal_obj =  0.034147424992681655  Gap =  0.011810982357597921 Sum =  0.9997019173730812
Iteration =  12  Dual obj =  0.022337631666643706  Primal_obj =  0.03411802486742302  Gap =  0.011780393200779313 Sum =  0.9998650959543383
Iteration =  13  Dual obj =  0.022339436806282413  Primal_obj =  0.03404176776972838  Gap =  0.011702330963445966 Sum =  0.9998650691573724
Iteration =  14  Dual obj =  0.022341081435264885  Primal_obj =  0.03343860746659834  Gap =  0.011097526031333453 Sum =  0.9998851576900181
Iteration =  15  Dual obj =  0.02234247761721662  Primal_obj =  0.03390778525620328  Gap =  0.011565307638986656 Sum =  1.0000344907407401
Iteration =  16  Dual obj =  0.02234371768014662  Primal_obj =  0.03398908112490452  Gap =  0.011645363444757903 Sum =  1.000226205792487
Iteration =  17  Dual obj =  0.02234476088521956  Primal_obj =  0.03308309967227267  Gap =  0.010738338787053114 Sum =  1.0000464617495486
Iteration =  18  Dual obj =  0.022345868945361426  Primal_obj =  0.03187296074703365  Gap =  0.009527091801672223 Sum =  1.0000897218233349
Iteration =  19  Dual obj =  0.02234672998804954  Primal_obj =  0.0313089653262803  Gap =  0.008962235338230762 Sum =  1.0000243071834254
Iteration =  20  Dual obj =  0.022347408297935484  Primal_obj =  0.030776264911533846  Gap =  0.008428856613598362 Sum =  1.0001332947862962
Iteration =  21  Dual obj =  0.02234840620755306  Primal_obj =  0.030504946805592487  Gap =  0.008156540598039427 Sum =  1.000166881893409
Iteration =  22  Dual obj =  0.02234914874603481  Primal_obj =  0.030362265458925605  Gap =  0.008013116712890796 Sum =  1.0002601492046994
Iteration =  23  Dual obj =  0.022349713134072646  Primal_obj =  0.02965438800129358  Gap =  0.0073046748672209345 Sum =  1.0003593099524553
Iteration =  24  Dual obj =  0.02235032685870147  Primal_obj =  0.02893354344396841  Gap =  0.0065832165852669385 Sum =  1.0001511495627144
Iteration =  0  Dual obj =  0.02235032685870147  Primal_obj =  0.02893354344396841  Gap =  0.0065832165852669385 Sum =  1.0001511495627144
Iteration =  1  Dual obj =  0.022350678755937693  Primal_obj =  0.02831158756655787  Gap =  0.005960908810620176 Sum =  1.000120477887353
Iteration =  2  Dual obj =  0.022350902904087547  Primal_obj =  0.027985605220969406  Gap =  0.005634702316881859 Sum =  1.0001192571570545
Iteration =  3  Dual obj =  0.022351166036239482  Primal_obj =  0.027630208490687466  Gap =  0.005279042454447984 Sum =  1.0000082878564411
Iteration =  4  Dual obj =  0.022351504474376345  Primal_obj =  0.027192517833096078  Gap =  0.004841013358719733 Sum =  1.0000758311952707
Iteration =  5  Dual obj =  0.022351736133986905  Primal_obj =  0.026999849136780496  Gap =  0.004648113002793591 Sum =  1.0001105616202615
Iteration =  6  Dual obj =  0.022352042031583898  Primal_obj =  0.026746437368553005  Gap =  0.004394395336969108 Sum =  1.0001353194515006
Iteration =  7  Dual obj =  0.022352351044165813  Primal_obj =  0.026590677798830592  Gap =  0.004238326754664779 Sum =  1.0001127685907356
Iteration =  8  Dual obj =  0.022352599853794865  Primal_obj =  0.026536213736884515  Gap =  0.004183613883089649 Sum =  1.0000257967462234
Iteration =  9  Dual obj =  0.02235278951514838  Primal_obj =  0.026556908170167023  Gap =  0.004204118655018643 Sum =  1.0000613564946668
Iteration =  10  Dual obj =  0.02235296189480809  Primal_obj =  0.02644171246742813  Gap =  0.00408875057262004 Sum =  0.999975159256121
Iteration =  11  Dual obj =  0.022353191285981955  Primal_obj =  0.02634624185955088  Gap =  0.0039930505735689265 Sum =  0.9998946930856876
Iteration =  12  Dual obj =  0.022353547261720924  Primal_obj =  0.02640757413427991  Gap =  0.004054026872558986 Sum =  0.9999346715854363
Iteration =  13  Dual obj =  0.02235391239784152  Primal_obj =  0.026599382487567727  Gap =  0.004245470089726207 Sum =  0.999760355438999
Iteration =  14  Dual obj =  0.022354361927622503  Primal_obj =  0.026752571054729585  Gap =  0.004398209127107082 Sum =  0.9996852378933044
Iteration =  15  Dual obj =  0.022354789797301843  Primal_obj =  0.026923025099656023  Gap =  0.00456823530235418 Sum =  0.9997560645657748
Iteration =  16  Dual obj =  0.022355201798621348  Primal_obj =  0.02693745376753333  Gap =  0.004582251968911981 Sum =  0.9998499337274089
Iteration =  17  Dual obj =  0.022355491786061728  Primal_obj =  0.026950913646364913  Gap =  0.004595421860303185 Sum =  1.0000069878747462
Iteration =  18  Dual obj =  0.02235582962909878  Primal_obj =  0.026873401662330446  Gap =  0.004517572033231665 Sum =  1.0000929475569438
Iteration =  19  Dual obj =  0.022356235843573158  Primal_obj =  0.026601497670573  Gap =  0.004245261826999844 Sum =  1.000074937618902
Iteration =  20  Dual obj =  0.02235664141960409  Primal_obj =  0.026290624800108825  Gap =  0.003933983380504734 Sum =  1.0001591955416704
Iteration =  21  Dual obj =  0.022356914366552315  Primal_obj =  0.02604033292415739  Gap =  0.003683418557605074 Sum =  1.0001703316628194
Iteration =  22  Dual obj =  0.022357221700152523  Primal_obj =  0.025876025041195086  Gap =  0.003518803341042563 Sum =  1.0001082278828184
Iteration =  23  Dual obj =  0.022357555574490946  Primal_obj =  0.02583690539908083  Gap =  0.0034793498245898856 Sum =  0.9999946182549244
Iteration =  24  Dual obj =  0.022357813533385014  Primal_obj =  0.025662892973352877  Gap =  0.003305079439967863 Sum =  0.9999843900165504
Done, writing results...
