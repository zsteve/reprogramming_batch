2021-04-29 13:04:02,993 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.15s.
2021-04-29 13:04:03,431 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.23s.
2021-04-29 13:04:03,830 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 13:04:03,952 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-29 13:04:03,955 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 13:04:03,965 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 13:04:04,837 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 118.
2021-04-29 13:04:04,838 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.89s.
Iteration =  0  Dual obj =  -35.17424432439333  Primal_obj =  31935.84354180082  Gap =  31971.017786125212 Sum =  410.0890064212083
Iteration =  1  Dual obj =  -0.03081242769777283  Primal_obj =  20.84375368286605  Gap =  20.874566110563823 Sum =  1.007657877197592
Iteration =  2  Dual obj =  0.012297279736865736  Primal_obj =  8.27911228250309  Gap =  8.266815002766226 Sum =  0.7895698887811229
Iteration =  3  Dual obj =  0.03154747271350699  Primal_obj =  4.007797648741439  Gap =  3.9762501760279325 Sum =  0.7976750844048799
Iteration =  4  Dual obj =  0.039262322891130706  Primal_obj =  2.277070205740938  Gap =  2.2378078828498076 Sum =  0.9031156375152816
Iteration =  5  Dual obj =  0.04356634611439324  Primal_obj =  0.9412985949518671  Gap =  0.8977322488374738 Sum =  1.0023371598375865
Iteration =  6  Dual obj =  0.044828498799109634  Primal_obj =  0.39989231576170425  Gap =  0.3550638169625946 Sum =  1.0087576350948266
Iteration =  7  Dual obj =  0.04523234294422092  Primal_obj =  0.21144532814932665  Gap =  0.16621298520510575 Sum =  0.9958358989471634
Iteration =  8  Dual obj =  0.045370960753766065  Primal_obj =  0.13155893750023104  Gap =  0.08618797674646497 Sum =  0.9942049994627385
Iteration =  9  Dual obj =  0.045432321987367554  Primal_obj =  0.10118850186931073  Gap =  0.05575617988194318 Sum =  0.9988519062763286
Iteration =  10  Dual obj =  0.045459099072248446  Primal_obj =  0.07485538311013606  Gap =  0.02939628403788762 Sum =  0.9996567528464753
Iteration =  11  Dual obj =  0.04546967873187924  Primal_obj =  0.06129965941307866  Gap =  0.015829980681199424 Sum =  0.998424850901589
Iteration =  12  Dual obj =  0.04547448937939333  Primal_obj =  0.054441961351226156  Gap =  0.008967471971832827 Sum =  0.9993432238779452
Iteration =  13  Dual obj =  0.045477079958070724  Primal_obj =  0.05115950359089656  Gap =  0.005682423632825839 Sum =  0.9999518401176786
Iteration =  14  Dual obj =  0.045479103146372664  Primal_obj =  0.049075438021923865  Gap =  0.0035963348755512006 Sum =  0.9997226474146783
Iteration =  15  Dual obj =  0.04548061865164618  Primal_obj =  0.04786419789339455  Gap =  0.002383579241748368 Sum =  0.9995663615013537
Iteration =  16  Dual obj =  0.0454816058954876  Primal_obj =  0.04721784674507255  Gap =  0.001736240849584951 Sum =  0.9997615207361136
Iteration =  17  Dual obj =  0.04548228293371863  Primal_obj =  0.046797518439991206  Gap =  0.0013152355062725773 Sum =  1.0000691452110493
Iteration =  18  Dual obj =  0.04548280117002891  Primal_obj =  0.046542729953919296  Gap =  0.0010599287838903848 Sum =  0.9998822600250761
Iteration =  19  Dual obj =  0.04548321279797547  Primal_obj =  0.046344170129273984  Gap =  0.0008609573312985119 Sum =  0.9998057425149693
Iteration =  20  Dual obj =  0.04548353905700918  Primal_obj =  0.04621515996725077  Gap =  0.0007316209102415927 Sum =  1.000054488714737
Iteration =  21  Dual obj =  0.0454838191337219  Primal_obj =  0.04611218902109544  Gap =  0.0006283698873735394 Sum =  1.0000201246381972
Iteration =  22  Dual obj =  0.045484040471670685  Primal_obj =  0.04600043565477689  Gap =  0.0005163951831062066 Sum =  0.9999036855321701
Iteration =  23  Dual obj =  0.04548422424288664  Primal_obj =  0.04592870096644602  Gap =  0.0004444767235593852 Sum =  0.999838490643798
Iteration =  24  Dual obj =  0.04548438554227281  Primal_obj =  0.04587309430956239  Gap =  0.0003887087672895806 Sum =  0.9999372938199402
Iteration =  0  Dual obj =  -26.387647058278322  Primal_obj =  25039.498373051672  Gap =  25065.886020109952 Sum =  410.0890064212083
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.062054596277308166  Primal_obj =  14.87615530806949  Gap =  14.938209904346799 Sum =  0.43666041833684954
Iteration =  3  Dual obj =  0.008106623534818995  Primal_obj =  13.172295782388426  Gap =  13.164189158853608 Sum =  0.7341611167212047
Iteration =  4  Dual obj =  0.03583001784071313  Primal_obj =  7.224406566474281  Gap =  7.188576548633568 Sum =  0.7475341606320771
Iteration =  5  Dual obj =  0.04601779720022549  Primal_obj =  3.9825814400611934  Gap =  3.936563642860968 Sum =  0.7947033073054011
Iteration =  6  Dual obj =  0.049857068486159534  Primal_obj =  2.727263951231153  Gap =  2.6774068827449935 Sum =  0.8576337301713057
Iteration =  7  Dual obj =  0.053020954645047705  Primal_obj =  2.248864807477273  Gap =  2.1958438528322253 Sum =  0.8692034464749839
Iteration =  8  Dual obj =  0.05523489035017241  Primal_obj =  1.913473623153629  Gap =  1.8582387328034564 Sum =  0.9242735739428776
Iteration =  9  Dual obj =  0.05670370112067119  Primal_obj =  1.4280380192255662  Gap =  1.371334318104895 Sum =  0.9516733307872665
Iteration =  10  Dual obj =  0.05768297296367747  Primal_obj =  0.8821502572224188  Gap =  0.8244672842587413 Sum =  0.9642640761307483
Iteration =  11  Dual obj =  0.05821242218784983  Primal_obj =  0.7411432568535449  Gap =  0.682930834665695 Sum =  0.9802208696502597
Iteration =  12  Dual obj =  0.05860169368164706  Primal_obj =  0.5704969715858771  Gap =  0.5118952779042301 Sum =  0.9865508133434422
Iteration =  13  Dual obj =  0.0588548206805822  Primal_obj =  0.4646793986398963  Gap =  0.40582457795931415 Sum =  0.9893770914795634
Iteration =  14  Dual obj =  0.059031027243768464  Primal_obj =  0.3888730805321842  Gap =  0.32984205328841576 Sum =  0.9953531899699424
Iteration =  15  Dual obj =  0.05914378692889842  Primal_obj =  0.29657408705255306  Gap =  0.23743030012365463 Sum =  0.9948585732594407
Iteration =  16  Dual obj =  0.059206780189388165  Primal_obj =  0.2552149507590592  Gap =  0.19600817056967104 Sum =  0.9971587496873938
Iteration =  17  Dual obj =  0.05925628708612153  Primal_obj =  0.23032072976066176  Gap =  0.17106444267454024 Sum =  0.998260052994522
Iteration =  18  Dual obj =  0.059292356845887656  Primal_obj =  0.20590710178011573  Gap =  0.14661474493422808 Sum =  1.0020170304350287
Iteration =  19  Dual obj =  0.05932101300979961  Primal_obj =  0.18760547981063963  Gap =  0.12828446680084002 Sum =  1.0004567067651307
Iteration =  20  Dual obj =  0.059347522547159706  Primal_obj =  0.17873600371394044  Gap =  0.11938848116678073 Sum =  1.0003334370051098
Iteration =  21  Dual obj =  0.05937288551865864  Primal_obj =  0.16470476158082675  Gap =  0.10533187606216812 Sum =  1.0006809969238488
Iteration =  22  Dual obj =  0.05939397527845075  Primal_obj =  0.15080925417999091  Gap =  0.09141527890154016 Sum =  1.0010048863505334
Iteration =  23  Dual obj =  0.059414484892203426  Primal_obj =  0.14742388878520346  Gap =  0.08800940389300003 Sum =  1.0004490156873604
Iteration =  24  Dual obj =  0.059431541847227556  Primal_obj =  0.13125509225842613  Gap =  0.07182355041119858 Sum =  1.0004904923576314
Iteration =  0  Dual obj =  0.059431541847227556  Primal_obj =  0.13125509225842613  Gap =  0.07182355041119858 Sum =  1.0004904923576314
Iteration =  1  Dual obj =  0.05943907620370534  Primal_obj =  0.12422815918570619  Gap =  0.06478908298200085 Sum =  1.000101781691738
Iteration =  2  Dual obj =  0.05944633889030168  Primal_obj =  0.11310876774189807  Gap =  0.05366242885159639 Sum =  1.0003330895704508
Iteration =  3  Dual obj =  0.05945148175763272  Primal_obj =  0.10600564411149549  Gap =  0.04655416235386277 Sum =  0.9993403922205345
Iteration =  4  Dual obj =  0.05945672348010471  Primal_obj =  0.10476733920851165  Gap =  0.045310615728406944 Sum =  0.9994418615404369
Iteration =  5  Dual obj =  0.059462989520738654  Primal_obj =  0.10149209625808119  Gap =  0.04202910673734253 Sum =  0.9998822453654193
Iteration =  6  Dual obj =  0.05946945015031892  Primal_obj =  0.09965930605027981  Gap =  0.040189855899960894 Sum =  1.0004298989745957
Iteration =  7  Dual obj =  0.05947559191629355  Primal_obj =  0.09725862045922298  Gap =  0.037783028542929434 Sum =  1.0007658406923212
Iteration =  8  Dual obj =  0.059481016398237725  Primal_obj =  0.09157717798180678  Gap =  0.03209616158356906 Sum =  1.0001477601382298
Iteration =  9  Dual obj =  0.05948702459629868  Primal_obj =  0.08873631123004133  Gap =  0.029249286633742655 Sum =  1.000619846296882
Iteration =  10  Dual obj =  0.05949220362567719  Primal_obj =  0.08527164875704152  Gap =  0.025779445131364327 Sum =  1.0001236938033087
Iteration =  11  Dual obj =  0.059497659387756516  Primal_obj =  0.08510977289127111  Gap =  0.025612113503514597 Sum =  0.9997330381359183
Iteration =  12  Dual obj =  0.05950144236196922  Primal_obj =  0.08301646185322534  Gap =  0.023515019491256117 Sum =  0.9997076358091068
Iteration =  13  Dual obj =  0.05950422986175549  Primal_obj =  0.0807918760298665  Gap =  0.021287646168111005 Sum =  0.9998661598576796
Iteration =  14  Dual obj =  0.059506906327718975  Primal_obj =  0.07726527237681997  Gap =  0.017758366049101 Sum =  0.9995009821088527
Iteration =  15  Dual obj =  0.05950928953340755  Primal_obj =  0.07470034184682842  Gap =  0.01519105231342087 Sum =  0.9990969232678018
Iteration =  16  Dual obj =  0.059511235051580715  Primal_obj =  0.07293394929068527  Gap =  0.013422714239104551 Sum =  0.9987599700289449
Iteration =  17  Dual obj =  0.059513073876978954  Primal_obj =  0.07180733022085713  Gap =  0.012294256343878172 Sum =  0.9991505652563428
Iteration =  18  Dual obj =  0.05951465662890739  Primal_obj =  0.07102084471140711  Gap =  0.011506188082499723 Sum =  0.9997287474841459
Iteration =  19  Dual obj =  0.05951583892818006  Primal_obj =  0.07040891801106812  Gap =  0.010893079082888057 Sum =  0.9997785336495436
Iteration =  20  Dual obj =  0.05951716014535109  Primal_obj =  0.06970465768531907  Gap =  0.010187497539967977 Sum =  0.9998502828231466
Iteration =  21  Dual obj =  0.059518483461365956  Primal_obj =  0.06933667148447918  Gap =  0.009818188023113225 Sum =  1.000474465860832
Iteration =  22  Dual obj =  0.05951952756844949  Primal_obj =  0.06945132648191153  Gap =  0.00993179891346204 Sum =  1.0008796190322693
Iteration =  23  Dual obj =  0.05952048134196068  Primal_obj =  0.06936886171567744  Gap =  0.009848380373716756 Sum =  1.000659828861315
Iteration =  24  Dual obj =  0.059521491981853275  Primal_obj =  0.06961935344642536  Gap =  0.010097861464572089 Sum =  1.0006281940713029
Iteration =  0  Dual obj =  0.059521491981853275  Primal_obj =  0.06961935344642536  Gap =  0.010097861464572089 Sum =  1.0006281940713029
Iteration =  1  Dual obj =  0.05952202666095814  Primal_obj =  0.06898152625120693  Gap =  0.00945949959024879 Sum =  1.000592088689301
Iteration =  2  Dual obj =  0.059522828209853204  Primal_obj =  0.06785389318060878  Gap =  0.008331064970755572 Sum =  1.0006940235670032
Iteration =  3  Dual obj =  0.05952368457328361  Primal_obj =  0.06680809110391785  Gap =  0.007284406530634238 Sum =  1.0003975462131847
Iteration =  4  Dual obj =  0.059524393755213345  Primal_obj =  0.06608510571057914  Gap =  0.006560711955365797 Sum =  1.0001728004435728
Iteration =  5  Dual obj =  0.05952492382457832  Primal_obj =  0.06563853889695194  Gap =  0.006113615072373617 Sum =  1.0000381855744027
Iteration =  6  Dual obj =  0.059525354436714355  Primal_obj =  0.0653367058037694  Gap =  0.0058113513670550385 Sum =  0.9998490968965394
Iteration =  7  Dual obj =  0.059526012043274235  Primal_obj =  0.0649926216343211  Gap =  0.0054666095910468615 Sum =  0.999659795015341
Iteration =  8  Dual obj =  0.059526561907314327  Primal_obj =  0.06481335399288232  Gap =  0.005286792085567996 Sum =  0.9995927538705256
Iteration =  9  Dual obj =  0.059526878601941724  Primal_obj =  0.0648347775724241  Gap =  0.00530789897048238 Sum =  0.999713159922229
Iteration =  10  Dual obj =  0.05952725435165836  Primal_obj =  0.06493302976532017  Gap =  0.005405775413661815 Sum =  0.999909459185786
Iteration =  11  Dual obj =  0.059527618127284104  Primal_obj =  0.06507749468454474  Gap =  0.005549876557260636 Sum =  0.9999837935351666
Iteration =  12  Dual obj =  0.059528137251521854  Primal_obj =  0.06506967721132181  Gap =  0.00554153995979996 Sum =  1.0000861988214726
Iteration =  13  Dual obj =  0.0595287191649059  Primal_obj =  0.06498447352816175  Gap =  0.005455754363255849 Sum =  0.9998488735923152
Iteration =  14  Dual obj =  0.05952926097079527  Primal_obj =  0.06492905567773039  Gap =  0.005399794706935114 Sum =  0.9997147696858912
Iteration =  15  Dual obj =  0.059529946621165716  Primal_obj =  0.06499149243289273  Gap =  0.005461545811727017 Sum =  0.9998169514833025
Iteration =  16  Dual obj =  0.059530793934367845  Primal_obj =  0.06528379506959334  Gap =  0.005753001135225491 Sum =  0.9995436825740289
Iteration =  17  Dual obj =  0.05953164607601721  Primal_obj =  0.06542817362362814  Gap =  0.005896527547610934 Sum =  0.9997084340620526
Iteration =  18  Dual obj =  0.05953229405387151  Primal_obj =  0.06550397965772664  Gap =  0.00597168560385513 Sum =  0.9999529900217055
Iteration =  19  Dual obj =  0.05953290687023398  Primal_obj =  0.06578788611260358  Gap =  0.006254979242369604 Sum =  1.0002680701717188
Iteration =  20  Dual obj =  0.059533410685485316  Primal_obj =  0.06593406095642244  Gap =  0.006400650270937128 Sum =  1.0002766365618783
Iteration =  21  Dual obj =  0.059533945320483755  Primal_obj =  0.06589116208459175  Gap =  0.006357216764107998 Sum =  1.0000171271944347
Iteration =  22  Dual obj =  0.05953448936334549  Primal_obj =  0.06574162023411745  Gap =  0.00620713087077196 Sum =  1.0002241354004413
Iteration =  23  Dual obj =  0.059535077987039886  Primal_obj =  0.06551938087207206  Gap =  0.0059843028850321695 Sum =  1.000045046759714
Iteration =  24  Dual obj =  0.05953566001974465  Primal_obj =  0.0655821836746632  Gap =  0.006046523654918555 Sum =  0.9998518417231729
Iteration =  0  Dual obj =  0.05953566001974465  Primal_obj =  0.0655821836746632  Gap =  0.006046523654918555 Sum =  0.9998518417231729
Iteration =  1  Dual obj =  0.059535884476223225  Primal_obj =  0.06521154635680891  Gap =  0.005675661880585686 Sum =  0.9998326821546497
Iteration =  2  Dual obj =  0.059536138531756835  Primal_obj =  0.06471692725859182  Gap =  0.005180788726834987 Sum =  0.9999697804433708
Iteration =  3  Dual obj =  0.05953639343817824  Primal_obj =  0.0641436593256075  Gap =  0.004607265887429268 Sum =  1.0000379470489233
Iteration =  4  Dual obj =  0.059536618693540655  Primal_obj =  0.06366380625774426  Gap =  0.004127187564203605 Sum =  1.0001728000467955
Iteration =  5  Dual obj =  0.059536849964383846  Primal_obj =  0.06316540508821214  Gap =  0.0036285551238282934 Sum =  1.000236278323797
Iteration =  6  Dual obj =  0.059537071126171  Primal_obj =  0.06280939759260165  Gap =  0.00327232646643065 Sum =  1.0001234024652594
Iteration =  7  Dual obj =  0.05953724539443825  Primal_obj =  0.06255882081480882  Gap =  0.0030215754203705703 Sum =  0.999973563578778
Iteration =  8  Dual obj =  0.05953736456400913  Primal_obj =  0.06241126193235605  Gap =  0.0028738973683469157 Sum =  0.999949089422487
Iteration =  9  Dual obj =  0.059537486987483366  Primal_obj =  0.06225785844066167  Gap =  0.0027203714531783066 Sum =  0.9998768387458626
Iteration =  10  Dual obj =  0.05953762967084178  Primal_obj =  0.062115065709439476  Gap =  0.002577436038597697 Sum =  0.9999309639342199
Iteration =  11  Dual obj =  0.05953769576697293  Primal_obj =  0.062063064830525747  Gap =  0.0025253690635528153 Sum =  0.9999857309941641
Iteration =  12  Dual obj =  0.059537784817545125  Primal_obj =  0.062005184020169433  Gap =  0.0024673992026243083 Sum =  1.0000762453128305
Iteration =  13  Dual obj =  0.05953788786997041  Primal_obj =  0.061964410637589055  Gap =  0.0024265227676186427 Sum =  1.0001657261378067
Iteration =  14  Dual obj =  0.059538061101845445  Primal_obj =  0.06189196619469401  Gap =  0.0023539050928485655 Sum =  1.0001969863055948
Iteration =  15  Dual obj =  0.05953825322026729  Primal_obj =  0.06181313428536406  Gap =  0.0022748810650967677 Sum =  1.0000564976037565
Iteration =  16  Dual obj =  0.05953828237569102  Primal_obj =  0.06179634396131545  Gap =  0.0022580615856244296 Sum =  1.000057487210705
Iteration =  17  Dual obj =  0.05953841951784292  Primal_obj =  0.0617832856760647  Gap =  0.002244866158221774 Sum =  0.9999441090906933
Iteration =  18  Dual obj =  0.05953857178632784  Primal_obj =  0.06174729302272509  Gap =  0.002208721236397246 Sum =  0.9998004795355611
Iteration =  19  Dual obj =  0.059538762727536505  Primal_obj =  0.06172337790528018  Gap =  0.002184615177743675 Sum =  0.9997722431614896
Iteration =  20  Dual obj =  0.05953900799119921  Primal_obj =  0.06179535351859299  Gap =  0.0022563455273937813 Sum =  0.9998149047859365
Iteration =  21  Dual obj =  0.059539222335188755  Primal_obj =  0.06186830948439568  Gap =  0.002329087149206925 Sum =  0.9999450987915661
Iteration =  22  Dual obj =  0.05953939412665871  Primal_obj =  0.062027754312073545  Gap =  0.0024883601854148382 Sum =  0.9999210784594181
Iteration =  23  Dual obj =  0.05953955483074831  Primal_obj =  0.06194468084374478  Gap =  0.0024051260129964655 Sum =  0.9999903504418337
Iteration =  24  Dual obj =  0.05953967281572192  Primal_obj =  0.061848889400390065  Gap =  0.002309216584668143 Sum =  1.000000834942857
Done, writing results...
