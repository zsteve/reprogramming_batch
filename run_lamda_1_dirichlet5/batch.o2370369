2021-04-28 18:29:46,155 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 2.96s.
2021-04-28 18:29:46,556 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.21s.
2021-04-28 18:29:46,927 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.37s.
2021-04-28 18:29:47,036 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-28 18:29:47,039 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-28 18:29:47,048 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-28 18:29:47,805 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 107.
2021-04-28 18:29:47,806 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.77s.
Iteration =  0  Dual obj =  -33.90317555705042  Primal_obj =  3326852.06673709  Gap =  3326885.969912647 Sum =  468.7514719966008
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.05945517502810056  Primal_obj =  5021.49848728509  Gap =  5021.557942460118 Sum =  0.9592986310691838
Iteration =  3  Dual obj =  0.14483141298286323  Primal_obj =  2385.9639926629084  Gap =  2385.8191612499254 Sum =  0.5602622375619641
Iteration =  4  Dual obj =  0.24041356134342612  Primal_obj =  1495.232805546  Gap =  1494.9923919846565 Sum =  0.468068941540692
Iteration =  5  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  6  Dual obj =  0.28172987217171647  Primal_obj =  826.870964506871  Gap =  826.5892346346993 Sum =  0.47456284709639596
Iteration =  7  Dual obj =  0.3301332452247986  Primal_obj =  520.199797881931  Gap =  519.8696646367061 Sum =  0.956075892411642
Iteration =  8  Dual obj =  0.3432017497859955  Primal_obj =  110.10967428963772  Gap =  109.76647253985173 Sum =  1.074613993930732
Iteration =  9  Dual obj =  0.3486014080130686  Primal_obj =  50.731626042208404  Gap =  50.38302463419534 Sum =  1.0589767275638573
Iteration =  10  Dual obj =  0.3508421672705118  Primal_obj =  20.136736741250587  Gap =  19.785894573980077 Sum =  1.0341590077096376
Iteration =  11  Dual obj =  0.35152542773371964  Primal_obj =  9.459596993825222  Gap =  9.108071566091503 Sum =  1.0091582254429965
Iteration =  12  Dual obj =  0.3517703027565256  Primal_obj =  3.959228570159972  Gap =  3.6074582674034463 Sum =  0.9982437921521087
Iteration =  13  Dual obj =  0.351874248244261  Primal_obj =  1.6864622234924487  Gap =  1.3345879752481877 Sum =  0.9967085396094848
Iteration =  14  Dual obj =  0.35191069683842663  Primal_obj =  1.146554970610746  Gap =  0.7946442737723194 Sum =  0.9986283454666467
Iteration =  15  Dual obj =  0.3519357000431259  Primal_obj =  1.0217187645174575  Gap =  0.6697830644743316 Sum =  0.9997135220041485
Iteration =  16  Dual obj =  0.3519541744726077  Primal_obj =  0.6808434916488078  Gap =  0.32888931717620007 Sum =  1.0002003382552869
Iteration =  17  Dual obj =  0.3519619106477937  Primal_obj =  0.6288066711058824  Gap =  0.2768447604580887 Sum =  0.9998144411982064
Iteration =  18  Dual obj =  0.3519666339847798  Primal_obj =  0.445348763756872  Gap =  0.0933821297720922 Sum =  0.9998724555134998
Iteration =  19  Dual obj =  0.35196856488400885  Primal_obj =  0.39982885939242285  Gap =  0.047860294508414 Sum =  1.0001084838597525
Iteration =  20  Dual obj =  0.35196962599269765  Primal_obj =  0.40345545485288337  Gap =  0.05148582886018571 Sum =  1.0002406324757733
Iteration =  21  Dual obj =  0.3519714000798899  Primal_obj =  0.41047076678815225  Gap =  0.058499366708262335 Sum =  1.00007228880796
Iteration =  22  Dual obj =  0.3519722593411567  Primal_obj =  0.3683545139269478  Gap =  0.016382254585791067 Sum =  0.9999399927911581
Iteration =  23  Dual obj =  0.35197248827726746  Primal_obj =  0.3573073301534665  Gap =  0.005334841876199037 Sum =  0.9999500056132743
Iteration =  24  Dual obj =  0.35197257319933345  Primal_obj =  0.3583508171656306  Gap =  0.006378243966297159 Sum =  1.0000137317854763
Iteration =  0  Dual obj =  -23.93153739919328  Primal_obj =  2912031.266993582  Gap =  2912055.198530981 Sum =  468.7514719966008
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.1759414684669833  Primal_obj =  11906.36421344166  Gap =  11906.540154910128 Sum =  3.0328753774711243
Iteration =  4  Dual obj =  0.42690126698019626  Primal_obj =  2586.7139439992075  Gap =  2586.2870427322273 Sum =  0.800410785000126
Iteration =  5  Dual obj =  0.5653292479056591  Primal_obj =  2179.10499203894  Gap =  2178.5396627910345 Sum =  0.7919072885568246
Iteration =  6  Dual obj =  0.6962632043200453  Primal_obj =  1869.4358349246588  Gap =  1868.7395717203387 Sum =  0.6470145758518795
Iteration =  7  Dual obj =  0.8048931321430272  Primal_obj =  1761.6091806971688  Gap =  1760.8042875650258 Sum =  0.45306383627061797
Iteration =  8  Dual obj =  0.8895115662236844  Primal_obj =  1109.79116032401  Gap =  1108.9016487577862 Sum =  2.2770748154971194
Iteration =  9  Dual obj =  0.9335199486952989  Primal_obj =  851.8281070931695  Gap =  850.8945871444741 Sum =  1.453337072162277
Iteration =  10  Dual obj =  0.9584794086721538  Primal_obj =  640.1670626887221  Gap =  639.20858328005 Sum =  1.1940664316971414
Iteration =  11  Dual obj =  0.9742187348684159  Primal_obj =  494.68402325033514  Gap =  493.7098045154667 Sum =  1.1488078023033954
Iteration =  12  Dual obj =  0.9867616169063435  Primal_obj =  430.80250649499396  Gap =  429.8157448780876 Sum =  1.1276832141994704
Iteration =  13  Dual obj =  0.9925325636966751  Primal_obj =  189.33914014524058  Gap =  188.3466075815439 Sum =  1.0676988894832702
Iteration =  14  Dual obj =  0.9955854842725248  Primal_obj =  127.52079775008069  Gap =  126.52521226580816 Sum =  1.0715138161380895
Iteration =  15  Dual obj =  0.9979094142505515  Primal_obj =  85.23059681392792  Gap =  84.23268739967736 Sum =  1.0576757596481452
Iteration =  16  Dual obj =  0.9991252249664315  Primal_obj =  35.44937949150973  Gap =  34.4502542665433 Sum =  1.019672223537969
Iteration =  17  Dual obj =  0.9995554605706729  Primal_obj =  14.149285652638744  Gap =  13.149730192068072 Sum =  1.021313964320067
Iteration =  18  Dual obj =  0.9998746652510717  Primal_obj =  13.41852520176987  Gap =  12.418650536518799 Sum =  1.021052675947887
Iteration =  19  Dual obj =  1.0000797092388276  Primal_obj =  8.629479857951065  Gap =  7.629400148712238 Sum =  1.0063021517994457
Iteration =  20  Dual obj =  1.000184372836984  Primal_obj =  5.062302132590524  Gap =  4.062117759753541 Sum =  1.003364535198989
Iteration =  21  Dual obj =  1.0002294931348068  Primal_obj =  3.34525413251148  Gap =  2.3450246393766734 Sum =  1.0036478292135564
Iteration =  22  Dual obj =  1.0002571380907916  Primal_obj =  3.0323818834051286  Gap =  2.032124745314337 Sum =  1.00061467863748
Iteration =  23  Dual obj =  1.0002752770948136  Primal_obj =  2.513077406842316  Gap =  1.5128021297475023 Sum =  0.9987499578509286
Iteration =  24  Dual obj =  1.0002880119163597  Primal_obj =  2.0839523682029024  Gap =  1.0836643562865427 Sum =  0.9990843975385453
Iteration =  0  Dual obj =  1.0002880119163597  Primal_obj =  2.0839523682029024  Gap =  1.0836643562865427 Sum =  0.9990843975385453
Iteration =  1  Dual obj =  1.0002960695389003  Primal_obj =  1.5034056679686176  Gap =  0.5031095984297174 Sum =  0.9995967391217593
Iteration =  2  Dual obj =  1.0003031849550876  Primal_obj =  1.5635253197954608  Gap =  0.5632221348403732 Sum =  0.9988259405145705
Iteration =  3  Dual obj =  1.000310609425588  Primal_obj =  1.4777706687278613  Gap =  0.4774600593022733 Sum =  0.9996992380656027
Iteration =  4  Dual obj =  1.0003143721455188  Primal_obj =  1.32794869097431  Gap =  0.3276343188287911 Sum =  0.9997654685906853
Iteration =  5  Dual obj =  1.0003168398859945  Primal_obj =  1.251140798771357  Gap =  0.25082395888536246 Sum =  0.999822132041838
Iteration =  6  Dual obj =  1.000318577163254  Primal_obj =  1.235834078730782  Gap =  0.2355155015675281 Sum =  0.9999980398889186
Iteration =  7  Dual obj =  1.0003204918452262  Primal_obj =  1.1745690294708464  Gap =  0.1742485376256202 Sum =  0.9998811922434601
Iteration =  8  Dual obj =  1.0003220618529536  Primal_obj =  1.1402428867855736  Gap =  0.13992082493262004 Sum =  0.9998403382040559
Iteration =  9  Dual obj =  1.0003230262207254  Primal_obj =  1.1095425242080479  Gap =  0.10921949798732244 Sum =  1.0001835603968243
Iteration =  10  Dual obj =  1.0003239268134463  Primal_obj =  1.0877078018183775  Gap =  0.08738387500493117 Sum =  0.9999274288856929
Iteration =  11  Dual obj =  1.0003245884655683  Primal_obj =  1.0720064836528422  Gap =  0.07168189518727397 Sum =  0.9998592256167596
Iteration =  12  Dual obj =  1.0003250988559595  Primal_obj =  1.0599359060268376  Gap =  0.05961080717087808 Sum =  0.9999531263659329
Iteration =  13  Dual obj =  1.0003255389924326  Primal_obj =  1.0452406983550802  Gap =  0.04491515936264756 Sum =  0.9997845277675492
Iteration =  14  Dual obj =  1.0003258883779063  Primal_obj =  1.043879441969325  Gap =  0.04355355359141866 Sum =  1.0000301551375077
Iteration =  15  Dual obj =  1.000326237273614  Primal_obj =  1.0383645516321907  Gap =  0.03803831435857674 Sum =  0.9998435626563456
Iteration =  16  Dual obj =  1.0003264925587465  Primal_obj =  1.0311480138609963  Gap =  0.0308215213022498 Sum =  1.0000389408188337
Iteration =  17  Dual obj =  1.0003267105897793  Primal_obj =  1.0275369657899  Gap =  0.02721025520012077 Sum =  1.000058924901662
Iteration =  18  Dual obj =  1.0003269115485505  Primal_obj =  1.0269896779023062  Gap =  0.02666276635375575 Sum =  0.9999829077994832
Iteration =  19  Dual obj =  1.0003271372623221  Primal_obj =  1.0224267768574005  Gap =  0.022099639595078324 Sum =  1.0000192844179012
Iteration =  20  Dual obj =  1.0003272650524682  Primal_obj =  1.0186168895068808  Gap =  0.018289624454412623 Sum =  1.0000109029161157
Iteration =  21  Dual obj =  1.0003273636017498  Primal_obj =  1.0139769682467423  Gap =  0.013649604644992541 Sum =  1.0000180668845973
Iteration =  22  Dual obj =  1.0003274454532987  Primal_obj =  1.01382414752434  Gap =  0.013496702071041256 Sum =  1.0000094523239227
Iteration =  23  Dual obj =  1.0003275106686849  Primal_obj =  1.0149513868300974  Gap =  0.014623876161412586 Sum =  0.9999617942018578
Iteration =  24  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  0  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  1  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  2  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  3  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  4  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  5  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  6  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  7  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  8  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  9  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  10  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  11  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  12  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  13  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  14  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  15  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  16  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  17  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  18  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  19  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  20  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  21  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  22  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  23  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  24  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  0  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  1  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  2  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  3  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  4  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  5  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  6  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  7  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  8  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  9  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  10  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  11  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  12  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  13  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  14  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  15  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  16  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  17  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  18  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  19  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  20  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  21  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  22  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  23  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Iteration =  24  Dual obj =  1.000327596495099  Primal_obj =  1.0191904702301482  Gap =  0.018862873735049135 Sum =  1.0000078872358198
Done, writing results...
