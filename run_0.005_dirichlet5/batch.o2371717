2021-04-29 12:23:48,775 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.19s.
2021-04-29 12:23:49,236 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.25s.
2021-04-29 12:23:49,634 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 12:23:49,759 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.13s.
2021-04-29 12:23:49,762 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:23:49,773 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:23:50,643 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 103.
2021-04-29 12:23:50,644 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.88s.
Iteration =  0  Dual obj =  -41.928163745713746  Primal_obj =  21281.500444305253  Gap =  21323.428608050966 Sum =  1063.5069682477624
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.11988197669186412  Primal_obj =  5.462398602420049  Gap =  5.582280579111913 Sum =  0.4603153148528614
Iteration =  3  Dual obj =  -0.05243800258753367  Primal_obj =  2.6401030159352077  Gap =  2.6925410185227414 Sum =  0.8763728290616215
Iteration =  4  Dual obj =  -0.042878953304658476  Primal_obj =  1.0787076949367196  Gap =  1.121586648241378 Sum =  0.9490583651254979
Iteration =  5  Dual obj =  -0.039021359468808636  Primal_obj =  0.5549451129907489  Gap =  0.5939664724595575 Sum =  1.0148745233736993
Iteration =  6  Dual obj =  -0.03746404064910381  Primal_obj =  0.27159336895038105  Gap =  0.30905740959948486 Sum =  1.0386904353994497
Iteration =  7  Dual obj =  -0.03683125287387913  Primal_obj =  0.1565025700552155  Gap =  0.19333382292909462 Sum =  1.0227237178831972
Iteration =  8  Dual obj =  -0.03635773479976557  Primal_obj =  0.09741811809866653  Gap =  0.1337758528984321 Sum =  1.0105056474801826
Iteration =  9  Dual obj =  -0.036050449687191205  Primal_obj =  0.05135494248641992  Gap =  0.08740539217361112 Sum =  1.0153548525606433
Iteration =  10  Dual obj =  -0.035869564889777585  Primal_obj =  0.019178571146162282  Gap =  0.05504813603593987 Sum =  1.0098632062690616
Iteration =  11  Dual obj =  -0.03576267982547713  Primal_obj =  0.0016039020585893182  Gap =  0.03736658188406645 Sum =  1.0037148044899704
Iteration =  12  Dual obj =  -0.035700720607857526  Primal_obj =  -0.012853541583713046  Gap =  0.02284717902414448 Sum =  1.002961281067002
Iteration =  13  Dual obj =  -0.0356683087985755  Primal_obj =  -0.02279698917359535  Gap =  0.01287131962498015 Sum =  1.0017131312398697
Iteration =  14  Dual obj =  -0.03565420161863353  Primal_obj =  -0.02790479151830194  Gap =  0.0077494101003315885 Sum =  1.000384025538819
Iteration =  15  Dual obj =  -0.03564693456707224  Primal_obj =  -0.030866416357819546  Gap =  0.004780518209252696 Sum =  0.9999333060190121
Iteration =  16  Dual obj =  -0.03564314928830121  Primal_obj =  -0.032524148062182096  Gap =  0.0031190012261191127 Sum =  1.000037149268374
Iteration =  17  Dual obj =  -0.03564105857873929  Primal_obj =  -0.033388029708830064  Gap =  0.002253028869909225 Sum =  0.9999694340391933
Iteration =  18  Dual obj =  -0.0356397026060159  Primal_obj =  -0.03392780157411972  Gap =  0.001711901031896182 Sum =  0.9998043666347622
Iteration =  19  Dual obj =  -0.03563875992057413  Primal_obj =  -0.03429510541730914  Gap =  0.0013436545032649919 Sum =  0.9998283412914049
Iteration =  20  Dual obj =  -0.03563810762762867  Primal_obj =  -0.03456515391464851  Gap =  0.0010729537129801625 Sum =  0.9999983184909018
Iteration =  21  Dual obj =  -0.03563762553163647  Primal_obj =  -0.03475641313113344  Gap =  0.0008812124005030328 Sum =  1.0000344034369033
Iteration =  22  Dual obj =  -0.03563725967575737  Primal_obj =  -0.03489943565794469  Gap =  0.0007378240178126799 Sum =  0.9999648233615357
Iteration =  23  Dual obj =  -0.03563698994904515  Primal_obj =  -0.03501024686405092  Gap =  0.000626743084994226 Sum =  1.0000058315426297
Iteration =  24  Dual obj =  -0.03563677780476533  Primal_obj =  -0.035090226902484284  Gap =  0.0005465509022810483 Sum =  1.000012929152639
Iteration =  0  Dual obj =  -63.670204236457714  Primal_obj =  35273.760521499025  Gap =  35337.43072573548 Sum =  1063.5069682477624
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.18117153731780522  Primal_obj =  39.55051615975452  Gap =  39.731687697072324 Sum =  2.3866603216600346
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  5  Dual obj =  -0.12893728447476183  Primal_obj =  7.102904624141171  Gap =  7.231841908615933 Sum =  0.6025612493194227
Iteration =  6  Dual obj =  -0.11590740419935043  Primal_obj =  9.212964829012092  Gap =  9.328872233211444 Sum =  0.6513294215850265
Iteration =  7  Dual obj =  -0.10530463809686794  Primal_obj =  13.984941061179054  Gap =  14.090245699275922 Sum =  0.8718740993094496
Iteration =  8  Dual obj =  -0.09919637714011156  Primal_obj =  14.634809574168782  Gap =  14.734005951308895 Sum =  1.1073200112000992
Iteration =  9  Dual obj =  -0.0931348639686019  Primal_obj =  10.446401193431448  Gap =  10.539536057400051 Sum =  1.158011281924085
Iteration =  10  Dual obj =  -0.08618428146666086  Primal_obj =  10.080573737750194  Gap =  10.166758019216855 Sum =  0.9489793038326961
Iteration =  11  Dual obj =  -0.08025833413720643  Primal_obj =  8.44131642346301  Gap =  8.521574757600215 Sum =  0.9238738800246125
Iteration =  12  Dual obj =  -0.06930666753634608  Primal_obj =  7.387701422915127  Gap =  7.457008090451473 Sum =  0.9546543732067212
Iteration =  13  Dual obj =  -0.0562335398154912  Primal_obj =  5.966766948606871  Gap =  6.023000488422363 Sum =  0.946380097606757
Iteration =  14  Dual obj =  -0.05400798594649077  Primal_obj =  4.9920412817807875  Gap =  5.046049267727279 Sum =  0.9172204941050262
Iteration =  15  Dual obj =  -0.052862478215106284  Primal_obj =  5.017328613385122  Gap =  5.070191091600228 Sum =  0.9115126220151131
Iteration =  16  Dual obj =  -0.05219377449336551  Primal_obj =  5.376433913757208  Gap =  5.4286276882505735 Sum =  0.9176785132862092
Iteration =  17  Dual obj =  -0.04800260717593399  Primal_obj =  5.081760288519159  Gap =  5.129762895695093 Sum =  0.9756111628753773
Iteration =  18  Dual obj =  -0.04498722180507602  Primal_obj =  4.670300594339659  Gap =  4.715287816144736 Sum =  0.9186945533283468
Iteration =  19  Dual obj =  -0.04030130472105891  Primal_obj =  3.3184445487000818  Gap =  3.3587458534211407 Sum =  0.926414759184581
Iteration =  20  Dual obj =  -0.03816578719670033  Primal_obj =  3.403628321645349  Gap =  3.4417941088420494 Sum =  0.9473759884367361
Iteration =  21  Dual obj =  -0.0352231980669245  Primal_obj =  2.6111724434810273  Gap =  2.6463956415479517 Sum =  0.9395635742338893
Iteration =  22  Dual obj =  -0.0337941725558264  Primal_obj =  2.0885824638207526  Gap =  2.122376636376579 Sum =  0.9242488552857426
Iteration =  23  Dual obj =  -0.0329788555031212  Primal_obj =  1.773978354283294  Gap =  1.8069572097864153 Sum =  0.9233796286449343
Iteration =  24  Dual obj =  -0.03191267327689845  Primal_obj =  1.5990649383838704  Gap =  1.6309776116607688 Sum =  0.9466296371517294
Iteration =  0  Dual obj =  -0.03191267327689845  Primal_obj =  1.5990649383838704  Gap =  1.6309776116607688 Sum =  0.9466296371517294
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.031204082976202176  Primal_obj =  1.2400627257721746  Gap =  1.2712668087483767 Sum =  0.9408346230052127
Iteration =  4  Dual obj =  -0.03016333245319644  Primal_obj =  1.0728730866866882  Gap =  1.1030364191398847 Sum =  0.946686084868803
Iteration =  5  Dual obj =  -0.029126591765361958  Primal_obj =  0.893672470520685  Gap =  0.9227990622860469 Sum =  0.9621068012292328
Iteration =  6  Dual obj =  -0.028440066945818895  Primal_obj =  0.8276634550043558  Gap =  0.8561035219501747 Sum =  0.9781702363796676
Iteration =  7  Dual obj =  -0.027861252094715353  Primal_obj =  0.6873311093033521  Gap =  0.7151923613980674 Sum =  0.9800707013774135
Iteration =  8  Dual obj =  -0.02737269078128749  Primal_obj =  0.60590475074618  Gap =  0.6332774415274675 Sum =  0.983847627062821
Iteration =  9  Dual obj =  -0.026985518087800045  Primal_obj =  0.47964287252531546  Gap =  0.5066283906131155 Sum =  0.9859200959741553
Iteration =  10  Dual obj =  -0.026636642711597516  Primal_obj =  0.4091966251500421  Gap =  0.4358332678616396 Sum =  0.9893343865922226
Iteration =  11  Dual obj =  -0.026322466982692243  Primal_obj =  0.34839861951340656  Gap =  0.3747210864960988 Sum =  0.9904916096477521
Iteration =  12  Dual obj =  -0.02607971453874583  Primal_obj =  0.3140240896738973  Gap =  0.3401038042126431 Sum =  0.9945691003744535
Iteration =  13  Dual obj =  -0.025848929634467006  Primal_obj =  0.27440539225688654  Gap =  0.30025432189135354 Sum =  0.9983893466102697
Iteration =  14  Dual obj =  -0.02568763467397156  Primal_obj =  0.24491208307490722  Gap =  0.2705997177488788 Sum =  0.99997644014923
Iteration =  15  Dual obj =  -0.025483489710692767  Primal_obj =  0.2004251058271133  Gap =  0.22590859553780607 Sum =  1.000717382190806
Iteration =  16  Dual obj =  -0.025342308306705506  Primal_obj =  0.16395708761845318  Gap =  0.18929939592515868 Sum =  1.0010841263267287
Iteration =  17  Dual obj =  -0.025235730393370383  Primal_obj =  0.1354692752134219  Gap =  0.16070500560679227 Sum =  1.003744207347054
Iteration =  18  Dual obj =  -0.02513337309911788  Primal_obj =  0.11221117024285693  Gap =  0.13734454334197482 Sum =  1.0042404225026351
Iteration =  19  Dual obj =  -0.025038378469984898  Primal_obj =  0.09990014197185976  Gap =  0.12493852044184466 Sum =  1.0055434378689185
Iteration =  20  Dual obj =  -0.02495859920204209  Primal_obj =  0.08564773196723399  Gap =  0.11060633116927608 Sum =  1.0060553872086568
Iteration =  21  Dual obj =  -0.024881205013539652  Primal_obj =  0.08740924502370329  Gap =  0.11229045003724294 Sum =  1.0070894570840863
Iteration =  22  Dual obj =  -0.024803872114631115  Primal_obj =  0.07440941505945405  Gap =  0.09921328717408516 Sum =  1.0089409965028042
Iteration =  23  Dual obj =  -0.024736276703385244  Primal_obj =  0.09084316598568999  Gap =  0.11557944268907523 Sum =  1.0081774698470651
Iteration =  24  Dual obj =  -0.02465228701108968  Primal_obj =  0.06707574985401851  Gap =  0.09172803686510819 Sum =  1.0089173204447595
Iteration =  0  Dual obj =  -0.02465228701108968  Primal_obj =  0.06707574985401851  Gap =  0.09172803686510819 Sum =  1.0089173204447595
Iteration =  1  Dual obj =  -0.024614368895398357  Primal_obj =  0.040947881609269904  Gap =  0.06556225050466827 Sum =  1.008049375831859
Iteration =  2  Dual obj =  -0.024586003028887048  Primal_obj =  0.030410997354333086  Gap =  0.05499700038322013 Sum =  1.0069363270900027
Iteration =  3  Dual obj =  -0.024560975251984786  Primal_obj =  0.021025718438230256  Gap =  0.04558669369021504 Sum =  1.0067687241871321
Iteration =  4  Dual obj =  -0.024533298227314808  Primal_obj =  0.0295358231004422  Gap =  0.05406912132775701 Sum =  1.0066598743087243
Iteration =  5  Dual obj =  -0.024500457885210103  Primal_obj =  0.033258330866963004  Gap =  0.05775878875217311 Sum =  1.0061760441875696
Iteration =  6  Dual obj =  -0.024472994853298454  Primal_obj =  0.02441152970010249  Gap =  0.04888452455340095 Sum =  1.0050762164218474
Iteration =  7  Dual obj =  -0.02444299476519065  Primal_obj =  0.02923602255735991  Gap =  0.05367901732255056 Sum =  1.0042936226756969
Iteration =  8  Dual obj =  -0.024410295305019973  Primal_obj =  0.032462742027669494  Gap =  0.05687303733268947 Sum =  1.0042533448941386
Iteration =  9  Dual obj =  -0.02437339713028619  Primal_obj =  0.03198323111303644  Gap =  0.05635662824332263 Sum =  1.0041795023171345
Iteration =  10  Dual obj =  -0.0243407072882685  Primal_obj =  0.029308028364273  Gap =  0.053648735652541496 Sum =  1.002780578226045
Iteration =  11  Dual obj =  -0.024314655378930926  Primal_obj =  0.02132497694142854  Gap =  0.04563963232035947 Sum =  1.001665058695867
Iteration =  12  Dual obj =  -0.02429227166926647  Primal_obj =  0.012331168881515989  Gap =  0.036623440550782455 Sum =  1.0003453176829895
Iteration =  13  Dual obj =  -0.024274811220590053  Primal_obj =  0.007016621775079668  Gap =  0.03129143299566972 Sum =  0.9996032210379484
Iteration =  14  Dual obj =  -0.024262612928115386  Primal_obj =  0.0036757925396782853  Gap =  0.02793840546779367 Sum =  0.9998716411244477
Iteration =  15  Dual obj =  -0.024250995140586193  Primal_obj =  0.004217044602242412  Gap =  0.028468039742828605 Sum =  0.9991721267322282
Iteration =  16  Dual obj =  -0.024240720334619523  Primal_obj =  0.0007138742156348743  Gap =  0.024954594550254398 Sum =  0.9992163871048596
Iteration =  17  Dual obj =  -0.024232655364569363  Primal_obj =  -0.0018997644025811194  Gap =  0.022332890961988244 Sum =  0.9988733149830653
Iteration =  18  Dual obj =  -0.024225836595564133  Primal_obj =  -0.004673046178545567  Gap =  0.019552790417018566 Sum =  0.9988352621506116
Iteration =  19  Dual obj =  -0.024220076632620026  Primal_obj =  -0.006222399897697989  Gap =  0.017997676734922037 Sum =  0.9998573617108548
Iteration =  20  Dual obj =  -0.02421478864190945  Primal_obj =  -0.008848804615228537  Gap =  0.015365984026680914 Sum =  0.9996544830902474
Iteration =  21  Dual obj =  -0.024210432956200484  Primal_obj =  -0.00880743361485388  Gap =  0.015402999341346604 Sum =  1.0004991930443274
Iteration =  22  Dual obj =  -0.024205398186337844  Primal_obj =  -0.008352491316994018  Gap =  0.015852906869343826 Sum =  1.0005628751125282
Iteration =  23  Dual obj =  -0.024199334438235055  Primal_obj =  -0.009127677664085343  Gap =  0.015071656774149712 Sum =  1.0011677101484566
Iteration =  24  Dual obj =  -0.02419529493045506  Primal_obj =  -0.010183278085612466  Gap =  0.014012016844842594 Sum =  1.0003757281884407
Iteration =  0  Dual obj =  -0.02419529493045506  Primal_obj =  -0.010183278085612466  Gap =  0.014012016844842594 Sum =  1.0003757281884407
Iteration =  1  Dual obj =  -0.02419313644546615  Primal_obj =  -0.011898585553646868  Gap =  0.012294550891819283 Sum =  1.000745721360286
Iteration =  2  Dual obj =  -0.024190932034434648  Primal_obj =  -0.013405277571100022  Gap =  0.010785654463334626 Sum =  1.0006248263664188
Iteration =  3  Dual obj =  -0.02418965047918204  Primal_obj =  -0.014045699611476406  Gap =  0.010143950867705635 Sum =  1.0003555382068874
Iteration =  4  Dual obj =  -0.024188346728457856  Primal_obj =  -0.01465541726890239  Gap =  0.009532929459555466 Sum =  1.000176851697295
Iteration =  5  Dual obj =  -0.024186614865332794  Primal_obj =  -0.014972362927254776  Gap =  0.009214251938078018 Sum =  1.0000637961418826
Iteration =  6  Dual obj =  -0.02418551374580436  Primal_obj =  -0.015012327567672748  Gap =  0.009173186178131613 Sum =  0.9997959930489377
Iteration =  7  Dual obj =  -0.024184420910170045  Primal_obj =  -0.015009526325342637  Gap =  0.009174894584827408 Sum =  0.9997828805483266
Iteration =  8  Dual obj =  -0.024182799419933235  Primal_obj =  -0.015109688279101668  Gap =  0.009073111140831567 Sum =  0.9994635369165157
Iteration =  9  Dual obj =  -0.024180715479943066  Primal_obj =  -0.014776682098405061  Gap =  0.009404033381538005 Sum =  0.9999142513873984
Iteration =  10  Dual obj =  -0.02417866209528592  Primal_obj =  -0.014418766200982383  Gap =  0.009759895894303539 Sum =  0.999817808493901
Iteration =  11  Dual obj =  -0.02417652474028121  Primal_obj =  -0.014478684838816758  Gap =  0.009697839901464451 Sum =  0.9998669138816476
Iteration =  12  Dual obj =  -0.02417364669153792  Primal_obj =  -0.014352041398524806  Gap =  0.009821605293013114 Sum =  0.999663927902575
Iteration =  13  Dual obj =  -0.024171135600250155  Primal_obj =  -0.014024276900164001  Gap =  0.010146858700086154 Sum =  0.9998092967040602
Iteration =  14  Dual obj =  -0.024169161380125127  Primal_obj =  -0.014134964082629417  Gap =  0.01003419729749571 Sum =  0.9996965911837881
Iteration =  15  Dual obj =  -0.024167163200982018  Primal_obj =  -0.01513782950682624  Gap =  0.009029333694155778 Sum =  0.9998084250132631
Iteration =  16  Dual obj =  -0.02416555433365283  Primal_obj =  -0.016331148137472204  Gap =  0.007834406196180626 Sum =  0.9997850384685483
Iteration =  17  Dual obj =  -0.024164327771918452  Primal_obj =  -0.017159774146410567  Gap =  0.007004553625507885 Sum =  0.9998074754048362
Iteration =  18  Dual obj =  -0.024162791441670706  Primal_obj =  -0.017976018310021352  Gap =  0.006186773131649354 Sum =  0.999926515273319
Iteration =  19  Dual obj =  -0.024161824137569506  Primal_obj =  -0.018178705978363602  Gap =  0.0059831181592059045 Sum =  0.9999476304831073
Iteration =  20  Dual obj =  -0.024160918158067736  Primal_obj =  -0.018630474403628444  Gap =  0.005530443754439292 Sum =  0.999961619026611
Iteration =  21  Dual obj =  -0.024160155558613925  Primal_obj =  -0.019007732535250718  Gap =  0.005152423023363207 Sum =  0.999844786054686
Iteration =  22  Dual obj =  -0.02415948800560869  Primal_obj =  -0.0192967467715916  Gap =  0.004862741234017091 Sum =  0.9998926756116617
Iteration =  23  Dual obj =  -0.0241587923443815  Primal_obj =  -0.019633270790307897  Gap =  0.004525521554073604 Sum =  1.000010693339341
Iteration =  24  Dual obj =  -0.024158233133895566  Primal_obj =  -0.019892699015776602  Gap =  0.004265534118118964 Sum =  1.00005719546746
Done, writing results...
