2021-04-29 12:23:49,473 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.27s.
2021-04-29 12:23:49,907 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-29 12:23:50,312 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 12:23:50,428 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-29 12:23:50,431 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:23:50,442 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:23:51,262 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 106.
2021-04-29 12:23:51,263 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.83s.
Iteration =  0  Dual obj =  -43.68361420352026  Primal_obj =  18286.414958348327  Gap =  18330.098572551848 Sum =  357.78961431983373
Iteration =  1  Dual obj =  -0.09601063170938368  Primal_obj =  6.820246922873264  Gap =  6.916257554582648 Sum =  0.777191960465742
Iteration =  2  Dual obj =  -0.07291473616913766  Primal_obj =  4.250740059730273  Gap =  4.323654795899411 Sum =  0.8510424760078856
Iteration =  3  Dual obj =  -0.0659389432372066  Primal_obj =  2.4060538677577394  Gap =  2.471992810994946 Sum =  0.8836082358405225
Iteration =  4  Dual obj =  -0.06256358278717448  Primal_obj =  1.3611778282559637  Gap =  1.4237414110431381 Sum =  0.99061679724584
Iteration =  5  Dual obj =  -0.061011299640650905  Primal_obj =  0.769151633872753  Gap =  0.8301629335134039 Sum =  1.0109194321331618
Iteration =  6  Dual obj =  -0.060340437083096124  Primal_obj =  0.435791226362948  Gap =  0.4961316634460441 Sum =  0.9972523395712497
Iteration =  7  Dual obj =  -0.05995341587279627  Primal_obj =  0.18342796727912591  Gap =  0.24338138315192218 Sum =  0.9936361559376451
Iteration =  8  Dual obj =  -0.05972459977378558  Primal_obj =  0.042000486291029954  Gap =  0.10172508606481553 Sum =  1.000075078532383
Iteration =  9  Dual obj =  -0.059636860386957126  Primal_obj =  -0.0028405851877276456  Gap =  0.05679627519922948 Sum =  0.9993520645649376
Iteration =  10  Dual obj =  -0.05959141386290748  Primal_obj =  -0.02662448258731806  Gap =  0.03296693127558942 Sum =  0.9995226549468514
Iteration =  11  Dual obj =  -0.05957108572218102  Primal_obj =  -0.036946610956151274  Gap =  0.022624474766029745 Sum =  0.9995942122487484
Iteration =  12  Dual obj =  -0.05956036414338445  Primal_obj =  -0.04723818251655103  Gap =  0.01232218162683342 Sum =  1.0004476144835996
Iteration =  13  Dual obj =  -0.059554686943671234  Primal_obj =  -0.05228300587321437  Gap =  0.007271681070456865 Sum =  0.9997382308986886
Iteration =  14  Dual obj =  -0.0595519741691897  Primal_obj =  -0.055336740490310454  Gap =  0.004215233678879243 Sum =  0.9999413301103549
Iteration =  15  Dual obj =  -0.05955044532223974  Primal_obj =  -0.057082520616750024  Gap =  0.0024679247054897185 Sum =  0.9998573031413814
Iteration =  16  Dual obj =  -0.05954959226158625  Primal_obj =  -0.05791544068628644  Gap =  0.0016341515752998081 Sum =  0.9998949335724949
Iteration =  17  Dual obj =  -0.059549026569123906  Primal_obj =  -0.058377181377021456  Gap =  0.0011718451921024498 Sum =  0.9998612432239874
Iteration =  18  Dual obj =  -0.05954862093921454  Primal_obj =  -0.05867389521915198  Gap =  0.0008747257200625649 Sum =  0.9999549104315133
Iteration =  19  Dual obj =  -0.05954832568130741  Primal_obj =  -0.05885890807291688  Gap =  0.0006894176083905301 Sum =  0.9999492713767819
Iteration =  20  Dual obj =  -0.05954809624298413  Primal_obj =  -0.058992961425093984  Gap =  0.0005551348178901433 Sum =  0.9999865219861526
Iteration =  21  Dual obj =  -0.05954793272827836  Primal_obj =  -0.059078625820695965  Gap =  0.00046930690758239385 Sum =  0.9999738898522282
Iteration =  22  Dual obj =  -0.0595478076277258  Primal_obj =  -0.059147523802540056  Gap =  0.0004002838251857474 Sum =  0.9999705480976981
Iteration =  23  Dual obj =  -0.05954769928615323  Primal_obj =  -0.05920036755930712  Gap =  0.0003473317268461104 Sum =  0.9999707836604272
Iteration =  24  Dual obj =  -0.059547609257693576  Primal_obj =  -0.0592454533174263  Gap =  0.0003021559402672791 Sum =  0.999982401275829
Iteration =  0  Dual obj =  -37.94398205849443  Primal_obj =  16940.455019361318  Gap =  16978.399001419813 Sum =  357.78961431983373
Iteration =  1  Dual obj =  -0.14782891379855237  Primal_obj =  11.5085411429015  Gap =  11.656370056700052 Sum =  0.7750461494449911
Iteration =  2  Dual obj =  -0.11869968189024896  Primal_obj =  14.61717848021254  Gap =  14.73587816210279 Sum =  0.9286078424092682
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  4  Dual obj =  -0.07622879769582709  Primal_obj =  6.871188996390759  Gap =  6.947417794086586 Sum =  0.7626648007874802
Iteration =  5  Dual obj =  -0.05836945014568251  Primal_obj =  5.813059861587158  Gap =  5.87142931173284 Sum =  0.9124695714015929
Iteration =  6  Dual obj =  -0.05093516131740097  Primal_obj =  4.121662174062741  Gap =  4.172597335380142 Sum =  0.8436319369137815
Iteration =  7  Dual obj =  -0.04777325334667169  Primal_obj =  2.832820856197857  Gap =  2.8805941095445284 Sum =  0.8849667907749688
Iteration =  8  Dual obj =  -0.04591265876498292  Primal_obj =  2.482564479791808  Gap =  2.528477138556791 Sum =  0.9005433292549694
Iteration =  9  Dual obj =  -0.04458592305798585  Primal_obj =  1.8524917914103978  Gap =  1.8970777144683837 Sum =  0.9125698083585161
Iteration =  10  Dual obj =  -0.043602737727265875  Primal_obj =  1.520089071178871  Gap =  1.563691808906137 Sum =  0.9386114517797695
Iteration =  11  Dual obj =  -0.042744236670522295  Primal_obj =  1.3717612051031702  Gap =  1.4145054417736924 Sum =  0.9683058613181776
Iteration =  12  Dual obj =  -0.04211770867885699  Primal_obj =  1.0059051656586524  Gap =  1.0480228743375093 Sum =  0.9916383094374641
Iteration =  13  Dual obj =  -0.04166310720815661  Primal_obj =  0.8823610846056837  Gap =  0.9240241918138403 Sum =  1.0008957488045704
Iteration =  14  Dual obj =  -0.04132184237368539  Primal_obj =  0.7038604397465553  Gap =  0.7451822821202407 Sum =  1.0016442551430926
Iteration =  15  Dual obj =  -0.041077487428059424  Primal_obj =  0.482642697556595  Gap =  0.5237201849846544 Sum =  0.9946906536854794
Iteration =  16  Dual obj =  -0.04090776967016989  Primal_obj =  0.44123912702941337  Gap =  0.48214689669958327 Sum =  0.9918885434281013
Iteration =  17  Dual obj =  -0.040777097306566486  Primal_obj =  0.3815892869599705  Gap =  0.422366384266537 Sum =  0.9927805848610834
Iteration =  18  Dual obj =  -0.04065590333461867  Primal_obj =  0.25945970677591  Gap =  0.3001156101105287 Sum =  0.9959730529794453
Iteration =  19  Dual obj =  -0.04057226682390419  Primal_obj =  0.18662190608323925  Gap =  0.22719417290714344 Sum =  0.9958009452606498
Iteration =  20  Dual obj =  -0.04051445102570842  Primal_obj =  0.14538149732408684  Gap =  0.18589594834979525 Sum =  0.9971494866977179
Iteration =  21  Dual obj =  -0.040463966549821644  Primal_obj =  0.0949137317374126  Gap =  0.13537769828723425 Sum =  0.9986395698618002
Iteration =  22  Dual obj =  -0.04042258532137342  Primal_obj =  0.07541808084663087  Gap =  0.11584066616800429 Sum =  1.001568277693513
Iteration =  23  Dual obj =  -0.04038765525140097  Primal_obj =  0.05640417007116727  Gap =  0.09679182532256825 Sum =  1.001576736738265
Iteration =  24  Dual obj =  -0.040361735156193075  Primal_obj =  0.03923465593225918  Gap =  0.07959639108845226 Sum =  1.0011150777332127
Iteration =  0  Dual obj =  -0.040361735156193075  Primal_obj =  0.03923465593225918  Gap =  0.07959639108845226 Sum =  1.0011150777332127
Iteration =  1  Dual obj =  -0.04034835732450437  Primal_obj =  0.02501114604908461  Gap =  0.06535950337358898 Sum =  0.9988264014592083
Iteration =  2  Dual obj =  -0.040338338468597384  Primal_obj =  0.015478957437279409  Gap =  0.05581729590587679 Sum =  0.9988323246301307
Iteration =  3  Dual obj =  -0.040328772406857005  Primal_obj =  0.011528848243538614  Gap =  0.05185762065039562 Sum =  0.9986574891208665
Iteration =  4  Dual obj =  -0.040320597955300075  Primal_obj =  0.008717277936642412  Gap =  0.04903787589194249 Sum =  0.997993184324794
Iteration =  5  Dual obj =  -0.040310705280322906  Primal_obj =  0.008408100460003343  Gap =  0.04871880574032625 Sum =  0.9970704530915695
Iteration =  6  Dual obj =  -0.04029828038957652  Primal_obj =  0.01068663862007252  Gap =  0.05098491900964904 Sum =  0.9990267232203471
Iteration =  7  Dual obj =  -0.04028639035129953  Primal_obj =  0.005069565199538245  Gap =  0.045355955550837775 Sum =  0.9998781207247678
Iteration =  8  Dual obj =  -0.040275865840598044  Primal_obj =  -0.002224856769232522  Gap =  0.03805100907136552 Sum =  1.0004424700115044
Iteration =  9  Dual obj =  -0.04026746552504075  Primal_obj =  -0.009429458896341364  Gap =  0.030838006628699385 Sum =  1.0003884771244964
Iteration =  10  Dual obj =  -0.04025999974698007  Primal_obj =  -0.013691136900298453  Gap =  0.02656886284668162 Sum =  1.0006013501804325
Iteration =  11  Dual obj =  -0.0402537133378505  Primal_obj =  -0.01625572973502523  Gap =  0.02399798360282527 Sum =  0.9995739648579773
Iteration =  12  Dual obj =  -0.0402482286566268  Primal_obj =  -0.018932224733701222  Gap =  0.021316003922925576 Sum =  0.999135626391982
Iteration =  13  Dual obj =  -0.040243678667071764  Primal_obj =  -0.020961371285565994  Gap =  0.01928230738150577 Sum =  0.999168979950062
Iteration =  14  Dual obj =  -0.04024031533303722  Primal_obj =  -0.023146323200548644  Gap =  0.017093992132488578 Sum =  0.9983750578427852
Iteration =  15  Dual obj =  -0.04023725961938627  Primal_obj =  -0.02571693237634312  Gap =  0.014520327243043148 Sum =  0.9990485750278901
Iteration =  16  Dual obj =  -0.04023448982673749  Primal_obj =  -0.027565511986296864  Gap =  0.012668977840440625 Sum =  1.0002981657729242
Iteration =  17  Dual obj =  -0.04023215537018485  Primal_obj =  -0.02951402718057107  Gap =  0.010718128189613776 Sum =  1.0003533707158536
Iteration =  18  Dual obj =  -0.04023031064302621  Primal_obj =  -0.030883315940932035  Gap =  0.009346994702094172 Sum =  1.0006460653984588
Iteration =  19  Dual obj =  -0.04022871081176119  Primal_obj =  -0.03218466395833444  Gap =  0.008044046853426745 Sum =  1.0002859487353242
Iteration =  20  Dual obj =  -0.040227302840565096  Primal_obj =  -0.03327393063898845  Gap =  0.006953372201576644 Sum =  1.0001245969738173
Iteration =  21  Dual obj =  -0.040226186467905586  Primal_obj =  -0.033911484575189194  Gap =  0.006314701892716393 Sum =  0.9994693355108337
Iteration =  22  Dual obj =  -0.04022521529731621  Primal_obj =  -0.03477049613288405  Gap =  0.005454719164432159 Sum =  0.9996008828668776
Iteration =  23  Dual obj =  -0.04022433827070525  Primal_obj =  -0.03536048902966432  Gap =  0.004863849241040927 Sum =  0.9998246632397949
Iteration =  24  Dual obj =  -0.040223556965297814  Primal_obj =  -0.035885548994527824  Gap =  0.00433800797076999 Sum =  0.9997540144948798
Iteration =  0  Dual obj =  -0.040223556965297814  Primal_obj =  -0.035885548994527824  Gap =  0.00433800797076999 Sum =  0.9997540144948798
Iteration =  1  Dual obj =  -0.04022327521604897  Primal_obj =  -0.03611778890785641  Gap =  0.00410548630819256 Sum =  1.000005425083483
Iteration =  2  Dual obj =  -0.04022301065435657  Primal_obj =  -0.036292821755595686  Gap =  0.003930188898760886 Sum =  0.9997487483511287
Iteration =  3  Dual obj =  -0.04022275638000705  Primal_obj =  -0.03644383908407349  Gap =  0.003778917295933562 Sum =  0.9997360495779299
Iteration =  4  Dual obj =  -0.040222451508625134  Primal_obj =  -0.03665876995033711  Gap =  0.003563681558288026 Sum =  1.0000797010156115
Iteration =  5  Dual obj =  -0.0402220656751977  Primal_obj =  -0.036850220914254425  Gap =  0.0033718447609432725 Sum =  0.9999402251407712
Iteration =  6  Dual obj =  -0.04022169577169914  Primal_obj =  -0.03699585516364384  Gap =  0.0032258406080552943 Sum =  1.0001641560368166
Iteration =  7  Dual obj =  -0.040221173325921865  Primal_obj =  -0.03717266119503697  Gap =  0.0030485121308848964 Sum =  1.0001708208211393
Iteration =  8  Dual obj =  -0.04022061779265125  Primal_obj =  -0.037353866196756264  Gap =  0.002866751595894987 Sum =  1.0000459891151061
Iteration =  9  Dual obj =  -0.0402200955071805  Primal_obj =  -0.03755236871599177  Gap =  0.002667726791188735 Sum =  0.9998657995190261
Iteration =  10  Dual obj =  -0.040219620200454845  Primal_obj =  -0.03765924951392524  Gap =  0.0025603706865296033 Sum =  0.9996659376203536
Iteration =  11  Dual obj =  -0.040219191408608614  Primal_obj =  -0.03783010819510131  Gap =  0.0023890832135073023 Sum =  0.9997148990634412
Iteration =  12  Dual obj =  -0.040218776874649614  Primal_obj =  -0.03797047055184968  Gap =  0.002248306322799931 Sum =  0.999688600537414
Iteration =  13  Dual obj =  -0.040218414042006476  Primal_obj =  -0.03810682208141196  Gap =  0.0021115919605945166 Sum =  0.9997300200415988
Iteration =  14  Dual obj =  -0.04021807794622573  Primal_obj =  -0.038312353152806636  Gap =  0.0019057247934190918 Sum =  0.9999750605164364
Iteration =  15  Dual obj =  -0.04021779357545548  Primal_obj =  -0.03846562904828697  Gap =  0.0017521645271685038 Sum =  1.0000292623564402
Iteration =  16  Dual obj =  -0.04021755440383985  Primal_obj =  -0.038588356270264135  Gap =  0.0016291981335757183 Sum =  1.0000145344407065
Iteration =  17  Dual obj =  -0.040217344550290884  Primal_obj =  -0.03870538194382943  Gap =  0.001511962606461456 Sum =  0.9999592207226518
Iteration =  18  Dual obj =  -0.04021717024938071  Primal_obj =  -0.038802237439824014  Gap =  0.0014149328095566932 Sum =  0.9999584809112569
Iteration =  19  Dual obj =  -0.04021701330396483  Primal_obj =  -0.03888981042466533  Gap =  0.0013272028792995008 Sum =  0.9999122928589589
Iteration =  20  Dual obj =  -0.04021686342195352  Primal_obj =  -0.03895911776634109  Gap =  0.00125774565561243 Sum =  0.9998759573359526
Iteration =  21  Dual obj =  -0.04021670955972238  Primal_obj =  -0.0390107784822228  Gap =  0.0012059310774995835 Sum =  0.9998985056972269
Iteration =  22  Dual obj =  -0.04021658119433551  Primal_obj =  -0.039059520544251033  Gap =  0.0011570606500844738 Sum =  0.9998402448327127
Iteration =  23  Dual obj =  -0.04021645935965694  Primal_obj =  -0.03910557938649474  Gap =  0.0011108799731621988 Sum =  0.999898147420088
Iteration =  24  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  0  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  1  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  2  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  3  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  4  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  5  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  6  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  7  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  8  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  9  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  10  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  11  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  12  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  13  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  14  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  15  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  16  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  17  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  18  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  19  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  20  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  21  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  22  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  23  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Iteration =  24  Dual obj =  -0.04021634701317513  Primal_obj =  -0.039144198838853644  Gap =  0.0010721481743214828 Sum =  0.9999608249943213
Done, writing results...
