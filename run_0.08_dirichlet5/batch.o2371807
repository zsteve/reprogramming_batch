2021-04-29 12:37:38,732 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.09s.
2021-04-29 12:37:39,142 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.21s.
2021-04-29 12:37:39,542 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 12:37:39,665 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-29 12:37:39,668 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:37:39,677 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:37:40,521 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 108.
2021-04-29 12:37:40,522 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.86s.
Iteration =  0  Dual obj =  -58.08610749219561  Primal_obj =  495773.9340727209  Gap =  495832.0201802131 Sum =  592.9046221505937
Iteration =  1  Dual obj =  -0.0136260660228331  Primal_obj =  510.45473858722227  Gap =  510.4683646532451 Sum =  1.403681200555754
Iteration =  2  Dual obj =  0.131514108358327  Primal_obj =  169.9646294722218  Gap =  169.83311536386347 Sum =  0.6784000467142168
Iteration =  3  Dual obj =  0.1956414973958872  Primal_obj =  80.51533543927637  Gap =  80.31969394188049 Sum =  0.5484921359387083
Iteration =  4  Dual obj =  0.23174662429044382  Primal_obj =  36.350267749842736  Gap =  36.11852112555229 Sum =  0.6944783546754816
Iteration =  5  Dual obj =  0.24638654931957074  Primal_obj =  15.980351600592543  Gap =  15.733965051272973 Sum =  0.9078885617270569
Iteration =  6  Dual obj =  0.25330958042422813  Primal_obj =  4.626394403883532  Gap =  4.373084823459304 Sum =  0.9248318296969383
Iteration =  7  Dual obj =  0.2549614249862538  Primal_obj =  1.7124836354606296  Gap =  1.457522210474376 Sum =  0.9938439934660197
Iteration =  8  Dual obj =  0.25545450725275265  Primal_obj =  0.7511936109378942  Gap =  0.4957391036851415 Sum =  1.0017559097137536
Iteration =  9  Dual obj =  0.25563601357750254  Primal_obj =  0.5121481333281077  Gap =  0.25651211975060517 Sum =  1.0025165801874456
Iteration =  10  Dual obj =  0.25572381475835126  Primal_obj =  0.3871829217620333  Gap =  0.13145910700368202 Sum =  1.0028362114134772
Iteration =  11  Dual obj =  0.2557632384075915  Primal_obj =  0.32650588540915537  Gap =  0.07074264700156385 Sum =  0.9999451900058762
Iteration =  12  Dual obj =  0.25578520045283004  Primal_obj =  0.30012461720538886  Gap =  0.04433941675255881 Sum =  0.9991402021294595
Iteration =  13  Dual obj =  0.25579756986276236  Primal_obj =  0.28453784885738465  Gap =  0.02874027899462228 Sum =  0.9998678383273064
Iteration =  14  Dual obj =  0.25580331377242044  Primal_obj =  0.27318026291461184  Gap =  0.0173769491421914 Sum =  0.9998379477828041
Iteration =  15  Dual obj =  0.2558083253263923  Primal_obj =  0.2713330515992073  Gap =  0.015524726272814982 Sum =  1.0000804996884944
Iteration =  16  Dual obj =  0.2558112484880891  Primal_obj =  0.2631361009228783  Gap =  0.0073248524347891975 Sum =  1.00003374034236
Iteration =  17  Dual obj =  0.25581245335974134  Primal_obj =  0.25966220248673383  Gap =  0.0038497491269924855 Sum =  0.9999235143332277
Iteration =  18  Dual obj =  0.2558132540214899  Primal_obj =  0.2585018776029254  Gap =  0.002688623581435512 Sum =  1.000072664511607
Iteration =  19  Dual obj =  0.2558138025976862  Primal_obj =  0.258327761544299  Gap =  0.002513958946612771 Sum =  0.9999840250773355
Iteration =  20  Dual obj =  0.2558144660312802  Primal_obj =  0.25717823150450914  Gap =  0.0013637654732289173 Sum =  0.9999004706617102
Iteration =  21  Dual obj =  0.25581465391276137  Primal_obj =  0.2566279096549546  Gap =  0.0008132557421932085 Sum =  1.0000073394219868
Iteration =  22  Dual obj =  0.2558148017745184  Primal_obj =  0.2561761081001732  Gap =  0.0003613063256548421 Sum =  1.0000106979617949
Iteration =  23  Dual obj =  0.25581484795098763  Primal_obj =  0.25604646727875124  Gap =  0.00023161932776361027 Sum =  1.000003531478486
Iteration =  24  Dual obj =  0.2558148509027233  Primal_obj =  0.25604356112460364  Gap =  0.00022871022188031276 Sum =  1.000000330341027
Iteration =  0  Dual obj =  -32.77806119792297  Primal_obj =  366163.8771064751  Gap =  366196.655167673 Sum =  592.9046221505937
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  0.005945911099900558  Primal_obj =  837.3931459648484  Gap =  837.3872000537484 Sum =  1.0761430855624727
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  5  Dual obj =  0.08592389697575992  Primal_obj =  330.68937092076163  Gap =  330.60344702378586 Sum =  1.3168628096848218
Iteration =  6  Dual obj =  0.2322834053913085  Primal_obj =  204.67565849142784  Gap =  204.44337508603653 Sum =  0.559474911460292
Iteration =  7  Dual obj =  0.3098068641179179  Primal_obj =  180.99721018628236  Gap =  180.68740332216444 Sum =  0.579891063552401
Iteration =  8  Dual obj =  0.3632593358983743  Primal_obj =  115.32621113149118  Gap =  114.9629517955928 Sum =  0.653214048685762
Iteration =  9  Dual obj =  0.39669831998778504  Primal_obj =  57.49196136187632  Gap =  57.095263041888536 Sum =  1.237255688648118
Iteration =  10  Dual obj =  0.4100328917444058  Primal_obj =  38.94403844223056  Gap =  38.53400555048615 Sum =  0.992239038632271
Iteration =  11  Dual obj =  0.41922553446759425  Primal_obj =  23.549032266369622  Gap =  23.12980673190203 Sum =  0.8508333153578409
Iteration =  12  Dual obj =  0.4242502977761268  Primal_obj =  14.971917040521456  Gap =  14.54766674274533 Sum =  1.0577862569655125
Iteration =  13  Dual obj =  0.42732497877808284  Primal_obj =  11.296881263786402  Gap =  10.869556285008318 Sum =  0.9438356328338651
Iteration =  14  Dual obj =  0.4293536296681035  Primal_obj =  8.741469831454117  Gap =  8.312116201786013 Sum =  0.9804128513075254
Iteration =  15  Dual obj =  0.4307397837375118  Primal_obj =  6.378627548329027  Gap =  5.947887764591515 Sum =  0.9959302446035938
Iteration =  16  Dual obj =  0.43167689362515804  Primal_obj =  4.940436159340831  Gap =  4.508759265715673 Sum =  0.983266414726222
Iteration =  17  Dual obj =  0.4324910329929592  Primal_obj =  4.285695944151359  Gap =  3.8532049111584 Sum =  1.0031488675858395
Iteration =  18  Dual obj =  0.4328811052101583  Primal_obj =  2.654729049477797  Gap =  2.2218479442676387 Sum =  0.9881814493524859
Iteration =  19  Dual obj =  0.43310553975148647  Primal_obj =  1.9870179430851378  Gap =  1.5539124033336513 Sum =  1.005128418491783
Iteration =  20  Dual obj =  0.4332658375438756  Primal_obj =  1.630572549268217  Gap =  1.1973067117243414 Sum =  0.9910124065950977
Iteration =  21  Dual obj =  0.43346383465709637  Primal_obj =  1.7045591695256639  Gap =  1.2710953348685674 Sum =  1.0025918399320446
Iteration =  22  Dual obj =  0.4335813113032208  Primal_obj =  1.072993914771114  Gap =  0.6394126034678933 Sum =  0.9965604118124902
Iteration =  23  Dual obj =  0.433639802376637  Primal_obj =  0.9810088243466986  Gap =  0.5473690219700615 Sum =  1.0009862342373268
Iteration =  24  Dual obj =  0.4336954665442963  Primal_obj =  0.9000415142513463  Gap =  0.46634604770704996 Sum =  0.9983872004725183
Iteration =  0  Dual obj =  0.4336954665442963  Primal_obj =  0.9000415142513463  Gap =  0.46634604770704996 Sum =  0.9983872004725183
Iteration =  1  Dual obj =  0.43373547388650857  Primal_obj =  0.8232912374051222  Gap =  0.38955576351861365 Sum =  0.9979475646980597
Iteration =  2  Dual obj =  0.43382234104167106  Primal_obj =  0.9328731768058601  Gap =  0.49905083576418907 Sum =  1.0018976312634016
Iteration =  3  Dual obj =  0.4338915696234146  Primal_obj =  0.7395040392123469  Gap =  0.3056124695889323 Sum =  0.9990739274104061
Iteration =  4  Dual obj =  0.4339326335346759  Primal_obj =  0.6595348590441148  Gap =  0.22560222550943887 Sum =  0.999477580831212
Iteration =  5  Dual obj =  0.43396088366735713  Primal_obj =  0.6121182532663669  Gap =  0.1781573695990098 Sum =  1.0022728419209965
Iteration =  6  Dual obj =  0.43398017652140664  Primal_obj =  0.5569911141238661  Gap =  0.12301093760245951 Sum =  1.0019147549135599
Iteration =  7  Dual obj =  0.43399399975823694  Primal_obj =  0.5244611835937483  Gap =  0.09046718383551133 Sum =  0.998057099887967
Iteration =  8  Dual obj =  0.4340062164848929  Primal_obj =  0.5126345945249381  Gap =  0.07862837804004519 Sum =  0.9995801445995174
Iteration =  9  Dual obj =  0.43401416714484775  Primal_obj =  0.49609403082475356  Gap =  0.06207986367990581 Sum =  1.001421972400316
Iteration =  10  Dual obj =  0.4340211196766274  Primal_obj =  0.49427108269077713  Gap =  0.060249963014149754 Sum =  1.000406723304963
Iteration =  11  Dual obj =  0.4340273049026645  Primal_obj =  0.4796657050355425  Gap =  0.04563840013287801 Sum =  0.9994954718587918
Iteration =  12  Dual obj =  0.4340322262142143  Primal_obj =  0.46826816974617275  Gap =  0.03423594353195847 Sum =  1.0001804037835702
Iteration =  13  Dual obj =  0.43403577729554355  Primal_obj =  0.4645513441225361  Gap =  0.03051556682699258 Sum =  1.0006420975767312
Iteration =  14  Dual obj =  0.43403882571587715  Primal_obj =  0.4606807183859414  Gap =  0.026641892670064227 Sum =  0.9996177493340787
Iteration =  15  Dual obj =  0.4340411611175752  Primal_obj =  0.4568304551312613  Gap =  0.022789294013686123 Sum =  1.0006296234381888
Iteration =  16  Dual obj =  0.4340431034602257  Primal_obj =  0.4588369542490769  Gap =  0.024793850788851213 Sum =  0.9995130003252405
Iteration =  17  Dual obj =  0.4340454386709917  Primal_obj =  0.4598734236836844  Gap =  0.025827985012692678 Sum =  1.000252038931983
Iteration =  18  Dual obj =  0.4340472955190849  Primal_obj =  0.45596466720160644  Gap =  0.021917371682521558 Sum =  0.999970791791412
Iteration =  19  Dual obj =  0.43404902857542477  Primal_obj =  0.4522362877999418  Gap =  0.018187259224517027 Sum =  0.9999530553458171
Iteration =  20  Dual obj =  0.4340507937382142  Primal_obj =  0.45023348835664023  Gap =  0.01618269461842603 Sum =  0.9999637815052349
Iteration =  21  Dual obj =  0.4340521171261318  Primal_obj =  0.4511595934849624  Gap =  0.017107476358830587 Sum =  1.0001651675774983
Iteration =  22  Dual obj =  0.43405346474883766  Primal_obj =  0.4498521371975884  Gap =  0.015798672448750717 Sum =  0.9999154619509355
Iteration =  23  Dual obj =  0.4340544475974353  Primal_obj =  0.44645029722097396  Gap =  0.01239584962353868 Sum =  0.9999456058328342
Iteration =  24  Dual obj =  0.4340553043898481  Primal_obj =  0.4441165937195023  Gap =  0.010061289329654222 Sum =  1.0002093341297322
Iteration =  0  Dual obj =  0.4340553043898481  Primal_obj =  0.4441165937195023  Gap =  0.010061289329654222 Sum =  1.0002093341297322
Iteration =  1  Dual obj =  0.4340557010672176  Primal_obj =  0.44147840917484904  Gap =  0.007422708107631459 Sum =  0.9997377085382475
Iteration =  2  Dual obj =  0.4340560861102424  Primal_obj =  0.4400127048427721  Gap =  0.005956618732529728 Sum =  1.0000285565604243
Iteration =  3  Dual obj =  0.43405645398843024  Primal_obj =  0.4403763569395166  Gap =  0.006319902951086365 Sum =  0.999919892207193
Iteration =  4  Dual obj =  0.43405687172660007  Primal_obj =  0.4404477415398139  Gap =  0.006390869813213851 Sum =  0.999938602749977
Iteration =  5  Dual obj =  0.4340573228714223  Primal_obj =  0.4414854864816756  Gap =  0.0074281636102533355 Sum =  0.9999425013063071
Iteration =  6  Dual obj =  0.4340579243643323  Primal_obj =  0.4417041523944489  Gap =  0.007646228030116553 Sum =  0.9999504393793492
Iteration =  7  Dual obj =  0.4340584230405605  Primal_obj =  0.4406548904756229  Gap =  0.00659646743506237 Sum =  0.9999194769213706
Iteration =  8  Dual obj =  0.434058833558003  Primal_obj =  0.43994258145452353  Gap =  0.005883747896520519 Sum =  0.9999880485002649
Iteration =  9  Dual obj =  0.4340591688243447  Primal_obj =  0.4390042633320287  Gap =  0.004945094507683989 Sum =  0.9999404019359422
Iteration =  10  Dual obj =  0.4340594019861332  Primal_obj =  0.43816470765973436  Gap =  0.004105305673601178 Sum =  1.0000003542206797
Iteration =  11  Dual obj =  0.43405962408763604  Primal_obj =  0.43749026138475  Gap =  0.0034306372971139587 Sum =  0.999868331214186
Iteration =  12  Dual obj =  0.4340598159236803  Primal_obj =  0.43719203811268564  Gap =  0.0031322221890053292 Sum =  0.9999676904387464
Iteration =  13  Dual obj =  0.43405997996756684  Primal_obj =  0.43731852330859455  Gap =  0.0032585433410277087 Sum =  1.0000839327978643
Iteration =  14  Dual obj =  0.4340601621685204  Primal_obj =  0.43731873479586936  Gap =  0.0032585726273489657 Sum =  0.999974889161127
Iteration =  15  Dual obj =  0.434060329868455  Primal_obj =  0.4373904096388965  Gap =  0.0033300797704415297 Sum =  0.9999694273109698
Iteration =  16  Dual obj =  0.4340605136158851  Primal_obj =  0.4378079195268912  Gap =  0.0037474059110060853 Sum =  1.0000356711487555
Iteration =  17  Dual obj =  0.43406067301387846  Primal_obj =  0.43775987338087907  Gap =  0.00369920036700061 Sum =  1.0000721118845417
Iteration =  18  Dual obj =  0.434060856527902  Primal_obj =  0.4379374059733637  Gap =  0.00387654944546173 Sum =  0.9999217977810804
Iteration =  19  Dual obj =  0.4340610460358995  Primal_obj =  0.4373258010289447  Gap =  0.0032647549930451825 Sum =  0.9999991031159969
Iteration =  20  Dual obj =  0.43406116916351073  Primal_obj =  0.43683706399680206  Gap =  0.002775894833291326 Sum =  1.000043901178171
Iteration =  21  Dual obj =  0.4340612572802541  Primal_obj =  0.4364404062980738  Gap =  0.002379149017819715 Sum =  0.9999498254772647
Iteration =  22  Dual obj =  0.4340613273735225  Primal_obj =  0.43613779372313644  Gap =  0.002076466349613948 Sum =  0.9999533075798831
Iteration =  23  Dual obj =  0.43406132805694964  Primal_obj =  0.43614226316124477  Gap =  0.002080935104295134 Sum =  0.9999297987522382
Iteration =  24  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  0  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  1  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  2  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  3  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  4  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  5  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  6  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  7  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  8  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  9  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  10  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  11  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  12  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  13  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  14  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  15  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  16  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  17  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  18  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  19  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  20  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  21  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  22  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  23  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Iteration =  24  Dual obj =  0.43406140568679297  Primal_obj =  0.43589695081489777  Gap =  0.0018355451281047985 Sum =  1.000040197472769
Done, writing results...
