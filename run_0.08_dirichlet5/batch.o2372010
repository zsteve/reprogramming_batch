2021-04-29 13:18:21,817 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.06s.
2021-04-29 13:18:22,228 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.22s.
2021-04-29 13:18:22,630 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 13:18:22,746 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-29 13:18:22,749 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 13:18:22,759 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 13:18:23,550 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 96.
2021-04-29 13:18:23,551 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.80s.
Iteration =  0  Dual obj =  -41.32998249581688  Primal_obj =  294972.3165089987  Gap =  295013.6464914945 Sum =  348.4688745749541
Iteration =  1  Dual obj =  -0.009453526343173955  Primal_obj =  669.7054263732396  Gap =  669.7148798995827 Sum =  1.5563644968896901
Iteration =  2  Dual obj =  0.10335243940443693  Primal_obj =  282.4381461427921  Gap =  282.3347937033877 Sum =  0.5726182163065288
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  4  Dual obj =  0.1530743218753592  Primal_obj =  86.16772941252304  Gap =  86.01465509064768 Sum =  0.41089003617101466
Iteration =  5  Dual obj =  0.18756541616698433  Primal_obj =  57.565414069724206  Gap =  57.37784865355722 Sum =  0.572121700979235
Iteration =  6  Dual obj =  0.21558776708485655  Primal_obj =  17.90994987042855  Gap =  17.694362103343696 Sum =  0.9120437622152425
Iteration =  7  Dual obj =  0.22207914544090024  Primal_obj =  5.157116434176805  Gap =  4.935037288735905 Sum =  0.9159183392926754
Iteration =  8  Dual obj =  0.22369865071608366  Primal_obj =  1.3286276721932162  Gap =  1.1049290214771326 Sum =  0.9928193199616004
Iteration =  9  Dual obj =  0.2240495238689748  Primal_obj =  0.49727185235339966  Gap =  0.27322232848442485 Sum =  1.000279327197811
Iteration =  10  Dual obj =  0.2241245428614599  Primal_obj =  0.3043299665488599  Gap =  0.0802054236874 Sum =  1.0022440855111572
Iteration =  11  Dual obj =  0.22414467694042828  Primal_obj =  0.25275782162186666  Gap =  0.028613144681438385 Sum =  1.0014813779173053
Iteration =  12  Dual obj =  0.22415417091838727  Primal_obj =  0.24371227742500615  Gap =  0.019558106506618878 Sum =  1.0006188392369255
Iteration =  13  Dual obj =  0.22415792611476365  Primal_obj =  0.22838782067174912  Gap =  0.00422989455698547 Sum =  0.9999286949325477
Iteration =  14  Dual obj =  0.22415893767491452  Primal_obj =  0.22635671821729736  Gap =  0.0021977805423828434 Sum =  0.9999210798885763
Iteration =  15  Dual obj =  0.22415949490372145  Primal_obj =  0.22516647106391055  Gap =  0.0010069761601891047 Sum =  1.0000261813067826
Iteration =  16  Dual obj =  0.22415971501781018  Primal_obj =  0.22455253523907415  Gap =  0.00039282022126396754 Sum =  0.9999482778738895
Iteration =  17  Dual obj =  0.2241597989465987  Primal_obj =  0.2243111114214152  Gap =  0.00015131247481647847 Sum =  0.999967287843919
Iteration =  18  Dual obj =  0.2241598174121934  Primal_obj =  0.22421867082102792  Gap =  5.8853408834519394e-05 Sum =  1.0000110191897855
Iteration =  19  Dual obj =  0.2241598183905964  Primal_obj =  0.2242118398699134  Gap =  5.2021479316988195e-05 Sum =  1.0000133235716102
Iteration =  20  Dual obj =  0.22415981934333473  Primal_obj =  0.2242055719387539  Gap =  4.575259541916843e-05 Sum =  1.0000131962958079
Iteration =  21  Dual obj =  0.22415982002122614  Primal_obj =  0.22420153224272693  Gap =  4.171222150078924e-05 Sum =  1.0000110928902497
Iteration =  22  Dual obj =  0.2241598206405001  Primal_obj =  0.22419777042658307  Gap =  3.794978608295807e-05 Sum =  1.0000099153011441
Iteration =  23  Dual obj =  0.22415982126632256  Primal_obj =  0.2241932601513014  Gap =  3.343888497883696e-05 Sum =  1.0000089283391387
Iteration =  24  Dual obj =  0.22415982177438137  Primal_obj =  0.2241897604456527  Gap =  2.9938671271323436e-05 Sum =  1.0000067968171593
Iteration =  0  Dual obj =  -24.01803936162726  Primal_obj =  222687.858126225  Gap =  222711.87616558664 Sum =  348.4688745749541
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  0.023004602171755963  Primal_obj =  536.9466756940385  Gap =  536.9236710918667 Sum =  0.892665896375206
Iteration =  3  Dual obj =  0.2084468253156891  Primal_obj =  275.71795537370656  Gap =  275.5095085483909 Sum =  0.46897975944968673
Iteration =  4  Dual obj =  0.3226454257720077  Primal_obj =  140.22983708152663  Gap =  139.90719165575462 Sum =  0.6183986207092355
Iteration =  5  Dual obj =  0.36995489561130407  Primal_obj =  62.89831012807533  Gap =  62.52835523246403 Sum =  0.6012344711258556
Iteration =  6  Dual obj =  0.3925633877387458  Primal_obj =  41.085846740624795  Gap =  40.69328335288605 Sum =  1.2654873694274245
Iteration =  7  Dual obj =  0.4038591606795611  Primal_obj =  22.23744533917526  Gap =  21.833586178495697 Sum =  0.9988305260159323
Iteration =  8  Dual obj =  0.40884453439229834  Primal_obj =  13.611361736151547  Gap =  13.20251720175925 Sum =  0.9421664924896257
Iteration =  9  Dual obj =  0.4113936665859905  Primal_obj =  8.701534025838242  Gap =  8.290140359252252 Sum =  1.0011146998831588
Iteration =  10  Dual obj =  0.41281607433412293  Primal_obj =  5.235023238023504  Gap =  4.822207163689381 Sum =  0.9893597698336354
Iteration =  11  Dual obj =  0.4134865344372972  Primal_obj =  3.360504028670151  Gap =  2.9470174942328535 Sum =  0.98967881364759
Iteration =  12  Dual obj =  0.41379169038693625  Primal_obj =  1.6884029191923817  Gap =  1.2746112288054454 Sum =  0.9982377592543138
Iteration =  13  Dual obj =  0.41398985669028016  Primal_obj =  1.1833626569505467  Gap =  0.7693728002602664 Sum =  1.0001018528358165
Iteration =  14  Dual obj =  0.41408027854468155  Primal_obj =  0.826401613050739  Gap =  0.41232133450605746 Sum =  0.9944592734680662
Iteration =  15  Dual obj =  0.4141208708505705  Primal_obj =  0.6620102470680227  Gap =  0.24788937621745222 Sum =  0.9989526009623073
Iteration =  16  Dual obj =  0.4141466222160577  Primal_obj =  0.6159674126729844  Gap =  0.2018207904569267 Sum =  1.0001391794160241
Iteration =  17  Dual obj =  0.4141659819148587  Primal_obj =  0.5675052106328121  Gap =  0.1533392287179534 Sum =  0.9986653719187311
Iteration =  18  Dual obj =  0.4141833958499053  Primal_obj =  0.5706960229127676  Gap =  0.15651262706286223 Sum =  1.0006456529822918
Iteration =  19  Dual obj =  0.4141962799477465  Primal_obj =  0.5348263981037771  Gap =  0.12063011815603059 Sum =  0.9996021608231558
Iteration =  20  Dual obj =  0.4142060008952177  Primal_obj =  0.5034586929311882  Gap =  0.08925269203597047 Sum =  0.998590071492836
Iteration =  21  Dual obj =  0.41421378884867854  Primal_obj =  0.48204296471835095  Gap =  0.06782917586967241 Sum =  1.0011351639334807
Iteration =  22  Dual obj =  0.41421935079837474  Primal_obj =  0.46860278503475217  Gap =  0.054383434236377426 Sum =  0.9994619411678278
Iteration =  23  Dual obj =  0.41422317178062673  Primal_obj =  0.4555829029957997  Gap =  0.041359731215172946 Sum =  0.9996588230961467
Iteration =  24  Dual obj =  0.4142260610245482  Primal_obj =  0.44864194026344717  Gap =  0.034415879238898994 Sum =  1.0006356867987896
Iteration =  0  Dual obj =  0.4142260610245482  Primal_obj =  0.44864194026344717  Gap =  0.034415879238898994 Sum =  1.0006356867987896
Iteration =  1  Dual obj =  0.41422751526077806  Primal_obj =  0.4400259355188144  Gap =  0.02579842025803636 Sum =  0.9997912546800306
Iteration =  2  Dual obj =  0.41422933383139626  Primal_obj =  0.4406136916808432  Gap =  0.026384357849446927 Sum =  0.9991010263173439
Iteration =  3  Dual obj =  0.41423169804223736  Primal_obj =  0.4413072922630443  Gap =  0.027075594220806964 Sum =  0.9998747158417789
Iteration =  4  Dual obj =  0.41423390393699006  Primal_obj =  0.43947210894715333  Gap =  0.025238205010163273 Sum =  1.0006945093844313
Iteration =  5  Dual obj =  0.41423584313429324  Primal_obj =  0.43665276790165125  Gap =  0.022416924767358015 Sum =  0.9997833604615862
Iteration =  6  Dual obj =  0.4142373243732542  Primal_obj =  0.43138528131453757  Gap =  0.01714795694128335 Sum =  0.9995701845531977
Iteration =  7  Dual obj =  0.41423834078647054  Primal_obj =  0.429155641934147  Gap =  0.014917301147676476 Sum =  1.0001986390231534
Iteration =  8  Dual obj =  0.41423924055728956  Primal_obj =  0.4282125421577565  Gap =  0.013973301600466947 Sum =  1.000216548041287
Iteration =  9  Dual obj =  0.41424013283438127  Primal_obj =  0.426285347713658  Gap =  0.012045214879276733 Sum =  0.9997449337303989
Iteration =  10  Dual obj =  0.41424072327106853  Primal_obj =  0.42445340387456404  Gap =  0.010212680603495505 Sum =  0.9997202537623773
Iteration =  11  Dual obj =  0.41424118406965005  Primal_obj =  0.4227066316502677  Gap =  0.008465447580617624 Sum =  1.0001178637979233
Iteration =  12  Dual obj =  0.41424145319753436  Primal_obj =  0.4230064505056029  Gap =  0.008764997308068567 Sum =  1.000095396712595
Iteration =  13  Dual obj =  0.4142418656573761  Primal_obj =  0.42387672501382845  Gap =  0.009634859356452363 Sum =  0.9998392720756475
Iteration =  14  Dual obj =  0.4142423602619667  Primal_obj =  0.42416684662382054  Gap =  0.009924486361853835 Sum =  0.9997534092787339
Iteration =  15  Dual obj =  0.41424278689249383  Primal_obj =  0.4238390325101681  Gap =  0.009596245617674248 Sum =  1.0001472226709023
Iteration =  16  Dual obj =  0.41424319257135406  Primal_obj =  0.42202223076051165  Gap =  0.007779038189157594 Sum =  1.0001598829696414
Iteration =  17  Dual obj =  0.4142435526827804  Primal_obj =  0.4203256918189425  Gap =  0.0060821391361621235 Sum =  0.9996440667612219
Iteration =  18  Dual obj =  0.41424377788985045  Primal_obj =  0.41910270699225866  Gap =  0.004858929102408205 Sum =  1.0001890170915733
Iteration =  19  Dual obj =  0.41424397179537814  Primal_obj =  0.41853835568920583  Gap =  0.004294383893827691 Sum =  1.0000730819548629
Iteration =  20  Dual obj =  0.4142441106440178  Primal_obj =  0.4178275872948879  Gap =  0.00358347665087011 Sum =  0.999813995633496
Iteration =  21  Dual obj =  0.4142442573461351  Primal_obj =  0.41737411913702366  Gap =  0.003129861790888533 Sum =  0.9999860363428661
Iteration =  22  Dual obj =  0.41424437270925596  Primal_obj =  0.41722560544031184  Gap =  0.002981232731055883 Sum =  1.0000849092042925
Iteration =  23  Dual obj =  0.41424449831194865  Primal_obj =  0.416965410795785  Gap =  0.002720912483836324 Sum =  1.0000142124789753
Iteration =  24  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  0  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  1  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  2  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  3  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  4  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  5  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  6  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  7  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  8  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  9  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  10  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  11  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  12  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  13  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  14  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  15  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  16  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  17  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  18  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  19  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  20  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  21  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  22  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  23  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  24  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  0  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  1  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  2  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  3  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  4  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  5  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  6  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  7  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  8  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  9  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  10  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  11  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  12  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  13  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  14  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  15  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  16  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  17  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  18  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  19  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  20  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  21  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  22  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  23  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Iteration =  24  Dual obj =  0.4142445784331739  Primal_obj =  0.4166787021876905  Gap =  0.0024341237545165706 Sum =  0.9998574630021246
Done, writing results...
