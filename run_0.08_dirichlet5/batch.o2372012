2021-04-29 13:23:29,500 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.04s.
2021-04-29 13:23:29,900 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.21s.
2021-04-29 13:23:30,286 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.39s.
2021-04-29 13:23:30,395 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-29 13:23:30,398 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 13:23:30,407 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 13:23:31,201 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 109.
2021-04-29 13:23:31,203 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.81s.
Iteration =  0  Dual obj =  -45.95740735696438  Primal_obj =  294705.55180801905  Gap =  294751.509215376 Sum =  361.71899190044326
Iteration =  1  Dual obj =  0.004821750707424244  Primal_obj =  326.48369097313224  Gap =  326.4788692224248 Sum =  1.0437987117372425
Iteration =  2  Dual obj =  0.163878235878379  Primal_obj =  154.64959254154462  Gap =  154.48571430566625 Sum =  0.7102749673158133
Iteration =  3  Dual obj =  0.20600374801194862  Primal_obj =  74.91740269274773  Gap =  74.71139894473578 Sum =  0.6614639264418145
Iteration =  4  Dual obj =  0.23854749210939627  Primal_obj =  32.50223810716866  Gap =  32.26369061505926 Sum =  0.7089592128650373
Iteration =  5  Dual obj =  0.25601703268240256  Primal_obj =  14.4884764831918  Gap =  14.232459450509397 Sum =  0.9365195538271527
Iteration =  6  Dual obj =  0.2611498220229741  Primal_obj =  3.3196983000814395  Gap =  3.0585484780584653 Sum =  0.9814862762564551
Iteration =  7  Dual obj =  0.2623766180231494  Primal_obj =  0.9349859303790294  Gap =  0.6726093123558801 Sum =  0.9986551168991442
Iteration =  8  Dual obj =  0.2626129377754428  Primal_obj =  0.5055540488619608  Gap =  0.24294111108651795 Sum =  1.0003091790425185
Iteration =  9  Dual obj =  0.26269510944911817  Primal_obj =  0.37554316499838614  Gap =  0.11284805554926797 Sum =  1.003239308615935
Iteration =  10  Dual obj =  0.2627245332776758  Primal_obj =  0.3066162371437883  Gap =  0.043891703866112464 Sum =  1.0005370146162236
Iteration =  11  Dual obj =  0.26273593832441433  Primal_obj =  0.28687973648874887  Gap =  0.02414379816433454 Sum =  0.9998981126607444
Iteration =  12  Dual obj =  0.26274168786966545  Primal_obj =  0.2766391421170815  Gap =  0.013897454247416063 Sum =  0.9993815899099324
Iteration =  13  Dual obj =  0.26274507312277007  Primal_obj =  0.2706294384112252  Gap =  0.007884365288455153 Sum =  0.9998096459998982
Iteration =  14  Dual obj =  0.2627468420929878  Primal_obj =  0.26689178963689253  Gap =  0.004144947543904709 Sum =  0.9999699936688005
Iteration =  15  Dual obj =  0.2627477498562672  Primal_obj =  0.2650445086445977  Gap =  0.002296758788330522 Sum =  1.0000647462561791
Iteration =  16  Dual obj =  0.26274820214719025  Primal_obj =  0.2645228090674444  Gap =  0.0017746069202541626 Sum =  0.9999082231016838
Iteration =  17  Dual obj =  0.26274855076611225  Primal_obj =  0.26381056436650585  Gap =  0.0010620136003935965 Sum =  1.000015780630885
Iteration =  18  Dual obj =  0.26274868465385964  Primal_obj =  0.26326828244886763  Gap =  0.0005195977950079866 Sum =  0.9999539714303973
Iteration =  19  Dual obj =  0.26274878838306154  Primal_obj =  0.2630958470636513  Gap =  0.0003470586805897624 Sum =  0.9999936870269404
Iteration =  20  Dual obj =  0.26274883766630963  Primal_obj =  0.2629931412508931  Gap =  0.000244303584583494 Sum =  1.0000042716145972
Iteration =  21  Dual obj =  0.26274885912553303  Primal_obj =  0.2629456197230856  Gap =  0.00019676059755258102 Sum =  1.0000055602111515
Iteration =  22  Dual obj =  0.26274885912553303  Primal_obj =  0.2629456197230856  Gap =  0.00019676059755258102 Sum =  1.0000055602111515
Iteration =  23  Dual obj =  0.26274885912553303  Primal_obj =  0.2629456197230856  Gap =  0.00019676059755258102 Sum =  1.0000055602111515
Iteration =  24  Dual obj =  0.26274885912553303  Primal_obj =  0.2629456197230856  Gap =  0.00019676059755258102 Sum =  1.0000055602111515
Iteration =  0  Dual obj =  -18.54598691732698  Primal_obj =  169178.39942785585  Gap =  169196.9454147732 Sum =  361.71899190044326
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  0.008687966837510261  Primal_obj =  369.57515584312495  Gap =  369.56646787628745 Sum =  0.97382384994073
Iteration =  3  Dual obj =  0.253455907093558  Primal_obj =  191.58244502724892  Gap =  191.32898912015537 Sum =  0.614450031628079
Iteration =  4  Dual obj =  0.34555655981836125  Primal_obj =  82.22539471149403  Gap =  81.87983815167567 Sum =  0.6008129671388287
Iteration =  5  Dual obj =  0.37817757608661495  Primal_obj =  43.47220383615354  Gap =  43.094026260066926 Sum =  1.247771685775465
Iteration =  6  Dual obj =  0.39222696956842207  Primal_obj =  20.849103026314165  Gap =  20.45687605674574 Sum =  0.9022818515201599
Iteration =  7  Dual obj =  0.39917093833510275  Primal_obj =  14.11225719698679  Gap =  13.713086258651686 Sum =  1.0103987267074124
Iteration =  8  Dual obj =  0.40322989825851246  Primal_obj =  8.03077483649042  Gap =  7.627544938231907 Sum =  0.994375959066214
Iteration =  9  Dual obj =  0.40501147842269575  Primal_obj =  4.796708834658983  Gap =  4.391697356236286 Sum =  1.0024946960768468
Iteration =  10  Dual obj =  0.4057033713624417  Primal_obj =  2.580213784870786  Gap =  2.174510413508344 Sum =  0.9930083766206499
Iteration =  11  Dual obj =  0.4060810687566843  Primal_obj =  1.6715284059861018  Gap =  1.2654473372294175 Sum =  0.9948594703926288
Iteration =  12  Dual obj =  0.4062645951920266  Primal_obj =  0.9424425181882214  Gap =  0.5361779229961948 Sum =  0.998156274340469
Iteration =  13  Dual obj =  0.4063386020181766  Primal_obj =  0.7947567036727952  Gap =  0.38841810165461854 Sum =  0.9992994137094382
Iteration =  14  Dual obj =  0.406410023133003  Primal_obj =  0.7697292032816498  Gap =  0.36331918014864684 Sum =  1.0001175781078446
Iteration =  15  Dual obj =  0.40646824270312737  Primal_obj =  0.6913449809290706  Gap =  0.2848767382259432 Sum =  0.9976991138367883
Iteration =  16  Dual obj =  0.40651609334438804  Primal_obj =  0.6484028089892523  Gap =  0.24188671564486425 Sum =  0.9991326306979914
Iteration =  17  Dual obj =  0.40654986974266466  Primal_obj =  0.5865512925622205  Gap =  0.18000142281955583 Sum =  1.0005266937714885
Iteration =  18  Dual obj =  0.40657502711512056  Primal_obj =  0.540967568082793  Gap =  0.13439254096767245 Sum =  0.9997316260215068
Iteration =  19  Dual obj =  0.4065910090578107  Primal_obj =  0.4920853769237753  Gap =  0.0854943678659646 Sum =  0.9994227747916946
Iteration =  20  Dual obj =  0.40660334701158846  Primal_obj =  0.48242956407646587  Gap =  0.07582621706487741 Sum =  0.999689714769004
Iteration =  21  Dual obj =  0.406614563680479  Primal_obj =  0.47218015204775365  Gap =  0.06556558836727466 Sum =  0.9996969521168406
Iteration =  22  Dual obj =  0.40662361755131826  Primal_obj =  0.4647563995403032  Gap =  0.058132781988984916 Sum =  1.0001110694125144
Iteration =  23  Dual obj =  0.4066312126506596  Primal_obj =  0.4541888322954467  Gap =  0.04755761964478711 Sum =  0.9999253136748805
Iteration =  24  Dual obj =  0.40663686577479324  Primal_obj =  0.44604529037783713  Gap =  0.03940842460304389 Sum =  0.9996663046759887
Iteration =  0  Dual obj =  0.40663686577479324  Primal_obj =  0.44604529037783713  Gap =  0.03940842460304389 Sum =  0.9996663046759887
Iteration =  1  Dual obj =  0.40664013599946813  Primal_obj =  0.42857784691899337  Gap =  0.021937710919525233 Sum =  0.9998817413104584
Iteration =  2  Dual obj =  0.406642551138137  Primal_obj =  0.42789374368402155  Gap =  0.021251192545884534 Sum =  0.999895825003501
Iteration =  3  Dual obj =  0.40664630386578016  Primal_obj =  0.4334627506485037  Gap =  0.026816446782723546 Sum =  0.9997870662645572
Iteration =  4  Dual obj =  0.406649589415758  Primal_obj =  0.4299400812815808  Gap =  0.02329049186582277 Sum =  0.9998205892610945
Iteration =  5  Dual obj =  0.406652468615225  Primal_obj =  0.42429351223381195  Gap =  0.017641043618586927 Sum =  0.9999118317269908
Iteration =  6  Dual obj =  0.40665454201717516  Primal_obj =  0.4235921742194932  Gap =  0.01693763220231803 Sum =  0.999888501507793
Iteration =  7  Dual obj =  0.40665639343189885  Primal_obj =  0.4215295462839297  Gap =  0.014873152852030835 Sum =  0.999988352040547
Iteration =  8  Dual obj =  0.40665821666031654  Primal_obj =  0.4205581217111286  Gap =  0.013899905050812067 Sum =  0.9998550686393815
Iteration =  9  Dual obj =  0.40665958584436995  Primal_obj =  0.42090724498153975  Gap =  0.0142476591371698 Sum =  0.9998924507824115
Iteration =  10  Dual obj =  0.40666090267808264  Primal_obj =  0.42105919551704996  Gap =  0.01439829283896732 Sum =  0.9997293325795966
Iteration =  11  Dual obj =  0.40666204132718503  Primal_obj =  0.41773049090433334  Gap =  0.01106844957714831 Sum =  0.9998410442483714
Iteration =  12  Dual obj =  0.4066628665807961  Primal_obj =  0.4151107270879126  Gap =  0.00844786050711649 Sum =  0.9999978951804935
Iteration =  13  Dual obj =  0.40666352775744263  Primal_obj =  0.41469939000626777  Gap =  0.008035862248825132 Sum =  1.0002299629157407
Iteration =  14  Dual obj =  0.40666415357027696  Primal_obj =  0.41460599650445085  Gap =  0.007941842934173882 Sum =  1.0002513990796542
Iteration =  15  Dual obj =  0.4066647767781534  Primal_obj =  0.41400234771749156  Gap =  0.007337570939338178 Sum =  0.9999992478210602
Iteration =  16  Dual obj =  0.4066652889709548  Primal_obj =  0.41333172395581574  Gap =  0.006666434984860969 Sum =  0.9998021381521388
Iteration =  17  Dual obj =  0.4066657616602384  Primal_obj =  0.4138139134196884  Gap =  0.007148151759449994 Sum =  0.9997269622878386
Iteration =  18  Dual obj =  0.4066661876153473  Primal_obj =  0.4138375994585153  Gap =  0.007171411843167996 Sum =  0.9997835729807472
Iteration =  19  Dual obj =  0.4066665826730802  Primal_obj =  0.41294080717919274  Gap =  0.006274224506112536 Sum =  0.9998441341591584
Iteration =  20  Dual obj =  0.4066668718221798  Primal_obj =  0.4122145672811196  Gap =  0.005547695458939794 Sum =  0.9999789651707722
Iteration =  21  Dual obj =  0.40666717500086896  Primal_obj =  0.411588124309326  Gap =  0.0049209493084570455 Sum =  1.000098541464889
Iteration =  22  Dual obj =  0.40666743068743955  Primal_obj =  0.41175279680757104  Gap =  0.005085366120131496 Sum =  1.0001177346444265
Iteration =  23  Dual obj =  0.40666768554135024  Primal_obj =  0.41246556353165353  Gap =  0.005797877990303291 Sum =  1.000059003283976
Iteration =  24  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  0  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  1  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  2  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  3  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  4  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  5  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  6  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  7  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  8  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  9  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  10  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  11  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  12  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  13  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  14  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  15  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  16  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  17  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  18  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  19  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  20  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  21  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  22  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  23  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  24  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  0  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  1  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  2  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  3  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  4  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  5  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  6  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  7  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  8  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  9  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  10  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  11  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  12  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  13  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  14  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  15  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  16  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  17  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  18  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  19  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  20  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  21  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  22  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  23  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Iteration =  24  Dual obj =  0.4066679336523713  Primal_obj =  0.41228431795151566  Gap =  0.00561638429914435 Sum =  0.9999577186182207
Done, writing results...
