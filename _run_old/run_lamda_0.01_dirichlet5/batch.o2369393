2021-04-27 22:08:16,319 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.28s.
2021-04-27 22:08:16,780 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-27 22:08:17,197 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.42s.
2021-04-27 22:08:17,320 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-27 22:08:17,323 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 22:08:17,333 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 22:08:18,182 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 109.
2021-04-27 22:08:18,183 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.86s.
Iteration =  0  Dual obj =  -38.421056472521755  Primal_obj =  28917.41889837565  Gap =  28955.839954848172 Sum =  416.3672446079836
Iteration =  1  Dual obj =  -0.05316154492650405  Primal_obj =  13.609476250789335  Gap =  13.662637795715838 Sum =  0.8612216358147206
Iteration =  2  Dual obj =  -0.01191835431101522  Primal_obj =  5.455735405754517  Gap =  5.467653760065532 Sum =  0.7931001943243378
Iteration =  3  Dual obj =  0.00043625127922850004  Primal_obj =  2.5839433264759633  Gap =  2.5835070751967346 Sum =  0.853633523267314
Iteration =  4  Dual obj =  0.006389994830624765  Primal_obj =  1.1513867169045682  Gap =  1.1449967220739434 Sum =  0.9754559084231433
Iteration =  5  Dual obj =  0.00822619020098031  Primal_obj =  0.47617283247763514  Gap =  0.46794664227665483 Sum =  1.008409587120366
Iteration =  6  Dual obj =  0.008762253100657341  Primal_obj =  0.23953253112930556  Gap =  0.23077027802864822 Sum =  0.9929535797382357
Iteration =  7  Dual obj =  0.008948933880012007  Primal_obj =  0.13896889839115284  Gap =  0.13001996451114084 Sum =  0.9927127277499551
Iteration =  8  Dual obj =  0.009035944941771361  Primal_obj =  0.07633854971868781  Gap =  0.06730260477691645 Sum =  0.9986859332810345
Iteration =  9  Dual obj =  0.009073718675639926  Primal_obj =  0.04620807083234475  Gap =  0.037134352156704825 Sum =  0.998611668995875
Iteration =  10  Dual obj =  0.00909267264483275  Primal_obj =  0.031105607624204265  Gap =  0.022012934979371516 Sum =  0.9991114733044493
Iteration =  11  Dual obj =  0.009101755848172624  Primal_obj =  0.020778622439602226  Gap =  0.011676866591429602 Sum =  1.000339900329203
Iteration =  12  Dual obj =  0.009105462497979576  Primal_obj =  0.015747137412133932  Gap =  0.006641674914154357 Sum =  0.9997531989350759
Iteration =  13  Dual obj =  0.009107419246245599  Primal_obj =  0.013369057475802928  Gap =  0.00426163822955733 Sum =  0.9996266591481007
Iteration =  14  Dual obj =  0.009108726651790279  Primal_obj =  0.011898280947759785  Gap =  0.0027895542959695055 Sum =  1.0000658158035438
Iteration =  15  Dual obj =  0.009109583898737242  Primal_obj =  0.010981545701295684  Gap =  0.0018719618025584417 Sum =  0.999852358665271
Iteration =  16  Dual obj =  0.009110188529781186  Primal_obj =  0.01044303091038798  Gap =  0.0013328423806067934 Sum =  0.9997064769614454
Iteration =  17  Dual obj =  0.00911063031204281  Primal_obj =  0.010130596264898581  Gap =  0.0010199659528557711 Sum =  0.9999487760758268
Iteration =  18  Dual obj =  0.00911096978894321  Primal_obj =  0.00992748641239416  Gap =  0.0008165166234509504 Sum =  0.9999903682048941
Iteration =  19  Dual obj =  0.009111229280648133  Primal_obj =  0.009787119494781088  Gap =  0.0006758902141329546 Sum =  0.999861587024667
Iteration =  20  Dual obj =  0.009111444865698214  Primal_obj =  0.009677667214736257  Gap =  0.0005662223490380432 Sum =  0.9999541484106267
Iteration =  21  Dual obj =  0.009111612294060854  Primal_obj =  0.009593814153720667  Gap =  0.00048220185965981363 Sum =  1.0000685533430942
Iteration =  22  Dual obj =  0.009111757153491735  Primal_obj =  0.009507842027538252  Gap =  0.0003960848740465171 Sum =  0.9999175510891002
Iteration =  23  Dual obj =  0.009111868518881025  Primal_obj =  0.009451303619182075  Gap =  0.0003394351003010495 Sum =  0.9999314867106327
Iteration =  24  Dual obj =  0.009111970756649292  Primal_obj =  0.00940513680223902  Gap =  0.0002931660455897274 Sum =  1.0000393206582556
Iteration =  0  Dual obj =  -38.45477418986339  Primal_obj =  30667.922322870396  Gap =  30706.37709706026 Sum =  416.3672446079836
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.2681718114278082  Primal_obj =  167.7268969806783  Gap =  167.9950687921061 Sum =  5.374896114580478
Iteration =  4  Dual obj =  -0.03520008034856429  Primal_obj =  17.376718154280006  Gap =  17.41191823462857 Sum =  0.8515194611426595
Iteration =  5  Dual obj =  -0.009293770248242586  Primal_obj =  13.386233683398238  Gap =  13.395527453646482 Sum =  0.8199861111616473
Iteration =  6  Dual obj =  -0.0012930776730254723  Primal_obj =  10.081262349645517  Gap =  10.082555427318542 Sum =  0.8288955312690545
Iteration =  7  Dual obj =  0.003625553624611068  Primal_obj =  8.99323127331769  Gap =  8.98960571969308 Sum =  0.8479298975459788
Iteration =  8  Dual obj =  0.009194532661492422  Primal_obj =  7.738137530532609  Gap =  7.728942997871116 Sum =  0.8724188012471509
Iteration =  9  Dual obj =  0.013566668791430397  Primal_obj =  5.3728067589393715  Gap =  5.359240090147941 Sum =  0.7990177773205615
Iteration =  10  Dual obj =  0.019057973718013967  Primal_obj =  4.126999992503944  Gap =  4.10794201878593 Sum =  0.8027785867681878
Iteration =  11  Dual obj =  0.021928854924075494  Primal_obj =  2.957101160954315  Gap =  2.9351723060302395 Sum =  0.8117739190037221
Iteration =  12  Dual obj =  0.023817246143616168  Primal_obj =  2.649250928109177  Gap =  2.6254336819655606 Sum =  0.8270641988288161
Iteration =  13  Dual obj =  0.025592273592492987  Primal_obj =  2.2308622293874225  Gap =  2.2052699557949293 Sum =  0.8565814547491115
Iteration =  14  Dual obj =  0.026991029033243612  Primal_obj =  1.663865746355096  Gap =  1.6368747173218525 Sum =  0.8851126604410111
Iteration =  15  Dual obj =  0.028025591485125775  Primal_obj =  1.4437912048793922  Gap =  1.4157656133942664 Sum =  0.9169607194671251
Iteration =  16  Dual obj =  0.028778631856654104  Primal_obj =  1.2696728736559788  Gap =  1.2408942417993247 Sum =  0.9549001195180145
Iteration =  17  Dual obj =  0.02933162985553759  Primal_obj =  1.2065033395578817  Gap =  1.1771717097023442 Sum =  0.9666066009649644
Iteration =  18  Dual obj =  0.029843961657889783  Primal_obj =  0.8707353709378016  Gap =  0.8408914092799118 Sum =  0.9540748886012824
Iteration =  19  Dual obj =  0.030203243080746543  Primal_obj =  0.7153310243893489  Gap =  0.6851277813086024 Sum =  0.9533343015172177
Iteration =  20  Dual obj =  0.030475853562813585  Primal_obj =  0.5991057350694468  Gap =  0.5686298815066332 Sum =  0.9621356601399378
Iteration =  21  Dual obj =  0.030690931082547522  Primal_obj =  0.6169325105931461  Gap =  0.5862415795105986 Sum =  0.9695252567826452
Iteration =  22  Dual obj =  0.030919355109226766  Primal_obj =  0.531295089632067  Gap =  0.5003757345228402 Sum =  0.964733875659407
Iteration =  23  Dual obj =  0.031061812063741947  Primal_obj =  0.46567328554312293  Gap =  0.434611473479381 Sum =  0.9668115646312307
Iteration =  24  Dual obj =  0.03120587512552058  Primal_obj =  0.4370949669285647  Gap =  0.4058890918030441 Sum =  0.9719754282780086
Iteration =  0  Dual obj =  0.03120587512552058  Primal_obj =  0.4370949669285647  Gap =  0.4058890918030441 Sum =  0.9719754282780086
Iteration =  1  Dual obj =  0.03127909079589624  Primal_obj =  0.3634722687451888  Gap =  0.33219317794929254 Sum =  0.9700993832947933
Iteration =  2  Dual obj =  0.031329620159005166  Primal_obj =  0.3239854866869618  Gap =  0.29265586652795667 Sum =  0.9740232923846448
Iteration =  3  Dual obj =  0.03139468202219894  Primal_obj =  0.2952581721312717  Gap =  0.2638634901090728 Sum =  0.9851184428676039
Iteration =  4  Dual obj =  0.031447367456715516  Primal_obj =  0.28553449988827123  Gap =  0.25408713243155573 Sum =  0.9868402875050926
Iteration =  5  Dual obj =  0.03151199954660479  Primal_obj =  0.27143223463921934  Gap =  0.23992023509261456 Sum =  0.9950428546871133
Iteration =  6  Dual obj =  0.031576214914201844  Primal_obj =  0.2671654770267054  Gap =  0.23558926211250356 Sum =  1.000422059370447
Iteration =  7  Dual obj =  0.031636566567582985  Primal_obj =  0.2397720198740204  Gap =  0.2081354533064374 Sum =  1.0034185495481356
Iteration =  8  Dual obj =  0.0316781475010474  Primal_obj =  0.24603257551962357  Gap =  0.21435442801857618 Sum =  1.0096422596349444
Iteration =  9  Dual obj =  0.031713254551413994  Primal_obj =  0.20673233396071627  Gap =  0.17501907940930228 Sum =  1.010849698710415
Iteration =  10  Dual obj =  0.031736760254958155  Primal_obj =  0.18480934756670625  Gap =  0.1530725873117481 Sum =  1.009280137138893
Iteration =  11  Dual obj =  0.031751383988101456  Primal_obj =  0.17275147782530986  Gap =  0.1410000938372084 Sum =  1.0095888487071827
Iteration =  12  Dual obj =  0.03176582341975483  Primal_obj =  0.1593249844175158  Gap =  0.127559160997761 Sum =  1.0057816095035028
Iteration =  13  Dual obj =  0.031779724189048855  Primal_obj =  0.13979969493667924  Gap =  0.10801997074763038 Sum =  1.0030632547358669
Iteration =  14  Dual obj =  0.0317908413099007  Primal_obj =  0.13114021496280936  Gap =  0.09934937365290866 Sum =  1.0027276407447139
Iteration =  15  Dual obj =  0.03180026737719695  Primal_obj =  0.12110752467430283  Gap =  0.08930725729710588 Sum =  1.0019937792649964
Iteration =  16  Dual obj =  0.03181020924761101  Primal_obj =  0.1102341338992682  Gap =  0.07842392465165719 Sum =  1.0006885820275806
Iteration =  17  Dual obj =  0.03181878385971244  Primal_obj =  0.10371817999213034  Gap =  0.0718993961324179 Sum =  1.00070045035721
Iteration =  18  Dual obj =  0.03182651494578104  Primal_obj =  0.09178204104665408  Gap =  0.05995552610087304 Sum =  1.0004698919320116
Iteration =  19  Dual obj =  0.03183261817339027  Primal_obj =  0.08633712045151484  Gap =  0.054504502278124575 Sum =  0.9999698236278267
Iteration =  20  Dual obj =  0.03183912631319661  Primal_obj =  0.08146843378978127  Gap =  0.049629307476584665 Sum =  0.9985020166628167
Iteration =  21  Dual obj =  0.03184420789558452  Primal_obj =  0.07470275206647048  Gap =  0.04285854417088596 Sum =  0.9976517837030703
Iteration =  22  Dual obj =  0.031849678693722794  Primal_obj =  0.07027582290053228  Gap =  0.03842614420680948 Sum =  0.9979118846274109
Iteration =  23  Dual obj =  0.03185377085918237  Primal_obj =  0.06527500081543065  Gap =  0.033421229956248286 Sum =  0.9981196247994464
Iteration =  24  Dual obj =  0.03185818421585268  Primal_obj =  0.0610046987106075  Gap =  0.02914651449475482 Sum =  0.9983271556335412
Iteration =  0  Dual obj =  0.03185818421585268  Primal_obj =  0.0610046987106075  Gap =  0.02914651449475482 Sum =  0.9983271556335412
Iteration =  1  Dual obj =  0.03186006419878405  Primal_obj =  0.05928450422607216  Gap =  0.02742444002728811 Sum =  0.9977440252858738
Iteration =  2  Dual obj =  0.03186148068376345  Primal_obj =  0.05719673948465803  Gap =  0.02533525880089458 Sum =  0.9978586820336562
Iteration =  3  Dual obj =  0.03186270565438225  Primal_obj =  0.05511860492371043  Gap =  0.02325589926932818 Sum =  0.9983239447343044
Iteration =  4  Dual obj =  0.03186400334283648  Primal_obj =  0.05400474335618871  Gap =  0.022140740013352228 Sum =  0.998394726916161
Iteration =  5  Dual obj =  0.031865450115321985  Primal_obj =  0.053261705005328286  Gap =  0.0213962548900063 Sum =  0.9993748610223143
Iteration =  6  Dual obj =  0.03186733862548875  Primal_obj =  0.052017219581548924  Gap =  0.02014988095606017 Sum =  0.9997738692582125
Iteration =  7  Dual obj =  0.031868756868041886  Primal_obj =  0.05194070482997716  Gap =  0.020071947961935274 Sum =  1.0003945807870163
Iteration =  8  Dual obj =  0.031870573943602314  Primal_obj =  0.0512405219764748  Gap =  0.019369948032872487 Sum =  1.000932755497518
Iteration =  9  Dual obj =  0.0318717228651959  Primal_obj =  0.050874039060577844  Gap =  0.019002316195381945 Sum =  1.0013356269208535
Iteration =  10  Dual obj =  0.03187297876930895  Primal_obj =  0.05057936506516858  Gap =  0.018706386295859627 Sum =  1.0013215609815282
Iteration =  11  Dual obj =  0.03187427122354711  Primal_obj =  0.04959709711147822  Gap =  0.017722825887931115 Sum =  1.0013908134914327
Iteration =  12  Dual obj =  0.03187543373083326  Primal_obj =  0.04918610768110447  Gap =  0.017310673950271215 Sum =  1.0019333378003257
Iteration =  13  Dual obj =  0.03187653487176002  Primal_obj =  0.04882295778587957  Gap =  0.016946422914119547 Sum =  1.0022802250303222
Iteration =  14  Dual obj =  0.03187794148925271  Primal_obj =  0.04846469026816083  Gap =  0.016586748778908124 Sum =  1.0019804970739057
Iteration =  15  Dual obj =  0.031879158479213854  Primal_obj =  0.04820574710865308  Gap =  0.016326588629439226 Sum =  1.0020476941274794
Iteration =  16  Dual obj =  0.031880633696660235  Primal_obj =  0.04839416086413456  Gap =  0.016513527167474326 Sum =  1.0013772780250494
Iteration =  17  Dual obj =  0.03188218069422393  Primal_obj =  0.048195277685865345  Gap =  0.016313096991641414 Sum =  1.0023714960078638
Iteration =  18  Dual obj =  0.03188343016577633  Primal_obj =  0.04836971745541287  Gap =  0.01648628728963654 Sum =  1.0018885772417816
Iteration =  19  Dual obj =  0.03188451939439767  Primal_obj =  0.04781291418732507  Gap =  0.015928394792927403 Sum =  1.0016351147424147
Iteration =  20  Dual obj =  0.03188554474690323  Primal_obj =  0.04601359847047637  Gap =  0.01412805372357314 Sum =  1.0010703845858082
Iteration =  21  Dual obj =  0.03188639414396905  Primal_obj =  0.04525401951232566  Gap =  0.01336762536835661 Sum =  1.0002253888886607
Iteration =  22  Dual obj =  0.03188719641375972  Primal_obj =  0.04447067777404244  Gap =  0.01258348136028272 Sum =  0.9997573338023447
Iteration =  23  Dual obj =  0.031887934346644754  Primal_obj =  0.043689910200322646  Gap =  0.011801975853677892 Sum =  0.9997317697380587
Iteration =  24  Dual obj =  0.03188858822272017  Primal_obj =  0.04313285861119387  Gap =  0.011244270388473698 Sum =  0.9992490606461952
Iteration =  0  Dual obj =  0.03188858822272017  Primal_obj =  0.04313285861119387  Gap =  0.011244270388473698 Sum =  0.9992490606461952
Iteration =  1  Dual obj =  0.03188895006587395  Primal_obj =  0.042645086156368875  Gap =  0.010756136090494924 Sum =  0.999274648224078
Iteration =  2  Dual obj =  0.031889350341473874  Primal_obj =  0.0420126834122555  Gap =  0.010123333070781629 Sum =  0.9995125967881747
Iteration =  3  Dual obj =  0.03188974715021882  Primal_obj =  0.04142400604829771  Gap =  0.009534258898078893 Sum =  0.9997702933381722
Iteration =  4  Dual obj =  0.03189005767696797  Primal_obj =  0.040946079813568334  Gap =  0.009056022136600367 Sum =  0.9999705036150612
Iteration =  5  Dual obj =  0.03189026385747489  Primal_obj =  0.04065648293024793  Gap =  0.008766219072773036 Sum =  0.9999731850453466
Iteration =  6  Dual obj =  0.03189050718440559  Primal_obj =  0.04025514691609745  Gap =  0.00836463973169186 Sum =  1.0000560233899995
Iteration =  7  Dual obj =  0.031890801607623705  Primal_obj =  0.03987230616567625  Gap =  0.007981504558052542 Sum =  0.9998838497625704
Iteration =  8  Dual obj =  0.0318912132986076  Primal_obj =  0.03945721418695916  Gap =  0.007566000888351562 Sum =  0.9998586762125173
Iteration =  9  Dual obj =  0.03189181821980778  Primal_obj =  0.03897871231910115  Gap =  0.0070868940992933685 Sum =  0.9998698123710097
Iteration =  10  Dual obj =  0.03189234253051673  Primal_obj =  0.03869387480867327  Gap =  0.0068015322781565385 Sum =  0.9999769627141648
Iteration =  11  Dual obj =  0.031892691154903674  Primal_obj =  0.03859801859968724  Gap =  0.006705327444783568 Sum =  1.0001595752598487
Iteration =  12  Dual obj =  0.0318930833496129  Primal_obj =  0.03862357356585075  Gap =  0.006730490216237853 Sum =  1.000412909291431
Iteration =  13  Dual obj =  0.03189360337558967  Primal_obj =  0.03856408318068609  Gap =  0.00667047980509642 Sum =  1.0006762045956452
Iteration =  14  Dual obj =  0.031893877163621014  Primal_obj =  0.038554505809168096  Gap =  0.006660628645547083 Sum =  1.0006942167182435
Iteration =  15  Dual obj =  0.03189427682708945  Primal_obj =  0.038671642959319893  Gap =  0.006777366132230442 Sum =  1.0009941780240912
Iteration =  16  Dual obj =  0.03189470580199978  Primal_obj =  0.03881805608281384  Gap =  0.006923350280814061 Sum =  1.0008225801925987
Iteration =  17  Dual obj =  0.031895188842636195  Primal_obj =  0.03878529590260893  Gap =  0.006890107059972735 Sum =  1.0007954805260821
Iteration =  18  Dual obj =  0.03189572868876264  Primal_obj =  0.03889057533225217  Gap =  0.0069948466434895246 Sum =  1.0006183775653166
Iteration =  19  Dual obj =  0.031896046706553396  Primal_obj =  0.03934656466041349  Gap =  0.007450517953860092 Sum =  1.0004709553028173
Iteration =  20  Dual obj =  0.03189641413653574  Primal_obj =  0.039756128010439484  Gap =  0.007859713873903745 Sum =  1.000150282519518
Iteration =  21  Dual obj =  0.03189672093314365  Primal_obj =  0.03985884137675924  Gap =  0.007962120443615592 Sum =  1.0000763663400425
Iteration =  22  Dual obj =  0.03189715349144054  Primal_obj =  0.03960336974311579  Gap =  0.007706216251675252 Sum =  1.000031860609108
Iteration =  23  Dual obj =  0.0318975616206847  Primal_obj =  0.03925089257644271  Gap =  0.007353330955758006 Sum =  1.0002568272526302
Iteration =  24  Dual obj =  0.03189802628723602  Primal_obj =  0.039222580590010936  Gap =  0.007324554302774913 Sum =  1.0000869442093938
Done, writing results...
