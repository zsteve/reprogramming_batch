2021-04-27 21:35:12,428 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.30s.
2021-04-27 21:35:12,887 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-27 21:35:13,309 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.42s.
2021-04-27 21:35:13,433 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-27 21:35:13,436 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 21:35:13,446 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 21:35:14,298 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 101.
2021-04-27 21:35:14,300 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.87s.
Iteration =  0  Dual obj =  -38.32877935602361  Primal_obj =  36021.35085374538  Gap =  36059.679633101405 Sum =  433.09277994203865
Iteration =  1  Dual obj =  -0.03329053532818688  Primal_obj =  23.165661629076446  Gap =  23.198952164404634 Sum =  1.0905301120782775
Iteration =  2  Dual obj =  0.010954268187972419  Primal_obj =  5.5891445079822155  Gap =  5.578190239794243 Sum =  0.7819090355639897
Iteration =  3  Dual obj =  0.024078111973433486  Primal_obj =  2.5894109829622676  Gap =  2.565332870988834 Sum =  0.8373810998602393
Iteration =  4  Dual obj =  0.030382020312111326  Primal_obj =  1.3322736072648378  Gap =  1.3018915869527266 Sum =  0.9448132370973099
Iteration =  5  Dual obj =  0.03254537061330691  Primal_obj =  0.5191609276267471  Gap =  0.4866155570134402 Sum =  1.016798110352723
Iteration =  6  Dual obj =  0.03321459420161058  Primal_obj =  0.32050863419372033  Gap =  0.28729403999210973 Sum =  0.9978058530832379
Iteration =  7  Dual obj =  0.03353055983432299  Primal_obj =  0.20675438419296865  Gap =  0.17322382435864567 Sum =  0.9928125443889825
Iteration =  8  Dual obj =  0.0337374887479453  Primal_obj =  0.145501942028044  Gap =  0.11176445328009871 Sum =  1.0004422446511119
Iteration =  9  Dual obj =  0.03383860167701405  Primal_obj =  0.08900882870186455  Gap =  0.0551702270248505 Sum =  1.000588444596884
Iteration =  10  Dual obj =  0.03388632403222948  Primal_obj =  0.06260746526651054  Gap =  0.02872114123428106 Sum =  0.9990977861491293
Iteration =  11  Dual obj =  0.03390592163063955  Primal_obj =  0.04740723931519848  Gap =  0.01350131768455893 Sum =  0.9992472058838057
Iteration =  12  Dual obj =  0.03391392609729  Primal_obj =  0.04095322122308123  Gap =  0.0070392951257912326 Sum =  0.9994429102491561
Iteration =  13  Dual obj =  0.03391766450711544  Primal_obj =  0.038058974344494706  Gap =  0.004141309837379266 Sum =  0.9994431172937055
Iteration =  14  Dual obj =  0.033919891127228874  Primal_obj =  0.036700817596221735  Gap =  0.0027809264689928614 Sum =  0.9994201386742153
Iteration =  15  Dual obj =  0.0339212848503546  Primal_obj =  0.03598048158615019  Gap =  0.0020591967357955904 Sum =  0.9999653057301139
Iteration =  16  Dual obj =  0.033922251788785135  Primal_obj =  0.035420146555856444  Gap =  0.0014978947670713089 Sum =  0.9995569805326855
Iteration =  17  Dual obj =  0.033922891956793065  Primal_obj =  0.03504298468986737  Gap =  0.0011200927330743057 Sum =  0.9997863809734159
Iteration =  18  Dual obj =  0.03392334810352368  Primal_obj =  0.03480883171217698  Gap =  0.0008854836086533008 Sum =  0.9998121497739842
Iteration =  19  Dual obj =  0.03392367902506149  Primal_obj =  0.034610029686605606  Gap =  0.0006863506615441134 Sum =  0.9998370548798425
Iteration =  20  Dual obj =  0.03392392184557144  Primal_obj =  0.03447359482714547  Gap =  0.0005496729815740314 Sum =  0.9998938390106946
Iteration =  21  Dual obj =  0.03392411172099531  Primal_obj =  0.03437912325328321  Gap =  0.0004550115322878995 Sum =  0.9999975628032821
Iteration =  22  Dual obj =  0.033924255225638314  Primal_obj =  0.03429621777073391  Gap =  0.0003719625450955971 Sum =  1.0000095276841623
Iteration =  23  Dual obj =  0.03392436840112792  Primal_obj =  0.03423445520944206  Gap =  0.00031008680831413893 Sum =  0.9999402897257549
Iteration =  24  Dual obj =  0.033924453606264934  Primal_obj =  0.03419283672918995  Gap =  0.00026838312292501443 Sum =  0.9999980624605829
Iteration =  0  Dual obj =  -41.50056046269417  Primal_obj =  43896.35835917719  Gap =  43937.85891963988 Sum =  433.09277994203865
Iteration =  1  Dual obj =  -0.07727087001931687  Primal_obj =  42.1764578602635  Gap =  42.253728730282816 Sum =  0.933403277912183
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  3  Dual obj =  -0.018453308581674426  Primal_obj =  15.466345288708123  Gap =  15.484798597289798 Sum =  0.7851591022428683
Iteration =  4  Dual obj =  0.016269230009736145  Primal_obj =  10.225254454862903  Gap =  10.208985224853166 Sum =  0.7756976755753188
Iteration =  5  Dual obj =  0.03294990807138366  Primal_obj =  5.860267233717121  Gap =  5.827317325645737 Sum =  0.805533940079793
Iteration =  6  Dual obj =  0.040841064570456186  Primal_obj =  3.907248582973759  Gap =  3.866407518403303 Sum =  0.8192609451526722
Iteration =  7  Dual obj =  0.04442292940888495  Primal_obj =  2.4860845614380964  Gap =  2.4416616320292115 Sum =  0.8241118432433931
Iteration =  8  Dual obj =  0.046674934914127636  Primal_obj =  1.6002490248405703  Gap =  1.5535740899264427 Sum =  0.8622338556019542
Iteration =  9  Dual obj =  0.04816437641870019  Primal_obj =  1.3617466779761236  Gap =  1.3135823015574235 Sum =  0.9004203469098017
Iteration =  10  Dual obj =  0.04926256913706867  Primal_obj =  1.1412207288756688  Gap =  1.0919581597386 Sum =  0.9413831646906001
Iteration =  11  Dual obj =  0.0501199971017858  Primal_obj =  0.8163654337021284  Gap =  0.7662454366003426 Sum =  0.9492795539720704
Iteration =  12  Dual obj =  0.0506738200270974  Primal_obj =  0.7248550270287168  Gap =  0.6741812070016194 Sum =  0.9634841640646121
Iteration =  13  Dual obj =  0.05103440864241628  Primal_obj =  0.5187650558765351  Gap =  0.46773064723411883 Sum =  0.9647925046873189
Iteration =  14  Dual obj =  0.05132097232442856  Primal_obj =  0.5191251823531083  Gap =  0.4678042100286798 Sum =  0.9772526378433879
Iteration =  15  Dual obj =  0.05160566728493329  Primal_obj =  0.4441084596622659  Gap =  0.39250279237733265 Sum =  0.9832979721321732
Iteration =  16  Dual obj =  0.05181101469116119  Primal_obj =  0.41382081972039636  Gap =  0.3620098050292352 Sum =  0.9841891674475398
Iteration =  17  Dual obj =  0.05196118804889649  Primal_obj =  0.3335488407311012  Gap =  0.2815876526822047 Sum =  0.9841099762493088
Iteration =  18  Dual obj =  0.05206733142502004  Primal_obj =  0.3193996169478212  Gap =  0.2673322855228012 Sum =  0.9943784906559933
Iteration =  19  Dual obj =  0.05215139276048142  Primal_obj =  0.2734363596041024  Gap =  0.22128496684362098 Sum =  0.9987628622157014
Iteration =  20  Dual obj =  0.05221587753574019  Primal_obj =  0.23679680932077155  Gap =  0.18458093178503135 Sum =  1.002254297728998
Iteration =  21  Dual obj =  0.052259801646015916  Primal_obj =  0.20127133318300314  Gap =  0.1490115315369872 Sum =  1.0064525189285192
Iteration =  22  Dual obj =  0.05229610761842052  Primal_obj =  0.17870284369704414  Gap =  0.12640673607862363 Sum =  1.005622190674671
Iteration =  23  Dual obj =  0.05232308197598878  Primal_obj =  0.16423686591727327  Gap =  0.11191378394128448 Sum =  1.0055141893556052
Iteration =  24  Dual obj =  0.052344912927852164  Primal_obj =  0.15273347060392578  Gap =  0.10038855767607362 Sum =  1.0068545585250588
Iteration =  0  Dual obj =  0.052344912927852164  Primal_obj =  0.15273347060392578  Gap =  0.10038855767607362 Sum =  1.0068545585250588
Iteration =  1  Dual obj =  0.05235517720247673  Primal_obj =  0.13987471421373648  Gap =  0.08751953701125975 Sum =  1.0058711786582328
Iteration =  2  Dual obj =  0.05236560459740605  Primal_obj =  0.13028748559934883  Gap =  0.07792188100194278 Sum =  1.003626168324495
Iteration =  3  Dual obj =  0.052376398829731746  Primal_obj =  0.12454124773439573  Gap =  0.07216484890466399 Sum =  1.0019596469108452
Iteration =  4  Dual obj =  0.052389354905560945  Primal_obj =  0.12289567431181028  Gap =  0.07050631940624934 Sum =  0.9987393449987072
Iteration =  5  Dual obj =  0.05240560748964089  Primal_obj =  0.11792080033619523  Gap =  0.06551519284655434 Sum =  0.9970712532064564
Iteration =  6  Dual obj =  0.052421711493376405  Primal_obj =  0.11430153746491226  Gap =  0.06187982597153585 Sum =  0.9965648412527425
Iteration =  7  Dual obj =  0.052435857481694076  Primal_obj =  0.11090757332016885  Gap =  0.05847171583847477 Sum =  0.9968506251486854
Iteration =  8  Dual obj =  0.052450440078482846  Primal_obj =  0.10063033938171131  Gap =  0.04817989930322847 Sum =  0.9982867054068845
Iteration =  9  Dual obj =  0.052462055090822704  Primal_obj =  0.0957441196455935  Gap =  0.043282064554770794 Sum =  0.9993222129475154
Iteration =  10  Dual obj =  0.0524720253218493  Primal_obj =  0.0945440603943524  Gap =  0.042072035072503094 Sum =  0.999555324302562
Iteration =  11  Dual obj =  0.05248293111930348  Primal_obj =  0.09555512462156741  Gap =  0.043072193502263934 Sum =  0.9989751941634769
Iteration =  12  Dual obj =  0.05249271184980722  Primal_obj =  0.09085548004794691  Gap =  0.03836276819813969 Sum =  0.9985380512599419
Iteration =  13  Dual obj =  0.05250128561080673  Primal_obj =  0.09218386988770853  Gap =  0.0396825842769018 Sum =  0.9962814551087138
Iteration =  14  Dual obj =  0.052509282550037124  Primal_obj =  0.09419713211838159  Gap =  0.04168784956834446 Sum =  0.9957546148902802
Iteration =  15  Dual obj =  0.05251758992084498  Primal_obj =  0.08975000661497437  Gap =  0.03723241669412939 Sum =  0.997630387067851
Iteration =  16  Dual obj =  0.05252379208094317  Primal_obj =  0.08365530268240332  Gap =  0.031131510601460147 Sum =  1.0001546342434025
Iteration =  17  Dual obj =  0.05252854204966233  Primal_obj =  0.0797526433740609  Gap =  0.027224101324398578 Sum =  1.0006287544524044
Iteration =  18  Dual obj =  0.05253242040167802  Primal_obj =  0.07670168843782228  Gap =  0.024169268036144262 Sum =  1.000651664277739
Iteration =  19  Dual obj =  0.052535473255659396  Primal_obj =  0.07298272450526884  Gap =  0.020447251249609444 Sum =  1.0010035926425076
Iteration =  20  Dual obj =  0.052537879948158624  Primal_obj =  0.07023443740853719  Gap =  0.017696557460378563 Sum =  1.0008347080270037
Iteration =  21  Dual obj =  0.05254021780943994  Primal_obj =  0.0677205454147883  Gap =  0.015180327605348355 Sum =  1.0003500997643238
Iteration =  22  Dual obj =  0.0525421314170217  Primal_obj =  0.06584432664458273  Gap =  0.013302195227561028 Sum =  1.00012484154967
Iteration =  23  Dual obj =  0.05254371126291387  Primal_obj =  0.06442300306601441  Gap =  0.011879291803100538 Sum =  1.0000160523651522
Iteration =  24  Dual obj =  0.052544862045243355  Primal_obj =  0.06337966765855552  Gap =  0.010834805613312161 Sum =  1.0003636671279101
Iteration =  0  Dual obj =  0.052544862045243355  Primal_obj =  0.06337966765855552  Gap =  0.010834805613312161 Sum =  1.0003636671279101
Iteration =  1  Dual obj =  0.052545392615642235  Primal_obj =  0.06269114480535536  Gap =  0.010145752189713121 Sum =  1.0002952212852851
Iteration =  2  Dual obj =  0.05254589081010384  Primal_obj =  0.06208063773018342  Gap =  0.009534746920079579 Sum =  1.0003683633090201
Iteration =  3  Dual obj =  0.052546265396935195  Primal_obj =  0.061654645546614276  Gap =  0.009108380149679081 Sum =  1.000324265663874
Iteration =  4  Dual obj =  0.052546865941250825  Primal_obj =  0.06120579155986708  Gap =  0.008658925618616253 Sum =  1.0004046431491826
Iteration =  5  Dual obj =  0.05254757368045912  Primal_obj =  0.06082655342960589  Gap =  0.008278979749146771 Sum =  1.0003755399171546
Iteration =  6  Dual obj =  0.052548155589247164  Primal_obj =  0.06068318181719503  Gap =  0.008135026227947866 Sum =  1.0001548250195766
Iteration =  7  Dual obj =  0.052548795886061234  Primal_obj =  0.06069896399070186  Gap =  0.008150168104640629 Sum =  1.000010016801454
Iteration =  8  Dual obj =  0.05254949343027404  Primal_obj =  0.06072769376097154  Gap =  0.0081782003306975 Sum =  0.9999517062638903
Iteration =  9  Dual obj =  0.05255029883129117  Primal_obj =  0.06051400009377488  Gap =  0.007963701262483712 Sum =  0.9992725797583821
Iteration =  10  Dual obj =  0.052551084552202545  Primal_obj =  0.06019909731901678  Gap =  0.007648012766814233 Sum =  0.9989790394803154
Iteration =  11  Dual obj =  0.05255205497393685  Primal_obj =  0.059965359325512495  Gap =  0.007413304351575646 Sum =  0.9993336913390672
Iteration =  12  Dual obj =  0.05255284421843702  Primal_obj =  0.059909591356527  Gap =  0.007356747138089981 Sum =  0.9999601754889587
Iteration =  13  Dual obj =  0.052553525656132166  Primal_obj =  0.05989340650844638  Gap =  0.007339880852314212 Sum =  1.000097975649656
Iteration =  14  Dual obj =  0.05255425239994564  Primal_obj =  0.06008246767140803  Gap =  0.007528215271462385 Sum =  1.0002131970613082
Iteration =  15  Dual obj =  0.052554980932844574  Primal_obj =  0.06052013044190284  Gap =  0.007965149509058266 Sum =  1.000068261074139
Iteration =  16  Dual obj =  0.05255567694288223  Primal_obj =  0.061162534151426716  Gap =  0.008606857208544483 Sum =  0.9999416723336942
Iteration =  17  Dual obj =  0.05255631158597089  Primal_obj =  0.06105586313514989  Gap =  0.008499551549179002 Sum =  0.9997637857053192
Iteration =  18  Dual obj =  0.05255709800061621  Primal_obj =  0.0614220944060867  Gap =  0.00886499640547049 Sum =  0.9995297289282852
Iteration =  19  Dual obj =  0.05255782737638494  Primal_obj =  0.061857658630835866  Gap =  0.009299831254450927 Sum =  0.9994307935440513
Iteration =  20  Dual obj =  0.05255851083356397  Primal_obj =  0.06210414210688005  Gap =  0.009545631273316077 Sum =  0.9996992194963887
Iteration =  21  Dual obj =  0.05255921774029776  Primal_obj =  0.06188252027382919  Gap =  0.009323302533531433 Sum =  1.000145747553168
Iteration =  22  Dual obj =  0.05255985076811989  Primal_obj =  0.061631976113468524  Gap =  0.009072125345348632 Sum =  1.0003463047391161
Iteration =  23  Dual obj =  0.05256054357894326  Primal_obj =  0.06134343386770316  Gap =  0.0087828902887599 Sum =  1.0005073287027053
Iteration =  24  Dual obj =  0.052561166555571776  Primal_obj =  0.06092003047356356  Gap =  0.008358863917991788 Sum =  1.000486595752744
Iteration =  0  Dual obj =  0.052561166555571776  Primal_obj =  0.06092003047356356  Gap =  0.008358863917991788 Sum =  1.000486595752744
Iteration =  1  Dual obj =  0.05256147480511053  Primal_obj =  0.060347730219576304  Gap =  0.007786255414465773 Sum =  1.000432788114015
Iteration =  2  Dual obj =  0.05256181380144355  Primal_obj =  0.05954782902117731  Gap =  0.006986015219733764 Sum =  1.00031375019322
Iteration =  3  Dual obj =  0.05256217861664576  Primal_obj =  0.05866468955609707  Gap =  0.006102510939451307 Sum =  1.0000844284785235
Iteration =  4  Dual obj =  0.05256250266578825  Primal_obj =  0.05795594201801364  Gap =  0.0053934393522253946 Sum =  0.9997908582843913
Iteration =  5  Dual obj =  0.052562777766590116  Primal_obj =  0.05741428742615335  Gap =  0.004851509659563234 Sum =  0.9997093047758672
Iteration =  6  Dual obj =  0.05256305640542688  Primal_obj =  0.056949911737773126  Gap =  0.004386855332346243 Sum =  0.999841358060151
Iteration =  7  Dual obj =  0.052563314067477884  Primal_obj =  0.05653578944050371  Gap =  0.003972475373025829 Sum =  1.0002126010587533
Iteration =  8  Dual obj =  0.05256350365303186  Primal_obj =  0.05627824717282599  Gap =  0.003714743519794131 Sum =  1.000295230792283
Iteration =  9  Dual obj =  0.05256365679772408  Primal_obj =  0.05606349928969455  Gap =  0.0034998424919704674 Sum =  1.0002654337504613
Iteration =  10  Dual obj =  0.0525637726471697  Primal_obj =  0.05590266856257678  Gap =  0.003338895915407078 Sum =  1.0001950187944428
Iteration =  11  Dual obj =  0.05256391125033  Primal_obj =  0.05575082870205396  Gap =  0.0031869174517239612 Sum =  1.0000981681769496
Iteration =  12  Dual obj =  0.05256402430575813  Primal_obj =  0.055649555141907864  Gap =  0.0030855308361497358 Sum =  0.9998821199870482
Iteration =  13  Dual obj =  0.05256414699597073  Primal_obj =  0.05553677352496579  Gap =  0.002972626528995062 Sum =  0.9997124994014017
Iteration =  14  Dual obj =  0.05256428340716915  Primal_obj =  0.05548164568646809  Gap =  0.002917362279298938 Sum =  0.99969258554913
Iteration =  15  Dual obj =  0.05256444177129388  Primal_obj =  0.055433322926460984  Gap =  0.002868881155167105 Sum =  0.9998640540417867
Iteration =  16  Dual obj =  0.05256460434939565  Primal_obj =  0.05537436595136896  Gap =  0.0028097616019733054 Sum =  0.9999337986294878
Iteration =  17  Dual obj =  0.0525647732486024  Primal_obj =  0.055307578629720563  Gap =  0.0027428053811181657 Sum =  0.9999623554310406
Iteration =  18  Dual obj =  0.052564944409653314  Primal_obj =  0.055328397921651125  Gap =  0.0027634535119978113 Sum =  1.0001093818759172
Iteration =  19  Dual obj =  0.052565201190841376  Primal_obj =  0.05544561548113509  Gap =  0.0028804142902937105 Sum =  1.000366282092672
Iteration =  20  Dual obj =  0.05256542497077346  Primal_obj =  0.05539450620064873  Gap =  0.0028290812298752688 Sum =  1.0002125679369627
Iteration =  21  Dual obj =  0.05256564326548231  Primal_obj =  0.05545917106736694  Gap =  0.002893527801884628 Sum =  0.9999463974532325
Iteration =  22  Dual obj =  0.05256578970916474  Primal_obj =  0.055487235752800734  Gap =  0.002921446043635992 Sum =  0.999802380463719
Iteration =  23  Dual obj =  0.05256590217614435  Primal_obj =  0.05546862229434679  Gap =  0.0029027201182024454 Sum =  0.9998056572337647
Iteration =  24  Dual obj =  0.052566027131205784  Primal_obj =  0.05546813743028222  Gap =  0.0029021102990764366 Sum =  0.9998874527194161
Done, writing results...
