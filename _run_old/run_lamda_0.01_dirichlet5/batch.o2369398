2021-04-27 22:17:11,637 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.28s.
2021-04-27 22:17:12,095 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-27 22:17:12,509 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.41s.
2021-04-27 22:17:12,634 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-27 22:17:12,637 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 22:17:12,648 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 22:17:13,497 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 119.
2021-04-27 22:17:13,499 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.86s.
Iteration =  0  Dual obj =  -40.98222722636012  Primal_obj =  36083.77384360577  Gap =  36124.75607083213 Sum =  436.44877772672044
Iteration =  1  Dual obj =  -0.053585774702408315  Primal_obj =  18.93688457738312  Gap =  18.990470352085527 Sum =  0.9862929006530019
Iteration =  2  Dual obj =  -0.021197461218124547  Primal_obj =  9.651629888243674  Gap =  9.672827349461798 Sum =  0.8961923808295487
Iteration =  3  Dual obj =  -0.009815255706109787  Primal_obj =  4.742086474812808  Gap =  4.751901730518918 Sum =  0.8200310479571122
Iteration =  4  Dual obj =  -0.0031287024381885225  Primal_obj =  2.629869325002362  Gap =  2.6329980274405504 Sum =  0.9473199909573139
Iteration =  5  Dual obj =  -0.00029853224046995624  Primal_obj =  0.9702636787256218  Gap =  0.9705622109660917 Sum =  0.9979768074276325
Iteration =  6  Dual obj =  0.0004832122890377367  Primal_obj =  0.4620882854341463  Gap =  0.46160507314510857 Sum =  0.9976701230349684
Iteration =  7  Dual obj =  0.0008152436547005171  Primal_obj =  0.27568934843952625  Gap =  0.2748741047848257 Sum =  0.9960640993321372
Iteration =  8  Dual obj =  0.0009977730280292946  Primal_obj =  0.15937876875667137  Gap =  0.15838099572864206 Sum =  0.9972852559774927
Iteration =  9  Dual obj =  0.001087177564285103  Primal_obj =  0.08172932793363492  Gap =  0.08064215036934982 Sum =  0.9994298612927625
Iteration =  10  Dual obj =  0.0011254236741026769  Primal_obj =  0.041682571068955246  Gap =  0.04055714739485257 Sum =  0.9987473348779182
Iteration =  11  Dual obj =  0.0011411692337083626  Primal_obj =  0.019596300263693536  Gap =  0.018455131029985174 Sum =  0.9995453697807175
Iteration =  12  Dual obj =  0.0011479232622622383  Primal_obj =  0.0099844299567287  Gap =  0.008836506694466461 Sum =  0.9997751844361699
Iteration =  13  Dual obj =  0.0011512714290627495  Primal_obj =  0.006103196027077415  Gap =  0.0049519245980146655 Sum =  0.9992424779491145
Iteration =  14  Dual obj =  0.001153186293769596  Primal_obj =  0.0042446367402421414  Gap =  0.0030914504464725455 Sum =  0.9995885194730199
Iteration =  15  Dual obj =  0.001154369924265937  Primal_obj =  0.0032906698454545358  Gap =  0.002136299921188599 Sum =  0.9998871015315889
Iteration =  16  Dual obj =  0.0011551650973928573  Primal_obj =  0.0027264248094442667  Gap =  0.0015712597120514094 Sum =  0.9998212548191773
Iteration =  17  Dual obj =  0.001155706470322159  Primal_obj =  0.002368437393735906  Gap =  0.001212730923413747 Sum =  0.9998919427228751
Iteration =  18  Dual obj =  0.0011561126321091401  Primal_obj =  0.002133226220167442  Gap =  0.0009771135880583016 Sum =  0.9999724489497588
Iteration =  19  Dual obj =  0.0011564393967095216  Primal_obj =  0.001963629441557091  Gap =  0.0008071900448475694 Sum =  0.9999126161877849
Iteration =  20  Dual obj =  0.0011567073060159347  Primal_obj =  0.0018507137696262416  Gap =  0.0006940064636103069 Sum =  0.9999505050714529
Iteration =  21  Dual obj =  0.0011568976134642972  Primal_obj =  0.0017573677522178394  Gap =  0.0006004701387535422 Sum =  0.9999372277233152
Iteration =  22  Dual obj =  0.0011570752864320313  Primal_obj =  0.0016720441494954968  Gap =  0.0005149688630634655 Sum =  0.9999358656873362
Iteration =  23  Dual obj =  0.0011572203513241612  Primal_obj =  0.001593178656378355  Gap =  0.0004359583050541939 Sum =  0.9999285739919941
Iteration =  24  Dual obj =  0.0011573300674552096  Primal_obj =  0.0015408722245950773  Gap =  0.0003835421571398677 Sum =  0.9999544851104855
Iteration =  0  Dual obj =  -46.49770116893717  Primal_obj =  35560.662396411404  Gap =  35607.160097580345 Sum =  436.44877772672044
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.09420314758581173  Primal_obj =  15.712932735758296  Gap =  15.807135883344108 Sum =  0.482649615911449
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  5  Dual obj =  -0.023569258832763368  Primal_obj =  14.11765376025953  Gap =  14.141223019092294 Sum =  0.8346919687730237
Iteration =  6  Dual obj =  -0.008514096283498612  Primal_obj =  9.700383461842053  Gap =  9.708897558125551 Sum =  0.7970466017603521
Iteration =  7  Dual obj =  -6.142299945306046e-05  Primal_obj =  6.938817933807436  Gap =  6.938879356806889 Sum =  0.823425031231503
Iteration =  8  Dual obj =  0.0054095216029483445  Primal_obj =  4.894441130419989  Gap =  4.8890316088170405 Sum =  0.8360241943244291
Iteration =  9  Dual obj =  0.008563570792001325  Primal_obj =  4.081007989394896  Gap =  4.0724444186028945 Sum =  0.8571817940538005
Iteration =  10  Dual obj =  0.010724811837016901  Primal_obj =  3.1760279706834935  Gap =  3.1653031588464766 Sum =  0.8750466147553257
Iteration =  11  Dual obj =  0.012137871900258064  Primal_obj =  2.470609595750342  Gap =  2.4584717238500837 Sum =  0.887478528652055
Iteration =  12  Dual obj =  0.013117303714175767  Primal_obj =  2.0634776045845795  Gap =  2.0503603008704037 Sum =  0.9045232205037217
Iteration =  13  Dual obj =  0.014011690058974336  Primal_obj =  1.713071064580256  Gap =  1.6990593745212816 Sum =  0.9266686055450721
Iteration =  14  Dual obj =  0.014678180725187076  Primal_obj =  1.4135523741173033  Gap =  1.3988741933921163 Sum =  0.9456621382651773
Iteration =  15  Dual obj =  0.015152261855622334  Primal_obj =  1.179996423030278  Gap =  1.1648441611746556 Sum =  0.9675905964403111
Iteration =  16  Dual obj =  0.015409382609760543  Primal_obj =  0.9706177441180139  Gap =  0.9552083615082534 Sum =  0.9667085120406163
Iteration =  17  Dual obj =  0.015554228309558937  Primal_obj =  0.8202296157299129  Gap =  0.804675387420354 Sum =  0.9677149790313471
Iteration =  18  Dual obj =  0.01572038551289957  Primal_obj =  0.7551126455400204  Gap =  0.7393922600271209 Sum =  0.9704356652569907
Iteration =  19  Dual obj =  0.015901356315847943  Primal_obj =  0.673033989479908  Gap =  0.65713263316406 Sum =  0.9767359840231626
Iteration =  20  Dual obj =  0.016063231970513528  Primal_obj =  0.6236942632638044  Gap =  0.6076310312932909 Sum =  0.9876123159604686
Iteration =  21  Dual obj =  0.016153255352151237  Primal_obj =  0.514787885445639  Gap =  0.4986346300934878 Sum =  0.9898843251018756
Iteration =  22  Dual obj =  0.016219453996929097  Primal_obj =  0.4338116461787035  Gap =  0.4175921921817744 Sum =  0.9921742691682846
Iteration =  23  Dual obj =  0.01627618460659055  Primal_obj =  0.3902506982809511  Gap =  0.3739745136743606 Sum =  0.994945838006688
Iteration =  24  Dual obj =  0.01631867036962474  Primal_obj =  0.35928476069396964  Gap =  0.3429660903243449 Sum =  0.9986721014549651
Iteration =  0  Dual obj =  0.01631867036962474  Primal_obj =  0.35928476069396964  Gap =  0.3429660903243449 Sum =  0.9986721014549651
Iteration =  1  Dual obj =  0.01635055877424349  Primal_obj =  0.35658489890839606  Gap =  0.34023434013415255 Sum =  0.9957522077923484
Iteration =  2  Dual obj =  0.01638960874856351  Primal_obj =  0.30557584412066974  Gap =  0.28918623537210625 Sum =  0.9970665233089123
Iteration =  3  Dual obj =  0.016444741480532026  Primal_obj =  0.32124988466546  Gap =  0.30480514318492796 Sum =  0.9967191150764922
Iteration =  4  Dual obj =  0.016507010932845564  Primal_obj =  0.3083893178222503  Gap =  0.29188230688940475 Sum =  1.0006799439618848
Iteration =  5  Dual obj =  0.01655565899205821  Primal_obj =  0.2580981984786598  Gap =  0.24154253948660157 Sum =  1.0025231562412564
Iteration =  6  Dual obj =  0.0165902546628299  Primal_obj =  0.1960019292160034  Gap =  0.1794116745531735 Sum =  1.0048823736783894
Iteration =  7  Dual obj =  0.016617864669244576  Primal_obj =  0.13543906870435113  Gap =  0.11882120403510656 Sum =  1.003053457899934
Iteration =  8  Dual obj =  0.01663513863626719  Primal_obj =  0.10510646820150979  Gap =  0.0884713295652426 Sum =  1.0010048538605454
Iteration =  9  Dual obj =  0.016647821943097486  Primal_obj =  0.08596626766582487  Gap =  0.06931844572272738 Sum =  0.9980291402729163
Iteration =  10  Dual obj =  0.01665723182340572  Primal_obj =  0.07134320932676882  Gap =  0.054685977503363105 Sum =  0.9984439791823447
Iteration =  11  Dual obj =  0.016665263373498253  Primal_obj =  0.06332417044540556  Gap =  0.046658907071907306 Sum =  0.9985226019921255
Iteration =  12  Dual obj =  0.01667193919012674  Primal_obj =  0.05682725191818547  Gap =  0.04015531272805872 Sum =  0.9998536581159928
Iteration =  13  Dual obj =  0.016677326343684774  Primal_obj =  0.049839677001115607  Gap =  0.03316235065743083 Sum =  1.000261115692303
Iteration =  14  Dual obj =  0.016682153916327283  Primal_obj =  0.04520055194932131  Gap =  0.028518398032994025 Sum =  1.0005842421903113
Iteration =  15  Dual obj =  0.016686198554585956  Primal_obj =  0.040809244718925664  Gap =  0.024123046164339707 Sum =  1.0010290930080932
Iteration =  16  Dual obj =  0.01668987986615903  Primal_obj =  0.03728247238716373  Gap =  0.020592592521004698 Sum =  0.9998417332078688
Iteration =  17  Dual obj =  0.01669277413298154  Primal_obj =  0.03501054833395967  Gap =  0.01831777420097813 Sum =  0.9991064485588976
Iteration =  18  Dual obj =  0.01669535420305184  Primal_obj =  0.032552364754779364  Gap =  0.015857010551727526 Sum =  0.9994586566365331
Iteration =  19  Dual obj =  0.016697677887009765  Primal_obj =  0.031237852376704026  Gap =  0.01454017448969426 Sum =  0.9995464590191329
Iteration =  20  Dual obj =  0.016699915297549627  Primal_obj =  0.029621152590372166  Gap =  0.01292123729282254 Sum =  1.0000533590012752
Iteration =  21  Dual obj =  0.016701826868208144  Primal_obj =  0.028934977946810284  Gap =  0.01223315107860214 Sum =  1.0001057500630952
Iteration =  22  Dual obj =  0.01670362772759635  Primal_obj =  0.028008045539330145  Gap =  0.011304417811733795 Sum =  1.0006030282385017
Iteration =  23  Dual obj =  0.01670525688718197  Primal_obj =  0.027140312369261746  Gap =  0.010435055482079778 Sum =  1.0000693622139498
Iteration =  24  Dual obj =  0.016706722507225144  Primal_obj =  0.02674335555733877  Gap =  0.010036633050113625 Sum =  1.0000117991366053
Iteration =  0  Dual obj =  0.016706722507225144  Primal_obj =  0.02674335555733877  Gap =  0.010036633050113625 Sum =  1.0000117991366053
Iteration =  1  Dual obj =  0.016707500306786405  Primal_obj =  0.025462139383192944  Gap =  0.008754639076406539 Sum =  0.9998459351496805
Iteration =  2  Dual obj =  0.01670833692732057  Primal_obj =  0.024022573354272075  Gap =  0.007314236426951507 Sum =  1.0002290382341235
Iteration =  3  Dual obj =  0.01670897415139348  Primal_obj =  0.023183535013860238  Gap =  0.0064745608624667585 Sum =  1.0000794381968057
Iteration =  4  Dual obj =  0.016709817780683006  Primal_obj =  0.02244864257467573  Gap =  0.005738824793992722 Sum =  1.0000267695153076
Iteration =  5  Dual obj =  0.016710418742385748  Primal_obj =  0.02202036650188191  Gap =  0.005309947759496163 Sum =  0.9999734312455272
Iteration =  6  Dual obj =  0.016710971496641896  Primal_obj =  0.021983084268898723  Gap =  0.005272112772256827 Sum =  0.9998931321854836
Iteration =  7  Dual obj =  0.016711595361293838  Primal_obj =  0.02217792467238154  Gap =  0.005466329311087703 Sum =  0.9998496815917308
Iteration =  8  Dual obj =  0.01671226619819772  Primal_obj =  0.022614923022307193  Gap =  0.005902656824109474 Sum =  0.999880835273546
Iteration =  9  Dual obj =  0.016713061387987817  Primal_obj =  0.02267316027228089  Gap =  0.005960098884293073 Sum =  1.0002845594017589
Iteration =  10  Dual obj =  0.016713961447626314  Primal_obj =  0.022701583593851382  Gap =  0.005987622146225068 Sum =  1.0003004717721953
Iteration =  11  Dual obj =  0.016714718360195075  Primal_obj =  0.022568541259369218  Gap =  0.005853822899174143 Sum =  1.000106407117269
Iteration =  12  Dual obj =  0.01671537782119281  Primal_obj =  0.02187036122229835  Gap =  0.0051549834011055395 Sum =  1.0000067946193643
Iteration =  13  Dual obj =  0.01671589756561542  Primal_obj =  0.021481619203910313  Gap =  0.004765721638294893 Sum =  0.9998294665076021
Iteration =  14  Dual obj =  0.016716527309951344  Primal_obj =  0.021272489122603405  Gap =  0.004555961812652061 Sum =  0.9997653539291561
Iteration =  15  Dual obj =  0.016717310042644807  Primal_obj =  0.02109357024083154  Gap =  0.004376260198186734 Sum =  0.9997925252027918
Iteration =  16  Dual obj =  0.016717897656885496  Primal_obj =  0.020887497329136986  Gap =  0.00416959967225149 Sum =  1.0000651655177073
Iteration =  17  Dual obj =  0.016718319550383103  Primal_obj =  0.020599926668814578  Gap =  0.003881607118431475 Sum =  0.9999667916938448
Iteration =  18  Dual obj =  0.016718651587570955  Primal_obj =  0.020407503411586495  Gap =  0.0036888518240155398 Sum =  0.9999295682441325
Iteration =  19  Dual obj =  0.016719029027343357  Primal_obj =  0.020279518218072085  Gap =  0.003560489190728728 Sum =  0.9999151021605515
Iteration =  20  Dual obj =  0.016719411838352554  Primal_obj =  0.020181188834956523  Gap =  0.0034617769966039692 Sum =  0.9998920963025384
Iteration =  21  Dual obj =  0.016719774422012616  Primal_obj =  0.020134563232584446  Gap =  0.0034147888105718303 Sum =  0.9997854499123311
Iteration =  22  Dual obj =  0.016720133704952646  Primal_obj =  0.019976499304039677  Gap =  0.0032563655990870306 Sum =  1.0001416055300167
Iteration =  23  Dual obj =  0.0167204212039626  Primal_obj =  0.019776731071279863  Gap =  0.0030563098673172633 Sum =  1.0001362985352102
Iteration =  24  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  0  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  1  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  2  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  3  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  4  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  5  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  6  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  7  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  8  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  9  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  10  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  11  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  12  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  13  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  14  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  15  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  16  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  17  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  18  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  19  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  20  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  21  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  22  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  23  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Iteration =  24  Dual obj =  0.016720678397444136  Primal_obj =  0.019531809399531502  Gap =  0.0028111310020873664 Sum =  1.0001142998912358
Done, writing results...
