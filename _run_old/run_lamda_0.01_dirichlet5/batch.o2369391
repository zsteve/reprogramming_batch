2021-04-27 22:03:21,169 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.29s.
2021-04-27 22:03:21,626 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-27 22:03:22,040 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.41s.
2021-04-27 22:03:22,164 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-27 22:03:22,167 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 22:03:22,178 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 22:03:23,036 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 111.
2021-04-27 22:03:23,037 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.87s.
Iteration =  0  Dual obj =  -36.73465205508485  Primal_obj =  45607.8084599482  Gap =  45644.54311200329 Sum =  680.1611622573638
Iteration =  1  Dual obj =  -0.04813667558646274  Primal_obj =  20.216291814843867  Gap =  20.26442849043033 Sum =  0.8071827597056852
Iteration =  2  Dual obj =  -0.00793683686160053  Primal_obj =  11.115171046351918  Gap =  11.12310788321352 Sum =  0.8284825318526909
Iteration =  3  Dual obj =  0.006002992208261948  Primal_obj =  5.396634766360008  Gap =  5.390631774151746 Sum =  0.8352732315346656
Iteration =  4  Dual obj =  0.012561777397519795  Primal_obj =  2.9154441566551816  Gap =  2.9028823792576617 Sum =  0.9371321268827679
Iteration =  5  Dual obj =  0.01516004833862136  Primal_obj =  1.3176822661253842  Gap =  1.3025222177867628 Sum =  1.006255806473472
Iteration =  6  Dual obj =  0.0161650080841209  Primal_obj =  0.6243778582959865  Gap =  0.6082128502118656 Sum =  1.0020925852756482
Iteration =  7  Dual obj =  0.01654844539596446  Primal_obj =  0.21117689616163873  Gap =  0.19462845076567428 Sum =  0.9934217945255147
Iteration =  8  Dual obj =  0.016650061010245777  Primal_obj =  0.10500728639226663  Gap =  0.08835722538202084 Sum =  0.9975479016885258
Iteration =  9  Dual obj =  0.01668303954463539  Primal_obj =  0.06462582568601191  Gap =  0.04794278614137652 Sum =  0.9996924204531971
Iteration =  10  Dual obj =  0.016701444585262293  Primal_obj =  0.05062159774483968  Gap =  0.03392015315957739 Sum =  0.9991673428983082
Iteration =  11  Dual obj =  0.016714610001018794  Primal_obj =  0.04127303177631714  Gap =  0.024558421775298343 Sum =  0.9981324573530105
Iteration =  12  Dual obj =  0.016722723798421768  Primal_obj =  0.03307988675527061  Gap =  0.016357162956848845 Sum =  1.0002594587687428
Iteration =  13  Dual obj =  0.01672745224466663  Primal_obj =  0.026588841967505453  Gap =  0.009861389722838822 Sum =  1.0003693661899855
Iteration =  14  Dual obj =  0.016730230758428048  Primal_obj =  0.022655715321915487  Gap =  0.005925484563487439 Sum =  0.9995518677955758
Iteration =  15  Dual obj =  0.016731943575908112  Primal_obj =  0.020544478376481143  Gap =  0.003812534800573031 Sum =  0.9996688075546437
Iteration =  16  Dual obj =  0.016733030248771028  Primal_obj =  0.019482677307153196  Gap =  0.002749647058382168 Sum =  0.999945589851172
Iteration =  17  Dual obj =  0.016733805140046243  Primal_obj =  0.018851337953508226  Gap =  0.0021175328134619836 Sum =  0.9999372336801577
Iteration =  18  Dual obj =  0.01673441868465285  Primal_obj =  0.018419655768992238  Gap =  0.0016852370843393888 Sum =  0.9996676657403831
Iteration =  19  Dual obj =  0.0167348935585762  Primal_obj =  0.01808311043269599  Gap =  0.0013482168741197897 Sum =  0.9998653763652925
Iteration =  20  Dual obj =  0.01673524159264852  Primal_obj =  0.017835398481390388  Gap =  0.0011001568887418697 Sum =  1.0000339444036248
Iteration =  21  Dual obj =  0.016735519508492974  Primal_obj =  0.0176481811363208  Gap =  0.0009126616278278266 Sum =  0.9998376663393171
Iteration =  22  Dual obj =  0.016735742362122365  Primal_obj =  0.017512833088939944  Gap =  0.0007770907268175795 Sum =  0.9998293020612835
Iteration =  23  Dual obj =  0.0167359196777883  Primal_obj =  0.01739418419119959  Gap =  0.0006582645134112913 Sum =  1.0000151163166042
Iteration =  24  Dual obj =  0.016736061719867842  Primal_obj =  0.017306720143405965  Gap =  0.0005706584235381229 Sum =  1.0000016860844663
Iteration =  0  Dual obj =  -35.56863397969788  Primal_obj =  43492.6501048185  Gap =  43528.2187387982 Sum =  680.1611622573638
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.0863867580987471  Primal_obj =  19.809681977075368  Gap =  19.896068735174115 Sum =  0.5215366445186347
Iteration =  3  Dual obj =  -0.010890732828095613  Primal_obj =  14.32128832325625  Gap =  14.332179056084344 Sum =  0.8646200987435073
Iteration =  4  Dual obj =  0.007288882609907711  Primal_obj =  10.551229680152884  Gap =  10.543940797542977 Sum =  0.8410800305651636
Iteration =  5  Dual obj =  0.017916274134970288  Primal_obj =  8.483790999667672  Gap =  8.465874725532702 Sum =  0.805770065389005
Iteration =  6  Dual obj =  0.023178926708780016  Primal_obj =  5.045432356953273  Gap =  5.022253430244493 Sum =  0.8282383048791346
Iteration =  7  Dual obj =  0.025582629086671575  Primal_obj =  5.096112212139393  Gap =  5.070529583052721 Sum =  0.8635978587089066
Iteration =  8  Dual obj =  0.02794915887643868  Primal_obj =  3.1799000185018316  Gap =  3.151950859625393 Sum =  0.8866362669582076
Iteration =  9  Dual obj =  0.02946516390456228  Primal_obj =  2.5929494240018327  Gap =  2.5634842600972703 Sum =  0.9401771443222452
Iteration =  10  Dual obj =  0.030555528060001145  Primal_obj =  1.6651559668019191  Gap =  1.634600438741918 Sum =  0.9641311491181812
Iteration =  11  Dual obj =  0.03135268352859942  Primal_obj =  1.4078238736451196  Gap =  1.3764711901165203 Sum =  0.9797656384591253
Iteration =  12  Dual obj =  0.0319827893460001  Primal_obj =  1.1369107487540338  Gap =  1.1049279594080337 Sum =  0.9781091331887193
Iteration =  13  Dual obj =  0.032430237085650696  Primal_obj =  0.7759014729967721  Gap =  0.7434712359111214 Sum =  0.9804469995457218
Iteration =  14  Dual obj =  0.03276819911417092  Primal_obj =  0.6071349596534061  Gap =  0.5743667605392352 Sum =  0.9976307932164034
Iteration =  15  Dual obj =  0.03297580369683968  Primal_obj =  0.44166061399564766  Gap =  0.408684810298808 Sum =  1.0045107628967813
Iteration =  16  Dual obj =  0.033136805259374805  Primal_obj =  0.36810139271125564  Gap =  0.33496458745188085 Sum =  0.9880895104740102
Iteration =  17  Dual obj =  0.03326027588826426  Primal_obj =  0.2841287582210835  Gap =  0.2508684823328193 Sum =  0.9947293269035996
Iteration =  18  Dual obj =  0.03335274818582867  Primal_obj =  0.2467865049236556  Gap =  0.2134337567378269 Sum =  0.9979845991454036
Iteration =  19  Dual obj =  0.033430430768723846  Primal_obj =  0.22040409408305348  Gap =  0.18697366331432963 Sum =  0.9929113378937222
Iteration =  20  Dual obj =  0.033489123183669214  Primal_obj =  0.20543816163009565  Gap =  0.17194903844642645 Sum =  0.9984427103131546
Iteration =  21  Dual obj =  0.03354321110132595  Primal_obj =  0.17380495262454815  Gap =  0.14026174152322218 Sum =  0.9946198361981251
Iteration =  22  Dual obj =  0.033585767568807094  Primal_obj =  0.17117057667154184  Gap =  0.13758480910273474 Sum =  0.9998364005101942
Iteration =  23  Dual obj =  0.0336245079777466  Primal_obj =  0.1645047732293911  Gap =  0.1308802652516445 Sum =  1.001475291568791
Iteration =  24  Dual obj =  0.03365629798895106  Primal_obj =  0.14162790090881638  Gap =  0.10797160291986532 Sum =  0.999853047447649
Iteration =  0  Dual obj =  0.03365629798895106  Primal_obj =  0.14162790090881638  Gap =  0.10797160291986532 Sum =  0.999853047447649
Iteration =  1  Dual obj =  0.03367004728174382  Primal_obj =  0.12433519241432964  Gap =  0.09066514513258582 Sum =  0.9987284199608832
Iteration =  2  Dual obj =  0.033684700428949  Primal_obj =  0.10949918812210857  Gap =  0.07581448769315957 Sum =  0.9979746413203527
Iteration =  3  Dual obj =  0.03369598384225528  Primal_obj =  0.10007197237023302  Gap =  0.06637598852797774 Sum =  0.9966385031858068
Iteration =  4  Dual obj =  0.03370693190523568  Primal_obj =  0.10160091681097108  Gap =  0.0678939849057354 Sum =  0.9973089901750082
Iteration =  5  Dual obj =  0.03372615261357465  Primal_obj =  0.10417793386545873  Gap =  0.07045178125188409 Sum =  0.9980194443798915
Iteration =  6  Dual obj =  0.033744745270707005  Primal_obj =  0.10085125072278361  Gap =  0.06710650545207661 Sum =  0.9976327496892781
Iteration =  7  Dual obj =  0.03376120614066249  Primal_obj =  0.10225020508283293  Gap =  0.06848899894217045 Sum =  0.9981740875159406
Iteration =  8  Dual obj =  0.03377468693738721  Primal_obj =  0.10569010996413986  Gap =  0.07191542302675265 Sum =  1.0005602956421482
Iteration =  9  Dual obj =  0.033787209716188316  Primal_obj =  0.10636562606644889  Gap =  0.07257841635026058 Sum =  1.0003892906169265
Iteration =  10  Dual obj =  0.0337985180585907  Primal_obj =  0.09422218881943838  Gap =  0.060423670760847675 Sum =  0.9996586217790778
Iteration =  11  Dual obj =  0.033809942911483155  Primal_obj =  0.08264579074476172  Gap =  0.048835847833278566 Sum =  1.00038645586135
Iteration =  12  Dual obj =  0.03381865737898734  Primal_obj =  0.073172155830844  Gap =  0.03935349845185666 Sum =  0.9991137652356162
Iteration =  13  Dual obj =  0.0338245211866782  Primal_obj =  0.0728050580068893  Gap =  0.038980536820211104 Sum =  0.9995779237305935
Iteration =  14  Dual obj =  0.033829352869576904  Primal_obj =  0.06762821195553752  Gap =  0.033798859085960614 Sum =  0.9993270917868606
Iteration =  15  Dual obj =  0.033833634821141254  Primal_obj =  0.06804006436209299  Gap =  0.03420642954095174 Sum =  1.0001894430809073
Iteration =  16  Dual obj =  0.033837875934905885  Primal_obj =  0.06604074408831134  Gap =  0.03220286815340546 Sum =  0.9991687660033544
Iteration =  17  Dual obj =  0.03384212375438614  Primal_obj =  0.059991602634379526  Gap =  0.026149478879993387 Sum =  1.0002316237030118
Iteration =  18  Dual obj =  0.03384595163238033  Primal_obj =  0.05516515673670097  Gap =  0.021319205104320643 Sum =  1.0000469592738344
Iteration =  19  Dual obj =  0.033849025319254766  Primal_obj =  0.05305885532096495  Gap =  0.019209830001710185 Sum =  1.0000872007943236
Iteration =  20  Dual obj =  0.0338512781920602  Primal_obj =  0.05185764500013093  Gap =  0.01800636680807073 Sum =  1.0011340579044359
Iteration =  21  Dual obj =  0.033853307372138326  Primal_obj =  0.05107903367196166  Gap =  0.017225726299823337 Sum =  1.0002453151606103
Iteration =  22  Dual obj =  0.0338552135964303  Primal_obj =  0.04966982372104617  Gap =  0.015814610124615866 Sum =  1.0000871313839341
Iteration =  23  Dual obj =  0.03385738186660154  Primal_obj =  0.0484945459683805  Gap =  0.014637164101778961 Sum =  0.9994334148657432
Iteration =  24  Dual obj =  0.03385879895395935  Primal_obj =  0.04782879645871152  Gap =  0.013969997504752169 Sum =  0.9993694775078629
Iteration =  0  Dual obj =  0.03385879895395935  Primal_obj =  0.04782879645871152  Gap =  0.013969997504752169 Sum =  0.9993694775078629
Iteration =  1  Dual obj =  0.033859621674643195  Primal_obj =  0.046668261061871136  Gap =  0.01280863938722794 Sum =  0.9994466564034028
Iteration =  2  Dual obj =  0.03386049748482473  Primal_obj =  0.04541225926130528  Gap =  0.011551761776480547 Sum =  0.9995444344435698
Iteration =  3  Dual obj =  0.03386117509895641  Primal_obj =  0.04474636864541848  Gap =  0.010885193546462064 Sum =  0.9996898391396714
Iteration =  4  Dual obj =  0.03386191653160734  Primal_obj =  0.044569850371996525  Gap =  0.010707933840389185 Sum =  1.0000910378096988
Iteration =  5  Dual obj =  0.0338627737756865  Primal_obj =  0.044078898082683976  Gap =  0.010216124306997476 Sum =  1.0003185192991566
Iteration =  6  Dual obj =  0.03386363059718134  Primal_obj =  0.043329817121633446  Gap =  0.009466186524452108 Sum =  1.0001197364440033
Iteration =  7  Dual obj =  0.03386438357484661  Primal_obj =  0.043038062406171  Gap =  0.009173678831324389 Sum =  1.0000322742296524
Iteration =  8  Dual obj =  0.03386493566749596  Primal_obj =  0.04308608731062065  Gap =  0.00922115164312469 Sum =  0.9998189772024495
Iteration =  9  Dual obj =  0.033865675713727214  Primal_obj =  0.04323322946325986  Gap =  0.009367553749532645 Sum =  0.9998041321885738
Iteration =  10  Dual obj =  0.03386659806718319  Primal_obj =  0.04329754102935972  Gap =  0.00943094296217653 Sum =  0.9992870769762812
Iteration =  11  Dual obj =  0.0338675369643906  Primal_obj =  0.043469489954625726  Gap =  0.009601952990235127 Sum =  0.9999917629426277
Iteration =  12  Dual obj =  0.033868550955737466  Primal_obj =  0.0435308769097094  Gap =  0.009662325953971936 Sum =  0.9995577734439853
Iteration =  13  Dual obj =  0.03386958765324323  Primal_obj =  0.043078338454316384  Gap =  0.009208750801073154 Sum =  0.9994255557747838
Iteration =  14  Dual obj =  0.03387068779103874  Primal_obj =  0.04238546174375919  Gap =  0.008514773952720454 Sum =  1.0002852232047932
Iteration =  15  Dual obj =  0.03387165960872228  Primal_obj =  0.04164685710466076  Gap =  0.007775197495938482 Sum =  1.0002029401418402
Iteration =  16  Dual obj =  0.033872397585130144  Primal_obj =  0.04126649755804457  Gap =  0.007394099972914424 Sum =  1.0000000637595643
Iteration =  17  Dual obj =  0.03387293292514836  Primal_obj =  0.040814479088460184  Gap =  0.006941546163311822 Sum =  1.000123661512494
Iteration =  18  Dual obj =  0.03387349342551735  Primal_obj =  0.04066940334742376  Gap =  0.006795909921906415 Sum =  0.9998588844072385
Iteration =  19  Dual obj =  0.03387426764747524  Primal_obj =  0.04076562066655291  Gap =  0.006891353019077673 Sum =  0.9997822033252375
Iteration =  20  Dual obj =  0.033875079258917196  Primal_obj =  0.04076814471881139  Gap =  0.006893065459894196 Sum =  0.9996980887581732
Iteration =  21  Dual obj =  0.03387582139259944  Primal_obj =  0.04134173162679461  Gap =  0.007465910234195169 Sum =  0.999706839246276
Iteration =  22  Dual obj =  0.03387636722336833  Primal_obj =  0.04212690466730434  Gap =  0.008250537443936015 Sum =  0.9996587456750388
Iteration =  23  Dual obj =  0.03387681285952934  Primal_obj =  0.041689563253980905  Gap =  0.007812750394451562 Sum =  0.9996797952688169
Iteration =  24  Dual obj =  0.0338772484562109  Primal_obj =  0.040921226447174955  Gap =  0.007043977990964054 Sum =  0.9997270306376727
Iteration =  0  Dual obj =  0.0338772484562109  Primal_obj =  0.040921226447174955  Gap =  0.007043977990964054 Sum =  0.9997270306376727
Iteration =  1  Dual obj =  0.033877462420066715  Primal_obj =  0.040580523894051354  Gap =  0.0067030614739846395 Sum =  0.9998613029797195
Iteration =  2  Dual obj =  0.03387772172236745  Primal_obj =  0.040062833181957205  Gap =  0.006185111459589755 Sum =  0.9998860938432528
Iteration =  3  Dual obj =  0.03387803328379291  Primal_obj =  0.039464719329745324  Gap =  0.005586686045952416 Sum =  0.9999398352118263
Iteration =  4  Dual obj =  0.03387862866268171  Primal_obj =  0.038765221031835925  Gap =  0.004886592369154216 Sum =  1.000093870863917
Iteration =  5  Dual obj =  0.03387895553761171  Primal_obj =  0.038474086035708996  Gap =  0.0045951304980972885 Sum =  1.0000550647018551
Iteration =  6  Dual obj =  0.03387914381666228  Primal_obj =  0.03825993439274113  Gap =  0.004380790576078847 Sum =  0.9999801322006278
Iteration =  7  Dual obj =  0.03387933539886394  Primal_obj =  0.03815838476459524  Gap =  0.0042790493657312995 Sum =  0.9999673028098863
Iteration =  8  Dual obj =  0.0338795390859295  Primal_obj =  0.03812336683775827  Gap =  0.0042438277518287715 Sum =  1.0000032069322946
Iteration =  9  Dual obj =  0.03387980017496925  Primal_obj =  0.038067446403217894  Gap =  0.004187646228248645 Sum =  0.9997608191348826
Iteration =  10  Dual obj =  0.03388001385543809  Primal_obj =  0.03821084383962682  Gap =  0.004330829984188732 Sum =  0.9997953202815721
Iteration =  11  Dual obj =  0.03388027111716581  Primal_obj =  0.038172346384231795  Gap =  0.004292075267065987 Sum =  0.9996919985885401
Iteration =  12  Dual obj =  0.03388053045264669  Primal_obj =  0.03812568899011587  Gap =  0.004245158537469179 Sum =  0.9999443730671239
Iteration =  13  Dual obj =  0.033880843680009334  Primal_obj =  0.03801645820628437  Gap =  0.004135614526275033 Sum =  1.0000270207593638
Iteration =  14  Dual obj =  0.03388124947991586  Primal_obj =  0.03816652914616578  Gap =  0.004285279666249919 Sum =  1.0002016102266658
Iteration =  15  Dual obj =  0.03388170641634447  Primal_obj =  0.0381799777459791  Gap =  0.004298271329634631 Sum =  1.0002827187039545
Iteration =  16  Dual obj =  0.033882273305894675  Primal_obj =  0.038436616017721054  Gap =  0.0045543427118263785 Sum =  1.0006962303535953
Iteration =  17  Dual obj =  0.03388275348221354  Primal_obj =  0.03836609108052519  Gap =  0.004483337598311647 Sum =  1.0003768040382925
Iteration =  18  Dual obj =  0.033882991904103  Primal_obj =  0.037942457358967605  Gap =  0.0040594654548646025 Sum =  1.0001990843526374
Iteration =  19  Dual obj =  0.03388318318043544  Primal_obj =  0.03767207654334036  Gap =  0.003788893362904916 Sum =  0.9998926020964214
Iteration =  20  Dual obj =  0.03388339132279789  Primal_obj =  0.03742173667674785  Gap =  0.003538345353949958 Sum =  0.9998249144178939
Iteration =  21  Dual obj =  0.03388359378401029  Primal_obj =  0.03722219468318293  Gap =  0.0033386008991726362 Sum =  0.9997020919759363
Iteration =  22  Dual obj =  0.033883795025755864  Primal_obj =  0.03704646721739187  Gap =  0.003162672191636004 Sum =  0.9995495835157274
Iteration =  23  Dual obj =  0.03388406413627718  Primal_obj =  0.036916612944679156  Gap =  0.0030325488084019733 Sum =  0.9994169336220751
Iteration =  24  Dual obj =  0.033884337299891806  Primal_obj =  0.03672032778096217  Gap =  0.0028359904810703607 Sum =  0.9996133918843874
Done, writing results...
