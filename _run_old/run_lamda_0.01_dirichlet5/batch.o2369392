2021-04-27 22:05:32,587 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.43s.
2021-04-27 22:05:33,028 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.23s.
2021-04-27 22:05:33,455 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.43s.
2021-04-27 22:05:33,586 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.13s.
2021-04-27 22:05:33,589 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 22:05:33,600 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 22:05:34,519 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 108.
2021-04-27 22:05:34,520 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.93s.
Iteration =  0  Dual obj =  -36.31796008812294  Primal_obj =  32794.56775384971  Gap =  32830.88571393783 Sum =  398.6619718437189
Iteration =  1  Dual obj =  -0.033112412804315004  Primal_obj =  19.440470154784464  Gap =  19.473582567588778 Sum =  0.937386938637983
Iteration =  2  Dual obj =  0.00888823624909326  Primal_obj =  8.098234126652368  Gap =  8.089345890403274 Sum =  0.7767067771620826
Iteration =  3  Dual obj =  0.023976903202560643  Primal_obj =  2.908975511086862  Gap =  2.8849986078843015 Sum =  0.8688106547432777
Iteration =  4  Dual obj =  0.029736969737261174  Primal_obj =  1.4946438396237616  Gap =  1.4649068698865004 Sum =  0.9439218293967693
Iteration =  5  Dual obj =  0.03236777504591809  Primal_obj =  0.7209339101133339  Gap =  0.6885661350674157 Sum =  1.000669218839437
Iteration =  6  Dual obj =  0.033074053640490896  Primal_obj =  0.35779590310224585  Gap =  0.324721849461755 Sum =  0.9987718103506739
Iteration =  7  Dual obj =  0.033310057764746104  Primal_obj =  0.23108728460350744  Gap =  0.19777722683876134 Sum =  0.9908535618150334
Iteration =  8  Dual obj =  0.033432007914047795  Primal_obj =  0.178517178577702  Gap =  0.1450851706636542 Sum =  0.9969210126075423
Iteration =  9  Dual obj =  0.03352810884594469  Primal_obj =  0.14400337708003474  Gap =  0.11047526823409005 Sum =  1.00106677960642
Iteration =  10  Dual obj =  0.033596555130788755  Primal_obj =  0.12448843060608399  Gap =  0.09089187547529523 Sum =  0.9995352986563444
Iteration =  11  Dual obj =  0.03364796993225644  Primal_obj =  0.10043670000284026  Gap =  0.06678873007058382 Sum =  0.9977993547759045
Iteration =  12  Dual obj =  0.03368237497001848  Primal_obj =  0.07860785905392023  Gap =  0.04492548408390175 Sum =  1.0005140166758915
Iteration =  13  Dual obj =  0.03370102750550649  Primal_obj =  0.059727786138962236  Gap =  0.026026758633455743 Sum =  1.0003387620128157
Iteration =  14  Dual obj =  0.033710720373808054  Primal_obj =  0.04646963160850409  Gap =  0.012758911234696038 Sum =  0.9995077586378194
Iteration =  15  Dual obj =  0.033715159075464046  Primal_obj =  0.040596849668624035  Gap =  0.006881690593159989 Sum =  0.9996020805549134
Iteration =  16  Dual obj =  0.03371753647284986  Primal_obj =  0.037838037862065646  Gap =  0.004120501389215783 Sum =  0.9999684143614165
Iteration =  17  Dual obj =  0.03371909082994811  Primal_obj =  0.03642749742241842  Gap =  0.0027084065924703124 Sum =  0.999868010333201
Iteration =  18  Dual obj =  0.033720121021741364  Primal_obj =  0.03565459557807199  Gap =  0.001934474556330626 Sum =  0.9997594583992455
Iteration =  19  Dual obj =  0.03372091226773463  Primal_obj =  0.0351830465761538  Gap =  0.001462134308419169 Sum =  0.9999234392490464
Iteration =  20  Dual obj =  0.03372146428828878  Primal_obj =  0.03489875164688845  Gap =  0.0011772873585996699 Sum =  1.0000524039697214
Iteration =  21  Dual obj =  0.03372188563583757  Primal_obj =  0.034644988662974344  Gap =  0.0009231030271367735 Sum =  0.9998523680807332
Iteration =  22  Dual obj =  0.0337221816651465  Primal_obj =  0.034464932043869564  Gap =  0.0007427503787230672 Sum =  0.99982316719643
Iteration =  23  Dual obj =  0.03372240225107055  Primal_obj =  0.034332185145924426  Gap =  0.0006097828948538747 Sum =  1.0000459192310218
Iteration =  24  Dual obj =  0.03372258783336348  Primal_obj =  0.03422862610896732  Gap =  0.0005060382756038387 Sum =  0.9999997060553185
Iteration =  0  Dual obj =  -24.91965825341419  Primal_obj =  23622.413710693912  Gap =  23647.333368947326 Sum =  398.6619718437189
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.06169716636134785  Primal_obj =  18.374609753578014  Gap =  18.436306919939362 Sum =  0.4948684964214082
Iteration =  3  Dual obj =  0.01808987491941732  Primal_obj =  11.553910289520969  Gap =  11.535820414601552 Sum =  0.8576282540299123
Iteration =  4  Dual obj =  0.03765839867663272  Primal_obj =  5.910674215174568  Gap =  5.873015816497936 Sum =  0.8340457478525974
Iteration =  5  Dual obj =  0.04492195914263628  Primal_obj =  3.187743555950314  Gap =  3.1428215968076776 Sum =  0.8318578924842666
Iteration =  6  Dual obj =  0.04821076943985932  Primal_obj =  2.2027753202408085  Gap =  2.154564550800949 Sum =  0.8647438953339885
Iteration =  7  Dual obj =  0.05029356651481395  Primal_obj =  1.5068128377561203  Gap =  1.4565192712413064 Sum =  0.9015108921156173
Iteration =  8  Dual obj =  0.05168294888732698  Primal_obj =  1.2654502253401  Gap =  1.2137672764527732 Sum =  0.945809582355124
Iteration =  9  Dual obj =  0.05263784620097718  Primal_obj =  0.8212508298712491  Gap =  0.7686129836702719 Sum =  0.9655010542493658
Iteration =  10  Dual obj =  0.05319060192913465  Primal_obj =  0.623779429372666  Gap =  0.5705888274435313 Sum =  0.9823910839320381
Iteration =  11  Dual obj =  0.053523165240851225  Primal_obj =  0.5315696772488248  Gap =  0.47804651200797355 Sum =  0.9863430145207426
Iteration =  12  Dual obj =  0.053752259695901396  Primal_obj =  0.4198292202930434  Gap =  0.366076960597142 Sum =  0.9925152418103497
Iteration =  13  Dual obj =  0.053884089377878405  Primal_obj =  0.36082320593874645  Gap =  0.30693911656086803 Sum =  0.9909174951902924
Iteration =  14  Dual obj =  0.05398955307271973  Primal_obj =  0.33277940046224697  Gap =  0.2787898473895272 Sum =  0.9945322662712905
Iteration =  15  Dual obj =  0.0540802364336309  Primal_obj =  0.2869732588762453  Gap =  0.2328930224426144 Sum =  0.9969339424842726
Iteration =  16  Dual obj =  0.05413988639078181  Primal_obj =  0.25062051005685354  Gap =  0.19648062366607172 Sum =  0.9983230315024769
Iteration =  17  Dual obj =  0.05418370830282379  Primal_obj =  0.22936441196330437  Gap =  0.17518070366048058 Sum =  1.0012447996312086
Iteration =  18  Dual obj =  0.054226515030504505  Primal_obj =  0.21383899108094623  Gap =  0.1596124760504417 Sum =  1.0027518224961396
Iteration =  19  Dual obj =  0.05426302262436318  Primal_obj =  0.21893034959215374  Gap =  0.16466732696779057 Sum =  1.005728748350084
Iteration =  20  Dual obj =  0.05430596519438803  Primal_obj =  0.20644982335672368  Gap =  0.15214385816233567 Sum =  1.0049296537201853
Iteration =  21  Dual obj =  0.05434135951562892  Primal_obj =  0.19246911013925694  Gap =  0.13812775062362803 Sum =  1.0013291101198911
Iteration =  22  Dual obj =  0.054376088856987234  Primal_obj =  0.17360964464713405  Gap =  0.11923355579014681 Sum =  0.9972611320626259
Iteration =  23  Dual obj =  0.0544031832379911  Primal_obj =  0.16084458209246455  Gap =  0.10644139885447346 Sum =  0.99824575894338
Iteration =  24  Dual obj =  0.05443132840116198  Primal_obj =  0.14155640878752251  Gap =  0.08712508038636053 Sum =  0.9988113383500492
Iteration =  0  Dual obj =  0.05443132840116198  Primal_obj =  0.14155640878752251  Gap =  0.08712508038636053 Sum =  0.9988113383500492
Iteration =  1  Dual obj =  0.0544424428355166  Primal_obj =  0.12112633339254428  Gap =  0.06668389055702767 Sum =  0.9989861196855856
Iteration =  2  Dual obj =  0.054451685776269826  Primal_obj =  0.10822712348430522  Gap =  0.05377543770803539 Sum =  0.9984708866062099
Iteration =  3  Dual obj =  0.05445921774825352  Primal_obj =  0.10175870645736614  Gap =  0.047299488709112616 Sum =  0.9994481455599613
Iteration =  4  Dual obj =  0.054465837825883906  Primal_obj =  0.09865724962091398  Gap =  0.04419141179503007 Sum =  0.9998447208947162
Iteration =  5  Dual obj =  0.05447305289573611  Primal_obj =  0.09518541752925236  Gap =  0.04071236463351625 Sum =  0.9994784194482769
Iteration =  6  Dual obj =  0.05448151143833539  Primal_obj =  0.09342260435484487  Gap =  0.038941092916509476 Sum =  1.0009907444532895
Iteration =  7  Dual obj =  0.05449152604601758  Primal_obj =  0.08945475020669068  Gap =  0.0349632241606731 Sum =  1.0002599763430815
Iteration =  8  Dual obj =  0.0545003063061881  Primal_obj =  0.0865282556231206  Gap =  0.032027949316932494 Sum =  1.0010685603883611
Iteration =  9  Dual obj =  0.05450685434599074  Primal_obj =  0.08103214852412552  Gap =  0.026525294178134776 Sum =  1.0007573380936554
Iteration =  10  Dual obj =  0.05451339662194776  Primal_obj =  0.07577375317800467  Gap =  0.021260356556056903 Sum =  1.000728955407976
Iteration =  11  Dual obj =  0.0545183765594657  Primal_obj =  0.07119428922405398  Gap =  0.016675912664588274 Sum =  1.0004695914386394
Iteration =  12  Dual obj =  0.05452227063841886  Primal_obj =  0.0676551207750278  Gap =  0.013132850136608948 Sum =  0.9997997093167759
Iteration =  13  Dual obj =  0.054525174815690344  Primal_obj =  0.06606839282689267  Gap =  0.011543218011202325 Sum =  0.999202914556936
Iteration =  14  Dual obj =  0.05452770137776408  Primal_obj =  0.06489169755661398  Gap =  0.010363996178849894 Sum =  0.9995544619162748
Iteration =  15  Dual obj =  0.05452996965031026  Primal_obj =  0.06471731090516818  Gap =  0.010187341254857915 Sum =  0.9993816638432444
Iteration =  16  Dual obj =  0.054531904126914256  Primal_obj =  0.06382657850974992  Gap =  0.009294674382835662 Sum =  0.9991457932811245
Iteration =  17  Dual obj =  0.05453366485934785  Primal_obj =  0.06322502770373332  Gap =  0.008691362844385472 Sum =  1.000296006390296
Iteration =  18  Dual obj =  0.054535331716233267  Primal_obj =  0.06258032738647465  Gap =  0.008044995670241382 Sum =  0.9999884026629616
Iteration =  19  Dual obj =  0.054536948712768304  Primal_obj =  0.062470626477138136  Gap =  0.007933677764369831 Sum =  1.000482263465723
Iteration =  20  Dual obj =  0.054538489295868686  Primal_obj =  0.061801299440001754  Gap =  0.007262810144133068 Sum =  0.9998335263176572
Iteration =  21  Dual obj =  0.05453967475935487  Primal_obj =  0.06132584976431374  Gap =  0.006786175004958872 Sum =  0.9998605048698794
Iteration =  22  Dual obj =  0.05454085426012606  Primal_obj =  0.061476453927066375  Gap =  0.006935599666940316 Sum =  0.9996213701091955
Iteration =  23  Dual obj =  0.0545420138563885  Primal_obj =  0.06111573611029254  Gap =  0.006573722253904041 Sum =  0.9995972243200624
Iteration =  24  Dual obj =  0.054542899372577835  Primal_obj =  0.060560569792283504  Gap =  0.006017670419705669 Sum =  1.0003648237378902
Iteration =  0  Dual obj =  0.054542899372577835  Primal_obj =  0.060560569792283504  Gap =  0.006017670419705669 Sum =  1.0003648237378902
Iteration =  1  Dual obj =  0.05454337465064829  Primal_obj =  0.05992989707809308  Gap =  0.005386522427444793 Sum =  1.0001103018248054
Iteration =  2  Dual obj =  0.054543722237705164  Primal_obj =  0.05938062211628431  Gap =  0.004836899878579146 Sum =  0.9999855048346544
Iteration =  3  Dual obj =  0.05454422969024525  Primal_obj =  0.0587910029828761  Gap =  0.004246773292630852 Sum =  0.9998982482528538
Iteration =  4  Dual obj =  0.054544882372446174  Primal_obj =  0.058366281207528764  Gap =  0.00382139883508259 Sum =  0.9997266027047909
Iteration =  5  Dual obj =  0.0545453757787014  Primal_obj =  0.05821822095620854  Gap =  0.003672845177507135 Sum =  0.9998440570385292
Iteration =  6  Dual obj =  0.05454579260894764  Primal_obj =  0.05812711629882355  Gap =  0.0035813236898759107 Sum =  1.0001371785879747
Iteration =  7  Dual obj =  0.054546238039033884  Primal_obj =  0.05807883380737494  Gap =  0.003532595768341057 Sum =  1.000063652930309
Iteration =  8  Dual obj =  0.054546918565545374  Primal_obj =  0.05821046233192423  Gap =  0.0036635437663788545 Sum =  1.0000452426476905
Iteration =  9  Dual obj =  0.054547779633845814  Primal_obj =  0.05832088812107242  Gap =  0.0037731084872266035 Sum =  0.999941892077364
Iteration =  10  Dual obj =  0.054548465957538116  Primal_obj =  0.05879588951591004  Gap =  0.004247423558371925 Sum =  0.9999955857566848
Iteration =  11  Dual obj =  0.05454911719546497  Primal_obj =  0.05928701490665028  Gap =  0.00473789771118531 Sum =  0.9999111719340649
Iteration =  12  Dual obj =  0.05454968313599817  Primal_obj =  0.05904082434434452  Gap =  0.004491141208346344 Sum =  0.999829420549186
Iteration =  13  Dual obj =  0.05455039716085152  Primal_obj =  0.058933388762831246  Gap =  0.004382991601979726 Sum =  1.0001361179863513
Iteration =  14  Dual obj =  0.05455103218196508  Primal_obj =  0.05859010964888543  Gap =  0.004039077466920352 Sum =  0.9998817032339556
Iteration =  15  Dual obj =  0.05455151457394204  Primal_obj =  0.05857171439577026  Gap =  0.004020199821828219 Sum =  1.00008862514359
Iteration =  16  Dual obj =  0.05455220382494838  Primal_obj =  0.058496359198854944  Gap =  0.003944155373906563 Sum =  1.0003360132893224
Iteration =  17  Dual obj =  0.05455267139949975  Primal_obj =  0.05858085818914148  Gap =  0.00402818678964173 Sum =  0.9999201436164709
Iteration =  18  Dual obj =  0.054553133353762766  Primal_obj =  0.058623628251636785  Gap =  0.004070494897874019 Sum =  1.0001428988150491
Iteration =  19  Dual obj =  0.05455353292494847  Primal_obj =  0.05830047546836503  Gap =  0.003746942543416565 Sum =  0.9999670212092855
Iteration =  20  Dual obj =  0.05455396994427872  Primal_obj =  0.05786722594008544  Gap =  0.003313255995806723 Sum =  0.9999618576661761
Iteration =  21  Dual obj =  0.05455441394751286  Primal_obj =  0.057494053729745066  Gap =  0.0029396397822322035 Sum =  0.9999311648216489
Iteration =  22  Dual obj =  0.054554819385310066  Primal_obj =  0.05732810654280976  Gap =  0.002773287157499693 Sum =  0.9999087083966198
Iteration =  23  Dual obj =  0.05455521104326118  Primal_obj =  0.057208666557788695  Gap =  0.002653455514527517 Sum =  0.999895971710261
Iteration =  24  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  0  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  1  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  2  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  3  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  4  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  5  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  6  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  7  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  8  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  9  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  10  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  11  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  12  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  13  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  14  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  15  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  16  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  17  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  18  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  19  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  20  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  21  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  22  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  23  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Iteration =  24  Dual obj =  0.0545555155702393  Primal_obj =  0.05710493308769592  Gap =  0.0025494175174566175 Sum =  0.9999085504892016
Done, writing results...
