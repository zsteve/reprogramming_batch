2021-04-27 21:44:31,136 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.29s.
2021-04-27 21:44:31,594 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-27 21:44:32,015 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.42s.
2021-04-27 21:44:32,136 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-27 21:44:32,140 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 21:44:32,151 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 21:44:33,002 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 114.
2021-04-27 21:44:33,003 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.87s.
Iteration =  0  Dual obj =  -44.80354795102513  Primal_obj =  53769.01699743298  Gap =  53813.820545384 Sum =  389.59995339765294
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.10616454598487049  Primal_obj =  13.682509574199129  Gap =  13.788674120184 Sum =  0.551858381194765
Iteration =  3  Dual obj =  0.00722739164117274  Primal_obj =  14.68426045979388  Gap =  14.677033068152706 Sum =  0.8699647167914066
Iteration =  4  Dual obj =  0.030531253027943128  Primal_obj =  5.7039430792377335  Gap =  5.67341182620979 Sum =  0.7865957520503957
Iteration =  5  Dual obj =  0.03895818891015347  Primal_obj =  3.9313785044519842  Gap =  3.892420315541831 Sum =  0.8471272669523824
Iteration =  6  Dual obj =  0.044578729194151845  Primal_obj =  3.0001128843266223  Gap =  2.9555341551324705 Sum =  0.9428066645873547
Iteration =  7  Dual obj =  0.04786954397902597  Primal_obj =  1.5614541421351982  Gap =  1.5135845981561722 Sum =  1.0007650941717459
Iteration =  8  Dual obj =  0.0489891931070167  Primal_obj =  0.8828360705086088  Gap =  0.8338468774015921 Sum =  1.008520044804038
Iteration =  9  Dual obj =  0.049593438021187264  Primal_obj =  0.48510196782903936  Gap =  0.4355085298078521 Sum =  0.9955029271386128
Iteration =  10  Dual obj =  0.04987679529326351  Primal_obj =  0.28782342408119566  Gap =  0.23794662878793216 Sum =  0.9937124238351029
Iteration =  11  Dual obj =  0.05002743022350208  Primal_obj =  0.16206788936714872  Gap =  0.11204045914364663 Sum =  0.9990073739578071
Iteration =  12  Dual obj =  0.0500841392953598  Primal_obj =  0.11787227490501016  Gap =  0.06778813560965036 Sum =  1.0014086979177161
Iteration =  13  Dual obj =  0.05011336766501305  Primal_obj =  0.08729586037057896  Gap =  0.03718249270556591 Sum =  1.0014282190212351
Iteration =  14  Dual obj =  0.05012908309308372  Primal_obj =  0.07362143844898135  Gap =  0.02349235535589763 Sum =  0.9997077435545041
Iteration =  15  Dual obj =  0.05013943968369747  Primal_obj =  0.06547058436657488  Gap =  0.015331144682877412 Sum =  0.9991304334270699
Iteration =  16  Dual obj =  0.0501462568706651  Primal_obj =  0.06081430958116365  Gap =  0.010668052710498546 Sum =  0.9994995220780971
Iteration =  17  Dual obj =  0.050150757346060434  Primal_obj =  0.05761800557846218  Gap =  0.007467248232401746 Sum =  0.9998765373662419
Iteration =  18  Dual obj =  0.050153685851428834  Primal_obj =  0.05518268154658891  Gap =  0.005028995695160077 Sum =  1.000017023074527
Iteration =  19  Dual obj =  0.05015539170601684  Primal_obj =  0.05369126629406143  Gap =  0.0035358745880445866 Sum =  0.9996962185901631
Iteration =  20  Dual obj =  0.05015650806950425  Primal_obj =  0.0527276322601609  Gap =  0.002571124190656651 Sum =  0.9996417573607865
Iteration =  21  Dual obj =  0.05015725266650145  Primal_obj =  0.05218120527540281  Gap =  0.0020239526089013624 Sum =  0.9999225597051813
Iteration =  22  Dual obj =  0.050157821391821705  Primal_obj =  0.051866450914792694  Gap =  0.0017086295229709891 Sum =  0.9999992706328699
Iteration =  23  Dual obj =  0.05015826834598194  Primal_obj =  0.051659498826276  Gap =  0.0015012304802940538 Sum =  1.0000082331141056
Iteration =  24  Dual obj =  0.0501586622633419  Primal_obj =  0.051504545341240944  Gap =  0.0013458830778990474 Sum =  0.9997812124841876
Iteration =  0  Dual obj =  -37.98791742413288  Primal_obj =  44792.59178119944  Gap =  44830.57969862357 Sum =  389.59995339765294
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.26965953062803927  Primal_obj =  205.50495788241943  Gap =  205.77461741304748 Sum =  4.634690495007102
Iteration =  4  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  5  Dual obj =  -0.055658718284791714  Primal_obj =  14.218832832177101  Gap =  14.274491550461892 Sum =  0.5017555475383578
Iteration =  6  Dual obj =  0.01465105755194672  Primal_obj =  15.776852249632405  Gap =  15.76220119208046 Sum =  0.8922182602889683
Iteration =  7  Dual obj =  0.03491672859157789  Primal_obj =  9.558428820723996  Gap =  9.52351209213242 Sum =  0.8376969427497034
Iteration =  8  Dual obj =  0.04485061233206832  Primal_obj =  6.1834905800611555  Gap =  6.1386399677290875 Sum =  0.8102554389226151
Iteration =  9  Dual obj =  0.04981017270968528  Primal_obj =  4.275452396453598  Gap =  4.225642223743913 Sum =  0.8305519921742859
Iteration =  10  Dual obj =  0.05334808390035488  Primal_obj =  3.762377905191697  Gap =  3.709029821291342 Sum =  0.8440931555942086
Iteration =  11  Dual obj =  0.055635441777545494  Primal_obj =  3.1241459344370175  Gap =  3.068510492659472 Sum =  0.8579924825071212
Iteration =  12  Dual obj =  0.05720500270028489  Primal_obj =  2.538042835810738  Gap =  2.480837833110453 Sum =  0.8699051283885637
Iteration =  13  Dual obj =  0.059290331535821084  Primal_obj =  2.797379381070484  Gap =  2.738089049534663 Sum =  0.9176073981893034
Iteration =  14  Dual obj =  0.06042382405910654  Primal_obj =  2.114537455504747  Gap =  2.0541136314456407 Sum =  0.9258369174821263
Iteration =  15  Dual obj =  0.061063415766916214  Primal_obj =  1.6348271426740553  Gap =  1.573763726907139 Sum =  0.9271489828947574
Iteration =  16  Dual obj =  0.06147303270525463  Primal_obj =  1.4536948143793016  Gap =  1.392221781674047 Sum =  0.935132089377763
Iteration =  17  Dual obj =  0.06182727153359173  Primal_obj =  1.3042167737053576  Gap =  1.242389502171766 Sum =  0.9407534228112383
Iteration =  18  Dual obj =  0.06212873304810645  Primal_obj =  1.2322817324065278  Gap =  1.1701529993584214 Sum =  0.9508831951642396
Iteration =  19  Dual obj =  0.06249876517824977  Primal_obj =  1.1691274646564664  Gap =  1.1066286994782166 Sum =  0.9637372001533684
Iteration =  20  Dual obj =  0.06298967818911853  Primal_obj =  1.0223646140688754  Gap =  0.9593749358797569 Sum =  0.9983486010404476
Iteration =  21  Dual obj =  0.06325382247422433  Primal_obj =  0.8495237668866782  Gap =  0.7862699444124539 Sum =  1.0039932686783515
Iteration =  22  Dual obj =  0.06337161314975173  Primal_obj =  0.6859880227736082  Gap =  0.6226164096238564 Sum =  0.992892997459667
Iteration =  23  Dual obj =  0.06343570146142714  Primal_obj =  0.6199115187083817  Gap =  0.5564758172469545 Sum =  0.9880257574887121
Iteration =  24  Dual obj =  0.06356920325167685  Primal_obj =  0.544063429756901  Gap =  0.48049422650522416 Sum =  0.9886296183907475
Iteration =  0  Dual obj =  0.06356920325167685  Primal_obj =  0.544063429756901  Gap =  0.48049422650522416 Sum =  0.9886296183907475
Iteration =  1  Dual obj =  0.06361816174173664  Primal_obj =  0.482865845200042  Gap =  0.4192476834583054 Sum =  0.9857747351087887
Iteration =  2  Dual obj =  0.06369875276982429  Primal_obj =  0.44156320171434227  Gap =  0.377864448944518 Sum =  1.0016302122868126
Iteration =  3  Dual obj =  0.06378757041312356  Primal_obj =  0.39223030152987015  Gap =  0.3284427311167466 Sum =  1.00784870247739
Iteration =  4  Dual obj =  0.06387977054972159  Primal_obj =  0.32261019782652656  Gap =  0.25873042727680495 Sum =  1.0092504690260788
Iteration =  5  Dual obj =  0.06393757593824677  Primal_obj =  0.2509598209230134  Gap =  0.1870222449847666 Sum =  1.001337170587051
Iteration =  6  Dual obj =  0.06397513386119211  Primal_obj =  0.20863978148191065  Gap =  0.14466464762071854 Sum =  0.9999226481510695
Iteration =  7  Dual obj =  0.06400337591157304  Primal_obj =  0.1774674578582297  Gap =  0.11346408194665666 Sum =  0.998273226274309
Iteration =  8  Dual obj =  0.06402648236492786  Primal_obj =  0.15483598736970566  Gap =  0.0908095050047778 Sum =  0.9985563272943874
Iteration =  9  Dual obj =  0.0640467149839893  Primal_obj =  0.1387521646934245  Gap =  0.0747054497094352 Sum =  1.000144756439043
Iteration =  10  Dual obj =  0.06406388781766732  Primal_obj =  0.13138237654131732  Gap =  0.06731848872365 Sum =  1.000335241801335
Iteration =  11  Dual obj =  0.06407771051544  Primal_obj =  0.12273163113455625  Gap =  0.05865392061911624 Sum =  1.00008087230506
Iteration =  12  Dual obj =  0.06408989279160018  Primal_obj =  0.11359179887033646  Gap =  0.04950190607873628 Sum =  0.9990977296820976
Iteration =  13  Dual obj =  0.06409954751772122  Primal_obj =  0.10928298867013862  Gap =  0.0451834411524174 Sum =  0.999149985892845
Iteration =  14  Dual obj =  0.06410723779306235  Primal_obj =  0.1038556453591823  Gap =  0.039748407566119956 Sum =  0.9998159029552101
Iteration =  15  Dual obj =  0.06411384923165817  Primal_obj =  0.09747026098087948  Gap =  0.03335641174922131 Sum =  0.9996016874522848
Iteration =  16  Dual obj =  0.06411887981241053  Primal_obj =  0.09332741576636054  Gap =  0.02920853595395001 Sum =  1.0005360117169089
Iteration =  17  Dual obj =  0.06412305824901007  Primal_obj =  0.08987184482509014  Gap =  0.02574878657608007 Sum =  1.0004931987608203
Iteration =  18  Dual obj =  0.06412680209321137  Primal_obj =  0.08720119681814746  Gap =  0.023074394724936095 Sum =  1.000955921945587
Iteration =  19  Dual obj =  0.06413017573420075  Primal_obj =  0.08411636168342633  Gap =  0.019986185949225577 Sum =  1.0003838470870072
Iteration =  20  Dual obj =  0.06413295796461112  Primal_obj =  0.08199792359882274  Gap =  0.017864965634211624 Sum =  1.0000942693581731
Iteration =  21  Dual obj =  0.06413548497822252  Primal_obj =  0.07955566516116948  Gap =  0.015420180182946955 Sum =  0.9997108867282913
Iteration =  22  Dual obj =  0.06413773743830643  Primal_obj =  0.07757152401518076  Gap =  0.01343378657687433 Sum =  0.9991968187237856
Iteration =  23  Dual obj =  0.06413996832508262  Primal_obj =  0.07569746934512857  Gap =  0.011557501020045949 Sum =  0.9996153252689174
Iteration =  24  Dual obj =  0.06414192981838085  Primal_obj =  0.07427942010554212  Gap =  0.010137490287161266 Sum =  0.9997401622008901
Iteration =  0  Dual obj =  0.06414192981838085  Primal_obj =  0.07427942010554212  Gap =  0.010137490287161266 Sum =  0.9997401622008901
Iteration =  1  Dual obj =  0.06414295174251267  Primal_obj =  0.07306415383752962  Gap =  0.008921202095016956 Sum =  0.9997318997009464
Iteration =  2  Dual obj =  0.06414392089024076  Primal_obj =  0.0718420689708626  Gap =  0.0076981480806218305 Sum =  0.999683998780773
Iteration =  3  Dual obj =  0.06414469955600732  Primal_obj =  0.0711564048649915  Gap =  0.0070117053089841785 Sum =  0.9998194942130927
Iteration =  4  Dual obj =  0.0641454878159189  Primal_obj =  0.07075107180554156  Gap =  0.00660558398962266 Sum =  1.0000319674999185
Iteration =  5  Dual obj =  0.06414630566111808  Primal_obj =  0.07049291434539923  Gap =  0.006346608684281149 Sum =  1.0002526658176885
Iteration =  6  Dual obj =  0.06414697094294715  Primal_obj =  0.07022521315938095  Gap =  0.006078242216433799 Sum =  1.0003150772691847
Iteration =  7  Dual obj =  0.06414754335836817  Primal_obj =  0.0699337342510593  Gap =  0.005786190892691126 Sum =  1.000095093112478
Iteration =  8  Dual obj =  0.06414831769547555  Primal_obj =  0.0698414316872385  Gap =  0.005693113991762949 Sum =  1.0000775630321574
Iteration =  9  Dual obj =  0.06414918192050342  Primal_obj =  0.06985402794549722  Gap =  0.005704846024993798 Sum =  0.9998147374094575
Iteration =  10  Dual obj =  0.06415018031538441  Primal_obj =  0.06968801259569171  Gap =  0.005537832280307298 Sum =  0.9997516244671025
Iteration =  11  Dual obj =  0.06415130666633181  Primal_obj =  0.06943426690406636  Gap =  0.005282960237734544 Sum =  0.9998189774988334
Iteration =  12  Dual obj =  0.06415225190890234  Primal_obj =  0.06942842092783104  Gap =  0.005276169018928703 Sum =  0.9994918040179648
Iteration =  13  Dual obj =  0.0641528996380713  Primal_obj =  0.06964823500465461  Gap =  0.005495335366583309 Sum =  1.0000211764494211
Iteration =  14  Dual obj =  0.06415350365990227  Primal_obj =  0.06907804721282318  Gap =  0.004924543552920907 Sum =  0.9997727887974743
Iteration =  15  Dual obj =  0.06415418234788614  Primal_obj =  0.06845810505712818  Gap =  0.004303922709242042 Sum =  0.9998195887414116
Iteration =  16  Dual obj =  0.06415478402137578  Primal_obj =  0.06812696343246492  Gap =  0.003972179411089141 Sum =  0.9999601730550243
Iteration =  17  Dual obj =  0.06415529100845378  Primal_obj =  0.06792770512063485  Gap =  0.0037724141121810717 Sum =  1.0001995270507429
Iteration =  18  Dual obj =  0.064155718415077  Primal_obj =  0.06776736642220539  Gap =  0.00361164800712839 Sum =  0.9999692076896802
Iteration =  19  Dual obj =  0.06415606518880088  Primal_obj =  0.06770513016530544  Gap =  0.0035490649765045623 Sum =  1.0001460297300468
Iteration =  20  Dual obj =  0.06415640828072922  Primal_obj =  0.06765486215967116  Gap =  0.0034984538789419456 Sum =  1.0003453679038075
Iteration =  21  Dual obj =  0.06415672716153994  Primal_obj =  0.0674847717996733  Gap =  0.003328044638133354 Sum =  1.0002757918410676
Iteration =  22  Dual obj =  0.06415703885809058  Primal_obj =  0.06732284993699422  Gap =  0.003165811078903638 Sum =  1.0002661911967599
Iteration =  23  Dual obj =  0.0641573210797289  Primal_obj =  0.067198717918401  Gap =  0.0030413968386721058 Sum =  1.0001051119645292
Iteration =  24  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  0  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  1  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  2  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  3  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  4  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  5  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  6  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  7  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  8  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  9  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  10  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  11  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  12  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  13  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  14  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  15  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  16  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  17  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  18  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  19  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  20  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  21  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  22  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  23  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Iteration =  24  Dual obj =  0.06415759844153791  Primal_obj =  0.06707186599046693  Gap =  0.0029142675489290115 Sum =  0.9998597026469818
Done, writing results...
