2021-04-27 21:35:09,190 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.31s.
2021-04-27 21:35:09,658 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-27 21:35:10,105 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.45s.
2021-04-27 21:35:10,230 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-27 21:35:10,233 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 21:35:10,244 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 21:35:11,090 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 110.
2021-04-27 21:35:11,091 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.86s.
Iteration =  0  Dual obj =  -51.53007765854305  Primal_obj =  48534.42649025595  Gap =  48585.956567914494 Sum =  417.3070543441888
Iteration =  1  Dual obj =  -0.047145648734253705  Primal_obj =  14.415479505040162  Gap =  14.462625153774416 Sum =  0.7601134524396047
Iteration =  2  Dual obj =  -0.008178330740991287  Primal_obj =  6.425436362630894  Gap =  6.433614693371885 Sum =  0.8125452016208963
Iteration =  3  Dual obj =  0.0041088031193689395  Primal_obj =  2.3397466982007273  Gap =  2.3356378950813586 Sum =  0.8679690689390326
Iteration =  4  Dual obj =  0.009347666308203897  Primal_obj =  1.2735424517600282  Gap =  1.2641947854518243 Sum =  0.9451144066685545
Iteration =  5  Dual obj =  0.011813740827373631  Primal_obj =  0.6256974364863843  Gap =  0.6138836956590107 Sum =  1.011761950784415
Iteration =  6  Dual obj =  0.012732891947054754  Primal_obj =  0.34614656589771625  Gap =  0.3334136739506615 Sum =  1.0025659828452902
Iteration =  7  Dual obj =  0.013034483817397129  Primal_obj =  0.20169744017176944  Gap =  0.1886629563543723 Sum =  0.9903136941117509
Iteration =  8  Dual obj =  0.013198956940870494  Primal_obj =  0.128151870490981  Gap =  0.11495291355011052 Sum =  0.9966828619438628
Iteration =  9  Dual obj =  0.013282507795219146  Primal_obj =  0.09637767970761407  Gap =  0.08309517191239493 Sum =  0.9988170942988825
Iteration =  10  Dual obj =  0.013345257358976063  Primal_obj =  0.06789072815206557  Gap =  0.0545454707930895 Sum =  0.9964736930201011
Iteration =  11  Dual obj =  0.013385189042803242  Primal_obj =  0.043707369080755024  Gap =  0.03032218003795178 Sum =  0.9984900415551698
Iteration =  12  Dual obj =  0.013406650258460027  Primal_obj =  0.031418537533299665  Gap =  0.018011887274839638 Sum =  0.999646132500422
Iteration =  13  Dual obj =  0.013419745865275737  Primal_obj =  0.025218360056725578  Gap =  0.011798614191449841 Sum =  0.9988204797112681
Iteration =  14  Dual obj =  0.013428380127788526  Primal_obj =  0.021321169426732733  Gap =  0.007892789298944207 Sum =  0.998104309947589
Iteration =  15  Dual obj =  0.013433682917047739  Primal_obj =  0.01856837307382765  Gap =  0.005134690156779913 Sum =  0.9993568581420016
Iteration =  16  Dual obj =  0.013436652659751778  Primal_obj =  0.01693200349307722  Gap =  0.003495350833325441 Sum =  1.000450620647482
Iteration =  17  Dual obj =  0.013438570124733536  Primal_obj =  0.015863537933427388  Gap =  0.0024249678086938516 Sum =  0.9996670998545958
Iteration =  18  Dual obj =  0.013439728738490034  Primal_obj =  0.015207703281565524  Gap =  0.0017679745430754894 Sum =  0.9995333606869325
Iteration =  19  Dual obj =  0.013440510475823834  Primal_obj =  0.01476851286926148  Gap =  0.0013280023934376453 Sum =  0.9998931151399075
Iteration =  20  Dual obj =  0.01344105658226976  Primal_obj =  0.014461394087889018  Gap =  0.001020337505619258 Sum =  0.9999871671990848
Iteration =  21  Dual obj =  0.013441448252808009  Primal_obj =  0.014243816659319702  Gap =  0.0008023684065116936 Sum =  0.9998845753765941
Iteration =  22  Dual obj =  0.013441730388691495  Primal_obj =  0.014110996937174228  Gap =  0.0006692665484827331 Sum =  0.9999991412715268
Iteration =  23  Dual obj =  0.013441957405925326  Primal_obj =  0.014004783044775093  Gap =  0.0005628256388497677 Sum =  1.0000589054409648
Iteration =  24  Dual obj =  0.013442148586093616  Primal_obj =  0.013909760310726188  Gap =  0.0004676117246325724 Sum =  0.9999206105256796
Iteration =  0  Dual obj =  -39.342872795341776  Primal_obj =  31658.235236685  Gap =  31697.578109480342 Sum =  417.3070543441888
Iteration =  1  Dual obj =  -0.04413083503017677  Primal_obj =  22.161248140730326  Gap =  22.205378975760503 Sum =  0.8164838294387287
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  3  Dual obj =  0.0024196171121297558  Primal_obj =  11.107680244890584  Gap =  11.105260627778454 Sum =  1.0128895169825245
Iteration =  4  Dual obj =  0.021235606460393734  Primal_obj =  5.26467721719864  Gap =  5.243441610738246 Sum =  0.821296320295565
Iteration =  5  Dual obj =  0.02815577801590085  Primal_obj =  3.6332124662700025  Gap =  3.6050566882541015 Sum =  0.8132304995390623
Iteration =  6  Dual obj =  0.031579696817572875  Primal_obj =  1.9774588150657992  Gap =  1.9458791182482265 Sum =  0.8471382747188142
Iteration =  7  Dual obj =  0.03370602186069338  Primal_obj =  1.536333666007817  Gap =  1.5026276441471236 Sum =  0.8974851887754052
Iteration =  8  Dual obj =  0.035101532752888825  Primal_obj =  1.08335641380896  Gap =  1.0482548810560712 Sum =  0.9210856320414832
Iteration =  9  Dual obj =  0.03611966576764102  Primal_obj =  0.9270585233091047  Gap =  0.8909388575414636 Sum =  0.9531055806818439
Iteration =  10  Dual obj =  0.03683307435321889  Primal_obj =  0.6793505154182979  Gap =  0.642517441065079 Sum =  0.9761860416782406
Iteration =  11  Dual obj =  0.03728516958457122  Primal_obj =  0.5541508940787825  Gap =  0.5168657244942113 Sum =  0.9855952517324298
Iteration =  12  Dual obj =  0.03761053817528543  Primal_obj =  0.4148479701847918  Gap =  0.3772374320095064 Sum =  0.9801307931306797
Iteration =  13  Dual obj =  0.037871592273792484  Primal_obj =  0.41224409379941607  Gap =  0.37437250152562357 Sum =  0.9887167892091455
Iteration =  14  Dual obj =  0.03803953238967126  Primal_obj =  0.32740867655760975  Gap =  0.28936914416793846 Sum =  0.9888233072654907
Iteration =  15  Dual obj =  0.038162536372932515  Primal_obj =  0.2465421761088083  Gap =  0.20837963973587578 Sum =  0.9835531590073298
Iteration =  16  Dual obj =  0.038241701761064756  Primal_obj =  0.2103983801790731  Gap =  0.17215667841800836 Sum =  0.9879697268006309
Iteration =  17  Dual obj =  0.03830203056966583  Primal_obj =  0.1874130757594083  Gap =  0.14911104518974247 Sum =  0.9928784551040405
Iteration =  18  Dual obj =  0.038348368522188106  Primal_obj =  0.16372319945967453  Gap =  0.12537483093748641 Sum =  0.9943576133664436
Iteration =  19  Dual obj =  0.038378351465270716  Primal_obj =  0.14840887628033603  Gap =  0.11003052481506531 Sum =  0.9945216090499653
Iteration =  20  Dual obj =  0.03840161520205926  Primal_obj =  0.1333224090079806  Gap =  0.09492079380592133 Sum =  0.9984986982923095
Iteration =  21  Dual obj =  0.038421950237968176  Primal_obj =  0.1250127277541121  Gap =  0.08659077751614391 Sum =  0.9993519585512163
Iteration =  22  Dual obj =  0.03844665706016566  Primal_obj =  0.12030935585978689  Gap =  0.08186269879962123 Sum =  0.999724060407231
Iteration =  23  Dual obj =  0.03846618241667342  Primal_obj =  0.11579969165159801  Gap =  0.07733350923492459 Sum =  1.0021230565747792
Iteration =  24  Dual obj =  0.03848553815885891  Primal_obj =  0.1077756151348766  Gap =  0.06929007697601769 Sum =  1.0031202766733698
Iteration =  0  Dual obj =  0.03848553815885891  Primal_obj =  0.1077756151348766  Gap =  0.06929007697601769 Sum =  1.0031202766733698
Iteration =  1  Dual obj =  0.03849474280420505  Primal_obj =  0.09668701979141782  Gap =  0.05819227698721277 Sum =  1.0009327148873668
Iteration =  2  Dual obj =  0.03850150867443483  Primal_obj =  0.08931615763274406  Gap =  0.05081464895830923 Sum =  1.0003845746551574
Iteration =  3  Dual obj =  0.03850895357099342  Primal_obj =  0.08519971123921163  Gap =  0.046690757668218216 Sum =  1.0007597827825407
Iteration =  4  Dual obj =  0.03851578629420187  Primal_obj =  0.08174734667038026  Gap =  0.043231560376178396 Sum =  0.9988223778635908
Iteration =  5  Dual obj =  0.038524008953728935  Primal_obj =  0.08068145241255054  Gap =  0.0421574434588216 Sum =  0.9980879974535668
Iteration =  6  Dual obj =  0.0385331057739018  Primal_obj =  0.08010595176935617  Gap =  0.04157284599545437 Sum =  0.9983920744593557
Iteration =  7  Dual obj =  0.038541158008546864  Primal_obj =  0.07626669177349343  Gap =  0.03772553376494657 Sum =  0.9991893782664096
Iteration =  8  Dual obj =  0.03854815629826468  Primal_obj =  0.07117525225903837  Gap =  0.03262709596077369 Sum =  0.998834359803077
Iteration =  9  Dual obj =  0.03855393926266762  Primal_obj =  0.06720142076829123  Gap =  0.028647481505623615 Sum =  0.9998768733311681
Iteration =  10  Dual obj =  0.038559447728559564  Primal_obj =  0.06389254900087146  Gap =  0.0253331012723119 Sum =  1.0001707677193654
Iteration =  11  Dual obj =  0.03856505434892471  Primal_obj =  0.06287558748454028  Gap =  0.02431053313561557 Sum =  1.0002906066578947
Iteration =  12  Dual obj =  0.03856947832133917  Primal_obj =  0.061363829684769666  Gap =  0.0227943513634305 Sum =  1.000735878969372
Iteration =  13  Dual obj =  0.03857337696833407  Primal_obj =  0.06087490104841439  Gap =  0.02230152408008032 Sum =  1.0004604316182357
Iteration =  14  Dual obj =  0.038576648049007144  Primal_obj =  0.061960496198574175  Gap =  0.02338384814956703 Sum =  1.0000384732748544
Iteration =  15  Dual obj =  0.03857972553304641  Primal_obj =  0.06135460897584366  Gap =  0.022774883442797253 Sum =  0.999884613958685
Iteration =  16  Dual obj =  0.038582462247566354  Primal_obj =  0.06119118825209202  Gap =  0.022608726004525667 Sum =  0.9991587973047265
Iteration =  17  Dual obj =  0.03858531830857938  Primal_obj =  0.06068370347639794  Gap =  0.022098385167818563 Sum =  0.9989009919620448
Iteration =  18  Dual obj =  0.03858846633492411  Primal_obj =  0.05911580786980969  Gap =  0.020527341534885578 Sum =  1.000162728180967
Iteration =  19  Dual obj =  0.03859087385423243  Primal_obj =  0.058337099259323816  Gap =  0.019746225405091383 Sum =  1.0015450446834264
Iteration =  20  Dual obj =  0.038593124457990756  Primal_obj =  0.055757731168053784  Gap =  0.017164606710063028 Sum =  1.001298702440996
Iteration =  21  Dual obj =  0.03859506391060269  Primal_obj =  0.053676630419192434  Gap =  0.015081566508589744 Sum =  1.0005735607807427
Iteration =  22  Dual obj =  0.038596873604130846  Primal_obj =  0.052497312619329495  Gap =  0.013900439015198648 Sum =  1.0008184457349287
Iteration =  23  Dual obj =  0.03859837190040218  Primal_obj =  0.05139159930798663  Gap =  0.01279322740758445 Sum =  1.0006842270387608
Iteration =  24  Dual obj =  0.03859976790196819  Primal_obj =  0.05008518017030514  Gap =  0.01148541226833695 Sum =  1.000156301871912
Iteration =  0  Dual obj =  0.03859976790196819  Primal_obj =  0.05008518017030514  Gap =  0.01148541226833695 Sum =  1.000156301871912
Iteration =  1  Dual obj =  0.03860050281767989  Primal_obj =  0.04904130282227012  Gap =  0.010440800004590231 Sum =  1.000323885291463
Iteration =  2  Dual obj =  0.03860112523845082  Primal_obj =  0.048072988098796024  Gap =  0.009471862860345202 Sum =  1.0002803151672843
Iteration =  3  Dual obj =  0.038601808292609834  Primal_obj =  0.047153434011059175  Gap =  0.008551625718449342 Sum =  1.0002835593815735
Iteration =  4  Dual obj =  0.038602472467154786  Primal_obj =  0.04654240760151501  Gap =  0.007939935134360226 Sum =  1.000303504922171
Iteration =  5  Dual obj =  0.03860295394286908  Primal_obj =  0.045916557176586895  Gap =  0.007313603233717818 Sum =  1.0002175304086336
Iteration =  6  Dual obj =  0.03860339051155322  Primal_obj =  0.045471991635614065  Gap =  0.006868601124060847 Sum =  0.9999243835456163
Iteration =  7  Dual obj =  0.03860395903936021  Primal_obj =  0.04511415000950535  Gap =  0.006510190970145137 Sum =  0.9997872673006145
Iteration =  8  Dual obj =  0.038604564137188296  Primal_obj =  0.044867576909443194  Gap =  0.006263012772254897 Sum =  0.9999974837616594
Iteration =  9  Dual obj =  0.038605203098693655  Primal_obj =  0.04469259009964277  Gap =  0.0060873870009491154 Sum =  0.9998710558192307
Iteration =  10  Dual obj =  0.038605821030580745  Primal_obj =  0.044567956096508224  Gap =  0.005962135065927479 Sum =  1.0000010600982583
Iteration =  11  Dual obj =  0.03860651356223291  Primal_obj =  0.04450189110588401  Gap =  0.0058953775436511036 Sum =  1.0007779767076312
Iteration =  12  Dual obj =  0.03860715813881223  Primal_obj =  0.04445987585119783  Gap =  0.005852717712385602 Sum =  1.0000621522657007
Iteration =  13  Dual obj =  0.0386078291260964  Primal_obj =  0.04461527957441416  Gap =  0.006007450448317762 Sum =  1.0000115240566987
Iteration =  14  Dual obj =  0.038608696597661155  Primal_obj =  0.04491834851598828  Gap =  0.006309651918327122 Sum =  1.0002772012078809
Iteration =  15  Dual obj =  0.0386093423592279  Primal_obj =  0.045126910951930374  Gap =  0.006517568592702472 Sum =  0.9998643494229844
Iteration =  16  Dual obj =  0.038609875206037994  Primal_obj =  0.045129716395662905  Gap =  0.0065198411896249114 Sum =  0.9995850361202829
Iteration =  17  Dual obj =  0.03861042103739755  Primal_obj =  0.045416260138163744  Gap =  0.006805839100766195 Sum =  1.0001636615194502
Iteration =  18  Dual obj =  0.038610967589821826  Primal_obj =  0.04601551489604966  Gap =  0.007404547306227832 Sum =  1.0001115049599107
Iteration =  19  Dual obj =  0.03861145448998851  Primal_obj =  0.04630162614381145  Gap =  0.007690171653822936 Sum =  0.9998938822647061
Iteration =  20  Dual obj =  0.0386119348583016  Primal_obj =  0.0457330992311796  Gap =  0.0071211643728780055 Sum =  0.9996932761493784
Iteration =  21  Dual obj =  0.0386123593172845  Primal_obj =  0.045308494872947275  Gap =  0.006696135555662772 Sum =  1.0000992017339279
Iteration =  22  Dual obj =  0.03861273145410296  Primal_obj =  0.045001806219159335  Gap =  0.006389074765056374 Sum =  0.999783755554235
Iteration =  23  Dual obj =  0.038613135252719075  Primal_obj =  0.04464019324384361  Gap =  0.006027057991124532 Sum =  1.0001680216593078
Iteration =  24  Dual obj =  0.038613570883079165  Primal_obj =  0.04419406178692764  Gap =  0.005580490903848476 Sum =  0.9998385611047773
Iteration =  0  Dual obj =  0.038613570883079165  Primal_obj =  0.04419406178692764  Gap =  0.005580490903848476 Sum =  0.9998385611047773
Iteration =  1  Dual obj =  0.03861379536605804  Primal_obj =  0.04387692335905154  Gap =  0.005263127992993499 Sum =  1.0000376371828208
Iteration =  2  Dual obj =  0.038613931378696065  Primal_obj =  0.04363347556313167  Gap =  0.0050195441844356065 Sum =  0.9997565457972559
Iteration =  3  Dual obj =  0.03861407043794896  Primal_obj =  0.04343264145568525  Gap =  0.004818571017736285 Sum =  1.000073349087905
Iteration =  4  Dual obj =  0.03861421402082067  Primal_obj =  0.04325153701120267  Gap =  0.004637322990381998 Sum =  1.0001054584990081
Iteration =  5  Dual obj =  0.03861436587487824  Primal_obj =  0.04310634315904095  Gap =  0.004491977284162715 Sum =  0.9998778186158294
Iteration =  6  Dual obj =  0.038614572912569936  Primal_obj =  0.04284420699058347  Gap =  0.004229634078013536 Sum =  0.9998141780814541
Iteration =  7  Dual obj =  0.03861499696323162  Primal_obj =  0.042374886982465276  Gap =  0.003759890019233658 Sum =  1.000104973216527
Iteration =  8  Dual obj =  0.03861535872340496  Primal_obj =  0.04205002530506946  Gap =  0.0034346665816644972 Sum =  1.0000287507190313
Iteration =  9  Dual obj =  0.038615696242933074  Primal_obj =  0.04182695036497999  Gap =  0.003211254122046918 Sum =  1.0001477228482372
Iteration =  10  Dual obj =  0.038615871155408835  Primal_obj =  0.04174700891842416  Gap =  0.0031311377630153236 Sum =  0.9999388414227683
Iteration =  11  Dual obj =  0.03861606698336113  Primal_obj =  0.041708737416438546  Gap =  0.003092670433077413 Sum =  1.0001984477244497
Iteration =  12  Dual obj =  0.038616252069415026  Primal_obj =  0.04168370464782545  Gap =  0.003067452578410422 Sum =  1.0000244903323887
Iteration =  13  Dual obj =  0.03861645835590667  Primal_obj =  0.04173290216386047  Gap =  0.0031164438079537976 Sum =  1.0000135786504858
Iteration =  14  Dual obj =  0.03861663624837623  Primal_obj =  0.0418239864985086  Gap =  0.003207350250132371 Sum =  1.0001664750024495
Iteration =  15  Dual obj =  0.03861679711214751  Primal_obj =  0.04179921702076002  Gap =  0.0031824199086125105 Sum =  1.0001353102303814
Iteration =  16  Dual obj =  0.038616983623307  Primal_obj =  0.04189279300647242  Gap =  0.0032758093831654206 Sum =  1.0000192800842025
Iteration =  17  Dual obj =  0.03861715820516752  Primal_obj =  0.042024499860589246  Gap =  0.003407341655421725 Sum =  1.0000677671195413
Iteration =  18  Dual obj =  0.03861741558875778  Primal_obj =  0.042072616350968275  Gap =  0.0034552007622104947 Sum =  1.000136545129456
Iteration =  19  Dual obj =  0.03861763461996163  Primal_obj =  0.04220308540922227  Gap =  0.00358545078926064 Sum =  1.0000647251604766
Iteration =  20  Dual obj =  0.03861789551724912  Primal_obj =  0.04231105123387029  Gap =  0.0036931557166211687 Sum =  1.000179058291434
Iteration =  21  Dual obj =  0.03861826734038254  Primal_obj =  0.042543770709682516  Gap =  0.003925503369299976 Sum =  1.0003166550486493
Iteration =  22  Dual obj =  0.03861856498095033  Primal_obj =  0.04251501685304057  Gap =  0.0038964518720902425 Sum =  0.9999793800747235
Iteration =  23  Dual obj =  0.038618865083885554  Primal_obj =  0.042527767141582504  Gap =  0.00390890205769695 Sum =  0.9996333866071649
Iteration =  24  Dual obj =  0.03861916920141069  Primal_obj =  0.04257806234926689  Gap =  0.0039588931478562045 Sum =  0.9999558409135386
Done, writing results...
