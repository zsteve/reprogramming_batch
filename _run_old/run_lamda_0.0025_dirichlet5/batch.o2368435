2021-04-27 13:47:55,276 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.13s.
2021-04-27 13:47:55,703 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.23s.
2021-04-27 13:47:56,088 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.39s.
2021-04-27 13:47:56,201 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-27 13:47:56,204 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 13:47:56,215 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 13:47:57,033 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 117.
2021-04-27 13:47:57,034 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.83s.
Iteration =  0  Dual obj =  -34.763823801108764  Primal_obj =  9145.524182012625  Gap =  9180.288005813734 Sum =  355.0295192979026
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.13763655748355794  Primal_obj =  3.0693000490635582  Gap =  3.2069366065471163 Sum =  0.6580429976360945
Iteration =  3  Dual obj =  -0.099680159942394  Primal_obj =  1.6090079769589063  Gap =  1.7086881369013003 Sum =  0.8954303642420632
Iteration =  4  Dual obj =  -0.09173151485220508  Primal_obj =  0.7200274109853263  Gap =  0.8117589258375314 Sum =  0.9297245358719967
Iteration =  5  Dual obj =  -0.08892098077882418  Primal_obj =  0.4822358032038999  Gap =  0.5711567839827241 Sum =  0.9831639015868103
Iteration =  6  Dual obj =  -0.08775810113086516  Primal_obj =  0.30767012689498174  Gap =  0.3954282280258469 Sum =  0.9978433509819016
Iteration =  7  Dual obj =  -0.08720762922577788  Primal_obj =  0.19318077981829246  Gap =  0.28038840904407036 Sum =  0.9964846387840739
Iteration =  8  Dual obj =  -0.0868794287020034  Primal_obj =  0.1238106246012356  Gap =  0.21069005330323898 Sum =  0.9929354616263972
Iteration =  9  Dual obj =  -0.08666462629894625  Primal_obj =  0.08312095984375187  Gap =  0.16978558614269812 Sum =  0.995026960036393
Iteration =  10  Dual obj =  -0.08651048880234254  Primal_obj =  0.03574684771519274  Gap =  0.12225733651753527 Sum =  0.9965021985487749
Iteration =  11  Dual obj =  -0.08639911892564862  Primal_obj =  0.011722624423720046  Gap =  0.09812174334936867 Sum =  0.9948569269818405
Iteration =  12  Dual obj =  -0.086305624879953  Primal_obj =  -0.014091151528245416  Gap =  0.07221447335170758 Sum =  0.9956400079195438
Iteration =  13  Dual obj =  -0.08624581770110351  Primal_obj =  -0.03047297626853851  Gap =  0.055772841432565 Sum =  0.9978826206751534
Iteration =  14  Dual obj =  -0.08620952374468252  Primal_obj =  -0.04755236240691284  Gap =  0.03865716133776968 Sum =  0.9993991511186728
Iteration =  15  Dual obj =  -0.08618305967377943  Primal_obj =  -0.05235151719828052  Gap =  0.03383154247549891 Sum =  0.9997127532367387
Iteration =  16  Dual obj =  -0.08616034822720262  Primal_obj =  -0.0568722552979949  Gap =  0.029288092929207712 Sum =  0.9995243826855943
Iteration =  17  Dual obj =  -0.08614214841787327  Primal_obj =  -0.06323469027764242  Gap =  0.022907458140230846 Sum =  0.999534696237588
Iteration =  18  Dual obj =  -0.08612964954109223  Primal_obj =  -0.06879228137272492  Gap =  0.017337368168367312 Sum =  0.9998045193847245
Iteration =  19  Dual obj =  -0.08612029747359783  Primal_obj =  -0.07251026188464998  Gap =  0.013610035588947841 Sum =  0.9998951475021179
Iteration =  20  Dual obj =  -0.08611407849826097  Primal_obj =  -0.07543594968405547  Gap =  0.010678128814205504 Sum =  0.9998340585342711
Iteration =  21  Dual obj =  -0.08611013640958036  Primal_obj =  -0.07777464161152038  Gap =  0.008335494798059978 Sum =  0.9999115507069241
Iteration =  22  Dual obj =  -0.08610761191815075  Primal_obj =  -0.07963206514756163  Gap =  0.006475546770589119 Sum =  1.000016928687037
Iteration =  23  Dual obj =  -0.08610591289932892  Primal_obj =  -0.08108309860591785  Gap =  0.005022814293411074 Sum =  0.9998596388976748
Iteration =  24  Dual obj =  -0.08610481400944667  Primal_obj =  -0.08214037982627001  Gap =  0.003964434183176657 Sum =  0.9999090968883353
Iteration =  0  Dual obj =  -36.91180092435755  Primal_obj =  8406.236803157348  Gap =  8443.148604081705 Sum =  355.0295192979026
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  inf
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.3392783573308644  Primal_obj =  170.60578663694454  Gap =  170.9450649942754 Sum =  6.0594945898721235
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  -0.14274711373291976  Primal_obj =  5.004473671951979  Gap =  5.147220785684899 Sum =  0.7516792037964226
Iteration =  5  Dual obj =  -0.1300060794086958  Primal_obj =  4.322679831896096  Gap =  4.452685911304791 Sum =  0.7569678611170324
Iteration =  6  Dual obj =  -0.11896613705509036  Primal_obj =  4.408672750432988  Gap =  4.527638887488078 Sum =  0.7779505619605406
Iteration =  7  Dual obj =  -0.11222576292987053  Primal_obj =  4.935173221195546  Gap =  5.047398984125417 Sum =  1.0877315006872053
Iteration =  8  Dual obj =  -0.10563607591270241  Primal_obj =  4.1288514214591405  Gap =  4.234487497371843 Sum =  0.9718163796631485
Iteration =  9  Dual obj =  -0.10070597932361464  Primal_obj =  3.4484594564564413  Gap =  3.549165435780056 Sum =  0.8965022253858572
Iteration =  10  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  11  Dual obj =  -0.09638907919573575  Primal_obj =  2.6053292807769752  Gap =  2.701718359972711 Sum =  0.9808181386199643
Iteration =  12  Dual obj =  -0.0921021733693197  Primal_obj =  2.1671246472447145  Gap =  2.2592268206140345 Sum =  0.8665708001333663
Iteration =  13  Dual obj =  -0.08901090547034632  Primal_obj =  2.0540351261686287  Gap =  2.143046031638975 Sum =  0.9478179345999034
Iteration =  14  Dual obj =  -0.0872991888941039  Primal_obj =  1.8557505465816295  Gap =  1.9430497354757335 Sum =  0.8827937259572208
Iteration =  15  Dual obj =  -0.08606250024146803  Primal_obj =  1.8501186639350304  Gap =  1.9361811641764985 Sum =  0.8771736722620307
Iteration =  16  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.062500
Iteration =  17  Dual obj =  -0.08516143530629028  Primal_obj =  1.450099899420859  Gap =  1.5352613347271493 Sum =  0.9360922852744527
Iteration =  18  Dual obj =  -0.08400560136945968  Primal_obj =  1.4135498955716737  Gap =  1.4975554969411333 Sum =  0.9143184640519455
Iteration =  19  Dual obj =  -0.08289612806028347  Primal_obj =  1.2943769327066001  Gap =  1.3772730607668837 Sum =  0.9305102652853123
Iteration =  20  Dual obj =  -0.08216865296022352  Primal_obj =  1.2715157282500729  Gap =  1.3536843812102963 Sum =  0.9389756458233984
Iteration =  21  Dual obj =  -0.08173008395137932  Primal_obj =  1.3252128251770854  Gap =  1.4069429091284646 Sum =  0.9374835952843252
Iteration =  22  Dual obj =  -0.08011300848919911  Primal_obj =  1.1531685660749842  Gap =  1.2332815745641832 Sum =  0.9265419656872738
Iteration =  23  Dual obj =  -0.07878517886420056  Primal_obj =  0.9703599175854967  Gap =  1.0491450964496973 Sum =  0.9297164166151287
Iteration =  24  Dual obj =  -0.07827376623647256  Primal_obj =  0.8629837551959834  Gap =  0.9412575214324559 Sum =  0.9388999599437842
Iteration =  0  Dual obj =  -0.07827376623647256  Primal_obj =  0.8629837551959834  Gap =  0.9412575214324559 Sum =  0.9388999599437842
Iteration =  1  Dual obj =  -0.07775427791096669  Primal_obj =  0.7380750515435994  Gap =  0.8158293294545661 Sum =  0.9387792026179174
Iteration =  2  Dual obj =  -0.07703288932578393  Primal_obj =  0.6305421055541041  Gap =  0.707574994879888 Sum =  0.95592827746292
Iteration =  3  Dual obj =  -0.0766828532678577  Primal_obj =  0.554229978211376  Gap =  0.6309128314792337 Sum =  0.9524255003853592
Iteration =  4  Dual obj =  -0.07604707089558937  Primal_obj =  0.5441395002311538  Gap =  0.6201865711267431 Sum =  0.966272504201257
Iteration =  5  Dual obj =  -0.07545313386759199  Primal_obj =  0.4892278282904279  Gap =  0.5646809621580199 Sum =  0.9771858134362681
Iteration =  6  Dual obj =  -0.07499542710840817  Primal_obj =  0.3698790080675533  Gap =  0.4448744351759615 Sum =  0.9816031009128712
Iteration =  7  Dual obj =  -0.07472051244278158  Primal_obj =  0.3220657254131467  Gap =  0.39678623785592826 Sum =  0.9811351899308824
Iteration =  8  Dual obj =  -0.07449416798424582  Primal_obj =  0.2875672533437371  Gap =  0.3620614213279829 Sum =  0.9835387404041005
Iteration =  9  Dual obj =  -0.07426927462255778  Primal_obj =  0.2633568527437645  Gap =  0.3376261273663223 Sum =  0.9852084828250418
Iteration =  10  Dual obj =  -0.07408604911990684  Primal_obj =  0.2369171776338852  Gap =  0.31100322675379205 Sum =  0.9836494776269075
Iteration =  11  Dual obj =  -0.07392884372552733  Primal_obj =  0.21224867078614473  Gap =  0.28617751451167206 Sum =  0.9903438445587014
Iteration =  12  Dual obj =  -0.07379489296481036  Primal_obj =  0.174984074427525  Gap =  0.24877896739233535 Sum =  0.9905136405799719
Iteration =  13  Dual obj =  -0.07369064328912754  Primal_obj =  0.14623908542234865  Gap =  0.2199297287114762 Sum =  0.9931230916424257
Iteration =  14  Dual obj =  -0.07359159295236213  Primal_obj =  0.11867379628467184  Gap =  0.19226538923703396 Sum =  0.9957474148001806
Iteration =  15  Dual obj =  -0.07351906249084034  Primal_obj =  0.09864631291669243  Gap =  0.17216537540753277 Sum =  0.9984859220305737
Iteration =  16  Dual obj =  -0.07344581744990825  Primal_obj =  0.0738817472627869  Gap =  0.14732756471269515 Sum =  0.9989766842030994
Iteration =  17  Dual obj =  -0.07338978362742701  Primal_obj =  0.05213160148031673  Gap =  0.12552138510774374 Sum =  0.9972920860759733
Iteration =  18  Dual obj =  -0.07334053155101729  Primal_obj =  0.046943956118116914  Gap =  0.1202844876691342 Sum =  0.998668480302163
Iteration =  19  Dual obj =  -0.07329109425303947  Primal_obj =  0.03613960691996229  Gap =  0.10943070117300176 Sum =  0.9977052219219611
Iteration =  20  Dual obj =  -0.07325228767392908  Primal_obj =  0.03732305788461435  Gap =  0.11057534555854343 Sum =  0.9966213177087206
Iteration =  21  Dual obj =  -0.07321693486239692  Primal_obj =  0.01975154071236146  Gap =  0.09296847557475837 Sum =  0.9984476694530424
Iteration =  22  Dual obj =  -0.07318333504455088  Primal_obj =  0.0025539229632410843  Gap =  0.07573725800779196 Sum =  0.9981083106678124
Iteration =  23  Dual obj =  -0.07315884807915142  Primal_obj =  -0.005593512873145912  Gap =  0.06756533520600551 Sum =  0.9985257710108314
Iteration =  24  Dual obj =  -0.07313756684525305  Primal_obj =  -0.011145886420166201  Gap =  0.06199168042508685 Sum =  0.9987012580837608
Iteration =  0  Dual obj =  -0.07313756684525305  Primal_obj =  -0.011145886420166201  Gap =  0.06199168042508685 Sum =  0.9987012580837608
Iteration =  1  Dual obj =  -0.07312954575256067  Primal_obj =  -0.014994112234559154  Gap =  0.05813543351800152 Sum =  0.9996721991931055
Iteration =  2  Dual obj =  -0.07312269651434636  Primal_obj =  -0.019491939784946136  Gap =  0.05363075672940022 Sum =  0.9989844105850316
Iteration =  3  Dual obj =  -0.07311484160266135  Primal_obj =  -0.021721138559109524  Gap =  0.05139370304355183 Sum =  0.9989776642504442
Iteration =  4  Dual obj =  -0.07310824197643137  Primal_obj =  -0.020321831799505335  Gap =  0.052786410176926035 Sum =  0.9988750595778304
Iteration =  5  Dual obj =  -0.07310008972996704  Primal_obj =  -0.019869937480558847  Gap =  0.05323015224940819 Sum =  0.9984975485649021
Iteration =  6  Dual obj =  -0.07309200992196213  Primal_obj =  -0.021108663675993553  Gap =  0.05198334624596858 Sum =  0.9988968923277506
Iteration =  7  Dual obj =  -0.07308550056258284  Primal_obj =  -0.021532876236715195  Gap =  0.051552624325867644 Sum =  0.9989673329961788
Iteration =  8  Dual obj =  -0.0730779567399041  Primal_obj =  -0.02353967422252222  Gap =  0.049538282517381876 Sum =  0.9988542374150878
Iteration =  9  Dual obj =  -0.07307175729477812  Primal_obj =  -0.02862916958004111  Gap =  0.04444258771473701 Sum =  0.9994832059554964
Iteration =  10  Dual obj =  -0.0730662110266106  Primal_obj =  -0.03316189782521638  Gap =  0.03990431320139422 Sum =  0.9991457249276008
Iteration =  11  Dual obj =  -0.07306071218186869  Primal_obj =  -0.0361822245108093  Gap =  0.03687848767105939 Sum =  0.9989162357388656
Iteration =  12  Dual obj =  -0.07305469646244989  Primal_obj =  -0.03880402914133271  Gap =  0.03425066732111717 Sum =  0.9989412735009052
Iteration =  13  Dual obj =  -0.0730500345203364  Primal_obj =  -0.04259258448708607  Gap =  0.03045745003325033 Sum =  0.9988153178623964
Iteration =  14  Dual obj =  -0.07304481251679855  Primal_obj =  -0.042538400720315145  Gap =  0.030506411796483404 Sum =  0.9989876050284034
Iteration =  15  Dual obj =  -0.07304041301467654  Primal_obj =  -0.04536352644633518  Gap =  0.027676886568341358 Sum =  0.9990588025600513
Iteration =  16  Dual obj =  -0.07303629919787656  Primal_obj =  -0.04864553880713271  Gap =  0.02439076039074385 Sum =  0.9988429798649968
Iteration =  17  Dual obj =  -0.07303339875765465  Primal_obj =  -0.048050347650757344  Gap =  0.024983051106897303 Sum =  0.9991360418802568
Iteration =  18  Dual obj =  -0.07303046356060312  Primal_obj =  -0.05106146404419064  Gap =  0.021968999516412485 Sum =  0.999112157235029
Iteration =  19  Dual obj =  -0.07302745718496237  Primal_obj =  -0.05199185978261116  Gap =  0.02103559740235121 Sum =  0.9994409317723778
Iteration =  20  Dual obj =  -0.07302493513000703  Primal_obj =  -0.05225798260735097  Gap =  0.020766952522656063 Sum =  0.999452885032523
Iteration =  21  Dual obj =  -0.07302257349023324  Primal_obj =  -0.05555619377796672  Gap =  0.017466379712266514 Sum =  0.9991919996220058
Iteration =  22  Dual obj =  -0.07302047957064911  Primal_obj =  -0.05633156101109155  Gap =  0.016688918559557564 Sum =  0.9989728690933218
Iteration =  23  Dual obj =  -0.07301882087072761  Primal_obj =  -0.058003495891601614  Gap =  0.015015324979125999 Sum =  0.9991954539467778
Iteration =  24  Dual obj =  -0.07301751558193059  Primal_obj =  -0.05985132782958141  Gap =  0.013166187752349179 Sum =  0.9993403602002169
Iteration =  0  Dual obj =  -0.07301751558193059  Primal_obj =  -0.05985132782958141  Gap =  0.013166187752349179 Sum =  0.9993403602002169
Iteration =  1  Dual obj =  -0.0730167669744315  Primal_obj =  -0.05930367891459319  Gap =  0.013713088059838313 Sum =  0.9993026130981415
Iteration =  2  Dual obj =  -0.07301637202175623  Primal_obj =  -0.059803936960144105  Gap =  0.013212435061612127 Sum =  0.9992236026942164
Iteration =  3  Dual obj =  -0.07301593174931573  Primal_obj =  -0.06026068306864342  Gap =  0.012755248680672307 Sum =  0.9993714144772128
Iteration =  4  Dual obj =  -0.07301550136317257  Primal_obj =  -0.06027194935227237  Gap =  0.012743552010900203 Sum =  0.999564093150096
Iteration =  5  Dual obj =  -0.07301518235748053  Primal_obj =  -0.060664996623546796  Gap =  0.012350185733933733 Sum =  0.9995234719317652
Iteration =  6  Dual obj =  -0.07301472162174412  Primal_obj =  -0.06165755819070329  Gap =  0.011357163431040831 Sum =  0.9995684440488121
Iteration =  7  Dual obj =  -0.07301408450830948  Primal_obj =  -0.06171452133895888  Gap =  0.011299563169350602 Sum =  0.9996020833763405
Iteration =  8  Dual obj =  -0.0730131149651209  Primal_obj =  -0.06275876165506186  Gap =  0.010254353310059042 Sum =  0.9994099145172161
Iteration =  9  Dual obj =  -0.0730121454157043  Primal_obj =  -0.06380982791887471  Gap =  0.009202317496829593 Sum =  0.9994391028505946
Iteration =  10  Dual obj =  -0.07301132650780738  Primal_obj =  -0.06465177996317521  Gap =  0.008359546544632168 Sum =  0.9995958941626325
Iteration =  11  Dual obj =  -0.07301054461201015  Primal_obj =  -0.06562979772173788  Gap =  0.007380746890272266 Sum =  0.9995237221521366
Iteration =  12  Dual obj =  -0.07300984200325027  Primal_obj =  -0.06609094482443542  Gap =  0.006918897178814845 Sum =  0.9995688427131332
Iteration =  13  Dual obj =  -0.07300916057550902  Primal_obj =  -0.06666130713128374  Gap =  0.006347853444225282 Sum =  0.9996191254609895
Iteration =  14  Dual obj =  -0.07300862731514493  Primal_obj =  -0.06724331785120541  Gap =  0.005765309463939522 Sum =  0.9999593631536772
Iteration =  15  Dual obj =  -0.07300817066916851  Primal_obj =  -0.06766354962951505  Gap =  0.005344621039653455 Sum =  0.9998448161669599
Iteration =  16  Dual obj =  -0.0730078427766067  Primal_obj =  -0.06782665801072968  Gap =  0.00518118476587702 Sum =  0.9998376393340692
Iteration =  17  Dual obj =  -0.07300753745618975  Primal_obj =  -0.06823937468307177  Gap =  0.004768162773117979 Sum =  0.9998393232496929
Iteration =  18  Dual obj =  -0.07300724242377357  Primal_obj =  -0.06868884141097717  Gap =  0.004318401012796402 Sum =  0.9997350192395185
Iteration =  19  Dual obj =  -0.0730070027929146  Primal_obj =  -0.06891134417133925  Gap =  0.004095658621575349 Sum =  0.9997198200917569
Iteration =  20  Dual obj =  -0.07300675554890525  Primal_obj =  -0.06923855483622694  Gap =  0.0037682007126783046 Sum =  0.9997675442598751
Iteration =  21  Dual obj =  -0.07300643359490253  Primal_obj =  -0.06967619347775388  Gap =  0.00333024011714865 Sum =  0.9999034014638583
Iteration =  22  Dual obj =  -0.07300620284385947  Primal_obj =  -0.06988684257063049  Gap =  0.0031193602732289827 Sum =  0.9997784864072979
Iteration =  23  Dual obj =  -0.07300597884923077  Primal_obj =  -0.07017111038540884  Gap =  0.0028348684638219296 Sum =  0.9999175922485377
Iteration =  24  Dual obj =  -0.07300579459923648  Primal_obj =  -0.07045250823411267  Gap =  0.002553286365123808 Sum =  0.9999057769310175
Done, writing results...
