2021-04-27 13:47:55,262 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.11s.
2021-04-27 13:47:55,700 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-27 13:47:56,091 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.39s.
2021-04-27 13:47:56,205 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-27 13:47:56,208 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 13:47:56,219 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 13:47:57,141 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 108.
2021-04-27 13:47:57,142 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.94s.
Iteration =  0  Dual obj =  -32.962309701705635  Primal_obj =  14646.407161908006  Gap =  14679.369471609712 Sum =  371.5885893055343
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.12914909728006452  Primal_obj =  4.271513744033276  Gap =  4.400662841313341 Sum =  0.699714230983577
Iteration =  3  Dual obj =  -0.08416155380296364  Primal_obj =  2.5117480510137122  Gap =  2.5959096048166757 Sum =  0.9151549532883017
Iteration =  4  Dual obj =  -0.07608473266280581  Primal_obj =  1.3165562234166879  Gap =  1.3926409560794937 Sum =  0.9252512875023005
Iteration =  5  Dual obj =  -0.07313203679365976  Primal_obj =  1.054224605079642  Gap =  1.1273566418733019 Sum =  0.954714272030162
Iteration =  6  Dual obj =  -0.07106016057523229  Primal_obj =  0.6862161493839677  Gap =  0.7572763099591999 Sum =  0.9895647331605899
Iteration =  7  Dual obj =  -0.06992098202759582  Primal_obj =  0.3513813235408001  Gap =  0.42130230556839593 Sum =  0.9953866878820814
Iteration =  8  Dual obj =  -0.06940447147840192  Primal_obj =  0.09894479159311029  Gap =  0.1683492630715122 Sum =  0.9970075398573343
Iteration =  9  Dual obj =  -0.06923181584656321  Primal_obj =  0.003550393202720714  Gap =  0.07278220904928392 Sum =  0.9982571540544161
Iteration =  10  Dual obj =  -0.06916736179024645  Primal_obj =  -0.04150265484488304  Gap =  0.02766470694536341 Sum =  0.9986899346096654
Iteration =  11  Dual obj =  -0.06914080126427818  Primal_obj =  -0.056114286690451445  Gap =  0.013026514573826739 Sum =  0.9992753290663831
Iteration =  12  Dual obj =  -0.06912936526847113  Primal_obj =  -0.06155301834124037  Gap =  0.007576346927230762 Sum =  0.9996004926768378
Iteration =  13  Dual obj =  -0.06912339757930762  Primal_obj =  -0.06432343046413046  Gap =  0.004799967115177162 Sum =  0.9997565654482782
Iteration =  14  Dual obj =  -0.0691199462009093  Primal_obj =  -0.06580857900712801  Gap =  0.003311367193781292 Sum =  0.9997046545983189
Iteration =  15  Dual obj =  -0.06911785958900311  Primal_obj =  -0.06661198266414926  Gap =  0.0025058769248538504 Sum =  0.9997606986568677
Iteration =  16  Dual obj =  -0.06911625402052214  Primal_obj =  -0.06718262870792002  Gap =  0.0019336253126021191 Sum =  0.9998876261590635
Iteration =  17  Dual obj =  -0.06911516015834468  Primal_obj =  -0.06754037774939593  Gap =  0.0015747824089487467 Sum =  0.9998927426399337
Iteration =  18  Dual obj =  -0.06911427353650813  Primal_obj =  -0.067833964237233  Gap =  0.0012803092992751397 Sum =  0.9998758836230095
Iteration =  19  Dual obj =  -0.06911360519091564  Primal_obj =  -0.06805030713683902  Gap =  0.0010632980540766224 Sum =  0.999930187084021
Iteration =  20  Dual obj =  -0.06911308656992299  Primal_obj =  -0.06821397517512386  Gap =  0.0008991113947991319 Sum =  0.9999302231599616
Iteration =  21  Dual obj =  -0.06911266252586724  Primal_obj =  -0.06834441152162155  Gap =  0.0007682510042456986 Sum =  0.9998878558621844
Iteration =  22  Dual obj =  -0.06911233103688971  Primal_obj =  -0.06844749252615662  Gap =  0.0006648385107330956 Sum =  0.9999324882082145
Iteration =  23  Dual obj =  -0.06911205949836625  Primal_obj =  -0.06853311389819605  Gap =  0.0005789456001702026 Sum =  0.999989793880597
Iteration =  24  Dual obj =  -0.0691118410406483  Primal_obj =  -0.06859859184169818  Gap =  0.0005132491989501137 Sum =  0.9999853484461901
Iteration =  0  Dual obj =  -31.22359736986516  Primal_obj =  10840.461579373963  Gap =  10871.685176743827 Sum =  371.5885893055343
Iteration =  1  Dual obj =  -0.15058237432202298  Primal_obj =  9.339631790534673  Gap =  9.490214164856695 Sum =  0.9938534616049949
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  -0.11093626681911907  Primal_obj =  6.7213088121283  Gap =  6.83224507894742 Sum =  1.0789248313265012
Iteration =  5  Dual obj =  -0.09497104515635717  Primal_obj =  5.141542300901764  Gap =  5.236513346058121 Sum =  0.9670935955675775
Iteration =  6  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  7  Dual obj =  -0.08808024761744108  Primal_obj =  3.921545302124689  Gap =  4.00962554974213 Sum =  0.9788890621737898
Iteration =  8  Dual obj =  -0.07937224642502792  Primal_obj =  4.121433581025468  Gap =  4.2008058274504965 Sum =  0.897202259530216
Iteration =  9  Dual obj =  -0.072668577150029  Primal_obj =  3.074581626000504  Gap =  3.147250203150533 Sum =  0.9146750149146856
Iteration =  10  Dual obj =  -0.0682572087069161  Primal_obj =  2.677084698715361  Gap =  2.745341907422277 Sum =  0.9415268985240213
Iteration =  11  Dual obj =  -0.0650206374811798  Primal_obj =  2.3209567213198214  Gap =  2.3859773588010014 Sum =  0.9378127207254322
Iteration =  12  Dual obj =  -0.06206089727613397  Primal_obj =  2.1526761731109505  Gap =  2.2147370703870846 Sum =  0.933603223151537
Iteration =  13  Dual obj =  -0.05948444524611672  Primal_obj =  1.780318977055755  Gap =  1.8398034223018718 Sum =  0.9271401115078577
Iteration =  14  Dual obj =  -0.05808786807893477  Primal_obj =  1.3202245009007016  Gap =  1.3783123689796364 Sum =  0.9304960126004671
Iteration =  15  Dual obj =  -0.05708297276980284  Primal_obj =  1.174826039794931  Gap =  1.2319090125647338 Sum =  0.9352033176093513
Iteration =  16  Dual obj =  -0.056470320576113564  Primal_obj =  1.0216545534831494  Gap =  1.078124874059263 Sum =  0.9410536435016532
Iteration =  17  Dual obj =  -0.055877743556713586  Primal_obj =  0.9776551389077743  Gap =  1.0335328824644878 Sum =  0.9455465385786985
Iteration =  18  Dual obj =  -0.05511302365562518  Primal_obj =  0.9426123699727837  Gap =  0.997725393628409 Sum =  0.9587820920542733
Iteration =  19  Dual obj =  -0.05447188242669935  Primal_obj =  0.8486236666941678  Gap =  0.9030955491208671 Sum =  0.9701964292721922
Iteration =  20  Dual obj =  -0.05391456227655149  Primal_obj =  0.6549985555033946  Gap =  0.708913117779946 Sum =  0.9729997086395101
Iteration =  21  Dual obj =  -0.05340655837733516  Primal_obj =  0.5226285041580592  Gap =  0.5760350625353944 Sum =  0.9785658303250795
Iteration =  22  Dual obj =  -0.05304000887417408  Primal_obj =  0.3378853854778769  Gap =  0.390925394352051 Sum =  0.9811636752495043
Iteration =  23  Dual obj =  -0.05280049613274479  Primal_obj =  0.25655494446719307  Gap =  0.30935544059993786 Sum =  0.9820866952871551
Iteration =  24  Dual obj =  -0.052604616629876075  Primal_obj =  0.20345869724282206  Gap =  0.25606331387269815 Sum =  0.9845379166562143
Iteration =  0  Dual obj =  -0.052604616629876075  Primal_obj =  0.20345869724282206  Gap =  0.25606331387269815 Sum =  0.9845379166562143
Iteration =  1  Dual obj =  -0.05250163795537933  Primal_obj =  0.1597373002481865  Gap =  0.21223893820356582 Sum =  0.986331381275184
Iteration =  2  Dual obj =  -0.05244012132755685  Primal_obj =  0.15186683857901273  Gap =  0.20430695990656958 Sum =  0.9879864070843221
Iteration =  3  Dual obj =  -0.05233656942234101  Primal_obj =  0.137345949777246  Gap =  0.189682519199587 Sum =  0.9926149157293971
Iteration =  4  Dual obj =  -0.05223901587967153  Primal_obj =  0.1210967654889876  Gap =  0.17333578136865913 Sum =  0.9942801212004106
Iteration =  5  Dual obj =  -0.05214332627328713  Primal_obj =  0.08486751499948395  Gap =  0.13701084127277108 Sum =  0.9962830109770394
Iteration =  6  Dual obj =  -0.05206752291732628  Primal_obj =  0.05478726643527593  Gap =  0.1068547893526022 Sum =  0.9975453395217166
Iteration =  7  Dual obj =  -0.052014249276478214  Primal_obj =  0.02105726804205374  Gap =  0.07307151731853195 Sum =  0.9955446418647739
Iteration =  8  Dual obj =  -0.05197068978504483  Primal_obj =  -0.007708884058230878  Gap =  0.04426180572681395 Sum =  0.9960167663114852
Iteration =  9  Dual obj =  -0.0519443561857408  Primal_obj =  -0.023291535789048065  Gap =  0.028652820396692737 Sum =  0.9975842476668857
Iteration =  10  Dual obj =  -0.05192730902268868  Primal_obj =  -0.03405958337634456  Gap =  0.017867725646344125 Sum =  0.9982913066897712
Iteration =  11  Dual obj =  -0.05191680673363986  Primal_obj =  -0.03950333845554686  Gap =  0.012413468278092997 Sum =  0.9992719332920408
Iteration =  12  Dual obj =  -0.05190949255385205  Primal_obj =  -0.042598997114533285  Gap =  0.009310495439318764 Sum =  0.999666233053545
Iteration =  13  Dual obj =  -0.051904036037220574  Primal_obj =  -0.044623876931489226  Gap =  0.007280159105731349 Sum =  0.9997642729348994
Iteration =  14  Dual obj =  -0.051899620889840785  Primal_obj =  -0.04600617068253715  Gap =  0.005893450207303634 Sum =  0.9995648771803152
Iteration =  15  Dual obj =  -0.05189608010721582  Primal_obj =  -0.04696236125105323  Gap =  0.004933718856162589 Sum =  0.9993949631969377
Iteration =  16  Dual obj =  -0.05189328377073143  Primal_obj =  -0.04766999237423768  Gap =  0.004223291396493752 Sum =  0.9991101645962019
Iteration =  17  Dual obj =  -0.05189086448862394  Primal_obj =  -0.04818882411991193  Gap =  0.003702040368712009 Sum =  0.9992726112743743
Iteration =  18  Dual obj =  -0.051888922952826655  Primal_obj =  -0.04863900474946846  Gap =  0.003249918203358196 Sum =  0.9993961999946287
Iteration =  19  Dual obj =  -0.05188721023847842  Primal_obj =  -0.049042904021646724  Gap =  0.0028443062168316963 Sum =  0.9994792434577422
Iteration =  20  Dual obj =  -0.05188590007027771  Primal_obj =  -0.04930890034690649  Gap =  0.0025769997233712205 Sum =  0.999561052029721
Iteration =  21  Dual obj =  -0.051884812841260654  Primal_obj =  -0.04955731404624954  Gap =  0.0023274987950111167 Sum =  0.9996552312503442
Iteration =  22  Dual obj =  -0.05188375593063588  Primal_obj =  -0.04978154171486217  Gap =  0.0021022142157737095 Sum =  0.9996083353310631
Iteration =  23  Dual obj =  -0.05188289862353468  Primal_obj =  -0.049943262447977824  Gap =  0.0019396361755568553 Sum =  0.999630128238402
Iteration =  24  Dual obj =  -0.05188207258923043  Primal_obj =  -0.05004614654952558  Gap =  0.0018359260397048521 Sum =  0.9996837920201783
Iteration =  0  Dual obj =  -0.05188207258923043  Primal_obj =  -0.05004614654952558  Gap =  0.0018359260397048521 Sum =  0.9996837920201783
Iteration =  1  Dual obj =  -0.05188166671916334  Primal_obj =  -0.05018631348824523  Gap =  0.0016953532309181077 Sum =  0.999649483727307
Iteration =  2  Dual obj =  -0.051881306768164714  Primal_obj =  -0.05030613865752001  Gap =  0.0015751681106447035 Sum =  0.9996652170882787
Iteration =  3  Dual obj =  -0.051881048944136025  Primal_obj =  -0.05038135841601482  Gap =  0.0014996905281212045 Sum =  0.9996888405269384
Iteration =  4  Dual obj =  -0.05188081210506891  Primal_obj =  -0.050432495422349774  Gap =  0.0014483166827191363 Sum =  0.9996988674816376
Iteration =  5  Dual obj =  -0.05188055860081592  Primal_obj =  -0.050467328692800434  Gap =  0.0014132299080154842 Sum =  0.9996909554525374
Iteration =  6  Dual obj =  -0.05188030104130523  Primal_obj =  -0.050487169933825085  Gap =  0.0013931311074801417 Sum =  0.9997042678895555
Iteration =  7  Dual obj =  -0.05187997047398313  Primal_obj =  -0.05052179140579531  Gap =  0.0013581790681878175 Sum =  0.9996677775800403
Iteration =  8  Dual obj =  -0.05187951326522047  Primal_obj =  -0.05057121492617679  Gap =  0.0013082983390436814 Sum =  0.9995454989382204
Iteration =  9  Dual obj =  -0.05187909218480401  Primal_obj =  -0.05060347043329044  Gap =  0.0012756217515135643 Sum =  0.9996352961638639
Iteration =  10  Dual obj =  -0.05187856734936049  Primal_obj =  -0.05063192192700078  Gap =  0.0012466454223597143 Sum =  0.99971548515297
Iteration =  11  Dual obj =  -0.05187805374001524  Primal_obj =  -0.05065138165688185  Gap =  0.0012266720831333872 Sum =  0.9998301588657403
Iteration =  12  Dual obj =  -0.051877541597168134  Primal_obj =  -0.05068099072250977  Gap =  0.0011965508746583642 Sum =  0.9999430318434238
Iteration =  13  Dual obj =  -0.05187711263467384  Primal_obj =  -0.050740527241063316  Gap =  0.0011365853936105216 Sum =  0.9999591444139355
Iteration =  14  Dual obj =  -0.05187671026901947  Primal_obj =  -0.050810232141778724  Gap =  0.0010664781272407484 Sum =  0.9999104532654172
Iteration =  15  Dual obj =  -0.051876358706426  Primal_obj =  -0.05088996210135742  Gap =  0.000986396605068579 Sum =  0.9997851469045612
Iteration =  16  Dual obj =  -0.05187607686650236  Primal_obj =  -0.050969836759481205  Gap =  0.0009062401070211584 Sum =  0.9997258181589221
Iteration =  17  Dual obj =  -0.05187581405571392  Primal_obj =  -0.051048034716986976  Gap =  0.000827779338726943 Sum =  0.9998138037151514
Iteration =  18  Dual obj =  -0.05187558448225566  Primal_obj =  -0.05111356658830228  Gap =  0.0007620178939533803 Sum =  0.9998448163653535
Iteration =  19  Dual obj =  -0.05187535058909513  Primal_obj =  -0.0511720294084026  Gap =  0.0007033211806925302 Sum =  0.9999357479810412
Iteration =  20  Dual obj =  -0.051875174929982726  Primal_obj =  -0.05121657822453886  Gap =  0.0006585967054438674 Sum =  0.9999374560336179
Iteration =  21  Dual obj =  -0.05187502690250656  Primal_obj =  -0.05125389972995516  Gap =  0.0006211271725514028 Sum =  0.9999005312926726
Iteration =  22  Dual obj =  -0.051874894774070764  Primal_obj =  -0.051286425449316456  Gap =  0.000588469324754308 Sum =  0.9998510673079969
Iteration =  23  Dual obj =  -0.05187479546922506  Primal_obj =  -0.05131373572264958  Gap =  0.0005610597465754846 Sum =  0.9998381686315732
Iteration =  24  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  0  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  1  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  2  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  3  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  4  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  5  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  6  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  7  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  8  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  9  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  10  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  11  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  12  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  13  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  14  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  15  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  16  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  17  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  18  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  19  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  20  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  21  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  22  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  23  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Iteration =  24  Dual obj =  -0.05187470744662717  Primal_obj =  -0.0513381669869042  Gap =  0.00053654045972297 Sum =  0.999855614308401
Done, writing results...
