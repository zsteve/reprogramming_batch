2021-04-26 23:05:15,974 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.30s.
2021-04-26 23:05:16,437 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-26 23:05:16,861 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.42s.
2021-04-26 23:05:16,979 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-26 23:05:16,982 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-26 23:05:16,992 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-26 23:05:17,838 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 121.
2021-04-26 23:05:17,839 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.86s.
Iteration =  0  Dual obj =  -39.885043521564455  Primal_obj =  19749.502474106772  Gap =  19789.387517628336 Sum =  417.43845291854336
Iteration =  1  Dual obj =  -0.11947735659406326  Primal_obj =  6.835088261325902  Gap =  6.9545656179199655 Sum =  0.9489878201092994
Iteration =  2  Dual obj =  -0.08921029592839183  Primal_obj =  3.2629068996415778  Gap =  3.35211719556997 Sum =  0.9250851140474573
Iteration =  3  Dual obj =  -0.08308291372597987  Primal_obj =  1.841351939013591  Gap =  1.924434852739571 Sum =  0.9479637396111685
Iteration =  4  Dual obj =  -0.07940298906044546  Primal_obj =  1.1153944977868604  Gap =  1.194797486847306 Sum =  0.9821189917589048
Iteration =  5  Dual obj =  -0.07764242639613603  Primal_obj =  0.39541718105781176  Gap =  0.4730596074539478 Sum =  0.9895543618187244
Iteration =  6  Dual obj =  -0.07712342775482683  Primal_obj =  0.08649869115777956  Gap =  0.1636221189126064 Sum =  0.9924070580381809
Iteration =  7  Dual obj =  -0.0769737991768997  Primal_obj =  -0.029286667125030696  Gap =  0.047687132051869 Sum =  0.9954469767954746
Iteration =  8  Dual obj =  -0.07691210679212088  Primal_obj =  -0.05088311695302221  Gap =  0.026028989839098668 Sum =  0.9968486741872934
Iteration =  9  Dual obj =  -0.07687032728909624  Primal_obj =  -0.05730723572398441  Gap =  0.019563091565111823 Sum =  0.9983992007087075
Iteration =  10  Dual obj =  -0.07684201122483236  Primal_obj =  -0.06278743407306984  Gap =  0.014054577151762518 Sum =  0.9987164488115539
Iteration =  11  Dual obj =  -0.07682581599337068  Primal_obj =  -0.06604921728007934  Gap =  0.010776598713291341 Sum =  0.9990581029630834
Iteration =  12  Dual obj =  -0.07681462812438247  Primal_obj =  -0.06885406818184744  Gap =  0.007960559942535028 Sum =  0.9997827863703191
Iteration =  13  Dual obj =  -0.07680765818438251  Primal_obj =  -0.07105967090329145  Gap =  0.005747987281091063 Sum =  0.9997890110452596
Iteration =  14  Dual obj =  -0.0768033760109648  Primal_obj =  -0.07289352898712922  Gap =  0.00390984702383558 Sum =  0.9996947034745038
Iteration =  15  Dual obj =  -0.07680082669469951  Primal_obj =  -0.07404690783300533  Gap =  0.0027539188616941823 Sum =  0.9997339882105893
Iteration =  16  Dual obj =  -0.07679928198142028  Primal_obj =  -0.07476458187018589  Gap =  0.002034700111234383 Sum =  0.9998128152025461
Iteration =  17  Dual obj =  -0.07679835844111853  Primal_obj =  -0.07525263704618466  Gap =  0.0015457213949338633 Sum =  0.9998486851798594
Iteration =  18  Dual obj =  -0.076797678843299  Primal_obj =  -0.07560085584795366  Gap =  0.001196822995345334 Sum =  0.999866496347309
Iteration =  19  Dual obj =  -0.07679720101719945  Primal_obj =  -0.07586561800429631  Gap =  0.0009315830129031366 Sum =  0.9998718668038367
Iteration =  20  Dual obj =  -0.0767968285845429  Primal_obj =  -0.07606121101213606  Gap =  0.0007356175724068381 Sum =  0.999882000794858
Iteration =  21  Dual obj =  -0.07679656481172836  Primal_obj =  -0.07618377647693839  Gap =  0.0006127883347899765 Sum =  0.9998941200052223
Iteration =  22  Dual obj =  -0.07679635351804683  Primal_obj =  -0.07627545306419198  Gap =  0.0005209004538548473 Sum =  0.9999582974531251
Iteration =  23  Dual obj =  -0.07679617391462884  Primal_obj =  -0.07634557686938982  Gap =  0.0004505970452390179 Sum =  0.9999126770625832
Iteration =  24  Dual obj =  -0.07679603101989241  Primal_obj =  -0.07639995954866587  Gap =  0.00039607147122654174 Sum =  0.9999275138052214
Iteration =  0  Dual obj =  -34.96201564455944  Primal_obj =  15950.854428748156  Gap =  15985.816444392716 Sum =  417.43845291854336
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  inf
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.25952363174553406  Primal_obj =  65.47875437646421  Gap =  65.73827800820975 Sum =  4.596818809645379
Iteration =  4  Dual obj =  -0.11276334393753727  Primal_obj =  9.496755906361308  Gap =  9.609519250298845 Sum =  1.1741110462393247
Iteration =  5  Dual obj =  -0.09719266970698323  Primal_obj =  5.176335196775782  Gap =  5.273527866482765 Sum =  0.9564012148920091
Iteration =  6  Dual obj =  -0.08727997368453813  Primal_obj =  7.03057688166395  Gap =  7.117856855348488 Sum =  0.9621942935474779
Iteration =  7  Dual obj =  -0.07738352169944444  Primal_obj =  5.063604268219689  Gap =  5.140987789919134 Sum =  0.9243007087172908
Iteration =  8  Dual obj =  -0.0705244452297824  Primal_obj =  3.048932586422336  Gap =  3.119457031652119 Sum =  0.9324090615917984
Iteration =  9  Dual obj =  -0.06746666192998925  Primal_obj =  2.378423878155482  Gap =  2.445890540085471 Sum =  0.9401756922604534
Iteration =  10  Dual obj =  -0.06581279170982374  Primal_obj =  2.0623819093351576  Gap =  2.1281947010449813 Sum =  0.9369949623359936
Iteration =  11  Dual obj =  -0.06420324897996059  Primal_obj =  1.6085700015127395  Gap =  1.6727732504927002 Sum =  0.9469112985373032
Iteration =  12  Dual obj =  -0.06286888756668764  Primal_obj =  1.2120050855867974  Gap =  1.274873973153485 Sum =  0.953482418863826
Iteration =  13  Dual obj =  -0.06189627227868589  Primal_obj =  1.038774729558188  Gap =  1.100671001836874 Sum =  0.957586022360356
Iteration =  14  Dual obj =  -0.061159261562292254  Primal_obj =  0.7717110644057659  Gap =  0.8328703259680581 Sum =  0.9638266425221561
Iteration =  15  Dual obj =  -0.06053160653521086  Primal_obj =  0.5619527222300598  Gap =  0.6224843287652706 Sum =  0.9701558761267124
Iteration =  16  Dual obj =  -0.06006878662054181  Primal_obj =  0.46704375346589566  Gap =  0.5271125400864375 Sum =  0.9797425558296208
Iteration =  17  Dual obj =  -0.059695622895520835  Primal_obj =  0.2887413610667678  Gap =  0.3484369839622886 Sum =  0.9918522629311497
Iteration =  18  Dual obj =  -0.05946890147390581  Primal_obj =  0.15980960713781983  Gap =  0.21927850861172565 Sum =  1.0020191336459248
Iteration =  19  Dual obj =  -0.059286959937092897  Primal_obj =  0.06606137460602185  Gap =  0.12534833454311475 Sum =  1.0033265303443957
Iteration =  20  Dual obj =  -0.059181015643102006  Primal_obj =  0.021129184260917616  Gap =  0.08031019990401962 Sum =  1.0016225778471046
Iteration =  21  Dual obj =  -0.05910930706401304  Primal_obj =  -0.0015349537797525459  Gap =  0.05757435328426049 Sum =  1.0012174071199178
Iteration =  22  Dual obj =  -0.05906083812191881  Primal_obj =  -0.011295339592875181  Gap =  0.04776549852904363 Sum =  1.0009227843256125
Iteration =  23  Dual obj =  -0.059021693710975015  Primal_obj =  -0.019923200285777987  Gap =  0.03909849342519703 Sum =  1.000071005850624
Iteration =  24  Dual obj =  -0.058992647747648425  Primal_obj =  -0.025528229127293092  Gap =  0.03346441862035533 Sum =  0.9995392153325977
Iteration =  0  Dual obj =  -0.058992647747648425  Primal_obj =  -0.025528229127293092  Gap =  0.03346441862035533 Sum =  0.9995392153325977
Iteration =  1  Dual obj =  -0.05896796480363978  Primal_obj =  -0.03354198554717494  Gap =  0.025425979256464837 Sum =  0.9990482707255213
Iteration =  2  Dual obj =  -0.0589530786228929  Primal_obj =  -0.037950355841126174  Gap =  0.02100272278176673 Sum =  0.9992314928975876
Iteration =  3  Dual obj =  -0.058940345076565905  Primal_obj =  -0.040413071035055814  Gap =  0.01852727404151009 Sum =  0.9987671484401164
Iteration =  4  Dual obj =  -0.05892729786446836  Primal_obj =  -0.04313636196637474  Gap =  0.01579093589809362 Sum =  0.9993936840852322
Iteration =  5  Dual obj =  -0.05891373882675896  Primal_obj =  -0.04480119508463554  Gap =  0.014112543742123423 Sum =  0.9996435280795815
Iteration =  6  Dual obj =  -0.058901348270271804  Primal_obj =  -0.046921305661625404  Gap =  0.0119800426086464 Sum =  0.9996357341441922
Iteration =  7  Dual obj =  -0.058891449404598645  Primal_obj =  -0.04837585017570377  Gap =  0.010515599228894876 Sum =  0.9994523055975195
Iteration =  8  Dual obj =  -0.058884092647394935  Primal_obj =  -0.04978346051099994  Gap =  0.009100632136394997 Sum =  0.9997924674746506
Iteration =  9  Dual obj =  -0.05887845317427165  Primal_obj =  -0.05111052043059086  Gap =  0.007767932743680789 Sum =  0.9994203419402738
Iteration =  10  Dual obj =  -0.05887445268943315  Primal_obj =  -0.05210246859353264  Gap =  0.0067719840959005115 Sum =  0.999093806386239
Iteration =  11  Dual obj =  -0.058871198932928775  Primal_obj =  -0.05288016569946821  Gap =  0.005991033233460563 Sum =  0.9992206758878752
Iteration =  12  Dual obj =  -0.05886833995616493  Primal_obj =  -0.053536730697842524  Gap =  0.005331609258322406 Sum =  0.9994796498420973
Iteration =  13  Dual obj =  -0.05886580517575981  Primal_obj =  -0.05416082520556027  Gap =  0.004704979970199537 Sum =  0.9996291192961888
Iteration =  14  Dual obj =  -0.05886374320890006  Primal_obj =  -0.054605552924626516  Gap =  0.004258190284273544 Sum =  0.9997664565466955
Iteration =  15  Dual obj =  -0.05886196093872192  Primal_obj =  -0.05507165834999493  Gap =  0.003790302588726986 Sum =  0.9996845073211764
Iteration =  16  Dual obj =  -0.058860308628965144  Primal_obj =  -0.055473310171767584  Gap =  0.0033869984571975598 Sum =  0.9994803725913671
Iteration =  17  Dual obj =  -0.05885890794669006  Primal_obj =  -0.05572658332422635  Gap =  0.0031323246224637113 Sum =  0.9995553440225781
Iteration =  18  Dual obj =  -0.05885757717330879  Primal_obj =  -0.05589257848974177  Gap =  0.002964998683567019 Sum =  0.999443919547553
Iteration =  19  Dual obj =  -0.05885639763378584  Primal_obj =  -0.0562062438331781  Gap =  0.002650153800607742 Sum =  0.9996640530866949
Iteration =  20  Dual obj =  -0.05885546507110819  Primal_obj =  -0.05641264100818888  Gap =  0.002442824062919312 Sum =  0.9997939583196184
Iteration =  21  Dual obj =  -0.05885463315064515  Primal_obj =  -0.05665674115351653  Gap =  0.002197891997128623 Sum =  0.9998277167386542
Iteration =  22  Dual obj =  -0.0588539761482043  Primal_obj =  -0.05684090382858353  Gap =  0.002013072319620765 Sum =  0.9998064808006321
Iteration =  23  Dual obj =  -0.05885333571911637  Primal_obj =  -0.05706398643709497  Gap =  0.0017893492820214019 Sum =  0.9997705675886428
Iteration =  24  Dual obj =  -0.05885283432297437  Primal_obj =  -0.05722826118599536  Gap =  0.0016245731369790087 Sum =  0.9997510064187259
Iteration =  0  Dual obj =  -0.05885283432297437  Primal_obj =  -0.05722826118599536  Gap =  0.0016245731369790087 Sum =  0.9997510064187259
Iteration =  1  Dual obj =  -0.058852617230153864  Primal_obj =  -0.057321735224835274  Gap =  0.00153088200531859 Sum =  0.9997878539024508
Iteration =  2  Dual obj =  -0.05885242454561407  Primal_obj =  -0.057407811056825034  Gap =  0.0014446134887890344 Sum =  0.9997944725299474
Iteration =  3  Dual obj =  -0.05885224474004948  Primal_obj =  -0.057491458300936105  Gap =  0.0013607864391133734 Sum =  0.999890302069101
Iteration =  4  Dual obj =  -0.05885210561870214  Primal_obj =  -0.0575462630108394  Gap =  0.0013058426078627408 Sum =  0.9998448601858659
Iteration =  5  Dual obj =  -0.05885194300637801  Primal_obj =  -0.05760357704746666  Gap =  0.0012483659589113544 Sum =  0.9997076348247513
Iteration =  6  Dual obj =  -0.05885175667045932  Primal_obj =  -0.05766698431262626  Gap =  0.0011847723578330555 Sum =  0.999745690462748
Iteration =  7  Dual obj =  -0.05885155094345284  Primal_obj =  -0.057728606443093564  Gap =  0.0011229445003592756 Sum =  0.9998436103596883
Iteration =  8  Dual obj =  -0.05885136519448016  Primal_obj =  -0.05776872496770209  Gap =  0.0010826402267780644 Sum =  0.9998038002890374
Iteration =  9  Dual obj =  -0.05885117370135143  Primal_obj =  -0.05780630878208451  Gap =  0.001044864919266919 Sum =  0.9998964966922653
Iteration =  10  Dual obj =  -0.05885099571343471  Primal_obj =  -0.05783709001033811  Gap =  0.0010139057030965973 Sum =  0.9999547291747383
Iteration =  11  Dual obj =  -0.05885077101933  Primal_obj =  -0.05787337438742167  Gap =  0.0009773966319083296 Sum =  0.9998560648790962
Iteration =  12  Dual obj =  -0.058850574153831575  Primal_obj =  -0.05790669641505625  Gap =  0.0009438777387753283 Sum =  0.9998500567537656
Iteration =  13  Dual obj =  -0.058850372597094074  Primal_obj =  -0.05795050204741199  Gap =  0.0008998705496820816 Sum =  0.9997905919882827
Iteration =  14  Dual obj =  -0.05885012832504542  Primal_obj =  -0.057994038868707715  Gap =  0.0008560894563377081 Sum =  0.9998385322462967
Iteration =  15  Dual obj =  -0.05884992226602561  Primal_obj =  -0.05804140564452173  Gap =  0.0008085166215038783 Sum =  0.9999428046839958
Iteration =  16  Dual obj =  -0.05884969678359228  Primal_obj =  -0.05808404030195051  Gap =  0.0007656564816417716 Sum =  0.9999739792103117
Iteration =  17  Dual obj =  -0.058849470613885076  Primal_obj =  -0.058126678416033986  Gap =  0.0007227921978510896 Sum =  0.9999071748496445
Iteration =  18  Dual obj =  -0.05884929038254258  Primal_obj =  -0.05815928001678451  Gap =  0.0006900103657580675 Sum =  0.9999910678386813
Iteration =  19  Dual obj =  -0.058849095053150655  Primal_obj =  -0.05820442515619975  Gap =  0.0006446698969509029 Sum =  0.9999567389527337
Iteration =  20  Dual obj =  -0.05884893670534002  Primal_obj =  -0.058248429698472645  Gap =  0.0006005070068673748 Sum =  0.9999316533223146
Iteration =  21  Dual obj =  -0.058848783128824314  Primal_obj =  -0.05828831294341552  Gap =  0.0005604701854087929 Sum =  0.9998427100423846
Iteration =  22  Dual obj =  -0.05884877057728593  Primal_obj =  -0.058291378437486385  Gap =  0.0005573921397995438 Sum =  0.9998532082446011
Iteration =  23  Dual obj =  -0.058848655221803714  Primal_obj =  -0.058325896321031134  Gap =  0.0005227589007725797 Sum =  0.9999259336629192
Iteration =  24  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  0  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  1  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  2  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  3  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  4  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  5  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  6  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  7  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  8  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  9  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  10  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  11  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  12  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  13  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  14  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  15  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  16  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  17  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  18  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  19  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  20  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  21  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  22  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  23  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Iteration =  24  Dual obj =  -0.05884855227919744  Primal_obj =  -0.05835885420810277  Gap =  0.0004896980710946686 Sum =  0.9999516620229185
Done, writing results...
