2021-04-27 21:52:19,699 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.29s.
2021-04-27 21:52:20,153 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.23s.
2021-04-27 21:52:20,579 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.43s.
2021-04-27 21:52:20,702 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-27 21:52:20,705 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 21:52:20,716 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 21:52:21,565 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 112.
2021-04-27 21:52:21,567 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.86s.
Iteration =  0  Dual obj =  -56.10391941106461  Primal_obj =  38363.603153881595  Gap =  38419.70707329266 Sum =  378.9737155475468
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.13760265129456406  Primal_obj =  10.331993281597837  Gap =  10.469595932892402 Sum =  0.5315093276743423
Iteration =  3  Dual obj =  -0.02830219893707364  Primal_obj =  7.476730890046965  Gap =  7.505033088984039 Sum =  0.8164523543730028
Iteration =  4  Dual obj =  -0.011759154977437635  Primal_obj =  2.77000755648803  Gap =  2.7817667114654676 Sum =  0.8483818099177214
Iteration =  5  Dual obj =  -0.0063367310000214915  Primal_obj =  1.5263209109337652  Gap =  1.5326576419337867 Sum =  0.9733161775076955
Iteration =  6  Dual obj =  -0.0038118203905936603  Primal_obj =  0.5699112438924347  Gap =  0.5737230642830284 Sum =  1.0196773081932204
Iteration =  7  Dual obj =  -0.003033273862028421  Primal_obj =  0.23001095828871815  Gap =  0.23304423215074657 Sum =  0.9981887005089823
Iteration =  8  Dual obj =  -0.0027558841983556645  Primal_obj =  0.12612401307801852  Gap =  0.12887989727637417 Sum =  0.9928459862884627
Iteration =  9  Dual obj =  -0.0026325538333138586  Primal_obj =  0.06105279400224471  Gap =  0.06368534783555857 Sum =  1.0016932292646188
Iteration =  10  Dual obj =  -0.002590508005131866  Primal_obj =  0.03256337847304358  Gap =  0.035153886478175446 Sum =  1.0005138509200096
Iteration =  11  Dual obj =  -0.002572311349503056  Primal_obj =  0.021233664557530146  Gap =  0.023805975907033202 Sum =  0.9979575796052689
Iteration =  12  Dual obj =  -0.0025609960181768128  Primal_obj =  0.014394428919080896  Gap =  0.01695542493725771 Sum =  0.9993818476766407
Iteration =  13  Dual obj =  -0.0025520881855725075  Primal_obj =  0.008480324275917564  Gap =  0.011032412461490072 Sum =  1.0003400968557175
Iteration =  14  Dual obj =  -0.0025468175276829015  Primal_obj =  0.004735890442919027  Gap =  0.007282707970601929 Sum =  0.9992366946018976
Iteration =  15  Dual obj =  -0.0025438390571358533  Primal_obj =  0.002209300614475676  Gap =  0.004753139671611529 Sum =  0.999377799019139
Iteration =  16  Dual obj =  -0.002542213296113623  Primal_obj =  0.00020054916959162672  Gap =  0.0027427624657052497 Sum =  1.0002760028300848
Iteration =  17  Dual obj =  -0.002541304913402224  Primal_obj =  -0.0008522605210158768  Gap =  0.0016890443923863472 Sum =  0.9998437606427145
Iteration =  18  Dual obj =  -0.0025407082348330905  Primal_obj =  -0.0014053516915231296  Gap =  0.001135356543309961 Sum =  0.9996982767343077
Iteration =  19  Dual obj =  -0.002540294670538988  Primal_obj =  -0.001721854461709263  Gap =  0.0008184402088297249 Sum =  0.9999169720095393
Iteration =  20  Dual obj =  -0.0025399875529515427  Primal_obj =  -0.0019294292709133715  Gap =  0.0006105582820381712 Sum =  1.0000330708216336
Iteration =  21  Dual obj =  -0.002539754751920514  Primal_obj =  -0.0020706647350079155  Gap =  0.0004690900169125986 Sum =  0.9998102932122117
Iteration =  22  Dual obj =  -0.002539568854860533  Primal_obj =  -0.002164781357657547  Gap =  0.00037478749720298594 Sum =  0.999870249668888
Iteration =  23  Dual obj =  -0.00253942073700248  Primal_obj =  -0.002235291416065932  Gap =  0.00030412932093654794 Sum =  1.000016662421078
Iteration =  24  Dual obj =  -0.0025393034251929105  Primal_obj =  -0.0022853128106126996  Gap =  0.0002539906145802109 Sum =  0.9998928978748802
Iteration =  0  Dual obj =  -64.78237420064076  Primal_obj =  47333.1549362258  Gap =  47397.937310426445 Sum =  378.9737155475468
Iteration =  1  Dual obj =  -0.16372733397610384  Primal_obj =  27.156643557477963  Gap =  27.32037089145407 Sum =  1.0904957186684792
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  5  Dual obj =  -0.11639964710100628  Primal_obj =  18.340199142100758  Gap =  18.456598789201763 Sum =  0.7147002604673551
Iteration =  6  Dual obj =  -0.09698778879063155  Primal_obj =  24.06738166350874  Gap =  24.164369452299372 Sum =  1.048235809108741
Iteration =  7  Dual obj =  -0.08920626663184263  Primal_obj =  31.185686233506317  Gap =  31.274892500138158 Sum =  0.8702971411801953
Iteration =  8  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.062500
Iteration =  9  Dual obj =  -0.06697202152386526  Primal_obj =  14.340070146669898  Gap =  14.407042168193763 Sum =  0.7916819301281588
Iteration =  10  Dual obj =  -0.06068663635665924  Primal_obj =  15.446408768299136  Gap =  15.507095404655795 Sum =  0.8490416699320922
Iteration =  11  Dual obj =  -0.03705778938943358  Primal_obj =  12.19989599510901  Gap =  12.236953784498443 Sum =  0.7428460048814818
Iteration =  12  Dual obj =  -0.029064055307931363  Primal_obj =  10.518870756953842  Gap =  10.547934812261772 Sum =  0.8328283562162289
Iteration =  13  Dual obj =  -0.02437206657793949  Primal_obj =  13.718710321840417  Gap =  13.743082388418356 Sum =  0.9505454881164446
Iteration =  14  Dual obj =  -0.020049203668198734  Primal_obj =  9.788430326335343  Gap =  9.808479530003542 Sum =  0.7860660837916846
Iteration =  15  Dual obj =  -0.016196635811474874  Primal_obj =  7.6951283482590345  Gap =  7.711324984070509 Sum =  0.8094721302504964
Iteration =  16  Dual obj =  -0.013802719186147915  Primal_obj =  7.819731993615887  Gap =  7.833534712802035 Sum =  0.8681516647739747
Iteration =  17  Dual obj =  -0.01025046836926262  Primal_obj =  6.765792428409517  Gap =  6.77604289677878 Sum =  0.7720261663503714
Iteration =  18  Dual obj =  -0.00861927955113577  Primal_obj =  6.254678316598274  Gap =  6.2632975961494095 Sum =  0.7734078600058509
Iteration =  19  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.031250
Iteration =  20  Dual obj =  -0.007557865625514873  Primal_obj =  5.484468467514907  Gap =  5.492026333140422 Sum =  0.8241294394097066
Iteration =  21  Dual obj =  -0.005619704108744947  Primal_obj =  5.142790683986086  Gap =  5.148410388094831 Sum =  0.8266422103000015
Iteration =  22  Dual obj =  -0.004858350584446586  Primal_obj =  4.661498009272876  Gap =  4.666356359857322 Sum =  0.8002825423072748
Iteration =  23  Dual obj =  -0.0044290412572478705  Primal_obj =  4.618882890665675  Gap =  4.623311931922923 Sum =  0.790491861375409
Iteration =  24  Dual obj =  -0.004038870124436461  Primal_obj =  4.708444350365563  Gap =  4.712483220489999 Sum =  0.7959468864008292
Iteration =  0  Dual obj =  -0.004038870124436461  Primal_obj =  4.708444350365563  Gap =  4.712483220489999 Sum =  0.7959468864008292
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.0022392059422481486  Primal_obj =  4.02371550091822  Gap =  4.025954706860468 Sum =  0.8247804756385588
Iteration =  3  Dual obj =  -0.00014568984487690895  Primal_obj =  4.102895914007933  Gap =  4.10304160385281 Sum =  0.8308056441563079
Iteration =  4  Dual obj =  0.003639153179256352  Primal_obj =  3.5444032986942524  Gap =  3.540764145514996 Sum =  0.8555585572974571
Iteration =  5  Dual obj =  0.005261786492642417  Primal_obj =  2.678943309156729  Gap =  2.6736815226640864 Sum =  0.8567192661764119
Iteration =  6  Dual obj =  0.006654110367902283  Primal_obj =  2.1353187939285623  Gap =  2.12866468356066 Sum =  0.875002064587922
Iteration =  7  Dual obj =  0.007812876441088922  Primal_obj =  2.016423167704444  Gap =  2.008610291263355 Sum =  0.889008959492566
Iteration =  8  Dual obj =  0.008683004581873231  Primal_obj =  1.7793595487313425  Gap =  1.7706765441494692 Sum =  0.9038864859453009
Iteration =  9  Dual obj =  0.009511477699358103  Primal_obj =  1.4677524496508516  Gap =  1.4582409719514935 Sum =  0.9146209700295556
Iteration =  10  Dual obj =  0.010014106518809594  Primal_obj =  1.2881158837943365  Gap =  1.278101777275527 Sum =  0.9182671645574279
Iteration =  11  Dual obj =  0.01059395701782027  Primal_obj =  1.1254649733877098  Gap =  1.1148710163698896 Sum =  0.9246008106916793
Iteration =  12  Dual obj =  0.011224296322041125  Primal_obj =  0.9379398848130274  Gap =  0.9267155884909862 Sum =  0.9468892272336719
Iteration =  13  Dual obj =  0.011650798491537242  Primal_obj =  0.8650374556906473  Gap =  0.85338665719911 Sum =  0.9685536728146431
Iteration =  14  Dual obj =  0.01198013445167769  Primal_obj =  0.7551599711991126  Gap =  0.7431798367474349 Sum =  0.9789925860000337
Iteration =  15  Dual obj =  0.012253541907332613  Primal_obj =  0.6584098118821107  Gap =  0.646156269974778 Sum =  0.9733999379918283
Iteration =  16  Dual obj =  0.012488278613035546  Primal_obj =  0.5617376139043162  Gap =  0.5492493352912806 Sum =  0.9835046541443613
Iteration =  17  Dual obj =  0.01272970688637812  Primal_obj =  0.48593964694770003  Gap =  0.4732099400613219 Sum =  1.0047461425556707
Iteration =  18  Dual obj =  0.01290507350076249  Primal_obj =  0.3908681321269511  Gap =  0.3779630586261886 Sum =  1.003982362623597
Iteration =  19  Dual obj =  0.013014256018445518  Primal_obj =  0.30840304474076974  Gap =  0.2953887887223242 Sum =  1.0041722561052908
Iteration =  20  Dual obj =  0.013109728561878142  Primal_obj =  0.24220100177122555  Gap =  0.2290912732093474 Sum =  1.0020114318364342
Iteration =  21  Dual obj =  0.013166938467223069  Primal_obj =  0.19109384057417148  Gap =  0.1779269021069484 Sum =  0.9942535140242557
Iteration =  22  Dual obj =  0.013211574044657153  Primal_obj =  0.1601344193280996  Gap =  0.14692284528344246 Sum =  0.9936918005714401
Iteration =  23  Dual obj =  0.013239480977162241  Primal_obj =  0.1450129472415928  Gap =  0.13177346626443057 Sum =  0.9946577940332597
Iteration =  24  Dual obj =  0.013265293454325533  Primal_obj =  0.13497262236217314  Gap =  0.1217073289078476 Sum =  0.9981818706416532
Iteration =  0  Dual obj =  0.013265293454325533  Primal_obj =  0.13497262236217314  Gap =  0.1217073289078476 Sum =  0.9981818706416532
Iteration =  1  Dual obj =  0.013280520632419898  Primal_obj =  0.11590313592870592  Gap =  0.10262261529628602 Sum =  0.9954216939728102
Iteration =  2  Dual obj =  0.013291456651565794  Primal_obj =  0.10386344314814461  Gap =  0.09057198649657881 Sum =  0.9955328389129231
Iteration =  3  Dual obj =  0.013300719138330249  Primal_obj =  0.09893813779129393  Gap =  0.08563741865296368 Sum =  0.9972857895445038
Iteration =  4  Dual obj =  0.01331109413062272  Primal_obj =  0.09305659866540374  Gap =  0.07974550453478102 Sum =  0.9981417250592955
Iteration =  5  Dual obj =  0.013323661160583294  Primal_obj =  0.08729217111572661  Gap =  0.07396850995514331 Sum =  0.9986227548275198
Iteration =  6  Dual obj =  0.013334113663479391  Primal_obj =  0.08575421550797353  Gap =  0.07242010184449414 Sum =  1.0017529896509099
Iteration =  7  Dual obj =  0.013348201064363196  Primal_obj =  0.07668217158897966  Gap =  0.06333397052461646 Sum =  1.0026613429125466
Iteration =  8  Dual obj =  0.013358228809806711  Primal_obj =  0.06871288062544748  Gap =  0.05535465181564077 Sum =  1.0021582801150126
Iteration =  9  Dual obj =  0.013366410726415302  Primal_obj =  0.06599963501710102  Gap =  0.05263322429068572 Sum =  1.002178803231806
Iteration =  10  Dual obj =  0.01337540203213063  Primal_obj =  0.05757617695899496  Gap =  0.044200774926864334 Sum =  1.0010174629559847
Iteration =  11  Dual obj =  0.01338239024390702  Primal_obj =  0.05229854118839347  Gap =  0.03891615094448645 Sum =  1.0008053405029727
Iteration =  12  Dual obj =  0.013387829808488533  Primal_obj =  0.04543800573954415  Gap =  0.03205017593105562 Sum =  0.9996218042838069
Iteration =  13  Dual obj =  0.01339271783062703  Primal_obj =  0.04207630078718326  Gap =  0.02868358295655623 Sum =  0.9999705122862084
Iteration =  14  Dual obj =  0.013397163478875082  Primal_obj =  0.03930113958394141  Gap =  0.025903976105066326 Sum =  1.0009455000395826
Iteration =  15  Dual obj =  0.013400596733264318  Primal_obj =  0.03592727782851522  Gap =  0.022526681095250904 Sum =  0.999951459743301
Iteration =  16  Dual obj =  0.0134036935857344  Primal_obj =  0.03315926302206315  Gap =  0.01975556943632875 Sum =  0.9990639401662622
Iteration =  17  Dual obj =  0.013406804848801333  Primal_obj =  0.03149856619875899  Gap =  0.018091761349957654 Sum =  0.9998734962258511
Iteration =  18  Dual obj =  0.013409286839362742  Primal_obj =  0.03014404564693139  Gap =  0.01673475880756865 Sum =  0.999864295416278
Iteration =  19  Dual obj =  0.013412670039564437  Primal_obj =  0.029331778372273437  Gap =  0.015919108332709 Sum =  0.9998415476452681
Iteration =  20  Dual obj =  0.013415407824508365  Primal_obj =  0.028378385845396772  Gap =  0.014962978020888407 Sum =  0.999854945177357
Iteration =  21  Dual obj =  0.01341805149846207  Primal_obj =  0.02800542969600224  Gap =  0.01458737819754017 Sum =  0.9998174953169703
Iteration =  22  Dual obj =  0.013419816170215173  Primal_obj =  0.029057537717774223  Gap =  0.01563772154755905 Sum =  1.0002167306474266
Iteration =  23  Dual obj =  0.013421800323020438  Primal_obj =  0.0271294725984203  Gap =  0.013707672275399863 Sum =  0.9998748165333758
Iteration =  24  Dual obj =  0.013423452951569756  Primal_obj =  0.027527151277159642  Gap =  0.014103698325589886 Sum =  0.9999022957733341
Iteration =  0  Dual obj =  0.013423452951569756  Primal_obj =  0.027527151277159642  Gap =  0.014103698325589886 Sum =  0.9999022957733341
Iteration =  1  Dual obj =  0.013424269821284057  Primal_obj =  0.02644355952264249  Gap =  0.013019289701358433 Sum =  1.0000772798149984
Iteration =  2  Dual obj =  0.013425129166797053  Primal_obj =  0.02513034460000571  Gap =  0.011705215433208658 Sum =  1.0002791032109521
Iteration =  3  Dual obj =  0.013425852314955626  Primal_obj =  0.023983779609411518  Gap =  0.010557927294455892 Sum =  0.9997389263330949
Iteration =  4  Dual obj =  0.01342652534614859  Primal_obj =  0.022836116377986576  Gap =  0.009409591031837986 Sum =  0.9995323325977763
Iteration =  5  Dual obj =  0.013427262635485271  Primal_obj =  0.02197370734664203  Gap =  0.008546444711156759 Sum =  0.9999030132719453
Iteration =  6  Dual obj =  0.013428045490678223  Primal_obj =  0.021182003937473687  Gap =  0.0077539584467954635 Sum =  1.0000222223224435
Iteration =  7  Dual obj =  0.013428863340081205  Primal_obj =  0.020778239723660136  Gap =  0.00734937638357893 Sum =  0.999510693347542
Iteration =  8  Dual obj =  0.01342949206253077  Primal_obj =  0.0203269402509271  Gap =  0.00689744818839633 Sum =  0.9997445963777725
Iteration =  9  Dual obj =  0.013429979210035258  Primal_obj =  0.02008091986610548  Gap =  0.0066509406560702235 Sum =  0.9999680397656067
Iteration =  10  Dual obj =  0.013430385688642597  Primal_obj =  0.019974560944540767  Gap =  0.00654417525589817 Sum =  1.0000201736387968
Iteration =  11  Dual obj =  0.013430834201356379  Primal_obj =  0.019958946306347647  Gap =  0.006528112104991268 Sum =  1.0001999008646982
Iteration =  12  Dual obj =  0.01343142307940988  Primal_obj =  0.020159356419162763  Gap =  0.006727933339752884 Sum =  1.0001097699023798
Iteration =  13  Dual obj =  0.013432191784849234  Primal_obj =  0.020933678921428542  Gap =  0.007501487136579308 Sum =  1.0003046178103072
Iteration =  14  Dual obj =  0.013433164954613473  Primal_obj =  0.02108877340050784  Gap =  0.007655608445894368 Sum =  1.0003210117083607
Iteration =  15  Dual obj =  0.013433890125683082  Primal_obj =  0.02112410115187452  Gap =  0.007690211026191437 Sum =  1.000419527538563
Iteration =  16  Dual obj =  0.013434763995529394  Primal_obj =  0.021730933416518536  Gap =  0.008296169420989142 Sum =  1.0004387842154585
Iteration =  17  Dual obj =  0.01343554612835951  Primal_obj =  0.021789209318032146  Gap =  0.008353663189672636 Sum =  1.000391137828467
Iteration =  18  Dual obj =  0.013436060913276805  Primal_obj =  0.022089210850214674  Gap =  0.00865314993693787 Sum =  1.0006788170830538
Iteration =  19  Dual obj =  0.013436691019207112  Primal_obj =  0.022383441597921647  Gap =  0.008946750578714534 Sum =  1.000735646109181
Iteration =  20  Dual obj =  0.013437402491617654  Primal_obj =  0.02215312553913161  Gap =  0.008715723047513956 Sum =  1.000638730437074
Iteration =  21  Dual obj =  0.013438099554341425  Primal_obj =  0.022354354636314633  Gap =  0.008916255081973207 Sum =  1.0003640474348376
Iteration =  22  Dual obj =  0.01343860593233067  Primal_obj =  0.021636623643782577  Gap =  0.008198017711451906 Sum =  1.0004130569056915
Iteration =  23  Dual obj =  0.013439129146670302  Primal_obj =  0.02118189864858741  Gap =  0.007742769501917109 Sum =  1.0002271121671973
Iteration =  24  Dual obj =  0.013439741257329607  Primal_obj =  0.02080709199728556  Gap =  0.007367350739955952 Sum =  1.0000705891108246
Done, writing results...
