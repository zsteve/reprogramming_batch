2021-04-27 21:44:50,590 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.29s.
2021-04-27 21:44:51,052 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-27 21:44:51,458 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.41s.
2021-04-27 21:44:51,581 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-27 21:44:51,584 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 21:44:51,596 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 21:44:52,442 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 105.
2021-04-27 21:44:52,444 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.86s.
Iteration =  0  Dual obj =  -36.72383828691237  Primal_obj =  38099.258136021526  Gap =  38135.98197430844 Sum =  391.48079351668906
Iteration =  1  Dual obj =  -0.05919083314441051  Primal_obj =  26.48002437036202  Gap =  26.53921520350643 Sum =  1.0637736987884392
Iteration =  2  Dual obj =  -0.017844230894586297  Primal_obj =  9.744809383255829  Gap =  9.762653614150414 Sum =  0.8303720678524626
Iteration =  3  Dual obj =  -0.00445338296020302  Primal_obj =  4.648521423680431  Gap =  4.652974806640634 Sum =  0.8174209905348797
Iteration =  4  Dual obj =  0.0015018882402001513  Primal_obj =  2.7108425965375385  Gap =  2.709340708297338 Sum =  0.8842925461043316
Iteration =  5  Dual obj =  0.005036189067603194  Primal_obj =  1.3536927069419573  Gap =  1.3486565178743541 Sum =  0.991605999611658
Iteration =  6  Dual obj =  0.0062155113578994965  Primal_obj =  0.6968414367833384  Gap =  0.6906259254254389 Sum =  1.0024888800084137
Iteration =  7  Dual obj =  0.006669856536828889  Primal_obj =  0.42027202445995593  Gap =  0.41360216792312704 Sum =  0.9941713352833147
Iteration =  8  Dual obj =  0.0069483442931020135  Primal_obj =  0.2875957132373134  Gap =  0.2806473689442114 Sum =  0.9955733086487744
Iteration =  9  Dual obj =  0.0070921306099858035  Primal_obj =  0.13169903378372896  Gap =  0.12460690317374316 Sum =  1.0012126649137478
Iteration =  10  Dual obj =  0.0071499403361548995  Primal_obj =  0.0749665087592275  Gap =  0.0678165684230726 Sum =  0.9999918090062422
Iteration =  11  Dual obj =  0.007177333991206854  Primal_obj =  0.04589063897240095  Gap =  0.038713304981194095 Sum =  0.9974773504062259
Iteration =  12  Dual obj =  0.007190265221243275  Primal_obj =  0.03008428397448465  Gap =  0.022894018753241374 Sum =  1.000204009124374
Iteration =  13  Dual obj =  0.007196341994315528  Primal_obj =  0.020981292263084136  Gap =  0.013784950268768609 Sum =  1.0002714199876186
Iteration =  14  Dual obj =  0.007199695416689741  Primal_obj =  0.01680516865107355  Gap =  0.00960547323438381 Sum =  0.9992600775600012
Iteration =  15  Dual obj =  0.007202126673604925  Primal_obj =  0.013864829238120435  Gap =  0.00666270256451551 Sum =  0.9992574680904391
Iteration =  16  Dual obj =  0.007203988429622454  Primal_obj =  0.012072799216762672  Gap =  0.004868810787140219 Sum =  1.0001036053997483
Iteration =  17  Dual obj =  0.007205311053077087  Primal_obj =  0.010949235730360982  Gap =  0.003743924677283895 Sum =  0.9998093880790357
Iteration =  18  Dual obj =  0.0072062808276996335  Primal_obj =  0.010187004420950704  Gap =  0.002980723593251071 Sum =  0.9994782443963169
Iteration =  19  Dual obj =  0.007207066500547213  Primal_obj =  0.009618086735991863  Gap =  0.0024110202354446497 Sum =  1.0000476274229233
Iteration =  20  Dual obj =  0.007207614625250519  Primal_obj =  0.009147371905333823  Gap =  0.001939757280083304 Sum =  1.000050349402561
Iteration =  21  Dual obj =  0.007208025182319517  Primal_obj =  0.008720176216357345  Gap =  0.0015121510340378279 Sum =  0.9998460556602692
Iteration =  22  Dual obj =  0.007208332156517495  Primal_obj =  0.008389762639628831  Gap =  0.0011814304831113363 Sum =  0.9999256902101237
Iteration =  23  Dual obj =  0.007208562866095981  Primal_obj =  0.008147163092508666  Gap =  0.000938600226412685 Sum =  1.0000058429621916
Iteration =  24  Dual obj =  0.007208754338301659  Primal_obj =  0.007957381339847094  Gap =  0.0007486270015454356 Sum =  0.9999189084993703
Iteration =  0  Dual obj =  -28.336028602336928  Primal_obj =  31753.76752254425  Gap =  31782.10355114659 Sum =  391.48079351668906
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.07728567798664962  Primal_obj =  20.60020859960644  Gap =  20.677494277593087 Sum =  0.5494403273579981
Iteration =  3  Dual obj =  -0.01682030518871042  Primal_obj =  14.309307102255898  Gap =  14.32612740744461 Sum =  0.8188191078629079
Iteration =  4  Dual obj =  0.006647578425213248  Primal_obj =  11.031302826484824  Gap =  11.024655248059611 Sum =  0.8816460634636039
Iteration =  5  Dual obj =  0.01813372026808116  Primal_obj =  5.119944039869796  Gap =  5.101810319601714 Sum =  0.8342378640201501
Iteration =  6  Dual obj =  0.022435285320187404  Primal_obj =  3.2514100870851204  Gap =  3.228974801764933 Sum =  0.8472067173017542
Iteration =  7  Dual obj =  0.024764859757094106  Primal_obj =  2.6194263888340217  Gap =  2.5946615290769275 Sum =  0.8678745269513795
Iteration =  8  Dual obj =  0.026286166446044788  Primal_obj =  2.0871722189666135  Gap =  2.060886052520569 Sum =  0.9161679289319283
Iteration =  9  Dual obj =  0.027430108998848374  Primal_obj =  1.7458492071314444  Gap =  1.718419098132596 Sum =  0.9717717697156159
Iteration =  10  Dual obj =  0.02822116804645331  Primal_obj =  1.2445731488103322  Gap =  1.216351980763879 Sum =  0.9824015208519647
Iteration =  11  Dual obj =  0.028737347882295736  Primal_obj =  1.0104964764336373  Gap =  0.9817591285513415 Sum =  0.9848899352828863
Iteration =  12  Dual obj =  0.029075067110553927  Primal_obj =  0.8256946357168866  Gap =  0.7966195686063327 Sum =  0.9797479981974269
Iteration =  13  Dual obj =  0.029266998671409555  Primal_obj =  0.7651347689582892  Gap =  0.7358677702868797 Sum =  0.9748339663069632
Iteration =  14  Dual obj =  0.029459038969878754  Primal_obj =  0.728286820017078  Gap =  0.6988277810471992 Sum =  0.9773442102662457
Iteration =  15  Dual obj =  0.029641350652834  Primal_obj =  0.6665958092808886  Gap =  0.6369544586280546 Sum =  0.9898775618918507
Iteration =  16  Dual obj =  0.029758647346003548  Primal_obj =  0.5842181096394575  Gap =  0.554459462293454 Sum =  0.9986850161638887
Iteration =  17  Dual obj =  0.02986850325081253  Primal_obj =  0.5220874218578454  Gap =  0.4922189186070329 Sum =  1.0129636595322076
Iteration =  18  Dual obj =  0.029951149733486164  Primal_obj =  0.48896987548213267  Gap =  0.4590187257486465 Sum =  1.0126840952021632
Iteration =  19  Dual obj =  0.030003052953303286  Primal_obj =  0.33956201196444663  Gap =  0.30955895901114333 Sum =  1.0094237272228996
Iteration =  20  Dual obj =  0.030041324729504694  Primal_obj =  0.2794820248649937  Gap =  0.249440700135489 Sum =  1.007918343316218
Iteration =  21  Dual obj =  0.030075000514793643  Primal_obj =  0.25064493745729416  Gap =  0.22056993694250052 Sum =  1.0038746759146822
Iteration =  22  Dual obj =  0.030099682204542795  Primal_obj =  0.23680740492588906  Gap =  0.20670772272134627 Sum =  0.9964348844182909
Iteration =  23  Dual obj =  0.030121842026809946  Primal_obj =  0.21866530433299014  Gap =  0.1885434623061802 Sum =  0.9980266803834854
Iteration =  24  Dual obj =  0.030143796719912158  Primal_obj =  0.20040598442737495  Gap =  0.1702621877074628 Sum =  0.9958523922873291
Iteration =  0  Dual obj =  0.030143796719912158  Primal_obj =  0.20040598442737495  Gap =  0.1702621877074628 Sum =  0.9958523922873291
Iteration =  1  Dual obj =  0.03015558979031533  Primal_obj =  0.1605016365572635  Gap =  0.13034604676694816 Sum =  0.9955811878381017
Iteration =  2  Dual obj =  0.03016483115044885  Primal_obj =  0.13864204596862423  Gap =  0.10847721481817538 Sum =  0.996665554911652
Iteration =  3  Dual obj =  0.030174151078330772  Primal_obj =  0.12840593383869156  Gap =  0.09823178276036079 Sum =  0.998945850201845
Iteration =  4  Dual obj =  0.0301818743340058  Primal_obj =  0.1182661190097681  Gap =  0.08808424467576231 Sum =  1.0009853300092006
Iteration =  5  Dual obj =  0.030190433620638585  Primal_obj =  0.11497677083598783  Gap =  0.08478633721534924 Sum =  1.0029168863695206
Iteration =  6  Dual obj =  0.030198303614903336  Primal_obj =  0.11645596734788487  Gap =  0.08625766373298153 Sum =  1.0040415204539168
Iteration =  7  Dual obj =  0.030207634654779342  Primal_obj =  0.1128342732228223  Gap =  0.08262663856804296 Sum =  1.0008529567863684
Iteration =  8  Dual obj =  0.0302159189641243  Primal_obj =  0.09839127473833273  Gap =  0.06817535577420843 Sum =  0.9986697166305368
Iteration =  9  Dual obj =  0.030222957611391377  Primal_obj =  0.09558672982279587  Gap =  0.06536377221140449 Sum =  0.9973105565657419
Iteration =  10  Dual obj =  0.030229459200389337  Primal_obj =  0.0906393332736605  Gap =  0.06040987407327116 Sum =  0.9978577469238343
Iteration =  11  Dual obj =  0.030235747563873774  Primal_obj =  0.08296809275858123  Gap =  0.05273234519470746 Sum =  0.9986209530480952
Iteration =  12  Dual obj =  0.030241196309992627  Primal_obj =  0.07996571361313334  Gap =  0.04972451730314072 Sum =  1.0000726401106947
Iteration =  13  Dual obj =  0.030246527819631466  Primal_obj =  0.07522993184420507  Gap =  0.0449834040245736 Sum =  1.0004979496847322
Iteration =  14  Dual obj =  0.03025095125043524  Primal_obj =  0.0674083147922847  Gap =  0.03715736354184945 Sum =  1.0005857019311792
Iteration =  15  Dual obj =  0.03025466660253949  Primal_obj =  0.059658653799357336  Gap =  0.029403987196817846 Sum =  0.9989011837563602
Iteration =  16  Dual obj =  0.030257812389405708  Primal_obj =  0.053568612395961696  Gap =  0.023310800006555988 Sum =  0.997846872673236
Iteration =  17  Dual obj =  0.030260435253254624  Primal_obj =  0.05046023247174042  Gap =  0.020199797218485794 Sum =  0.9979655998583612
Iteration =  18  Dual obj =  0.030262375246822647  Primal_obj =  0.047465022397461934  Gap =  0.017202647150639287 Sum =  0.9989650607036358
Iteration =  19  Dual obj =  0.03026385796130452  Primal_obj =  0.04518702367872868  Gap =  0.014923165717424157 Sum =  0.9995376635533663
Iteration =  20  Dual obj =  0.030265447238270887  Primal_obj =  0.04274815976487821  Gap =  0.012482712526607324 Sum =  1.0010103539136357
Iteration =  21  Dual obj =  0.03026650516129466  Primal_obj =  0.041475468652244676  Gap =  0.011208963490950016 Sum =  1.0016130283439293
Iteration =  22  Dual obj =  0.0302675060629773  Primal_obj =  0.04029859208950211  Gap =  0.010031086026524808 Sum =  1.0012143773645878
Iteration =  23  Dual obj =  0.03026864275553975  Primal_obj =  0.038993824801158  Gap =  0.008725182045618247 Sum =  1.0001976496696456
Iteration =  24  Dual obj =  0.030269511701052413  Primal_obj =  0.03812715637788788  Gap =  0.00785764467683547 Sum =  0.9997264745557845
Iteration =  0  Dual obj =  0.030269511701052413  Primal_obj =  0.03812715637788788  Gap =  0.00785764467683547 Sum =  0.9997264745557845
Iteration =  1  Dual obj =  0.030269884427716852  Primal_obj =  0.03765743641343522  Gap =  0.007387551985718367 Sum =  0.9997771994773197
Iteration =  2  Dual obj =  0.030270359147483085  Primal_obj =  0.03701426874538706  Gap =  0.006743909597903976 Sum =  1.0001613631049024
Iteration =  3  Dual obj =  0.03027079513698539  Primal_obj =  0.03653120592443122  Gap =  0.006260410787445832 Sum =  1.0006323255072274
Iteration =  4  Dual obj =  0.030271225883690144  Primal_obj =  0.0362385441734458  Gap =  0.005967318289755653 Sum =  1.0006440180949385
Iteration =  5  Dual obj =  0.030271755626857626  Primal_obj =  0.03608168611916754  Gap =  0.005809930492309913 Sum =  0.9999682731917392
Iteration =  6  Dual obj =  0.030272202739204654  Primal_obj =  0.03602414364244827  Gap =  0.005751940903243616 Sum =  0.9994574231440945
Iteration =  7  Dual obj =  0.0302726541438532  Primal_obj =  0.03587786262802241  Gap =  0.005605208484169209 Sum =  0.9992362611962693
Iteration =  8  Dual obj =  0.030273201690027448  Primal_obj =  0.03598464678384859  Gap =  0.005711445093821144 Sum =  0.9990222302705984
Iteration =  9  Dual obj =  0.030273752632610194  Primal_obj =  0.0362919466234438  Gap =  0.006018193990833608 Sum =  0.9991686493938142
Iteration =  10  Dual obj =  0.03027443806219932  Primal_obj =  0.03641890289507636  Gap =  0.006144464832877044 Sum =  0.9998144571920412
Iteration =  11  Dual obj =  0.03027498682137103  Primal_obj =  0.03633972811256493  Gap =  0.006064741291193901 Sum =  1.0001142553196043
Iteration =  12  Dual obj =  0.03027562631289034  Primal_obj =  0.03605244204715824  Gap =  0.005776815734267901 Sum =  1.000060818649651
Iteration =  13  Dual obj =  0.03027623163683147  Primal_obj =  0.03563815044927021  Gap =  0.0053619188124387415 Sum =  0.9998714994383072
Iteration =  14  Dual obj =  0.0302767485896563  Primal_obj =  0.03533098388030992  Gap =  0.00505423529065362 Sum =  0.9997132294968646
Iteration =  15  Dual obj =  0.030277181543722168  Primal_obj =  0.035098880383304276  Gap =  0.004821698839582108 Sum =  0.9995784707533079
Iteration =  16  Dual obj =  0.030277625294175717  Primal_obj =  0.035137153702410454  Gap =  0.004859528408234736 Sum =  0.9996754366278787
Iteration =  17  Dual obj =  0.030278074510012895  Primal_obj =  0.03522776112524334  Gap =  0.004949686615230445 Sum =  0.9997068187052744
Iteration =  18  Dual obj =  0.030278454125283998  Primal_obj =  0.035176796317410886  Gap =  0.004898342192126887 Sum =  0.9999747087138925
Iteration =  19  Dual obj =  0.03027884351745771  Primal_obj =  0.03524851080946734  Gap =  0.004969667292009629 Sum =  1.0003280284060496
Iteration =  20  Dual obj =  0.030279228934946285  Primal_obj =  0.035425577620795845  Gap =  0.00514634868584956 Sum =  1.0007055890224628
Iteration =  21  Dual obj =  0.030279368275798413  Primal_obj =  0.0354319469719562  Gap =  0.005152578696157789 Sum =  1.0006963965432214
Iteration =  22  Dual obj =  0.030279691083425285  Primal_obj =  0.035411131307606314  Gap =  0.005131440224181029 Sum =  1.0003881354896662
Iteration =  23  Dual obj =  0.0302800153469033  Primal_obj =  0.03538734952479285  Gap =  0.005107334177889545 Sum =  0.9999469356424111
Iteration =  24  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  0  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  1  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  2  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  3  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  4  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  5  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  6  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  7  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  8  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  9  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  10  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  11  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  12  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  13  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  14  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  15  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  16  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  17  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  18  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  19  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  20  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  21  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  22  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  23  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Iteration =  24  Dual obj =  0.030280307538831756  Primal_obj =  0.03517622774010859  Gap =  0.0048959202012768335 Sum =  0.9995003916980184
Done, writing results...
