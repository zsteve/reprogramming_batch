2021-04-27 21:44:30,785 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.30s.
2021-04-27 21:44:31,244 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-27 21:44:31,656 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.41s.
2021-04-27 21:44:31,780 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-27 21:44:31,783 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 21:44:31,795 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 21:44:32,648 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 102.
2021-04-27 21:44:32,649 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.87s.
Iteration =  0  Dual obj =  -50.336811032875715  Primal_obj =  63049.631207724844  Gap =  63099.96801875772 Sum =  368.62681310652783
Iteration =  1  Dual obj =  -0.04000210125689067  Primal_obj =  22.96448256507738  Gap =  23.00448466633427 Sum =  0.872673879388226
Iteration =  2  Dual obj =  -0.003203110850293678  Primal_obj =  6.802665608126466  Gap =  6.805868718976759 Sum =  0.7254577107879769
Iteration =  3  Dual obj =  0.012544057838393685  Primal_obj =  3.10992353646291  Gap =  3.097379478624516 Sum =  0.8070970307021046
Iteration =  4  Dual obj =  0.018458787141474708  Primal_obj =  1.6182084614129897  Gap =  1.599749674271515 Sum =  0.9460767200495384
Iteration =  5  Dual obj =  0.02089591679979111  Primal_obj =  0.6769923722029589  Gap =  0.6560964554031679 Sum =  1.0138919183006867
Iteration =  6  Dual obj =  0.021578025636112746  Primal_obj =  0.3674660571987536  Gap =  0.3458880315626408 Sum =  0.9893278427526375
Iteration =  7  Dual obj =  0.021829671652150946  Primal_obj =  0.22287680685529881  Gap =  0.20104713520314788 Sum =  0.9923590043473549
Iteration =  8  Dual obj =  0.021936289591753647  Primal_obj =  0.14149692591948337  Gap =  0.11956063632772973 Sum =  0.9986639628092009
Iteration =  9  Dual obj =  0.021994210515154076  Primal_obj =  0.11077476537968842  Gap =  0.08878055486453434 Sum =  0.9973102321688763
Iteration =  10  Dual obj =  0.02203694897770843  Primal_obj =  0.08177181973465328  Gap =  0.05973487075694485 Sum =  0.9982944774690143
Iteration =  11  Dual obj =  0.02206107081299141  Primal_obj =  0.05247902033911024  Gap =  0.030417949526118832 Sum =  1.0022417503273324
Iteration =  12  Dual obj =  0.02207197563255997  Primal_obj =  0.03847619977568156  Gap =  0.016404224143121593 Sum =  1.000254558632222
Iteration =  13  Dual obj =  0.022077735166744133  Primal_obj =  0.030889162888161237  Gap =  0.008811427721417103 Sum =  0.999212318414588
Iteration =  14  Dual obj =  0.022080879950442153  Primal_obj =  0.02717841259083531  Gap =  0.005097532640393157 Sum =  0.9998577486659843
Iteration =  15  Dual obj =  0.022082605460872824  Primal_obj =  0.025251357236034846  Gap =  0.0031687517751620223 Sum =  1.0003579337940407
Iteration =  16  Dual obj =  0.022083613185278638  Primal_obj =  0.02422192462601526  Gap =  0.002138311440736621 Sum =  0.9996629399200303
Iteration =  17  Dual obj =  0.022084242008491763  Primal_obj =  0.023640042378124587  Gap =  0.001555800369632824 Sum =  0.999907586129391
Iteration =  18  Dual obj =  0.022084675101656275  Primal_obj =  0.023289397867269676  Gap =  0.0012047227656134009 Sum =  1.0000631824877386
Iteration =  19  Dual obj =  0.022084998521658194  Primal_obj =  0.02306307646552959  Gap =  0.000978077943871395 Sum =  0.9998902601049604
Iteration =  20  Dual obj =  0.02208525549957149  Primal_obj =  0.022918437594125415  Gap =  0.0008331820945539255 Sum =  0.999877736785822
Iteration =  21  Dual obj =  0.022085474232899957  Primal_obj =  0.02280433765012474  Gap =  0.0007188634172247826 Sum =  1.0000859401431659
Iteration =  22  Dual obj =  0.022085669111686006  Primal_obj =  0.02269526175113004  Gap =  0.000609592639444035 Sum =  0.9999748195527873
Iteration =  23  Dual obj =  0.022085818215024845  Primal_obj =  0.02260755963287983  Gap =  0.0005217414178549859 Sum =  0.999886728762403
Iteration =  24  Dual obj =  0.022085931336081787  Primal_obj =  0.0225440218431011  Gap =  0.0004580905070193132 Sum =  1.0000395087984797
Iteration =  0  Dual obj =  -38.00735306377814  Primal_obj =  57963.573616600785  Gap =  58001.58096966456 Sum =  368.62681310652783
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.101628334516349  Primal_obj =  12.6341686015992  Gap =  12.735796936115548 Sum =  0.416757312501307
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  -0.023259933648308664  Primal_obj =  17.716832201345934  Gap =  17.740092134994242 Sum =  0.7033093701184743
Iteration =  5  Dual obj =  0.0054848525053570185  Primal_obj =  14.2917950466151  Gap =  14.286310194109742 Sum =  0.7652372764423463
Iteration =  6  Dual obj =  0.018335024341869968  Primal_obj =  10.604369253275037  Gap =  10.586034228933167 Sum =  0.812533248151529
Iteration =  7  Dual obj =  0.02563392303215764  Primal_obj =  7.188270028369234  Gap =  7.162636105337077 Sum =  0.7967496636313016
Iteration =  8  Dual obj =  0.03327799554338525  Primal_obj =  4.470665204144349  Gap =  4.437387208600963 Sum =  0.806774820251345
Iteration =  9  Dual obj =  0.03692977954022016  Primal_obj =  2.8888386574126863  Gap =  2.851908877872466 Sum =  0.833469320652912
Iteration =  10  Dual obj =  0.03894334559551874  Primal_obj =  2.137612396360611  Gap =  2.0986690507650922 Sum =  0.8528975596381285
Iteration =  11  Dual obj =  0.040459491875520115  Primal_obj =  1.8412065970692177  Gap =  1.8007471051936976 Sum =  0.8870754460497077
Iteration =  12  Dual obj =  0.041645444767759165  Primal_obj =  1.513131557908142  Gap =  1.4714861131403827 Sum =  0.9480350765553063
Iteration =  13  Dual obj =  0.042507570638996184  Primal_obj =  1.2131871225003246  Gap =  1.1706795518613284 Sum =  0.9736158507038979
Iteration =  14  Dual obj =  0.04312764961358242  Primal_obj =  0.9297434202147299  Gap =  0.8866157706011475 Sum =  0.9729724430164417
Iteration =  15  Dual obj =  0.04355039209024565  Primal_obj =  0.7893416691674072  Gap =  0.7457912770771615 Sum =  0.9815472987724458
Iteration =  16  Dual obj =  0.043899713168024726  Primal_obj =  0.7670199072930688  Gap =  0.723120194125044 Sum =  0.991904188294747
Iteration =  17  Dual obj =  0.0441729767372018  Primal_obj =  0.5663364747939881  Gap =  0.5221634980567863 Sum =  0.9890724962529047
Iteration =  18  Dual obj =  0.04434999352562397  Primal_obj =  0.5032669469308668  Gap =  0.45891695340524286 Sum =  0.9925745202874983
Iteration =  19  Dual obj =  0.044485586311955955  Primal_obj =  0.4533736720023567  Gap =  0.4088880856904007 Sum =  0.9955872009358893
Iteration =  20  Dual obj =  0.04458869468247217  Primal_obj =  0.3648530119253134  Gap =  0.3202643172428412 Sum =  0.9972291887843718
Iteration =  21  Dual obj =  0.04465074424702095  Primal_obj =  0.3231165561896084  Gap =  0.27846581194258746 Sum =  0.9935908973884149
Iteration =  22  Dual obj =  0.0446921593093776  Primal_obj =  0.2982883938608056  Gap =  0.253596234551428 Sum =  0.9951645898039634
Iteration =  23  Dual obj =  0.044725039861347266  Primal_obj =  0.28858255349510314  Gap =  0.24385751363375588 Sum =  1.0019037717976378
Iteration =  24  Dual obj =  0.04475509711418707  Primal_obj =  0.27376912609689563  Gap =  0.22901402898270856 Sum =  1.0067173102682738
Iteration =  0  Dual obj =  0.04475509711418707  Primal_obj =  0.27376912609689563  Gap =  0.22901402898270856 Sum =  1.0067173102682738
Iteration =  1  Dual obj =  0.044776845093383755  Primal_obj =  0.24721992268723741  Gap =  0.20244307759385366 Sum =  1.0025827840816777
Iteration =  2  Dual obj =  0.04479407597092395  Primal_obj =  0.22337324605553643  Gap =  0.1785791700846125 Sum =  1.0005671714773938
Iteration =  3  Dual obj =  0.044809913110605025  Primal_obj =  0.20972511747149614  Gap =  0.1649152043608911 Sum =  0.9985617197336035
Iteration =  4  Dual obj =  0.04482922523464933  Primal_obj =  0.20728470486256345  Gap =  0.16245547962791412 Sum =  0.9958294608618871
Iteration =  5  Dual obj =  0.044850397716158626  Primal_obj =  0.20286960832101003  Gap =  0.1580192106048514 Sum =  0.9984801908595043
Iteration =  6  Dual obj =  0.04487133743490573  Primal_obj =  0.19992111682590066  Gap =  0.15504977939099493 Sum =  0.9990056464348511
Iteration =  7  Dual obj =  0.04489403672468155  Primal_obj =  0.1903987587665411  Gap =  0.14550472204185955 Sum =  0.9990324198265457
Iteration =  8  Dual obj =  0.04491307889758858  Primal_obj =  0.1607536359400581  Gap =  0.11584055704246951 Sum =  0.9994066883688579
Iteration =  9  Dual obj =  0.044929130649610474  Primal_obj =  0.1482176879556556  Gap =  0.10328855730604512 Sum =  0.9972158805360479
Iteration =  10  Dual obj =  0.04494101281965332  Primal_obj =  0.1399735652900585  Gap =  0.09503255247040518 Sum =  0.9952118853448322
Iteration =  11  Dual obj =  0.0449519496413672  Primal_obj =  0.13257075195548512  Gap =  0.08761880231411792 Sum =  0.9967614277588348
Iteration =  12  Dual obj =  0.044961132881155524  Primal_obj =  0.11946032808812593  Gap =  0.0744991952069704 Sum =  0.9989156015113788
Iteration =  13  Dual obj =  0.04496835896750881  Primal_obj =  0.10257720267850699  Gap =  0.057608843710998184 Sum =  0.9998405871479463
Iteration =  14  Dual obj =  0.04497419964858344  Primal_obj =  0.09485249964041176  Gap =  0.049878299991828315 Sum =  1.0009733943330434
Iteration =  15  Dual obj =  0.0449792162772886  Primal_obj =  0.08728766023316069  Gap =  0.04230844395587209 Sum =  1.0019717815564353
Iteration =  16  Dual obj =  0.044983230422431776  Primal_obj =  0.08254274425802507  Gap =  0.0375595138355933 Sum =  1.001960191130671
Iteration =  17  Dual obj =  0.04498642124442227  Primal_obj =  0.07718290783552194  Gap =  0.032196486591099666 Sum =  1.0005262725458213
Iteration =  18  Dual obj =  0.0449891492765387  Primal_obj =  0.07535799646765955  Gap =  0.030368847191120846 Sum =  1.0004301567518032
Iteration =  19  Dual obj =  0.04499168903699323  Primal_obj =  0.07066828664168553  Gap =  0.025676597604692306 Sum =  0.9998372341169464
Iteration =  20  Dual obj =  0.044993877834237764  Primal_obj =  0.06980550667888302  Gap =  0.02481162884464526 Sum =  1.0002464268464852
Iteration =  21  Dual obj =  0.04499576198323113  Primal_obj =  0.06660891166691878  Gap =  0.021613149683687646 Sum =  1.0002773847964312
Iteration =  22  Dual obj =  0.04499746989031278  Primal_obj =  0.0662889347678946  Gap =  0.021291464877581823 Sum =  1.000149634992922
Iteration =  23  Dual obj =  0.044998980000682066  Primal_obj =  0.06465483973990382  Gap =  0.019655859739221758 Sum =  0.9996142233667168
Iteration =  24  Dual obj =  0.04500062748333615  Primal_obj =  0.0631750401157199  Gap =  0.018174412632383743 Sum =  0.9996217062795573
Iteration =  0  Dual obj =  0.04500062748333615  Primal_obj =  0.0631750401157199  Gap =  0.018174412632383743 Sum =  0.9996217062795573
Iteration =  1  Dual obj =  0.04500138466281271  Primal_obj =  0.0617380327549462  Gap =  0.016736648092133488 Sum =  0.999340378315638
Iteration =  2  Dual obj =  0.04500253504310141  Primal_obj =  0.059144318586644665  Gap =  0.014141783543543257 Sum =  0.9995817241829104
Iteration =  3  Dual obj =  0.04500345552285283  Primal_obj =  0.05748671950483586  Gap =  0.012483263981983031 Sum =  0.9998458512348943
Iteration =  4  Dual obj =  0.045004135300391795  Primal_obj =  0.056185729119425  Gap =  0.011181593819033206 Sum =  0.9999876391054592
Iteration =  5  Dual obj =  0.045004742777601525  Primal_obj =  0.05517159996091037  Gap =  0.010166857183308842 Sum =  0.9997607199766181
Iteration =  6  Dual obj =  0.045005225256304855  Primal_obj =  0.054662417844940414  Gap =  0.009657192588635559 Sum =  1.0003057953155663
Iteration =  7  Dual obj =  0.045005775216216154  Primal_obj =  0.05431588231067315  Gap =  0.009310107094456996 Sum =  1.0004579893890582
Iteration =  8  Dual obj =  0.04500638872779098  Primal_obj =  0.0539835332107307  Gap =  0.008977144482939715 Sum =  1.0003523105416539
Iteration =  9  Dual obj =  0.04500688135801681  Primal_obj =  0.053572865006270134  Gap =  0.008565983648253325 Sum =  1.000410750138121
Iteration =  10  Dual obj =  0.04500746776047396  Primal_obj =  0.05351512332602673  Gap =  0.008507655565552774 Sum =  1.0001914834848653
Iteration =  11  Dual obj =  0.04500822920096341  Primal_obj =  0.05310886099340342  Gap =  0.008100631792440013 Sum =  0.9999120090150591
Iteration =  12  Dual obj =  0.045009118773691736  Primal_obj =  0.053131626035763366  Gap =  0.00812250726207163 Sum =  0.9998802812137193
Iteration =  13  Dual obj =  0.04500990714295916  Primal_obj =  0.052682659133795204  Gap =  0.007672751990836044 Sum =  0.9997069078963725
Iteration =  14  Dual obj =  0.045010567350748765  Primal_obj =  0.052386534991496356  Gap =  0.007375967640747591 Sum =  0.9997585012266509
Iteration =  15  Dual obj =  0.04501116763304547  Primal_obj =  0.051978514914308105  Gap =  0.006967347281262637 Sum =  1.0001618301574802
Iteration =  16  Dual obj =  0.0450116936229418  Primal_obj =  0.05142883594456603  Gap =  0.006417142321624228 Sum =  0.9998698708569147
Iteration =  17  Dual obj =  0.04501230615389709  Primal_obj =  0.05081824225553648  Gap =  0.005805936101639389 Sum =  1.000012503845332
Iteration =  18  Dual obj =  0.045012827787150475  Primal_obj =  0.050213048742214744  Gap =  0.005200220955064269 Sum =  1.0000849511573673
Iteration =  19  Dual obj =  0.045013297833981086  Primal_obj =  0.04971660818255397  Gap =  0.004703310348572881 Sum =  1.0000785063517024
Iteration =  20  Dual obj =  0.04501367451098268  Primal_obj =  0.04943625727767145  Gap =  0.004422582766688769 Sum =  0.9998151250244505
Iteration =  21  Dual obj =  0.04501403076317785  Primal_obj =  0.04922575544034315  Gap =  0.004211724677165296 Sum =  0.9999484109437555
Iteration =  22  Dual obj =  0.04501431001060252  Primal_obj =  0.04909612249154835  Gap =  0.004081812480945829 Sum =  1.0001662671404654
Iteration =  23  Dual obj =  0.04501462259062095  Primal_obj =  0.048944798480628854  Gap =  0.003930175890007902 Sum =  0.999938927993993
Iteration =  24  Dual obj =  0.0450148817195036  Primal_obj =  0.04882609447095347  Gap =  0.003811212751449869 Sum =  1.0000036714256355
Iteration =  0  Dual obj =  0.0450148817195036  Primal_obj =  0.04882609447095347  Gap =  0.003811212751449869 Sum =  1.0000036714256355
Iteration =  1  Dual obj =  0.045015013048976815  Primal_obj =  0.04863982410813575  Gap =  0.0036248110591589333 Sum =  1.0000622053225179
Iteration =  2  Dual obj =  0.045015143910977565  Primal_obj =  0.0484556104150488  Gap =  0.0034404665040712323 Sum =  1.0000782946248883
Iteration =  3  Dual obj =  0.04501530694679767  Primal_obj =  0.048195631834382066  Gap =  0.003180324887584393 Sum =  0.9998029953682028
Iteration =  4  Dual obj =  0.04501548397521768  Primal_obj =  0.04792183308302479  Gap =  0.002906349107807113 Sum =  0.99988286239045
Iteration =  5  Dual obj =  0.04501564411761538  Primal_obj =  0.047701857442709356  Gap =  0.0026862133250939724 Sum =  0.9999000843555256
Iteration =  6  Dual obj =  0.04501578887628246  Primal_obj =  0.04754135652534297  Gap =  0.002525567649060513 Sum =  0.9999232553308298
Iteration =  7  Dual obj =  0.04501591530332875  Primal_obj =  0.04742361139853202  Gap =  0.0024076960952032697 Sum =  1.0000949906742158
Iteration =  8  Dual obj =  0.04501604835849091  Primal_obj =  0.04731371495237255  Gap =  0.002297666593881642 Sum =  1.0001025683055127
Iteration =  9  Dual obj =  0.04501609037079157  Primal_obj =  0.04728394743904833  Gap =  0.0022678570682567595 Sum =  1.0000720892071162
Iteration =  10  Dual obj =  0.04501615677002854  Primal_obj =  0.04723808387474358  Gap =  0.0022219271047150407 Sum =  1.0000625526988784
Iteration =  11  Dual obj =  0.04501625869516673  Primal_obj =  0.04720453013020874  Gap =  0.002188271435042008 Sum =  0.9999175867767085
Iteration =  12  Dual obj =  0.04501638312409786  Primal_obj =  0.047172172227139555  Gap =  0.0021557891030416984 Sum =  0.9998099221960048
Iteration =  13  Dual obj =  0.04501652196202304  Primal_obj =  0.04718126235039584  Gap =  0.0021647403883727975 Sum =  0.999930780487996
Iteration =  14  Dual obj =  0.045016705903660276  Primal_obj =  0.04712152678509075  Gap =  0.0021048208814304775 Sum =  0.9999808260904317
Iteration =  15  Dual obj =  0.04501686312790735  Primal_obj =  0.04710577593691735  Gap =  0.002088912809010003 Sum =  1.000033693537279
Iteration =  16  Dual obj =  0.045017027065677256  Primal_obj =  0.04708797319372933  Gap =  0.002070946128052073 Sum =  1.0000761508934906
Iteration =  17  Dual obj =  0.04501720220797813  Primal_obj =  0.047118735522975616  Gap =  0.002101533314997489 Sum =  1.0001642273844062
Iteration =  18  Dual obj =  0.045017366210775164  Primal_obj =  0.04713171967121291  Gap =  0.002114353460437743 Sum =  1.0002304454504292
Iteration =  19  Dual obj =  0.04501749069189678  Primal_obj =  0.04715620701571774  Gap =  0.002138716323820955 Sum =  1.0000926964982428
Iteration =  20  Dual obj =  0.045017639875949395  Primal_obj =  0.047175864359768185  Gap =  0.002158224483818791 Sum =  0.9999461451328412
Iteration =  21  Dual obj =  0.04501775498329165  Primal_obj =  0.04711901599558213  Gap =  0.0021012610122904812 Sum =  0.9999196214502796
Iteration =  22  Dual obj =  0.04501789214612302  Primal_obj =  0.04699033228723615  Gap =  0.001972440141113127 Sum =  0.999916752378875
Iteration =  23  Dual obj =  0.04501803285697589  Primal_obj =  0.04689707316914615  Gap =  0.0018790403121702604 Sum =  0.9999620493644364
Iteration =  24  Dual obj =  0.0450181584217708  Primal_obj =  0.04678959919033955  Gap =  0.0017714407685687494 Sum =  1.0000213796929525
Done, writing results...
