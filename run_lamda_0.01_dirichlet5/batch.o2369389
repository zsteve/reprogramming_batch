2021-04-27 22:01:24,064 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.28s.
2021-04-27 22:01:24,525 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-27 22:01:24,947 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.42s.
2021-04-27 22:01:25,072 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-27 22:01:25,075 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-27 22:01:25,086 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-27 22:01:25,937 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 103.
2021-04-27 22:01:25,938 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.87s.
Iteration =  0  Dual obj =  -52.9606420255047  Primal_obj =  65830.63844295178  Gap =  65883.59908497728 Sum =  398.29007968597296
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.12686124520611713  Primal_obj =  12.796725798629678  Gap =  12.923587043835795 Sum =  0.49188641824334606
Iteration =  3  Dual obj =  -0.00905438263587495  Primal_obj =  10.208413194351778  Gap =  10.217467576987653 Sum =  0.7943204602974413
Iteration =  4  Dual obj =  0.011244414188199513  Primal_obj =  4.547263497893356  Gap =  4.536019083705156 Sum =  0.8035932222269979
Iteration =  5  Dual obj =  0.020493031243236117  Primal_obj =  2.103062031725244  Gap =  2.082569000482008 Sum =  0.893388438802442
Iteration =  6  Dual obj =  0.024454136483235935  Primal_obj =  1.070079887105366  Gap =  1.04562575062213 Sum =  0.9987978609512136
Iteration =  7  Dual obj =  0.02587224907479147  Primal_obj =  0.5528310016960394  Gap =  0.5269587526212479 Sum =  1.0109193022189378
Iteration =  8  Dual obj =  0.02645026747824479  Primal_obj =  0.31121347129199783  Gap =  0.28476320381375303 Sum =  0.9928974332948866
Iteration =  9  Dual obj =  0.026705589365525136  Primal_obj =  0.18305610423262986  Gap =  0.15635051486710472 Sum =  0.994568486250917
Iteration =  10  Dual obj =  0.02681913429164841  Primal_obj =  0.13179853383038262  Gap =  0.10497939953873421 Sum =  1.0000595277731454
Iteration =  11  Dual obj =  0.02687265895677323  Primal_obj =  0.10181460918822813  Gap =  0.07494195023145489 Sum =  0.99951103787535
Iteration =  12  Dual obj =  0.02690430145019063  Primal_obj =  0.08258911321333384  Gap =  0.055684811763143216 Sum =  0.9974411496943705
Iteration =  13  Dual obj =  0.026926572097282275  Primal_obj =  0.06539258562115943  Gap =  0.03846601352387716 Sum =  0.9990698834096535
Iteration =  14  Dual obj =  0.026940315868443046  Primal_obj =  0.05101199514736156  Gap =  0.024071679278918512 Sum =  1.000515362896057
Iteration =  15  Dual obj =  0.02694755302004982  Primal_obj =  0.04281421174701101  Gap =  0.015866658726961195 Sum =  1.0000678958519338
Iteration =  16  Dual obj =  0.0269512251020808  Primal_obj =  0.036754977368628844  Gap =  0.009803752266548043 Sum =  0.9997680895258295
Iteration =  17  Dual obj =  0.02695319619773596  Primal_obj =  0.03317640550055316  Gap =  0.006223209302817199 Sum =  0.9999659790792816
Iteration =  18  Dual obj =  0.02695444672847169  Primal_obj =  0.031492425259032814  Gap =  0.004537978530561124 Sum =  1.0000882036982603
Iteration =  19  Dual obj =  0.026955241115601592  Primal_obj =  0.029997222310921903  Gap =  0.003041981195320311 Sum =  0.9997638109658225
Iteration =  20  Dual obj =  0.02695586281540581  Primal_obj =  0.029005223301153474  Gap =  0.0020493604857476644 Sum =  0.999734843241196
Iteration =  21  Dual obj =  0.026956314458956538  Primal_obj =  0.028392610176173422  Gap =  0.0014362957172168837 Sum =  0.9999162895063869
Iteration =  22  Dual obj =  0.02695663309221489  Primal_obj =  0.028030461350712285  Gap =  0.001073828258497396 Sum =  1.0000167604435868
Iteration =  23  Dual obj =  0.026956868298980387  Primal_obj =  0.027803377600017568  Gap =  0.0008465093010371801 Sum =  0.9999407599725698
Iteration =  24  Dual obj =  0.0269570549705181  Primal_obj =  0.02765254910216665  Gap =  0.0006954941316485476 Sum =  0.9999208198083893
Iteration =  0  Dual obj =  -57.213421332822804  Primal_obj =  86519.63262034574  Gap =  86576.84604167857 Sum =  398.29007968597296
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.11468600158619534  Primal_obj =  14.541301136709398  Gap =  14.655987138295593 Sum =  0.4645483352487646
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  -0.051014456239572084  Primal_obj =  42.78651564833413  Gap =  42.8375301045737 Sum =  1.024817658039546
Iteration =  5  Dual obj =  0.000708853349758308  Primal_obj =  16.628616247602626  Gap =  16.62790739425287 Sum =  0.7484219226607246
Iteration =  6  Dual obj =  0.013606605067224789  Primal_obj =  9.635388817089867  Gap =  9.621782212022643 Sum =  0.7829545770725319
Iteration =  7  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  8  Dual obj =  0.020303387708477207  Primal_obj =  8.650219905399156  Gap =  8.62991651769068 Sum =  0.8261740022144531
Iteration =  9  Dual obj =  0.029555152313316096  Primal_obj =  6.0687109303759605  Gap =  6.039155778062645 Sum =  0.8130814117079842
Iteration =  10  Dual obj =  0.03574670840391577  Primal_obj =  4.165517827038526  Gap =  4.12977111863461 Sum =  0.8156749520522547
Iteration =  11  Dual obj =  0.03836899221960045  Primal_obj =  3.226632787773512  Gap =  3.1882637955539117 Sum =  0.8366154356770529
Iteration =  12  Dual obj =  0.04050152810261022  Primal_obj =  2.8973387277755016  Gap =  2.856837199672891 Sum =  0.8515171545583906
Iteration =  13  Dual obj =  0.04214363144595938  Primal_obj =  2.684481223281322  Gap =  2.642337591835363 Sum =  0.8610990908022091
Iteration =  14  Dual obj =  0.04349346326518577  Primal_obj =  1.9566960828250144  Gap =  1.9132026195598286 Sum =  0.9017391314464873
Iteration =  15  Dual obj =  0.044615280717346224  Primal_obj =  1.4279457428982472  Gap =  1.3833304621809008 Sum =  0.9101585527010501
Iteration =  16  Dual obj =  0.045440172819218125  Primal_obj =  1.5534338837434478  Gap =  1.5079937109242296 Sum =  0.9537152339159103
Iteration =  17  Dual obj =  0.04604329496577962  Primal_obj =  1.0575171864461377  Gap =  1.011473891480358 Sum =  0.9383638250102819
Iteration =  18  Dual obj =  0.04666380090573188  Primal_obj =  1.1065723177015447  Gap =  1.0599085167958129 Sum =  0.9664616995191009
Iteration =  19  Dual obj =  0.047134044033246364  Primal_obj =  1.0960329454147961  Gap =  1.0488989013815497 Sum =  0.9791403082131287
Iteration =  20  Dual obj =  0.04747468501505138  Primal_obj =  0.85957788211408  Gap =  0.8121031970990287 Sum =  0.9802576223262123
Iteration =  21  Dual obj =  0.04779794870635541  Primal_obj =  0.7130798238883228  Gap =  0.6652818751819674 Sum =  0.9841305819542578
Iteration =  22  Dual obj =  0.048001262611941854  Primal_obj =  0.6330737615479561  Gap =  0.5850724989360143 Sum =  0.9901347301776505
Iteration =  23  Dual obj =  0.04813111323895382  Primal_obj =  0.5718471090769202  Gap =  0.5237159958379664 Sum =  0.9972501826728175
Iteration =  24  Dual obj =  0.048249421049660846  Primal_obj =  0.5268373294904889  Gap =  0.47858790844082805 Sum =  0.9991682270729789
Iteration =  0  Dual obj =  0.048249421049660846  Primal_obj =  0.5268373294904889  Gap =  0.47858790844082805 Sum =  0.9991682270729789
Iteration =  1  Dual obj =  0.04832699586010359  Primal_obj =  0.43539152193461533  Gap =  0.38706452607451175 Sum =  0.9880264279685484
Iteration =  2  Dual obj =  0.04839256876741796  Primal_obj =  0.38166833196774486  Gap =  0.3332757632003269 Sum =  0.9847703421795164
Iteration =  3  Dual obj =  0.048447881418824  Primal_obj =  0.3603400204357907  Gap =  0.3118921390169667 Sum =  0.9903329108023772
Iteration =  4  Dual obj =  0.0485193906290281  Primal_obj =  0.33880191819602307  Gap =  0.29028252756699496 Sum =  0.9996736725872368
Iteration =  5  Dual obj =  0.048587952373769214  Primal_obj =  0.30319494425609134  Gap =  0.2546069918823221 Sum =  1.0042115533141702
Iteration =  6  Dual obj =  0.048634901885095186  Primal_obj =  0.2663281016476427  Gap =  0.21769319976254753 Sum =  1.0037946644836842
Iteration =  7  Dual obj =  0.048673371844694974  Primal_obj =  0.22711627323878622  Gap =  0.17844290139409125 Sum =  1.0008826907227486
Iteration =  8  Dual obj =  0.048707522977207804  Primal_obj =  0.21614855765998278  Gap =  0.167441034682775 Sum =  1.0033725690906468
Iteration =  9  Dual obj =  0.048736974516956105  Primal_obj =  0.18459468671343032  Gap =  0.13585771219647422 Sum =  1.0035348624620632
Iteration =  10  Dual obj =  0.0487587706245181  Primal_obj =  0.153589166332739  Gap =  0.1048303957082209 Sum =  1.0024011826540853
Iteration =  11  Dual obj =  0.04877445647996452  Primal_obj =  0.13426329036234824  Gap =  0.08548883388238372 Sum =  1.0006690635634365
Iteration =  12  Dual obj =  0.048786478541096384  Primal_obj =  0.12142045672151146  Gap =  0.07263397818041507 Sum =  1.0005176446186528
Iteration =  13  Dual obj =  0.04879776605466544  Primal_obj =  0.1109281257692895  Gap =  0.06213035971462406 Sum =  1.0001850599442716
Iteration =  14  Dual obj =  0.04880631774886967  Primal_obj =  0.10336346195212237  Gap =  0.0545571442032527 Sum =  1.0002019685299475
Iteration =  15  Dual obj =  0.04881533752418763  Primal_obj =  0.09685594804788104  Gap =  0.04804061052369341 Sum =  0.9996309371492247
Iteration =  16  Dual obj =  0.04882415763316351  Primal_obj =  0.09234550581871179  Gap =  0.04352134818554828 Sum =  0.9979996817529169
Iteration =  17  Dual obj =  0.048831386827126615  Primal_obj =  0.08761630363621328  Gap =  0.03878491680908667 Sum =  0.9973908786096313
Iteration =  18  Dual obj =  0.04883798337004831  Primal_obj =  0.08418713738666588  Gap =  0.03534915401661756 Sum =  0.9978885810579781
Iteration =  19  Dual obj =  0.048843962904713344  Primal_obj =  0.07866216246257793  Gap =  0.029818199557864584 Sum =  0.9988487980041343
Iteration =  20  Dual obj =  0.048849435948962294  Primal_obj =  0.07649158030034922  Gap =  0.027642144351386927 Sum =  0.9999397513962225
Iteration =  21  Dual obj =  0.048854230605150414  Primal_obj =  0.07297460603898881  Gap =  0.024120375433838395 Sum =  0.9994780665087815
Iteration =  22  Dual obj =  0.048857422239765  Primal_obj =  0.06989005536469098  Gap =  0.02103263312492598 Sum =  0.9998822089338677
Iteration =  23  Dual obj =  0.048860312546932946  Primal_obj =  0.06678458030586883  Gap =  0.01792426775893588 Sum =  0.9997926352949392
Iteration =  24  Dual obj =  0.048862912838684214  Primal_obj =  0.06516448609860664  Gap =  0.01630157325992243 Sum =  1.0000267675536576
Iteration =  0  Dual obj =  0.048862912838684214  Primal_obj =  0.06516448609860664  Gap =  0.01630157325992243 Sum =  1.0000267675536576
Iteration =  1  Dual obj =  0.048863966864545236  Primal_obj =  0.06364869449666648  Gap =  0.014784727632121242 Sum =  1.0000028193207164
Iteration =  2  Dual obj =  0.04886503161330682  Primal_obj =  0.06219399933421822  Gap =  0.013328967720911404 Sum =  1.0000599543916806
Iteration =  3  Dual obj =  0.048866051959665376  Primal_obj =  0.0607973881399325  Gap =  0.011931336180267121 Sum =  1.0000166107789887
Iteration =  4  Dual obj =  0.0488671697288295  Primal_obj =  0.05975264220416045  Gap =  0.010885472475330948 Sum =  1.000077917911748
Iteration =  5  Dual obj =  0.04886829511213092  Primal_obj =  0.058834901507539054  Gap =  0.009966606395408133 Sum =  1.000112261217466
Iteration =  6  Dual obj =  0.04886920464852703  Primal_obj =  0.058596317692876224  Gap =  0.009727113044349193 Sum =  0.9997613127867417
Iteration =  7  Dual obj =  0.04887035279397014  Primal_obj =  0.05812483509176987  Gap =  0.00925448229779973 Sum =  0.9998253863273334
Iteration =  8  Dual obj =  0.04887151000491006  Primal_obj =  0.058313937017712536  Gap =  0.009442427012802478 Sum =  0.9999177856626225
Iteration =  9  Dual obj =  0.04887293703171755  Primal_obj =  0.05821291006867062  Gap =  0.009339973036953067 Sum =  1.0002417720887204
Iteration =  10  Dual obj =  0.048874302242816664  Primal_obj =  0.057998020439640044  Gap =  0.00912371819682338 Sum =  1.0000917524780812
Iteration =  11  Dual obj =  0.048875534091554  Primal_obj =  0.058715087432184114  Gap =  0.009839553340630115 Sum =  0.9999898350217477
Iteration =  12  Dual obj =  0.04887700205690392  Primal_obj =  0.05890470399707625  Gap =  0.010027701940172329 Sum =  1.0002173615371028
Iteration =  13  Dual obj =  0.048878252316843035  Primal_obj =  0.059591494584104066  Gap =  0.01071324226726103 Sum =  1.0004789574711204
Iteration =  14  Dual obj =  0.048879346866574455  Primal_obj =  0.05963376368395281  Gap =  0.010754416817378355 Sum =  1.0003364081614876
Iteration =  15  Dual obj =  0.04888057275678526  Primal_obj =  0.060075246178957445  Gap =  0.011194673422172188 Sum =  0.99995693479575
Iteration =  16  Dual obj =  0.04888174142029203  Primal_obj =  0.060053945035118794  Gap =  0.011172203614826764 Sum =  0.9996373814793853
Iteration =  17  Dual obj =  0.04888289878019224  Primal_obj =  0.06004041194335709  Gap =  0.01115751316316485 Sum =  1.0001444658875733
Iteration =  18  Dual obj =  0.04888392227447541  Primal_obj =  0.06042979837731132  Gap =  0.01154587610283591 Sum =  1.0004380543338303
Iteration =  19  Dual obj =  0.048884978062583725  Primal_obj =  0.06064107935245252  Gap =  0.011756101289868794 Sum =  1.0003903511148435
Iteration =  20  Dual obj =  0.04888579546497547  Primal_obj =  0.059491655686694185  Gap =  0.010605860221718715 Sum =  1.000272889168954
Iteration =  21  Dual obj =  0.04888678237530758  Primal_obj =  0.05806769609969518  Gap =  0.009180913724387597 Sum =  0.9998913056224755
Iteration =  22  Dual obj =  0.048887838025927915  Primal_obj =  0.05778514153868142  Gap =  0.008897303512753502 Sum =  0.9999773174098823
Iteration =  23  Dual obj =  0.04888847372674584  Primal_obj =  0.05819860158054853  Gap =  0.00931012785380269 Sum =  0.999861907637917
Iteration =  24  Dual obj =  0.04888915550850471  Primal_obj =  0.0571423825988816  Gap =  0.008253227090376895 Sum =  0.9997940331250326
Iteration =  0  Dual obj =  0.04888915550850471  Primal_obj =  0.0571423825988816  Gap =  0.008253227090376895 Sum =  0.9997940331250326
Iteration =  1  Dual obj =  0.04888943111928911  Primal_obj =  0.05665134791143164  Gap =  0.007761916792142533 Sum =  0.9999243099336528
Iteration =  2  Dual obj =  0.048889756918838914  Primal_obj =  0.055851621492056205  Gap =  0.006961864573217291 Sum =  1.0000846421592295
Iteration =  3  Dual obj =  0.04889022780260245  Primal_obj =  0.054718803354093445  Gap =  0.005828575551490994 Sum =  1.0001885058196298
Iteration =  4  Dual obj =  0.0488906105799321  Primal_obj =  0.05397976004043152  Gap =  0.0050891494604994175 Sum =  1.0000107311501463
Iteration =  5  Dual obj =  0.04889091872430866  Primal_obj =  0.05347692771369772  Gap =  0.004586008989389059 Sum =  0.9998394786503293
Iteration =  6  Dual obj =  0.04889118942884006  Primal_obj =  0.05310972779051532  Gap =  0.00421853836167526 Sum =  1.0000392663869362
Iteration =  7  Dual obj =  0.048891451209199646  Primal_obj =  0.05277599584518307  Gap =  0.0038845446359834224 Sum =  1.0001353809126097
Iteration =  8  Dual obj =  0.04889166239765845  Primal_obj =  0.052535566553772534  Gap =  0.0036439041561140834 Sum =  0.9999070614152104
Iteration =  9  Dual obj =  0.0488918199773904  Primal_obj =  0.05243264605648315  Gap =  0.00354082607909275 Sum =  0.9997834368273941
Iteration =  10  Dual obj =  0.04889199558566197  Primal_obj =  0.05234046331098377  Gap =  0.0034484677253217993 Sum =  0.9999264132521207
Iteration =  11  Dual obj =  0.04889215593860252  Primal_obj =  0.052305189420330904  Gap =  0.0034130334817283822 Sum =  1.0000198047403572
Iteration =  12  Dual obj =  0.04889231091970457  Primal_obj =  0.05234292740072096  Gap =  0.00345061648101639 Sum =  1.0000476871024482
Iteration =  13  Dual obj =  0.04889245725926382  Primal_obj =  0.05240640090156204  Gap =  0.00351394364229822 Sum =  1.0001142707114627
Iteration =  14  Dual obj =  0.04889262225776528  Primal_obj =  0.05248832415962572  Gap =  0.0035957019018604403 Sum =  1.000098420203401
Iteration =  15  Dual obj =  0.048892885076186665  Primal_obj =  0.05252445660545156  Gap =  0.003631571529264896 Sum =  1.0001644255176645
Iteration =  16  Dual obj =  0.04889315520332187  Primal_obj =  0.0525622691848049  Gap =  0.0036691139814830354 Sum =  1.0000841962836957
Iteration =  17  Dual obj =  0.048893435402027896  Primal_obj =  0.05253249731488051  Gap =  0.003639061912852612 Sum =  1.000090569203112
Iteration =  18  Dual obj =  0.04889367344889439  Primal_obj =  0.052761506376128614  Gap =  0.0038678329272342216 Sum =  1.0000180733083828
Iteration =  19  Dual obj =  0.048893878449414355  Primal_obj =  0.052758978851094526  Gap =  0.0038651004016801715 Sum =  0.9999205175214462
Iteration =  20  Dual obj =  0.048894111772873367  Primal_obj =  0.052787013615555975  Gap =  0.0038929018426826084 Sum =  0.9999837555407618
Iteration =  21  Dual obj =  0.04889436897563755  Primal_obj =  0.05276003720464338  Gap =  0.003865668229005831 Sum =  1.0000876387613482
Iteration =  22  Dual obj =  0.04889444401775923  Primal_obj =  0.05273748849712383  Gap =  0.0038430444793646004 Sum =  1.0001080393625323
Iteration =  23  Dual obj =  0.0488946303127683  Primal_obj =  0.05268634923021659  Gap =  0.0037917189174482904 Sum =  1.0000885897195677
Iteration =  24  Dual obj =  0.04889487191268116  Primal_obj =  0.052634750827577015  Gap =  0.0037398789148958556 Sum =  1.0000187685365276
Done, writing results...
