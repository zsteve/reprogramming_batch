2021-04-29 12:38:51,029 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.11s.
2021-04-29 12:38:51,463 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.23s.
2021-04-29 12:38:51,860 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.40s.
2021-04-29 12:38:51,970 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-29 12:38:51,973 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:38:51,982 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:38:52,774 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 120.
2021-04-29 12:38:52,775 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.80s.
Iteration =  0  Dual obj =  -37.42769822468877  Primal_obj =  474010.98153371294  Gap =  474048.4092319376 Sum =  410.31296425362507
Iteration =  1  Dual obj =  -0.011675476700973644  Primal_obj =  715.4867157481708  Gap =  715.4983912248717 Sum =  0.9825135826769223
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  0.07293298694845289  Primal_obj =  307.640344833176  Gap =  307.56741184622757 Sum =  0.7472692861618544
Iteration =  5  Dual obj =  0.16601403674150855  Primal_obj =  430.52869290698624  Gap =  430.36267887024474 Sum =  0.5446713355012496
Iteration =  6  Dual obj =  0.23066412939669262  Primal_obj =  175.53417565205473  Gap =  175.30351152265803 Sum =  0.5330109243047949
Iteration =  7  Dual obj =  0.263620052359989  Primal_obj =  73.23134289086406  Gap =  72.96772283850407 Sum =  0.8102043780410444
Iteration =  8  Dual obj =  0.2773473992762808  Primal_obj =  22.055893835989693  Gap =  21.778546436713413 Sum =  0.935029413614788
Iteration =  9  Dual obj =  0.28180843688037227  Primal_obj =  5.858133976684098  Gap =  5.576325539803725 Sum =  0.9825028463272596
Iteration =  10  Dual obj =  0.28300370266951236  Primal_obj =  1.930111472225919  Gap =  1.6471077695564067 Sum =  0.9970506949214163
Iteration =  11  Dual obj =  0.2833192549434621  Primal_obj =  0.79464860734676  Gap =  0.5113293524032979 Sum =  1.0004177656080495
Iteration =  12  Dual obj =  0.28343708658667305  Primal_obj =  0.5263693627738406  Gap =  0.24293227618716756 Sum =  0.9992522128995118
Iteration =  13  Dual obj =  0.2834837565239453  Primal_obj =  0.38282788943548574  Gap =  0.09934413291154043 Sum =  1.0008791994599635
Iteration =  14  Dual obj =  0.2835080546028974  Primal_obj =  0.35283628218260243  Gap =  0.06932822757970503 Sum =  1.000616704643419
Iteration =  15  Dual obj =  0.28351904297370856  Primal_obj =  0.30435158389892597  Gap =  0.020832540925217413 Sum =  1.000078545892202
Iteration =  16  Dual obj =  0.2835250886905195  Primal_obj =  0.29416713544425543  Gap =  0.010642046753735923 Sum =  1.0003506344573205
Iteration =  17  Dual obj =  0.28352777699770915  Primal_obj =  0.28753595079786254  Gap =  0.004008173800153392 Sum =  1.000194107537042
Iteration =  18  Dual obj =  0.2835281258344054  Primal_obj =  0.2849720652190175  Gap =  0.0014439393846121251 Sum =  1.000021220173154
Iteration =  19  Dual obj =  0.28352828163194554  Primal_obj =  0.2850509149720416  Gap =  0.0015226333400960579 Sum =  0.9999749843837359
Iteration =  20  Dual obj =  0.28352851788684486  Primal_obj =  0.2846563301996104  Gap =  0.0011278123127655415 Sum =  0.9998135398038036
Iteration =  21  Dual obj =  0.28352866260701975  Primal_obj =  0.28410211921624345  Gap =  0.0005734566092236992 Sum =  1.0000071657430392
Iteration =  22  Dual obj =  0.2835287280212472  Primal_obj =  0.2840146910802993  Gap =  0.0004859630590521302 Sum =  1.0000673254976937
Iteration =  23  Dual obj =  0.28352877664879983  Primal_obj =  0.28360553871606997  Gap =  7.67620672701419e-05 Sum =  0.9999906540143809
Iteration =  24  Dual obj =  0.28352877753466693  Primal_obj =  0.2835947939782493  Gap =  6.601644358239511e-05 Sum =  0.9999896585196469
Iteration =  0  Dual obj =  -17.943225151206857  Primal_obj =  334112.72982262797  Gap =  334130.6730477792 Sum =  410.31296425362507
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.16731685458197074  Primal_obj =  1483.6813173143678  Gap =  1483.8486341689497 Sum =  2.4376587909305245
Iteration =  4  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  5  Dual obj =  0.2245868507237145  Primal_obj =  508.25987656668883  Gap =  508.0352897159651 Sum =  0.8559054232559719
Iteration =  6  Dual obj =  0.38646565218578455  Primal_obj =  385.0530171346707  Gap =  384.6665514824849 Sum =  0.5329385923483934
Iteration =  7  Dual obj =  0.4820272147996119  Primal_obj =  223.96427988286325  Gap =  223.48225266806364 Sum =  1.7333743169148743
Iteration =  8  Dual obj =  0.5095887910609722  Primal_obj =  87.41316283025343  Gap =  86.90357403919245 Sum =  0.8230164788265837
Iteration =  9  Dual obj =  0.5221397868165947  Primal_obj =  58.65369897637757  Gap =  58.131559189560974 Sum =  1.245342136932631
Iteration =  10  Dual obj =  0.5311028548424886  Primal_obj =  45.822369528760056  Gap =  45.29126667391757 Sum =  0.9589221829704154
Iteration =  11  Dual obj =  0.536029088921766  Primal_obj =  28.659086050780537  Gap =  28.123056961858772 Sum =  1.086331289565776
Iteration =  12  Dual obj =  0.5384839259068522  Primal_obj =  19.482112656861563  Gap =  18.94362873095471 Sum =  0.992440072144804
Iteration =  13  Dual obj =  0.5398005829492314  Primal_obj =  10.434472628873507  Gap =  9.894672045924276 Sum =  1.0336311772086006
Iteration =  14  Dual obj =  0.5405382629847494  Primal_obj =  7.974927961276184  Gap =  7.434389698291435 Sum =  1.0054427672642399
Iteration =  15  Dual obj =  0.5411522068924046  Primal_obj =  5.165013140911598  Gap =  4.623860934019193 Sum =  1.0166334582177567
Iteration =  16  Dual obj =  0.5414457165400159  Primal_obj =  3.149069281763212  Gap =  2.6076235652231965 Sum =  1.008753283798184
Iteration =  17  Dual obj =  0.5416878999972123  Primal_obj =  2.9221829734522853  Gap =  2.380495073455073 Sum =  1.005383731821461
Iteration =  18  Dual obj =  0.541893048242889  Primal_obj =  2.3128542666959597  Gap =  1.7709612184530708 Sum =  1.0079358905885338
Iteration =  19  Dual obj =  0.5420536905576935  Primal_obj =  1.7717948080833013  Gap =  1.2297411175256077 Sum =  1.001709683204656
Iteration =  20  Dual obj =  0.5421678838429391  Primal_obj =  1.5628444540808593  Gap =  1.0206765702379201 Sum =  0.9998781074539216
Iteration =  21  Dual obj =  0.542230088892186  Primal_obj =  1.108695817147154  Gap =  0.5664657282549679 Sum =  1.0003903557871694
Iteration =  22  Dual obj =  0.5422695928364142  Primal_obj =  0.9918254313863407  Gap =  0.44955583854992653 Sum =  0.9999006979024807
Iteration =  23  Dual obj =  0.5423035881900595  Primal_obj =  0.9369987346734989  Gap =  0.3946951464834394 Sum =  0.9999042961517106
Iteration =  24  Dual obj =  0.5423336915875103  Primal_obj =  0.8726148688854488  Gap =  0.3302811772979385 Sum =  0.9998864619847846
Iteration =  0  Dual obj =  0.5423336915875103  Primal_obj =  0.8726148688854488  Gap =  0.3302811772979385 Sum =  0.9998864619847846
Iteration =  1  Dual obj =  0.5423538859078434  Primal_obj =  0.7622129680370673  Gap =  0.2198590821292239 Sum =  0.9993619927605983
Iteration =  2  Dual obj =  0.5423770216573486  Primal_obj =  0.7652837337470895  Gap =  0.2229067120897409 Sum =  1.0025360227070061
Iteration =  3  Dual obj =  0.5423977173032323  Primal_obj =  0.6826692876744758  Gap =  0.1402715703712435 Sum =  0.9996673301177459
Iteration =  4  Dual obj =  0.5424097921832145  Primal_obj =  0.6461615840482728  Gap =  0.10375179186505834 Sum =  1.0008963809469726
Iteration =  5  Dual obj =  0.5424187783763468  Primal_obj =  0.6353960262361953  Gap =  0.09297724785984851 Sum =  1.0003379305584974
Iteration =  6  Dual obj =  0.5424252375708193  Primal_obj =  0.6177867732679023  Gap =  0.07536153569708304 Sum =  1.0000492298666912
Iteration =  7  Dual obj =  0.5424300275755093  Primal_obj =  0.6041348501830017  Gap =  0.06170482260749244 Sum =  1.0003363727532877
Iteration =  8  Dual obj =  0.5424337642055383  Primal_obj =  0.592578774891601  Gap =  0.050145010686062697 Sum =  1.000076403526972
Iteration =  9  Dual obj =  0.5424368879202868  Primal_obj =  0.5817348300990797  Gap =  0.0392979421787929 Sum =  1.0001708833397767
Iteration =  10  Dual obj =  0.5424390398026795  Primal_obj =  0.5767017208395858  Gap =  0.03426268103690633 Sum =  1.000358634734965
Iteration =  11  Dual obj =  0.5424408156952883  Primal_obj =  0.5731490025512589  Gap =  0.030708186855970543 Sum =  1.0002802822971222
Iteration =  12  Dual obj =  0.54244246841411  Primal_obj =  0.5700576491173419  Gap =  0.02761518070323188 Sum =  1.000128220851269
Iteration =  13  Dual obj =  0.5424438129289433  Primal_obj =  0.5636485714511759  Gap =  0.02120475852223258 Sum =  1.0001599219076491
Iteration =  14  Dual obj =  0.5424447059544895  Primal_obj =  0.5582203726693531  Gap =  0.015775666714863634 Sum =  0.9999442926527772
Iteration =  15  Dual obj =  0.5424453050324272  Primal_obj =  0.5555399624270349  Gap =  0.01309465739460769 Sum =  1.0000041822883539
Iteration =  16  Dual obj =  0.5424457728646068  Primal_obj =  0.5537848044904354  Gap =  0.01133903162582861 Sum =  0.9998539153835637
Iteration =  17  Dual obj =  0.5424461763885989  Primal_obj =  0.5531598583068018  Gap =  0.010713681918202878 Sum =  1.0000497971062055
Iteration =  18  Dual obj =  0.5424465737776402  Primal_obj =  0.5536429377783503  Gap =  0.011196364000710113 Sum =  0.9999453728380681
Iteration =  19  Dual obj =  0.5424470816833578  Primal_obj =  0.5529477647956156  Gap =  0.010500683112257825 Sum =  0.9998469730841404
Iteration =  20  Dual obj =  0.5424474684919922  Primal_obj =  0.5514079247494871  Gap =  0.008960456257494864 Sum =  1.00000887940876
Iteration =  21  Dual obj =  0.5424477077992236  Primal_obj =  0.5493780657506938  Gap =  0.006930357951470234 Sum =  0.9999524064225803
Iteration =  22  Dual obj =  0.5424478747512447  Primal_obj =  0.5485035810793071  Gap =  0.006055706328062405 Sum =  1.0001132730137225
Iteration =  23  Dual obj =  0.5424480215358515  Primal_obj =  0.5484464202684621  Gap =  0.005998398732610655 Sum =  1.0001450808697334
Iteration =  24  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  0  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  1  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  2  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  3  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  4  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  5  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  6  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  7  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  8  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  9  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  10  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  11  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  12  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  13  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  14  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  15  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  16  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  17  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  18  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  19  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  20  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  21  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  22  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  23  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  24  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  0  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  1  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  2  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  3  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  4  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  5  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  6  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  7  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  8  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  9  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  10  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  11  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  12  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  13  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  14  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  15  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  16  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  17  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  18  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  19  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  20  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  21  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  22  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  23  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Iteration =  24  Dual obj =  0.5424481630067166  Primal_obj =  0.5487235563934492  Gap =  0.006275393386732553 Sum =  1.000043071569489
Done, writing results...
