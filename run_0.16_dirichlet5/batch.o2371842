2021-04-29 12:39:17,824 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.08s.
2021-04-29 12:39:18,230 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.21s.
2021-04-29 12:39:18,624 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.39s.
2021-04-29 12:39:18,741 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-29 12:39:18,744 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 12:39:18,754 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 12:39:19,640 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 108.
2021-04-29 12:39:19,641 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.90s.
Iteration =  0  Dual obj =  -23.43649715136055  Primal_obj =  461297.28051564173  Gap =  461320.7170127931 Sum =  324.64421258796335
Iteration =  1  Dual obj =  0.03813569006599436  Primal_obj =  948.6705747876781  Gap =  948.6324390976121 Sum =  1.1595215776586048
Iteration =  2  Dual obj =  0.1457469420193559  Primal_obj =  378.2683805267907  Gap =  378.12263358477134 Sum =  0.5144452841910001
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  4  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  5  Dual obj =  0.21701372296273777  Primal_obj =  304.6408524749246  Gap =  304.42383875196185 Sum =  0.538236098889531
Iteration =  6  Dual obj =  0.2704492850990052  Primal_obj =  246.41248066224708  Gap =  246.14203137714807 Sum =  0.6627486600710866
Iteration =  7  Dual obj =  0.3309982907509691  Primal_obj =  121.86065057426164  Gap =  121.52965228351067 Sum =  0.6689036913808266
Iteration =  8  Dual obj =  0.3519949381993929  Primal_obj =  24.79646645589947  Gap =  24.444471517700077 Sum =  1.0358245416493415
Iteration =  9  Dual obj =  0.3568528902795135  Primal_obj =  7.740390209363094  Gap =  7.3835373190835805 Sum =  0.9941250355517455
Iteration =  10  Dual obj =  0.3583482522405492  Primal_obj =  2.911626099093849  Gap =  2.5532778468533 Sum =  0.9993733105766728
Iteration =  11  Dual obj =  0.35883103024022145  Primal_obj =  1.3234645540700918  Gap =  0.9646335238298703 Sum =  1.0020070235901648
Iteration =  12  Dual obj =  0.3589790049843836  Primal_obj =  0.7487247260938246  Gap =  0.38974572110944095 Sum =  1.000281709738563
Iteration =  13  Dual obj =  0.359034614672194  Primal_obj =  0.5124358904032765  Gap =  0.15340127573108253 Sum =  0.9992899431288107
Iteration =  14  Dual obj =  0.35905193548993947  Primal_obj =  0.42597177327013425  Gap =  0.06691983778019478 Sum =  1.000085175832309
Iteration =  15  Dual obj =  0.3590608078695687  Primal_obj =  0.40189622602740477  Gap =  0.04283541815783609 Sum =  1.000323986054641
Iteration =  16  Dual obj =  0.35906646794567987  Primal_obj =  0.38842667648704593  Gap =  0.029360208541366062 Sum =  0.9998907240687527
Iteration =  17  Dual obj =  0.3590699600640781  Primal_obj =  0.3775866727593873  Gap =  0.01851671269530919 Sum =  1.000076572914527
Iteration =  18  Dual obj =  0.359072585886172  Primal_obj =  0.3730658062854488  Gap =  0.013993220399276751 Sum =  0.9999836536936225
Iteration =  19  Dual obj =  0.35907375341894676  Primal_obj =  0.365919407137264  Gap =  0.006845653718317246 Sum =  0.9999465684523374
Iteration =  20  Dual obj =  0.35907446154854405  Primal_obj =  0.36373877248608166  Gap =  0.004664310937537608 Sum =  0.9999560663661753
Iteration =  21  Dual obj =  0.3590750744543233  Primal_obj =  0.3645154605963007  Gap =  0.0054403861419773936 Sum =  1.0001718060893405
Iteration =  22  Dual obj =  0.35907555568990474  Primal_obj =  0.36086546134737346  Gap =  0.0017899056574687267 Sum =  0.9999416964752127
Iteration =  23  Dual obj =  0.3590757070620483  Primal_obj =  0.3599178184929763  Gap =  0.0008421114309280497 Sum =  1.0000145548339154
Iteration =  24  Dual obj =  0.35907578021609843  Primal_obj =  0.3594188983627129  Gap =  0.00034311814661447393 Sum =  1.0000123286331797
Iteration =  0  Dual obj =  -16.191419411117273  Primal_obj =  390313.7393002282  Gap =  390329.9307196393 Sum =  324.64421258796335
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  0.12797406180110998  Primal_obj =  1333.144212918948  Gap =  1333.0162388571468 Sum =  1.0858003851573328
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  5  Dual obj =  0.2709155222446324  Primal_obj =  624.6105840216371  Gap =  624.3396684993925 Sum =  0.9587520640836158
Iteration =  6  Dual obj =  0.4589251999398758  Primal_obj =  433.6258487010916  Gap =  433.16692350115176 Sum =  0.38465236369814765
Iteration =  7  Dual obj =  0.5495736696639668  Primal_obj =  350.0333789287883  Gap =  349.4838052591243 Sum =  1.6533645447003422
Iteration =  8  Dual obj =  0.5928127025838317  Primal_obj =  166.14473976030655  Gap =  165.5519270577227 Sum =  0.5663768397152267
Iteration =  9  Dual obj =  0.6303498995576029  Primal_obj =  128.63896198312563  Gap =  128.008612083568 Sum =  1.3688950153655473
Iteration =  10  Dual obj =  0.6534592804820383  Primal_obj =  66.27839135864872  Gap =  65.62493207816668 Sum =  0.952834767252001
Iteration =  11  Dual obj =  0.6629871999645334  Primal_obj =  36.22917444906708  Gap =  35.56618724910255 Sum =  1.1385727946199915
Iteration =  12  Dual obj =  0.6671978115246426  Primal_obj =  22.22541180749847  Gap =  21.55821399597383 Sum =  1.0486266974135265
Iteration =  13  Dual obj =  0.6699876449057123  Primal_obj =  15.043059122825932  Gap =  14.37307147792022 Sum =  1.0350919860251342
Iteration =  14  Dual obj =  0.6714124575017915  Primal_obj =  9.071109942607352  Gap =  8.39969748510556 Sum =  1.0263183000884881
Iteration =  15  Dual obj =  0.6722629705272226  Primal_obj =  5.0679673354556884  Gap =  4.3957043649284655 Sum =  1.011505442421796
Iteration =  16  Dual obj =  0.6726564616920157  Primal_obj =  3.4977623539280507  Gap =  2.825105892236035 Sum =  1.023215122353438
Iteration =  17  Dual obj =  0.6729802029609872  Primal_obj =  3.048053134976405  Gap =  2.375072932015418 Sum =  1.005176837690027
Iteration =  18  Dual obj =  0.6732587602385569  Primal_obj =  2.4214826446622837  Gap =  1.7482238844237268 Sum =  1.0135891162931125
Iteration =  19  Dual obj =  0.6734313492037992  Primal_obj =  1.576702439754592  Gap =  0.9032710905507927 Sum =  1.006758575262717
Iteration =  20  Dual obj =  0.6735259292095921  Primal_obj =  1.3740166567016643  Gap =  0.7004907274920722 Sum =  1.0007258463765398
Iteration =  21  Dual obj =  0.6735870035359053  Primal_obj =  1.1955788259934896  Gap =  0.5219918224575844 Sum =  1.0042874880231571
Iteration =  22  Dual obj =  0.6736341055842638  Primal_obj =  1.0521985808414094  Gap =  0.37856447525714554 Sum =  1.0012368510714587
Iteration =  23  Dual obj =  0.6736698010735245  Primal_obj =  0.9791722717218492  Gap =  0.3055024706483247 Sum =  0.9998775892252203
Iteration =  24  Dual obj =  0.6736983194268783  Primal_obj =  0.94351648757861  Gap =  0.26981816815173165 Sum =  1.0011964920893663
Iteration =  0  Dual obj =  0.6736983194268783  Primal_obj =  0.94351648757861  Gap =  0.26981816815173165 Sum =  1.0011964920893663
Iteration =  1  Dual obj =  0.6737192742428348  Primal_obj =  0.8875961373232837  Gap =  0.21387686308044884 Sum =  0.9981265735924503
Iteration =  2  Dual obj =  0.6737479800433901  Primal_obj =  0.8037813790151744  Gap =  0.13003339897178434 Sum =  1.0016082454786108
Iteration =  3  Dual obj =  0.6737636940233257  Primal_obj =  0.7762474094786287  Gap =  0.10248371545530299 Sum =  1.0012191286622807
Iteration =  4  Dual obj =  0.6737744936807978  Primal_obj =  0.7721815337201182  Gap =  0.09840704003932044 Sum =  1.001763056156808
Iteration =  5  Dual obj =  0.6737823778485355  Primal_obj =  0.7361144838082035  Gap =  0.062332105959668094 Sum =  0.9991893227813318
Iteration =  6  Dual obj =  0.6737863386603072  Primal_obj =  0.7204021873210654  Gap =  0.046615848660758186 Sum =  0.9993205246089857
Iteration =  7  Dual obj =  0.6737899196329384  Primal_obj =  0.7147502359248611  Gap =  0.04096031629192265 Sum =  0.9993230299730431
Iteration =  8  Dual obj =  0.6737931320700538  Primal_obj =  0.7105981698322962  Gap =  0.03680503776224242 Sum =  0.9996856479205529
Iteration =  9  Dual obj =  0.673795478337353  Primal_obj =  0.7015208055704274  Gap =  0.027725327233074415 Sum =  1.000242485925229
Iteration =  10  Dual obj =  0.6737972166417088  Primal_obj =  0.6946900254492093  Gap =  0.02089280880750055 Sum =  1.0004413520343571
Iteration =  11  Dual obj =  0.6737988493953286  Primal_obj =  0.6903184404037261  Gap =  0.016519591008397505 Sum =  1.0000997754496073
Iteration =  12  Dual obj =  0.673799630719902  Primal_obj =  0.6836806196461517  Gap =  0.009880988926249668 Sum =  0.9998151407058569
Iteration =  13  Dual obj =  0.6738001053605045  Primal_obj =  0.6825077378630182  Gap =  0.008707632502513718 Sum =  0.9998124936099779
Iteration =  14  Dual obj =  0.6738007279857335  Primal_obj =  0.6820379464258322  Gap =  0.008237218440098615 Sum =  0.9998823813933322
Iteration =  15  Dual obj =  0.6738011488195358  Primal_obj =  0.679343643655973  Gap =  0.005542494836437206 Sum =  0.9999952820252789
Iteration =  16  Dual obj =  0.6738014445009349  Primal_obj =  0.6782790755955889  Gap =  0.004477631094653933 Sum =  1.0000574338701176
Iteration =  17  Dual obj =  0.6738016179467442  Primal_obj =  0.6777560277362925  Gap =  0.003954409789548308 Sum =  1.000080612616115
Iteration =  18  Dual obj =  0.6738018249106493  Primal_obj =  0.6776597830680997  Gap =  0.0038579581574503807 Sum =  1.0000234457215127
Iteration =  19  Dual obj =  0.6738020610870579  Primal_obj =  0.6782556937398196  Gap =  0.004453632652761774 Sum =  0.9999603978140992
Iteration =  20  Dual obj =  0.6738022688963677  Primal_obj =  0.6776599740469771  Gap =  0.0038577051506093474 Sum =  0.9998606540599514
Iteration =  21  Dual obj =  0.673802414302424  Primal_obj =  0.6771817258123813  Gap =  0.0033793115099572946 Sum =  0.9999118491902514
Iteration =  22  Dual obj =  0.6738024828798248  Primal_obj =  0.6769658355953295  Gap =  0.003163352715504719 Sum =  1.0000157915117132
Iteration =  23  Dual obj =  0.6738024858988297  Primal_obj =  0.6769631324503315  Gap =  0.0031606465515017224 Sum =  1.000048726376558
Iteration =  24  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  0  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  1  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  2  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  3  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  4  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  5  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  6  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  7  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  8  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  9  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  10  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  11  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  12  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  13  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  14  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  15  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  16  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  17  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  18  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  19  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  20  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  21  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  22  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  23  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  24  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  0  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  1  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  2  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  3  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  4  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  5  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  6  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  7  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  8  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  9  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  10  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  11  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  12  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  13  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  14  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  15  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  16  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  17  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  18  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  19  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  20  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  21  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  22  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  23  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Iteration =  24  Dual obj =  0.6738025117361433  Primal_obj =  0.6768572460231855  Gap =  0.0030547342870422822 Sum =  0.9999860705353648
Done, writing results...
