2021-04-26 23:05:15,785 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.28s.
2021-04-26 23:05:16,240 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.24s.
2021-04-26 23:05:16,658 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.42s.
2021-04-26 23:05:16,781 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.12s.
2021-04-26 23:05:16,784 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-26 23:05:16,795 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-26 23:05:17,663 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 118.
2021-04-26 23:05:17,664 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.88s.
Iteration =  0  Dual obj =  -45.270752457984635  Primal_obj =  16587.93264373861  Gap =  16633.203396196597 Sum =  373.0011530223145
Iteration =  1  Dual obj =  -0.11691655595784765  Primal_obj =  6.607921187557984  Gap =  6.724837743515832 Sum =  0.77645607616485
Iteration =  2  Dual obj =  -0.09397787776495337  Primal_obj =  2.2583692572300738  Gap =  2.352347134995027 Sum =  0.9185884780310791
Iteration =  3  Dual obj =  -0.08816790535719171  Primal_obj =  1.421791451468975  Gap =  1.5099593568261667 Sum =  0.9423260453613502
Iteration =  4  Dual obj =  -0.08596504973260893  Primal_obj =  0.9809040544482205  Gap =  1.0668691041808294 Sum =  0.9763393943818209
Iteration =  5  Dual obj =  -0.08475045500389763  Primal_obj =  0.6158706094344815  Gap =  0.7006210644383791 Sum =  1.0028172648900913
Iteration =  6  Dual obj =  -0.08379346191259236  Primal_obj =  0.37070368230301265  Gap =  0.454497144215605 Sum =  1.0007864356639056
Iteration =  7  Dual obj =  -0.08324536331676803  Primal_obj =  0.1952618973192382  Gap =  0.2785072606360062 Sum =  1.0008805881420155
Iteration =  8  Dual obj =  -0.08297288023019248  Primal_obj =  0.09104816732310661  Gap =  0.17402104755329909 Sum =  0.9989259573435599
Iteration =  9  Dual obj =  -0.08282750192969808  Primal_obj =  0.032072174569419604  Gap =  0.11489967649911768 Sum =  0.9960197364624251
Iteration =  10  Dual obj =  -0.08273027418264262  Primal_obj =  -0.0028360120415897028  Gap =  0.07989426214105291 Sum =  0.9959364879449122
Iteration =  11  Dual obj =  -0.08266448715328796  Primal_obj =  -0.03051046202213814  Gap =  0.05215402513114982 Sum =  0.9984309355523253
Iteration =  12  Dual obj =  -0.08262270134663027  Primal_obj =  -0.052181314693626094  Gap =  0.03044138665300418 Sum =  0.9983908956299371
Iteration =  13  Dual obj =  -0.08260017298716568  Primal_obj =  -0.06425044557528443  Gap =  0.018349727411881248 Sum =  0.9992703480067309
Iteration =  14  Dual obj =  -0.0825882285216617  Primal_obj =  -0.07096869080466987  Gap =  0.011619537716991826 Sum =  0.9992203272525195
Iteration =  15  Dual obj =  -0.08258121623687407  Primal_obj =  -0.0753032879684358  Gap =  0.0072779282684382746 Sum =  0.9998194207042623
Iteration =  16  Dual obj =  -0.08257676242819961  Primal_obj =  -0.07746795781177195  Gap =  0.005108804616427667 Sum =  0.9999539179304845
Iteration =  17  Dual obj =  -0.08257365393356067  Primal_obj =  -0.07882375729496875  Gap =  0.003749896638591918 Sum =  0.9996027842147683
Iteration =  18  Dual obj =  -0.08257174257466833  Primal_obj =  -0.07975768850448174  Gap =  0.002814054070186589 Sum =  0.9996492126185854
Iteration =  19  Dual obj =  -0.0825703150086377  Primal_obj =  -0.080540139284578  Gap =  0.00203017572405971 Sum =  0.9999040370354321
Iteration =  20  Dual obj =  -0.08256940819763818  Primal_obj =  -0.08106525557274458  Gap =  0.0015041526248936038 Sum =  0.9998821214086946
Iteration =  21  Dual obj =  -0.08256878959545427  Primal_obj =  -0.08143770131558363  Gap =  0.0011310882798706429 Sum =  0.9998511815606055
Iteration =  22  Dual obj =  -0.08256837589615001  Primal_obj =  -0.08169456114568723  Gap =  0.0008738147504627897 Sum =  0.999930102816716
Iteration =  23  Dual obj =  -0.08256808810975161  Primal_obj =  -0.08188500105421419  Gap =  0.0006830870555374208 Sum =  0.9999941613051699
Iteration =  24  Dual obj =  -0.08256788805832013  Primal_obj =  -0.0820138740599224  Gap =  0.0005540139983977316 Sum =  0.9999962357287732
Iteration =  0  Dual obj =  -37.00089423907215  Primal_obj =  13784.065983510493  Gap =  13821.066877749565 Sum =  373.0011530223145
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  -0.45923442538724174  Primal_obj =  207.8381843229455  Gap =  208.29741874833275 Sum =  13.096268725098245
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  4  Dual obj =  -0.15559599383380315  Primal_obj =  7.586863753745958  Gap =  7.742459747579761 Sum =  0.7967743297115761
Iteration =  5  Dual obj =  -0.136806342691991  Primal_obj =  7.225199112769931  Gap =  7.362005455461922 Sum =  1.091504844966829
Iteration =  6  Dual obj =  -0.12624723468207233  Primal_obj =  5.74817636159112  Gap =  5.874423596273192 Sum =  0.8348212780430575
Iteration =  7  Dual obj =  -0.11939514444928183  Primal_obj =  7.85723637705824  Gap =  7.976631521507522 Sum =  0.9676355316117016
Iteration =  8  Dual obj =  -0.11041128575402098  Primal_obj =  6.511987114174231  Gap =  6.622398399928253 Sum =  1.038379133527994
Iteration =  9  Dual obj =  -0.09976002961400826  Primal_obj =  5.240140625323924  Gap =  5.339900654937932 Sum =  0.9681461413674467
Iteration =  10  Dual obj =  -0.09645937591330915  Primal_obj =  5.615350378745545  Gap =  5.711809754658854 Sum =  0.94799404209876
Iteration =  11  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.125000
Iteration =  12  Dual obj =  -0.09142596528915357  Primal_obj =  3.7909260706790273  Gap =  3.882352035968181 Sum =  0.9884106471343506
Iteration =  13  Dual obj =  -0.08777255802235834  Primal_obj =  3.429247957007608  Gap =  3.5170205150299663 Sum =  0.9609262217153214
Iteration =  14  Dual obj =  -0.08396648843487137  Primal_obj =  2.9600656702467503  Gap =  3.0440321586816217 Sum =  0.9196412781053386
Iteration =  15  Dual obj =  -0.07771842083434458  Primal_obj =  2.5178250796268515  Gap =  2.595543500461196 Sum =  0.9292329514874145
Iteration =  16  Dual obj =  -0.07632854296671723  Primal_obj =  2.3205879596243486  Gap =  2.3969165025910657 Sum =  0.959787132666191
Iteration =  17  Dual obj =  -0.07491809284120102  Primal_obj =  2.079033202232915  Gap =  2.1539512950741164 Sum =  0.9327404449791096
Iteration =  18  Dual obj =  -0.07348919968719445  Primal_obj =  1.6989816790708123  Gap =  1.7724708787580068 Sum =  0.9400120216146968
Iteration =  19  Dual obj =  -0.07301976964922302  Primal_obj =  1.6999895223176924  Gap =  1.7730092919669154 Sum =  0.9429594449562229
Iteration =  20  Dual obj =  -0.07238004779640522  Primal_obj =  1.523281755674061  Gap =  1.5956618034704662 Sum =  0.93757276704661
Iteration =  21  Dual obj =  -0.07174417641143313  Primal_obj =  1.4380624333124237  Gap =  1.5098066097238567 Sum =  0.9443729665529038
Iteration =  22  Dual obj =  -0.07112202160432768  Primal_obj =  1.2737551579564994  Gap =  1.344877179560827 Sum =  0.951091673165744
Iteration =  23  Dual obj =  -0.0706385122628115  Primal_obj =  1.089835218599421  Gap =  1.1604737308622324 Sum =  0.9582805230091958
Iteration =  24  Dual obj =  -0.07021525221483911  Primal_obj =  0.9991743419050994  Gap =  1.0693895941199385 Sum =  0.9614881260443253
Iteration =  0  Dual obj =  -0.07021525221483911  Primal_obj =  0.9991743419050994  Gap =  1.0693895941199385 Sum =  0.9614881260443253
Iteration =  1  Dual obj =  -0.07001874658613033  Primal_obj =  0.9138586076031373  Gap =  0.9838773541892676 Sum =  0.9626342108519326
Iteration =  2  Dual obj =  -0.06970678378265792  Primal_obj =  0.8165142309431888  Gap =  0.8862210147258467 Sum =  0.9662523640202187
Iteration =  3  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  4  Dual obj =  -0.06958939975178569  Primal_obj =  0.7831346963690803  Gap =  0.852724096120866 Sum =  0.9680127222028778
Iteration =  5  Dual obj =  -0.0694506404301893  Primal_obj =  0.7497415624990564  Gap =  0.8191922029292458 Sum =  0.9682717440583907
Iteration =  6  Dual obj =  -0.0691628700765266  Primal_obj =  0.7556818980442697  Gap =  0.8248447681207962 Sum =  0.9781262620577756
Iteration =  7  Dual obj =  -0.06866660372007208  Primal_obj =  0.6941142565399155  Gap =  0.7627808602599876 Sum =  0.9859174661995829
Iteration =  8  Dual obj =  -0.06827514982215754  Primal_obj =  0.5580099447040517  Gap =  0.6262850945262093 Sum =  1.0001540590249105
Iteration =  9  Dual obj =  -0.06801467624521863  Primal_obj =  0.35431690985159403  Gap =  0.42233158609681265 Sum =  1.0021761415279806
Iteration =  10  Dual obj =  -0.06781924422785897  Primal_obj =  0.265506651553586  Gap =  0.33332589578144495 Sum =  0.999242135516905
Iteration =  11  Dual obj =  -0.06767643994414574  Primal_obj =  0.20228728603182788  Gap =  0.2699637259759736 Sum =  0.9991037239398781
Iteration =  12  Dual obj =  -0.06755452261004453  Primal_obj =  0.16897478724926424  Gap =  0.23652930985930876 Sum =  0.9936036390497325
Iteration =  13  Dual obj =  -0.06745085830363201  Primal_obj =  0.14496411028115258  Gap =  0.2124149685847846 Sum =  0.9959400995449501
Iteration =  14  Dual obj =  -0.0673454769308909  Primal_obj =  0.12115606217699737  Gap =  0.18850153910788825 Sum =  0.9987295270369863
Iteration =  15  Dual obj =  -0.06725612225569871  Primal_obj =  0.10713559367700864  Gap =  0.17439171593270736 Sum =  0.9949684986945001
Iteration =  16  Dual obj =  -0.06718087539372451  Primal_obj =  0.07772218160957126  Gap =  0.14490305700329575 Sum =  0.9942625946678658
Iteration =  17  Dual obj =  -0.06712368600301936  Primal_obj =  0.049629958519688155  Gap =  0.11675364452270752 Sum =  0.996187574575434
Iteration =  18  Dual obj =  -0.0670809116857193  Primal_obj =  0.03270016385766156  Gap =  0.09978107554338085 Sum =  0.9963028877172333
Iteration =  19  Dual obj =  -0.06704267430038735  Primal_obj =  0.017838495804458815  Gap =  0.08488117010484617 Sum =  0.9967607877712332
Iteration =  20  Dual obj =  -0.06700549095412818  Primal_obj =  0.005318961189967691  Gap =  0.07232445214409587 Sum =  0.9981521137562204
Iteration =  21  Dual obj =  -0.06696999609547384  Primal_obj =  -0.007012797535135146  Gap =  0.059957198560338695 Sum =  0.9984634200952243
Iteration =  22  Dual obj =  -0.06694236471424818  Primal_obj =  -0.01520901689880115  Gap =  0.05173334781544703 Sum =  0.9979189331814597
Iteration =  23  Dual obj =  -0.06692045486010739  Primal_obj =  -0.02357722641016767  Gap =  0.04334322844993972 Sum =  0.9975988019969261
Iteration =  24  Dual obj =  -0.0669052804259443  Primal_obj =  -0.030082350676784483  Gap =  0.03682292974915982 Sum =  0.9985731902502621
Iteration =  0  Dual obj =  -0.0669052804259443  Primal_obj =  -0.030082350676784483  Gap =  0.03682292974915982 Sum =  0.9985731902502621
Iteration =  1  Dual obj =  -0.06689772169509932  Primal_obj =  -0.033058565888191505  Gap =  0.033839155806907814 Sum =  0.9978819606494017
Iteration =  2  Dual obj =  -0.0668918278840744  Primal_obj =  -0.03581652834466785  Gap =  0.031075299539406548 Sum =  0.9978212936780391
Iteration =  3  Dual obj =  -0.06688697262017428  Primal_obj =  -0.03808721813632905  Gap =  0.028799754483845225 Sum =  0.9980629971014578
Iteration =  4  Dual obj =  -0.06687949261029123  Primal_obj =  -0.040224150127736696  Gap =  0.026655342482554537 Sum =  0.9984612059543373
Iteration =  5  Dual obj =  -0.06687151132872957  Primal_obj =  -0.04187910959055563  Gap =  0.024992401738173936 Sum =  0.9989300064272254
Iteration =  6  Dual obj =  -0.06686305997525002  Primal_obj =  -0.043857182517812635  Gap =  0.023005877457437388 Sum =  0.9993758874436056
Iteration =  7  Dual obj =  -0.06685391716347198  Primal_obj =  -0.046110506814094426  Gap =  0.02074341034937756 Sum =  0.998962122697006
Iteration =  8  Dual obj =  -0.06684568157675867  Primal_obj =  -0.04910865611047051  Gap =  0.017737025466288164 Sum =  0.9996797612510759
Iteration =  9  Dual obj =  -0.0668387410396779  Primal_obj =  -0.0515855723069501  Gap =  0.015253168732727806 Sum =  0.9997709849151105
Iteration =  10  Dual obj =  -0.06683360661410283  Primal_obj =  -0.05318657992849764  Gap =  0.01364702668560519 Sum =  0.9993923165611449
Iteration =  11  Dual obj =  -0.06682913390940354  Primal_obj =  -0.05515849947070675  Gap =  0.011670634438696786 Sum =  0.9989315346801162
Iteration =  12  Dual obj =  -0.06682511721122689  Primal_obj =  -0.05708954897470417  Gap =  0.009735568236522718 Sum =  0.999525514405433
Iteration =  13  Dual obj =  -0.06682199316616913  Primal_obj =  -0.05828747927699321  Gap =  0.008534513889175921 Sum =  0.9998528924570719
Iteration =  14  Dual obj =  -0.06681940516081698  Primal_obj =  -0.05958554940861843  Gap =  0.007233855752198551 Sum =  1.000111369875838
Iteration =  15  Dual obj =  -0.06681706077969268  Primal_obj =  -0.06045091025766375  Gap =  0.006366150522028935 Sum =  0.9996851304052016
Iteration =  16  Dual obj =  -0.06681499237947552  Primal_obj =  -0.06137568596668512  Gap =  0.005439306412790404 Sum =  0.9994867767309159
Iteration =  17  Dual obj =  -0.06681345178733222  Primal_obj =  -0.06202309953984678  Gap =  0.0047903522474854465 Sum =  0.9994687318051713
Iteration =  18  Dual obj =  -0.06681213002653127  Primal_obj =  -0.06253314929460312  Gap =  0.004278980731928159 Sum =  0.9990992606823793
Iteration =  19  Dual obj =  -0.0668110013719185  Primal_obj =  -0.06295933625884988  Gap =  0.003851665113068628 Sum =  0.9992790397364653
Iteration =  20  Dual obj =  -0.06681004467026475  Primal_obj =  -0.063282530085799  Gap =  0.003527514584465749 Sum =  0.9994481163384221
Iteration =  21  Dual obj =  -0.0668092128705058  Primal_obj =  -0.063560225531083  Gap =  0.003248987339422804 Sum =  0.9997011975659928
Iteration =  22  Dual obj =  -0.06680837699622164  Primal_obj =  -0.06386320552936275  Gap =  0.0029451714668588813 Sum =  0.9998332321526129
Iteration =  23  Dual obj =  -0.06680751819681968  Primal_obj =  -0.06410030854617127  Gap =  0.0027072096506484122 Sum =  0.9997899363008753
Iteration =  24  Dual obj =  -0.06680672489816626  Primal_obj =  -0.06435528585209747  Gap =  0.0024514390460687874 Sum =  0.9999006701299207
Iteration =  0  Dual obj =  -0.06680672489816626  Primal_obj =  -0.06435528585209747  Gap =  0.0024514390460687874 Sum =  0.9999006701299207
Iteration =  1  Dual obj =  -0.06680636263073833  Primal_obj =  -0.06448140560070485  Gap =  0.002324957030033478 Sum =  0.9998354287810454
Iteration =  2  Dual obj =  -0.06680594667274384  Primal_obj =  -0.06460189008918107  Gap =  0.0022040565835627635 Sum =  0.9999183409881007
Iteration =  3  Dual obj =  -0.0668057126544183  Primal_obj =  -0.06466703396234871  Gap =  0.002138678692069587 Sum =  0.9997255921869528
Iteration =  4  Dual obj =  -0.06680550648144964  Primal_obj =  -0.06471130015477287  Gap =  0.00209420632667677 Sum =  0.9997217372212672
Iteration =  5  Dual obj =  -0.06680525657973728  Primal_obj =  -0.0647697961625564  Gap =  0.002035460417180876 Sum =  0.999666492873338
Iteration =  6  Dual obj =  -0.06680502875413735  Primal_obj =  -0.0647966215049749  Gap =  0.0020084072491624583 Sum =  0.9996876116153105
Iteration =  7  Dual obj =  -0.06680473413450122  Primal_obj =  -0.06484268216208801  Gap =  0.001962051972413212 Sum =  0.9998772319929207
Iteration =  8  Dual obj =  -0.0668043555274393  Primal_obj =  -0.06489311186408231  Gap =  0.0019112436633569874 Sum =  0.9998911276595785
Iteration =  9  Dual obj =  -0.06680401691183828  Primal_obj =  -0.06493990104344917  Gap =  0.0018641158683891101 Sum =  1.0000729119850615
Iteration =  10  Dual obj =  -0.06680360523673792  Primal_obj =  -0.06499194365188353  Gap =  0.0018116615848543932 Sum =  1.000059461647948
Iteration =  11  Dual obj =  -0.06680311055223288  Primal_obj =  -0.06506362807027423  Gap =  0.001739482481958654 Sum =  1.0001019949703474
Iteration =  12  Dual obj =  -0.06680256799008077  Primal_obj =  -0.06517302529166595  Gap =  0.0016295426984148237 Sum =  0.9998389311086365
Iteration =  13  Dual obj =  -0.06680205329085785  Primal_obj =  -0.06530417255592494  Gap =  0.0014978807349329132 Sum =  0.9997501661306591
Iteration =  14  Dual obj =  -0.06680155735644824  Primal_obj =  -0.0654462101734137  Gap =  0.0013553471830345387 Sum =  0.9999907892112098
Iteration =  15  Dual obj =  -0.06680114625138632  Primal_obj =  -0.06554086893941208  Gap =  0.0012602773119742422 Sum =  0.9998611592951571
Iteration =  16  Dual obj =  -0.06680079580011353  Primal_obj =  -0.06563069651557611  Gap =  0.0011700992845374153 Sum =  0.9999449807970482
Iteration =  17  Dual obj =  -0.06680052116214648  Primal_obj =  -0.0657112897510295  Gap =  0.0010892314111169837 Sum =  0.9998992833174739
Iteration =  18  Dual obj =  -0.06680025418429564  Primal_obj =  -0.06578099604411825  Gap =  0.0010192581401773926 Sum =  0.9999572803513647
Iteration =  19  Dual obj =  -0.06679999321947808  Primal_obj =  -0.06585678248820324  Gap =  0.0009432107312748322 Sum =  0.9998302238658907
Iteration =  20  Dual obj =  -0.06679977639101498  Primal_obj =  -0.06592394234934741  Gap =  0.0008758340416675642 Sum =  0.9999011426252092
Iteration =  21  Dual obj =  -0.06679958880408135  Primal_obj =  -0.06597932383388071  Gap =  0.0008202649702006432 Sum =  0.9998367707035327
Iteration =  22  Dual obj =  -0.06679943459150109  Primal_obj =  -0.06602513293588896  Gap =  0.0007743016556121252 Sum =  0.99983118912642
Iteration =  23  Dual obj =  -0.0667992875548715  Primal_obj =  -0.06606641395240037  Gap =  0.0007328736024711235 Sum =  0.9999544563569239
Iteration =  24  Dual obj =  -0.06679914154185776  Primal_obj =  -0.06611058481316677  Gap =  0.0006885567286909894 Sum =  0.9998717244615254
Done, writing results...
