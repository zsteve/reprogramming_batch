2021-04-29 13:17:09,504 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 3.06s.
2021-04-29 13:17:09,901 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.21s.
2021-04-29 13:17:10,294 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.39s.
2021-04-29 13:17:10,408 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.11s.
2021-04-29 13:17:10,411 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 13:17:10,421 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 13:17:11,223 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 121.
2021-04-29 13:17:11,224 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 0.82s.
Iteration =  0  Dual obj =  -40.017177807000635  Primal_obj =  207987.93966442504  Gap =  208027.95684223203 Sum =  417.5583545879613
Iteration =  1  Dual obj =  -0.012522866162956968  Primal_obj =  250.72970777940168  Gap =  250.74223064556463 Sum =  1.2894856390323142
Iteration =  2  Dual obj =  0.11099382667009325  Primal_obj =  66.38525465359831  Gap =  66.27426082692821 Sum =  0.8487727093243527
Iteration =  3  Dual obj =  0.14284737430265207  Primal_obj =  41.87236354239717  Gap =  41.72951616809451 Sum =  0.674463084146233
Iteration =  4  Dual obj =  0.1647828778266416  Primal_obj =  20.569733315687078  Gap =  20.404950437860435 Sum =  0.7225388426896189
Iteration =  5  Dual obj =  0.17981135650361998  Primal_obj =  6.2891929736070376  Gap =  6.109381617103417 Sum =  0.9149781283365701
Iteration =  6  Dual obj =  0.18373327199592995  Primal_obj =  1.3513394911968029  Gap =  1.167606219200873 Sum =  0.9813112869740048
Iteration =  7  Dual obj =  0.18453368434360282  Primal_obj =  0.46218411734496145  Gap =  0.2776504330013586 Sum =  1.0049168140907865
Iteration =  8  Dual obj =  0.18468051003905805  Primal_obj =  0.25239742561372014  Gap =  0.06771691557466208 Sum =  1.0023664558310155
Iteration =  9  Dual obj =  0.18471454194661674  Primal_obj =  0.20595867916702554  Gap =  0.0212441372204088 Sum =  1.0003536585740527
Iteration =  10  Dual obj =  0.1847232669683409  Primal_obj =  0.19603743932353823  Gap =  0.011314172355197327 Sum =  0.9997167402228041
Iteration =  11  Dual obj =  0.18472693464556664  Primal_obj =  0.19005665018883344  Gap =  0.005329715543266805 Sum =  0.999795707260813
Iteration =  12  Dual obj =  0.18472848695845567  Primal_obj =  0.18685558734960275  Gap =  0.00212710039114708 Sum =  0.9999748780615849
Iteration =  13  Dual obj =  0.1847291606539091  Primal_obj =  0.18618106068712403  Gap =  0.0014519000332149368 Sum =  1.000026849653436
Iteration =  14  Dual obj =  0.18472970731658844  Primal_obj =  0.18555593843974463  Gap =  0.0008262311231561903 Sum =  1.0000347482675105
Iteration =  15  Dual obj =  0.1847299921152147  Primal_obj =  0.18512215806160998  Gap =  0.0003921659463952676 Sum =  1.0000102259270993
Iteration =  16  Dual obj =  0.1847300851536619  Primal_obj =  0.18488812711319436  Gap =  0.00015804195953245115 Sum =  0.9999615744683921
Iteration =  17  Dual obj =  0.18473010934682416  Primal_obj =  0.18484065315001286  Gap =  0.00011054380318870072 Sum =  0.9999950972889518
Iteration =  18  Dual obj =  0.18473011673736695  Primal_obj =  0.18482532021378517  Gap =  9.520347641822635e-05 Sum =  1.000013200478133
Iteration =  19  Dual obj =  0.18473011828411207  Primal_obj =  0.1848208879504672  Gap =  9.076966635512829e-05 Sum =  1.0000220585132165
Iteration =  20  Dual obj =  0.1847301198798812  Primal_obj =  0.18481892302127761  Gap =  8.880314139642076e-05 Sum =  1.0000228952531534
Iteration =  21  Dual obj =  0.1847301198798812  Primal_obj =  0.18481892302127761  Gap =  8.880314139642076e-05 Sum =  1.0000228952531534
Iteration =  22  Dual obj =  0.1847301198798812  Primal_obj =  0.18481892302127761  Gap =  8.880314139642076e-05 Sum =  1.0000228952531534
Iteration =  23  Dual obj =  0.1847301198798812  Primal_obj =  0.18481892302127761  Gap =  8.880314139642076e-05 Sum =  1.0000228952531534
Iteration =  24  Dual obj =  0.1847301198798812  Primal_obj =  0.18481892302127761  Gap =  8.880314139642076e-05 Sum =  1.0000228952531534
Iteration =  0  Dual obj =  -20.798017138546694  Primal_obj =  137583.27826532812  Gap =  137604.07628246667 Sum =  417.5583545879613
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.1881349947691896  Primal_obj =  484.11645942232957  Gap =  484.30459441709877 Sum =  2.990245906370437
Iteration =  4  Dual obj =  0.10561078582769876  Primal_obj =  201.6839656034095  Gap =  201.57835481758178 Sum =  1.0612671995995442
Iteration =  5  Dual obj =  0.19938871600348104  Primal_obj =  79.45761203650424  Gap =  79.25822332050076 Sum =  0.8337307490553042
Iteration =  6  Dual obj =  0.23676411256347993  Primal_obj =  36.525567730242905  Gap =  36.28880361767943 Sum =  0.6424271496277657
Iteration =  7  Dual obj =  0.2563512964388791  Primal_obj =  26.604993286701166  Gap =  26.348641990262287 Sum =  0.6662676192448467
Iteration =  8  Dual obj =  0.26949698119331744  Primal_obj =  16.154803672609912  Gap =  15.885306691416595 Sum =  0.9313647569681152
Iteration =  9  Dual obj =  0.2751080622571323  Primal_obj =  11.393292348889988  Gap =  11.118184286632856 Sum =  0.9898729670505787
Iteration =  10  Dual obj =  0.2786158998216136  Primal_obj =  8.107941386133517  Gap =  7.829325486311903 Sum =  0.9058611828488651
Iteration =  11  Dual obj =  0.28072642266363423  Primal_obj =  5.5826172913381065  Gap =  5.301890868674472 Sum =  1.0052149809039137
Iteration =  12  Dual obj =  0.28189824274139524  Primal_obj =  3.934464178135028  Gap =  3.6525659353936324 Sum =  0.9970671000379492
Iteration =  13  Dual obj =  0.2826560337122887  Primal_obj =  1.9820278532636864  Gap =  1.6993718195513976 Sum =  0.9997700046332012
Iteration =  14  Dual obj =  0.28302491413821895  Primal_obj =  1.3606083735452421  Gap =  1.0775834594070233 Sum =  0.9975919800005805
Iteration =  15  Dual obj =  0.28326100384931624  Primal_obj =  1.2065629061769694  Gap =  0.9233019023276532 Sum =  1.0061919557172616
Iteration =  16  Dual obj =  0.28344497947234387  Primal_obj =  1.0918722218068277  Gap =  0.8084272423344838 Sum =  0.9963177446819351
Iteration =  17  Dual obj =  0.2836189121828306  Primal_obj =  0.9689223006827943  Gap =  0.6853033884999638 Sum =  1.0022592179186005
Iteration =  18  Dual obj =  0.2837377394809111  Primal_obj =  0.8390401692106788  Gap =  0.5553024297297677 Sum =  0.9982939067032688
Iteration =  19  Dual obj =  0.28381354305740525  Primal_obj =  0.638063175737795  Gap =  0.3542496326803898 Sum =  0.9973599240276444
Iteration =  20  Dual obj =  0.2838642263433315  Primal_obj =  0.5659082204863328  Gap =  0.2820439941430013 Sum =  1.000090593613805
Iteration =  21  Dual obj =  0.283909949639528  Primal_obj =  0.5028878198792092  Gap =  0.21897787023968118 Sum =  1.0004734127849986
Iteration =  22  Dual obj =  0.283941569781864  Primal_obj =  0.4275191837924145  Gap =  0.14357761401055047 Sum =  1.000019648161698
Iteration =  23  Dual obj =  0.2839629161414838  Primal_obj =  0.38252950456698015  Gap =  0.09856658842549637 Sum =  1.000155258181475
Iteration =  24  Dual obj =  0.28397736219523656  Primal_obj =  0.36127988819164625  Gap =  0.07730252599640969 Sum =  1.0002260298002354
Iteration =  0  Dual obj =  0.28397736219523656  Primal_obj =  0.36127988819164625  Gap =  0.07730252599640969 Sum =  1.0002260298002354
Iteration =  1  Dual obj =  0.28398793466453576  Primal_obj =  0.31593984758939553  Gap =  0.03195191292485977 Sum =  0.9995531466077212
Iteration =  2  Dual obj =  0.28399356951526145  Primal_obj =  0.3165439840657077  Gap =  0.03255041455044627 Sum =  1.000078192292367
Iteration =  3  Dual obj =  0.28400133773933584  Primal_obj =  0.32197224746220815  Gap =  0.037970909722872315 Sum =  0.9988789630362722
Iteration =  4  Dual obj =  0.2840106858193034  Primal_obj =  0.31451400486163766  Gap =  0.030503319042334276 Sum =  0.9998108225851099
Iteration =  5  Dual obj =  0.2840165657398689  Primal_obj =  0.3108621731153794  Gap =  0.026845607375510505 Sum =  1.0000895613600238
Iteration =  6  Dual obj =  0.2840228413691937  Primal_obj =  0.310624799593485  Gap =  0.02660195822429129 Sum =  0.9993908636617942
Iteration =  7  Dual obj =  0.2840289012918008  Primal_obj =  0.31265194832632115  Gap =  0.028623047034520344 Sum =  1.0006759992044665
Iteration =  8  Dual obj =  0.28403505181389044  Primal_obj =  0.3064402939112734  Gap =  0.022405242097382982 Sum =  0.9994790454191722
Iteration =  9  Dual obj =  0.2840395586462841  Primal_obj =  0.30749680337220464  Gap =  0.023457244725920534 Sum =  1.000556192214645
Iteration =  10  Dual obj =  0.28404362083736917  Primal_obj =  0.2987013007255893  Gap =  0.014657679888220143 Sum =  0.9993863080019673
Iteration =  11  Dual obj =  0.2840459061745349  Primal_obj =  0.2953557011856175  Gap =  0.01130979501108259 Sum =  0.9999255738799009
Iteration =  12  Dual obj =  0.2840477140416782  Primal_obj =  0.29439204176240474  Gap =  0.01034432772072652 Sum =  0.9998198057633965
Iteration =  13  Dual obj =  0.28404925069555026  Primal_obj =  0.29321154201222194  Gap =  0.009162291316671678 Sum =  0.9998902927074743
Iteration =  14  Dual obj =  0.28405066935135403  Primal_obj =  0.2921554524334361  Gap =  0.008104783082082068 Sum =  1.0001458507215495
Iteration =  15  Dual obj =  0.28405191489306136  Primal_obj =  0.291310356682944  Gap =  0.007258441789882664 Sum =  0.9993843136815174
Iteration =  16  Dual obj =  0.28405309446230065  Primal_obj =  0.29096883454306993  Gap =  0.006915740080769284 Sum =  1.0003266709189793
Iteration =  17  Dual obj =  0.2840540928277293  Primal_obj =  0.29060683121481007  Gap =  0.006552738387080759 Sum =  0.9998381684412971
Iteration =  18  Dual obj =  0.2840551755570275  Primal_obj =  0.29087124493968397  Gap =  0.006816069382656498 Sum =  1.0003304471913337
Iteration =  19  Dual obj =  0.28405630897491607  Primal_obj =  0.2914249555998351  Gap =  0.00736864662491904 Sum =  0.9999788722379497
Iteration =  20  Dual obj =  0.28405743199382516  Primal_obj =  0.29083003888681114  Gap =  0.006772606892985977 Sum =  1.000027709805823
Iteration =  21  Dual obj =  0.2840584278850776  Primal_obj =  0.29020189039850275  Gap =  0.006143462513425124 Sum =  1.000265845303055
Iteration =  22  Dual obj =  0.2840593638334657  Primal_obj =  0.29021742187835103  Gap =  0.0061580580448853395 Sum =  0.999929654974756
Iteration =  23  Dual obj =  0.284060163052839  Primal_obj =  0.2904504174492069  Gap =  0.006390254396367923 Sum =  0.9997873381295812
Iteration =  24  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  0  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  1  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  2  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  3  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  4  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  5  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  6  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  7  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  8  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  9  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  10  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  11  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  12  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  13  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  14  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  15  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  16  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  17  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  18  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  19  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  20  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  21  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  22  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  23  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  24  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  0  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  1  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  2  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  3  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  4  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  5  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  6  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  7  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  8  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  9  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  10  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  11  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  12  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  13  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  14  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  15  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  16  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  17  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  18  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  19  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  20  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  21  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  22  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  23  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Iteration =  24  Dual obj =  0.28406095576413815  Primal_obj =  0.28944391297467387  Gap =  0.0053829572105357215 Sum =  1.000177031757695
Done, writing results...
