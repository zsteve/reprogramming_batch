2021-04-29 13:24:39,023 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 5.13s.
2021-04-29 13:24:39,580 - pegasus.tools.preprocessing - INFO - Function 'pca' finished in 0.31s.
2021-04-29 13:24:40,132 - pegasus.tools.nearest_neighbors - INFO - Function 'get_neighbors' finished in 0.55s.
2021-04-29 13:24:40,294 - pegasus.tools.nearest_neighbors - INFO - Function 'calculate_affinity_matrix' finished in 0.16s.
2021-04-29 13:24:40,298 - pegasus.tools.diffusion_map - INFO - Calculating connected components is done.
2021-04-29 13:24:40,311 - pegasus.tools.diffusion_map - INFO - Calculating normalized affinity matrix is done.
2021-04-29 13:24:41,356 - pegasus.tools.diffusion_map - INFO - Detected knee point at t = 104.
2021-04-29 13:24:41,357 - pegasus.tools.diffusion_map - INFO - Function 'diffmap' finished in 1.06s.
Iteration =  0  Dual obj =  -43.88878139163424  Primal_obj =  2479351.2392010842  Gap =  2479395.127982476 Sum =  399.3157420543939
Iteration =  1  Dual obj =  -0.000995264586860889  Primal_obj =  4390.7886191577445  Gap =  4390.789614422331 Sum =  1.352685120396052
Iteration =  2  Dual obj =  0.1436093981227292  Primal_obj =  1912.392661633705  Gap =  1912.2490522355824 Sum =  0.6739781030932823
Iteration =  3  Dual obj =  0.23862654499994046  Primal_obj =  1139.5825346534596  Gap =  1139.3439081084596 Sum =  0.5067996433437539
Iteration =  4  Dual obj =  0.30098901590153226  Primal_obj =  568.3567157185205  Gap =  568.0557267026189 Sum =  0.7296342552051226
Iteration =  5  Dual obj =  0.32302488661942796  Primal_obj =  110.99976778969935  Gap =  110.67674290307993 Sum =  1.0186830574845012
Iteration =  6  Dual obj =  0.32951836843648574  Primal_obj =  32.239760314865784  Gap =  31.9102419464293 Sum =  1.0080509887880842
Iteration =  7  Dual obj =  0.33201926169888424  Primal_obj =  12.30824223130196  Gap =  11.976222969603077 Sum =  0.993238229717074
Iteration =  8  Dual obj =  0.33280987220746044  Primal_obj =  5.442202239793828  Gap =  5.109392367586368 Sum =  0.9882212124667867
Iteration =  9  Dual obj =  0.3331167185902103  Primal_obj =  2.605751497245606  Gap =  2.2726347786553958 Sum =  1.0007766156406055
Iteration =  10  Dual obj =  0.33322096070124085  Primal_obj =  1.2907540065764156  Gap =  0.9575330458751747 Sum =  0.9994573957363002
Iteration =  11  Dual obj =  0.33327691566250184  Primal_obj =  1.0692176580102395  Gap =  0.7359407423477377 Sum =  0.999454961316585
Iteration =  12  Dual obj =  0.3333028803489719  Primal_obj =  0.5840059624844822  Gap =  0.25070308213551035 Sum =  0.9996304310622159
Iteration =  13  Dual obj =  0.3333180684483338  Primal_obj =  0.5807135785162179  Gap =  0.24739551006788407 Sum =  0.9985766217154926
Iteration =  14  Dual obj =  0.3333278167938213  Primal_obj =  0.44482904660199146  Gap =  0.11150122980817018 Sum =  0.9998307236121691
Iteration =  15  Dual obj =  0.3333342880308766  Primal_obj =  0.43851140551461476  Gap =  0.10517711748373815 Sum =  1.0000344327165296
Iteration =  16  Dual obj =  0.3333392567696554  Primal_obj =  0.40676853735672625  Gap =  0.07342928058707082 Sum =  1.0001089165861357
Iteration =  17  Dual obj =  0.3333432622941872  Primal_obj =  0.3709479779579194  Gap =  0.03760471566373219 Sum =  0.9999943072344428
Iteration =  18  Dual obj =  0.33334554893782425  Primal_obj =  0.36717705307555776  Gap =  0.033831504137733504 Sum =  1.0000144545405982
Iteration =  19  Dual obj =  0.33334666395526424  Primal_obj =  0.3492762464046432  Gap =  0.015929582449378976 Sum =  1.000012158134377
Iteration =  20  Dual obj =  0.3333472725527597  Primal_obj =  0.34623025087227655  Gap =  0.012882978319516847 Sum =  1.0000647064116057
Iteration =  21  Dual obj =  0.33334878133584445  Primal_obj =  0.3540214445603396  Gap =  0.02067266322449518 Sum =  1.000066553091405
Iteration =  22  Dual obj =  0.33334940407597785  Primal_obj =  0.3458730855063473  Gap =  0.012523681430369471 Sum =  0.9998596367068483
Iteration =  23  Dual obj =  0.3333499978636649  Primal_obj =  0.34247444185744735  Gap =  0.009124443993782427 Sum =  0.9999435425665031
Iteration =  24  Dual obj =  0.33335037943237306  Primal_obj =  0.33566455175884913  Gap =  0.0023141723264760716 Sum =  0.999998692961044
Iteration =  0  Dual obj =  -27.874743771485875  Primal_obj =  2039106.2381260893  Gap =  2039134.1128698608 Sum =  399.3157420543939
Iteration =  1  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.500000
Iteration =  2  Dual obj =  nan  Primal_obj =  nan  Gap =  nan Sum =  nan
Warning: NaN encountered, restarting and scaling down learning rate. lr_new = 0.250000
Iteration =  3  Dual obj =  -0.2148148989820926  Primal_obj =  9859.585488999828  Gap =  9859.80030389881 Sum =  3.249992914817271
Iteration =  4  Dual obj =  0.34800224143326586  Primal_obj =  2067.2859275334367  Gap =  2066.9379252920035 Sum =  0.750012986130046
Iteration =  5  Dual obj =  0.49972190741987776  Primal_obj =  1811.701517619805  Gap =  1811.201795712385 Sum =  0.5589379838882826
Iteration =  6  Dual obj =  0.6357174185588342  Primal_obj =  1264.541500682156  Gap =  1263.9057832635972 Sum =  0.48075026276318383
Iteration =  7  Dual obj =  0.7084359715725803  Primal_obj =  849.4254084812117  Gap =  848.716972509639 Sum =  2.255289108959645
Iteration =  8  Dual obj =  0.7559937732456941  Primal_obj =  549.1692505959777  Gap =  548.413256822732 Sum =  1.0600082771593373
Iteration =  9  Dual obj =  0.7915375946260721  Primal_obj =  397.38529693506086  Gap =  396.5937593404348 Sum =  1.1711125314176374
Iteration =  10  Dual obj =  0.8118357576794097  Primal_obj =  270.15234055436594  Gap =  269.3405047966865 Sum =  1.2680599828244752
Iteration =  11  Dual obj =  0.825283075864724  Primal_obj =  189.95149432677943  Gap =  189.1262112509147 Sum =  1.0986377951104362
Iteration =  12  Dual obj =  0.8310082614343792  Primal_obj =  76.4272381848709  Gap =  75.59622992343652 Sum =  1.0265317406725267
Iteration =  13  Dual obj =  0.8334959847408154  Primal_obj =  35.38512921071692  Gap =  34.551633225976104 Sum =  1.0559960875621754
Iteration =  14  Dual obj =  0.8356669670883747  Primal_obj =  47.39027111142097  Gap =  46.5546041443326 Sum =  1.0897321649404912
Iteration =  15  Dual obj =  0.8371277836175466  Primal_obj =  19.070226460497388  Gap =  18.23309867687984 Sum =  1.0450524582754201
Iteration =  16  Dual obj =  0.837715889608687  Primal_obj =  11.445866200473935  Gap =  10.608150310865248 Sum =  1.0071295181243687
Iteration =  17  Dual obj =  0.8380330423533668  Primal_obj =  6.366342158373163  Gap =  5.528309116019797 Sum =  1.0124325372620502
Iteration =  18  Dual obj =  0.8381731929110532  Primal_obj =  3.397162959426851  Gap =  2.558989766515798 Sum =  1.018761810577887
Iteration =  19  Dual obj =  0.8382482681886885  Primal_obj =  2.7680544804258034  Gap =  1.929806212237115 Sum =  1.0150338095294715
Iteration =  20  Dual obj =  0.8383018744667892  Primal_obj =  2.2571453112237676  Gap =  1.4188434367569784 Sum =  1.000423929897495
Iteration =  21  Dual obj =  0.8383312998835667  Primal_obj =  1.607705672789336  Gap =  0.7693743729057693 Sum =  0.995776339030223
Iteration =  22  Dual obj =  0.838344484197291  Primal_obj =  1.1962794943288322  Gap =  0.35793501013154116 Sum =  1.0006893714657885
Iteration =  23  Dual obj =  0.8383500868110074  Primal_obj =  1.053976649924076  Gap =  0.2156265631130685 Sum =  1.0022944280499753
Iteration =  24  Dual obj =  0.8383533425398846  Primal_obj =  1.0015104270036785  Gap =  0.16315708446379396 Sum =  1.0006865649818077
Iteration =  0  Dual obj =  0.8383533425398846  Primal_obj =  1.0015104270036785  Gap =  0.16315708446379396 Sum =  1.0006865649818077
Iteration =  1  Dual obj =  0.8383553880209684  Primal_obj =  0.9377686091830651  Gap =  0.09941322116209672 Sum =  1.000274610861961
Iteration =  2  Dual obj =  0.8383575821458025  Primal_obj =  0.9489770797651216  Gap =  0.11061949761931911 Sum =  0.9992678783150706
Iteration =  3  Dual obj =  0.8383593191155287  Primal_obj =  0.9148866257356374  Gap =  0.07652730662010865 Sum =  0.9995385795661591
Iteration =  4  Dual obj =  0.8383602852049419  Primal_obj =  0.9072768089879071  Gap =  0.0689165237829652 Sum =  0.9996676450209593
Iteration =  5  Dual obj =  0.8383609495501632  Primal_obj =  0.8873523482260985  Gap =  0.04899139867593538 Sum =  0.9998724847899413
Iteration =  6  Dual obj =  0.8383616133397823  Primal_obj =  0.8756157696385813  Gap =  0.037254156298799024 Sum =  0.9999972203023934
Iteration =  7  Dual obj =  0.8383620346548909  Primal_obj =  0.8723014219354973  Gap =  0.033939387280606415 Sum =  1.0003812511059798
Iteration =  8  Dual obj =  0.8383624524831091  Primal_obj =  0.867041151000968  Gap =  0.02867869851785887 Sum =  1.000461921998125
Iteration =  9  Dual obj =  0.8383628214955057  Primal_obj =  0.8679555850235595  Gap =  0.029592763528053845 Sum =  1.0004741528999683
Iteration =  10  Dual obj =  0.838363168097688  Primal_obj =  0.8630770983438294  Gap =  0.024713930246141436 Sum =  1.0003805882620824
Iteration =  11  Dual obj =  0.83836343561923  Primal_obj =  0.8590083540675235  Gap =  0.020644918448293526 Sum =  1.000310846136977
Iteration =  12  Dual obj =  0.8383636453524509  Primal_obj =  0.85547882434631  Gap =  0.01711517899385906 Sum =  1.0001036086576915
Iteration =  13  Dual obj =  0.8383638092901781  Primal_obj =  0.8533539564498376  Gap =  0.014990147159659517 Sum =  1.0000464416182426
Iteration =  14  Dual obj =  0.8383638734915269  Primal_obj =  0.8519811240337605  Gap =  0.013617250542233617 Sum =  1.0000154691493826
Iteration =  15  Dual obj =  0.8383639856536  Primal_obj =  0.8511303920030238  Gap =  0.01276640634942372 Sum =  1.0001020061671435
Iteration =  16  Dual obj =  0.8383640917941326  Primal_obj =  0.8495538678677136  Gap =  0.01118977607358096 Sum =  1.0001105480540564
Iteration =  17  Dual obj =  0.8383641996842994  Primal_obj =  0.8489441597795914  Gap =  0.01057996009529194 Sum =  1.0002567369161683
Iteration =  18  Dual obj =  0.8383642862967535  Primal_obj =  0.8483149922358109  Gap =  0.009950705939057336 Sum =  1.0001863021550208
Iteration =  19  Dual obj =  0.83836436108228  Primal_obj =  0.8476689103068851  Gap =  0.009304549224605108 Sum =  1.0001729452390902
Iteration =  20  Dual obj =  0.838364424069471  Primal_obj =  0.8468448123020061  Gap =  0.008480388232535163 Sum =  1.0001633548116877
Iteration =  21  Dual obj =  0.8383644858265911  Primal_obj =  0.8455416742527048  Gap =  0.007177188426113701 Sum =  1.0000341642167623
Iteration =  22  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  23  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  24  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  0  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  1  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  2  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  3  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  4  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  5  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  6  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  7  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  8  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  9  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  10  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  11  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  12  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  13  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  14  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  15  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  16  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  17  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  18  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  19  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  20  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  21  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  22  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  23  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  24  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  0  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  1  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  2  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  3  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  4  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  5  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  6  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  7  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  8  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  9  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  10  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  11  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  12  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  13  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  14  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  15  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  16  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  17  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  18  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  19  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  20  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  21  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  22  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  23  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Iteration =  24  Dual obj =  0.8383645118759169  Primal_obj =  0.844852024484743  Gap =  0.006487512608826074 Sum =  1.00010041091508
Done, writing results...
